- en: Chapter 4. Creating Virtual Machines
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第4章。创建虚拟机
- en: '|   | *"...But if the concept of abstraction is so mundane in IT, what explains
    the increasing fascination with virtualization in recent years? The trend is even
    more hard-core in data centers, where virtualization is deeply ingrained in the
    development strategy of these environments since the mid-2000s. And the infatuation
    continues to grow....Accordingly, these facilities have been assaulted with virtual
    servers, virtual networks, virtual storage, virtual appliances, and other "V-technologies"
    that promise relief from the cuffs of reality."* |   |'
  id: totrans-1
  prefs: []
  type: TYPE_TB
  zh: '|   | *"...但是，如果抽象概念在IT领域如此普通，那是什么解释了近年来虚拟化越来越受到关注？这一趋势在数据中心中更加显著，自2000年代中期以来，虚拟化已经深深嵌入这些环境的开发战略中。而这种迷恋仍在增长……因此，这些设施已被虚拟服务器、虚拟网络、虚拟存储、虚拟设备和其他''V技术''所包围，承诺从现实的束缚中解脱出来。"*
    |   |'
- en: '|   | -- *Gustavo A. A. Santana, Data Center Virtualization Fundamentals* |'
  id: totrans-2
  prefs: []
  type: TYPE_TB
  zh: '|   | -- *古斯塔沃·A·A·桑塔纳，《数据中心虚拟化基础》* |'
- en: In [Chapter 3](ch03.html "Chapter 3. Creating Containers"), *Creating Containers*,
    we explored the creation, configuration, and control of LXC containers using Proxmox
    VE. In this chapter, we turn our focus to KVM-QEMU virtual machine creation and
    control with Proxmox VE.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第3章](ch03.html "第3章。创建容器")中，*创建容器*，我们探讨了如何使用Proxmox VE创建、配置和控制LXC容器。在本章中，我们将重点介绍如何使用Proxmox
    VE创建和控制KVM-QEMU虚拟机。
- en: While we contrasted virtual machines with containers in [Chapter 1](ch01.html
    "Chapter 1. Proxmox VE Fundamentals"), *Proxmox VE Fundamentals*, we will take
    this opportunity to dive deeper into specific advantages virtual machines still
    seem to have over containers despite the clear signs that we're in the thrall
    of a container revolution. At the same time, we will explore use cases based on
    what we've learned.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第1章](ch01.html "第1章。Proxmox VE基础")中，我们对比了虚拟机和容器，*Proxmox VE基础*，我们将借此机会深入探讨虚拟机相比容器仍然具备的一些优势，尽管显而易见地，我们正处于容器革命的浪潮中。同时，我们还将基于所学探索一些应用场景。
- en: 'We will then walk through the process of deriving virtual machines from ISO
    images using Proxmox VE. PVE is intended as a server virtualization platform;
    therefore, we''ll walk through the creation and configuration of two VMs: the
    first running Microsoft Windows 2012r2 and the second running Fedora Core 23 Server.'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将讲解如何使用Proxmox VE从ISO镜像创建虚拟机。PVE作为服务器虚拟化平台，因此我们将演示创建和配置两个虚拟机：第一个运行Microsoft
    Windows 2012r2，第二个运行Fedora Core 23 Server。
- en: Since both operating systems have graphical user interface components, we will
    take advantage of an opportunity to explore more of the PVE's feature set than
    we might otherwise have had an authentic need to cover.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这两个操作系统都有图形用户界面组件，我们将抓住这个机会，探索更多PVE的功能，这在没有实际需求时我们可能不会涉及。
- en: 'By the conclusion of [Chapter 4](ch04.html "Chapter 4. Creating Virtual Machines"), *Creating
    Virtual Machines*, we''ll have covered the following aspects of full virtualization
    with Proxmox VE:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 到了[第4章](ch04.html "第4章。创建虚拟机")的结尾，*创建虚拟机*，我们将涵盖使用Proxmox VE进行完全虚拟化的以下方面：
- en: Uploading ISOs to Proxmox VE's local storage
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将ISO上传到Proxmox VE的本地存储
- en: Creating and configuring virtual machines from the PVE web interface
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从PVE Web界面创建和配置虚拟机
- en: Interacting with VMs using the PVE web interface's console feature
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用PVE Web界面的控制台功能与虚拟机交互
- en: Reconfiguring a virtual machine
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重新配置虚拟机
- en: Controlling the state of a virtual machine
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制虚拟机的状态
- en: First, however, we will take a step back and explore the persistent role hardware
    virtualization will have, even as enthusiasm for containers echoes around us.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，首先我们将回顾并探讨硬件虚拟化在容器热潮中的持续作用。
- en: Distinguishing features of virtual machines
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 虚拟机的特征区别
- en: 'Though containers have clearly gained impressive momentum in so brief a period,
    virtual machines continue to have salient and distinguishing features. For example:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管容器在如此短的时间内确实取得了显著的进展，但虚拟机依然拥有显著的独特特点。例如：
- en: A VM may run any operating system designed for the host's architecture; for
    example, Android-x86, FreeBSD, Ubuntu, Windows Server, and even desktop OSs can
    all run on separate virtual machines on a Proxmox VE host, provided the host has
    adequate hardware resources.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机可以运行任何为主机架构设计的操作系统；例如，Android-x86、FreeBSD、Ubuntu、Windows Server，甚至桌面操作系统都可以在Proxmox
    VE主机上运行多个虚拟机，只要主机拥有足够的硬件资源。
- en: '![Distinguishing features of virtual machines](img/image_04_001.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![虚拟机的区别特征](img/image_04_001.png)'
- en: Ubuntu 15.04 virtual machine hosted on Proxmox VE and accessed via the SPICE
    console option in the PVE's Web interface
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在Proxmox VE上托管的Ubuntu 15.04虚拟机，通过PVE的Web界面中的SPICE控制台选项访问
- en: One VM may host many containers; when we look for creative and savvy data center
    solutions, we would like to stay consistently aware that OS virtualization and
    system virtualization have a complementary relationship, rather than a competitive
    or antagonistic one. VMs still offer more thorough isolation, for example, than
    containers.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一台虚拟机可以托管多个容器；当我们寻找创意和聪明的数据中心解决方案时，我们需要始终意识到，操作系统虚拟化和系统虚拟化是互补的关系，而不是竞争或对立的关系。例如，虚拟机仍然提供比容器更彻底的隔离。
- en: VMs and containers call for different security concerns and approaches. Impressively
    thorough standards for system virtualization are mature and freely available,
    while intelligence on OS virtualization security and standardized solutions are
    not yet mature.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟机和容器涉及不同的安全问题和方法。系统虚拟化的标准非常成熟且可自由获取，而操作系统虚拟化的安全性和标准化解决方案尚未成熟。
- en: Tip
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: We'll address security and PVE more thoroughly in [Chapter 7](ch07.html "Chapter 7. Securing
    Proxmox VE"), *Securing Proxmox VE*.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在[第7章](ch07.html "第7章：保护Proxmox VE")中更全面地讨论安全性和PVE，*保护Proxmox VE*。
- en: System virtualization's distinguishing features suggest that, for the time being,
    virtual machines are more flexible than containers; for example, many operating
    systems may coexist on a single **hypervisor** such as Proxmox VE. Containers
    cannot achieve this. For now, this means that pure containers will only exist
    when GNU-/Linux-based hosts have GNU-/Linux-based containers and Microsoft-based
    containers can only run on Microsoft OS-based hosts. Containers hosted by Proxmox
    VE thus require that the host OS share GNU/Linux libraries and binaries.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 系统虚拟化的区别特征表明，至少在当前，虚拟机比容器更具灵活性；例如，许多操作系统可以在单一的**虚拟化管理程序**上共存，如Proxmox VE。而容器无法实现这一点。目前，这意味着纯容器仅在基于GNU-/Linux的主机上才会存在，而基于Microsoft的容器只能在基于Microsoft操作系统的主机上运行。因此，由Proxmox
    VE托管的容器需要主机操作系统共享GNU/Linux库和二进制文件。
- en: With as much momentum as the container movement has, this restriction of containers
    to Unix-type operating systems may change very soon with the release of Windows
    Server 2016, which is now available to preview; Microsoft has announced plans
    to incorporate Docker into the product ([http://zdnet.com/article/microsoft-to-add-virtualized-containers-non-server-mode-to-windows-server-2016/](http://zdnet.com/article/microsoft-to-add-virtualized-containers-non-server-mode-to-windows-server-2016/),
    accessed June 1, 2015).
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管容器技术发展迅速，但随着Windows Server 2016的发布，这一限制可能会很快改变，Windows Server 2016现已可以预览；微软已宣布计划将Docker集成到该产品中（[http://zdnet.com/article/microsoft-to-add-virtualized-containers-non-server-mode-to-windows-server-2016/](http://zdnet.com/article/microsoft-to-add-virtualized-containers-non-server-mode-to-windows-server-2016/)，访问时间：2015年6月1日）。
- en: Note
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Docker is an open-source containerization solution under very active development
    and that is generating significant attention. A brief investigation suggests that
    a Windows host running Docker can run Linux containers. This counterpoint is quickly
    resolved once we realize Docker actually does this only with the support of a
    system virtualization layer, such as boot2docker ([https://github.com/boot2docker/boot2docker](https://github.com/boot2docker/boot2docker)).
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Docker是一个开源的容器化解决方案，正在积极开发并且引起了广泛关注。简要调查表明，运行Docker的Windows主机可以运行Linux容器。一旦我们意识到Docker实际上只有在系统虚拟化层的支持下才能做到这一点（如boot2docker
    [https://github.com/boot2docker/boot2docker](https://github.com/boot2docker/boot2docker)），这个反论点就很容易解决。
- en: 'The flexibility system virtualization may claim, with regard to operating systems,
    does come at a cost: *virtual machines require more resources and have more overhead
    than containers*.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 系统虚拟化在操作系统方面可能声称的灵活性，确实是有代价的：*虚拟机比容器需要更多的资源，并且有更多的开销*。
- en: In the next section, we'll explore scenarios that make system virtualization
    nevertheless compelling.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将探讨一些使系统虚拟化仍然具有吸引力的场景。
- en: Scenarios for system virtualization
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 系统虚拟化的应用场景
- en: 'From the distinguishing features discussed previously, some very powerful use
    cases emerge. For example:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 从前面讨论的区别特征中，我们可以得出一些非常强大的使用案例。例如：
- en: Cross-platform software development and testing
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跨平台软件开发和测试
- en: Administration and management of systems in an enterprise with concerns across
    platforms
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 企业中跨平台系统的管理和运维
- en: Dependency on legacy applications, systems, or data
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对遗留应用程序、系统或数据的依赖
- en: A proving ground for deployment of new systems or policies
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 新系统或政策部署的试验场
- en: Labs serving IT and ICT students
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为 IT 和 ICT 学生提供的实验室
- en: Productivity and consistency across platforms
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跨平台的生产力和一致性
- en: These scenarios highlight the changes brought about by each difference, particularly
    between the two forms of virtualization encouraged and supported by Proxmox VE,
    virtual machines, and containers.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这些场景突出了每个差异所带来的变化，特别是 Proxmox VE 支持的两种虚拟化形式——虚拟机和容器之间的差异。
- en: 'This chapter proceeds with confidence to an informed conclusion: containers
    and virtual machines (or OS virtualization and system virtualization) are two
    different tools that together provide the data center and its engineers with powerful
    flexibility and an opportunity to exercise discretion in the (re)formation of
    the datacenter.'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 本章自信地得出一个有根据的结论：容器和虚拟机（或操作系统虚拟化和系统虚拟化）是两种不同的工具，它们共同为数据中心及其工程师提供了强大的灵活性，并在（重）构建数据中心时提供了行使自由裁量权的机会。
- en: Let's have a look at the VM creation process with Proxmox VE.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看使用 Proxmox VE 创建虚拟机的过程。
- en: Creating a virtual machine
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建虚拟机
- en: This section provides an abstract overview of the virtual machine creation process,
    from configuring the machine to the installation of the operating system and ultimately
    to controlling its state.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 本节提供了虚拟机创建过程的抽象概述，从配置机器到操作系统的安装，再到最终控制其状态。
- en: Installation media
  id: totrans-42
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装介质
- en: In the best-case scenario, the operating system intended for a new virtual machine
    is available as a downloadable ISO file. This single file is intended to perfectly
    represent an entire CD or DVD. In the case of several GNU/Linux distributions,
    the full install media spans several DVDs.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在最佳情况下，计划用于新虚拟机的操作系统可以作为可下载的 ISO 文件。这单个文件旨在完美地代表整个 CD 或 DVD。在一些 GNU/Linux 发行版的情况下，完整的安装介质跨越多个
    DVD。
- en: Usually, in these cases, a network installation (or `netinst`) disk image is
    available that provides just enough operating system to drive the system devices,
    the installer, and then download and install requested software from online repositories.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，在这些情况下，会有一个网络安装（或 `netinst`）磁盘映像，提供足够的操作系统来驱动系统设备，安装程序，然后从在线仓库下载并安装所需的软件。
- en: When the OS is available as an ISO, we can simply download it to a remote workstation
    and then upload it to the PVE host's local storage using PVE's web interface,
    and carry on with the creation of the VM.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 当操作系统作为 ISO 文件可用时，我们可以简单地将其下载到远程工作站，然后通过 PVE 的 Web 界面上传到 PVE 主机的本地存储，并继续创建虚拟机。
- en: Uploading an ISO file to local storage on PVE
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 将 ISO 文件上传到 PVE 的本地存储
- en: There are five steps to working with an ISO image from a remote workstation.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 使用远程工作站处理 ISO 镜像有五个步骤。
- en: Download the ISO from the Web to a local workstation and verify that the image
    is not corrupted or compromised (see [http://www.online-tech-tips.com/cool-websites/what-is-checksum/](http://www.online-tech-tips.com/cool-websites/what-is-checksum/)
    to learn more about this process).
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 Web 下载 ISO 到本地工作站，并验证图像是否没有损坏或被篡改（请参阅 [http://www.online-tech-tips.com/cool-websites/what-is-checksum/](http://www.online-tech-tips.com/cool-websites/what-is-checksum/)
    了解有关此过程的更多信息）。
- en: Access the Proxmox VE web interface by navigating to it in a browser (point
    your browser to `https://<ip address>:8006`, where `<ipaddress>` is the IP address
    of PVE).
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过浏览器访问 Proxmox VE Web 界面（将浏览器指向 `https://<ip address>:8006`，其中 `<ip address>`
    是 PVE 的 IP 地址）。
- en: In the left pane of the browser window, **Server View** should be selected.
    Beneath the drop-down menu, a folder labeled **Datacenter** should be available.
    Expand the contents to reveal your PVE host, labeled by hostname. Expand that
    to reveal the host's local storage, and then select its local storage. In the
    following screenshot, for example, the hostname of the PVE host is pve4, so the
    local storage is labeled **local (pve4)**.![Uploading an ISO file to local storage
    on PVE](img/image_04_002.png)
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在浏览器窗口的左侧窗格中，应该选择 **Server View**。在下拉菜单下方，应该可以看到一个名为 **Datacenter** 的文件夹。展开该文件夹以显示
    PVE 主机，按主机名标记。再展开，显示该主机的本地存储，接着选择它的本地存储。例如，在下面的截图中，PVE 主机的主机名为 pve4，因此本地存储标记为
    **local (pve4)**。![将 ISO 文件上传到 PVE 本地存储](img/image_04_002.png)
- en: Navigating to a PVE node's local storage
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 导航到 PVE 节点的本地存储
- en: After choosing local storage, three tabs should appear in the right pane: **Summary**, **Content**,
    and **Permissions**. Select the **Content** tab to reveal two buttons in the right
    pane, **Templates** and **Uploads**:![Uploading an ISO file to local storage on
    PVE](img/image_04_003.png)
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择本地存储后，右侧窗格应显示三个标签：**摘要**、**内容**和**权限**。选择**内容**标签以显示右侧窗格中的两个按钮，**模板**和**上传**：![上传
    ISO 文件到 PVE 本地存储](img/image_04_003.png)
- en: Local storage
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 本地存储
- en: To proceed, click on the **Upload** button. In the dialog that appears, choose **ISO
    image** from the drop-down menu labeled **Content**, then click on the **Select
    File...** button to browse the workstation's filesystem for the disk image to
    be uploaded to the PVE host.![Uploading an ISO file to local storage on PVE](img/image_04_004.png)
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为继续操作，请点击**上传**按钮。在弹出的对话框中，从名为**内容**的下拉菜单中选择**ISO 镜像**，然后点击**选择文件...**按钮，浏览工作站的文件系统以选择要上传到
    PVE 主机的磁盘镜像文件。![上传 ISO 文件到 PVE 本地存储](img/image_04_004.png)
- en: Upload dialog
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 上传对话框
- en: Note
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The path to the ISO files uploaded to PVE's local storage via its web interface
    is `/var/lib/template/iso` by default. With this in mind, note that files can
    also be transferred to this location from a workstation via `scp` or `sftp` to
    the Proxmox VE server, provided the tools are installed on the remote workstation.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，通过 Web 界面上传到 PVE 本地存储的 ISO 文件路径为 `/var/lib/template/iso`。请注意，文件也可以通过 `scp`
    或 `sftp` 从工作站传输到该位置，前提是远程工作站上安装了相关工具。
- en: With the install media available to PVE, we're ready to configure and create
    a VM using Proxmox VE's web interface. The next section explores the process.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在 PVE 可用安装介质的情况下，我们已准备好使用 Proxmox VE 的 Web 界面配置并创建虚拟机。下一部分将探讨这一过程。
- en: Preparing a virtual machine
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 准备虚拟机
- en: We begin the process by finding the hostname and local storage of our Proxmox
    VE instance in the server view of the PVE web interface. Select the host and click
    on the **Create VM** button (at the upper right corner of the page) to start configuring
    a new virtual machine.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过在 PVE Web 界面的服务器视图中找到 Proxmox VE 实例的主机名和本地存储开始该过程。选择主机并点击页面右上角的**创建虚拟机**按钮，开始配置新虚拟机。
- en: 'A dialog entitled **Create: Virtual Machine** appears in the browser window.
    This is used to provide initial specifications for the new virtual machine, including
    not only hardware specifications, but also the OS type and the name PVE will use
    to refer to the new VM.'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 一个名为**创建：虚拟机**的对话框将出现在浏览器窗口中。此对话框用于为新虚拟机提供初步规格，包括硬件规格、操作系统类型以及 PVE 用来引用新虚拟机的名称。
- en: 'The tabs, from left to right, are as follows:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 从左到右，标签页如下：
- en: General
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 常规
- en: OS
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统
- en: CD/DVD
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CD/DVD
- en: Hard Disk
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 硬盘
- en: CPU
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CPU
- en: Memory
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内存
- en: Network
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络
- en: Confirm
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确认
- en: After completing a tab, move forward either by clicking on the next tab in the
    sequence or by clicking on the **Next** button.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 完成一个标签页后，可以通过点击下一个标签页或点击**下一步**按钮继续操作。
- en: Anticipating the configuration tabs
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 预期配置标签页
- en: 'What follows is a brief overview of what we can expect from each tab in the
    **Create: Virtual Machine** dialog.'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是我们可以从**创建：虚拟机**对话框中每个标签页中期待的简要概述。
- en: General
  id: totrans-74
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 常规
- en: It's on the **General** tab that the name and VM ID of a virtual machine are defined.
    Note that the "name" field doesn't refer to the VM's hostname; that's defined
    when the OS is configured. Rather, it is the name that Proxmox VE will use to
    refer to this VM in the web interface.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在**常规**标签页中，定义了虚拟机的名称和 VM ID。请注意，"名称"字段指的不是虚拟机的主机名；主机名是在配置操作系统时定义的。此处的名称是 Proxmox
    VE 用来在 Web 界面中引用此虚拟机的名称。
- en: In a production environment, it's recommended that you stay deliberate and systematic
    with your naming scheme, just as you would be with a hostname in a datacenter.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在生产环境中，建议在命名方案上保持谨慎和系统化，就像在数据中心为主机命名一样。
- en: When defining the VM ID, it is similarly important to be rigorously systematic.
    Each VM and container must be assigned a unique number that PVE refers to as VM
    ID. Although Proxmox VE will provide a default VM ID number, this is an arbitrary
    system, rather than a deliberated system resulting from a well-formed policy.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在定义 VM ID 时，同样重要的是要保持严格的系统化。每个虚拟机和容器都必须分配一个唯一的数字，PVE 称之为 VM ID。虽然 Proxmox VE
    会提供一个默认的 VM ID，但这是一个任意的系统，而不是一个由良好制定的政策所产生的有意识系统。
- en: In a large production environment, consider assigning VM IDs in a dedicated
    range relative to the virtual server's purpose (for example, VM ID 1000-2000 for
    VMs providing web services). You'll appreciate that you did if your datacenter
    grows as you systematize backup plans and establish a plan for virtual-server
    lifecycle management.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在大型生产环境中，考虑根据虚拟服务器的用途为虚拟机分配专用的ID范围（例如，虚拟机ID 1000-2000用于提供Web服务的虚拟机）。如果你的数据中心随着备份计划的系统化和虚拟服务器生命周期管理计划的建立而扩展，你会感激你这样做过。
- en: OS
  id: totrans-79
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 操作系统
- en: The **OS** tab provides some support for creating VMs intended for use with
    specific operating systems. Note there are multiple options, based on the kernel
    version, for GNU/Linux distributions.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**操作系统**选项卡提供了创建面向特定操作系统的虚拟机的一些支持。请注意，对于GNU/Linux发行版，基于内核版本有多个选项。'
- en: '![OS](img/image_04_005.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![操作系统](img/image_04_005.png)'
- en: CD/DVD
  id: totrans-82
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 光盘/CD/DVD
- en: The **CD/DVD** tab provides an opportunity to specify the initial disc image
    to be used for installing the OS; alternatively, we can direct PVE to rely on
    a physical disc in a local optical drive. If you select an ISO image, you're asked
    to choose from among the ISOs that are already uploaded to Proxmox VE.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '**光盘/CD/DVD**选项卡提供了指定用于安装操作系统的初始光盘镜像的机会；或者，我们可以指示PVE依赖本地光驱中的物理光盘。如果选择ISO镜像，系统会要求你从已上传到Proxmox
    VE的ISO文件中选择。'
- en: Hard Disk
  id: totrans-84
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 硬盘
- en: On the **Hard Disk** tab, we can define the size of the secondary storage allocated
    for the VM. There's also a **Bus/Device** field, as well as a field labeled **Storage**
    to specify the location to store the virtual disk. For the purpose of this text,
    we'll keep this field set to the default, **local**.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在**硬盘**选项卡中，我们可以定义为虚拟机分配的二级存储的大小。还有一个**总线/设备**字段，以及一个标记为**存储**的字段，用于指定存储虚拟磁盘的位置。为了本文的目的，我们将保持该字段为默认值**local**。
- en: Tip
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: For more on virtual storage, see [Chapter 5](ch05.html "Chapter 5. Working with
    Virtual Disks"), *Working with Virtual Disks*.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 有关虚拟存储的更多信息，请参阅[第5章](ch05.html "第5章。使用虚拟磁盘")，*使用虚拟磁盘*。
- en: CPU
  id: totrans-88
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: CPU
- en: The **CPU** tab provides an opportunity to define not only the CPU socket count,
    but also the number of cores to utilize per socket.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**CPU**选项卡提供了定义CPU插槽数量的机会，还可以定义每个插槽使用的核心数。'
- en: Memory
  id: totrans-90
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 内存
- en: The **Memory** tab offers two methods for allocating RAM for the virtual machine;
    we can select a fixed amount in MB, or we can automatically allocate RAM within
    a specified range.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: '**内存**选项卡提供了两种为虚拟机分配RAM的方法；我们可以选择一个固定的MB值，也可以在指定范围内自动分配RAM。'
- en: Network
  id: totrans-92
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 网络
- en: Of particular interest on the Network tab are the three networking modes available
    in the left column of the tab and the opportunity to define the **Model** of the
    network interface in the right column.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在“网络”选项卡中，特别值得注意的是左列中提供的三种网络模式，以及右列中定义网络接口**模型**的机会。
- en: '![Network](img/image_04_006.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![网络](img/image_04_006.png)'
- en: In the preceding screenshot, the VM will be configured to behave as if it's
    connected directly to the physical network by relying on PVE's bridged mode. By
    way of contrast, the NAT (network address translation) mode connects the VM to
    an isolated LAN maintained by the host and well isolated from the physical network.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，虚拟机将配置为通过依赖PVE的桥接模式，表现得好像它直接连接到物理网络。相比之下，NAT（网络地址转换）模式将虚拟机连接到主机维护的孤立局域网，并且与物理网络完全隔离。
- en: In the same screenshot, the model of the network card is set to **Intel E1000**.
    Performance is not as good as we'd get from **virtio paravirtualization**, but
    Microsoft Windows guests will work out of the box with this model, whereas virtio
    would need additional drivers. Intel E1000 stands out for its compatibility, while
    virtio offers superior performance.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在相同的截图中，网络卡的模型设置为**Intel E1000**。性能不如我们从**virtio半虚拟化**中获得的效果，但Windows操作系统的虚拟机可以即插即用，而virtio则需要额外的驱动程序。Intel
    E1000以其兼容性突出，而virtio则提供更优越的性能。
- en: Tip
  id: totrans-97
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: A VM configured with NAT mode can access resources on the physical network,
    but is not visible or accessible to resources beyond the Proxmox VE host.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 配置为NAT模式的虚拟机可以访问物理网络上的资源，但不能被Proxmox VE主机之外的资源看到或访问。
- en: Proxmox VE's network model is sophisticated and very flexible. To learn more,
    see [Chapter 6](ch06.html "Chapter 6. Networking with Proxmox VE"), *Networking
    and Proxmox VE*, which is a chapter dedicated to Proxmox VE networking. Also,
    consider a visit to the wiki page [https://pve.proxmox.com/wiki/Network_Model](https://pve.proxmox.com/wiki/Network_Model).
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: Proxmox VE的网络模型复杂且非常灵活。要了解更多信息，请参见[第6章](ch06.html "第6章 网络与Proxmox VE")，*网络与Proxmox
    VE*，这是一个专门介绍Proxmox VE网络的章节。还可以访问[https://pve.proxmox.com/wiki/Network_Model](https://pve.proxmox.com/wiki/Network_Model)的维基页面。
- en: Confirm
  id: totrans-100
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 确认
- en: The **Confirm** tab offers a summary view of the VM configuration to review
    before committing to the creation of the VM.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '**确认**标签提供了虚拟机配置的概览，供在创建虚拟机之前进行审核。'
- en: On this tab, a **Finish** button appears where the **Next** button was on the
    other tabs. To create the VM, click on the **Finish** button.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在此标签页中，出现了一个**完成**按钮，位置与其他标签页中的**下一步**按钮相同。要创建虚拟机，请点击**完成**按钮。
- en: 'After completing the **Create: Virtual Machine** dialog, the virtual machine
    is configured—analogous to having built a physical computer, plugged it in, powered
    it up just long enough to insert your installation media in the optical drive,
    and then eagerly looking forward to it powering back on for the installation of
    the OS.'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 完成**创建：虚拟机**对话框后，虚拟机配置完成——这类似于构建了一台物理计算机，将其插电，打开电源，只开启足够长的时间以便将安装介质插入光驱，然后迫不及待地等待它重新开机以便安装操作系统。
- en: Tip
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Stay conscious of the host's hardware specifications and cognizant of how resources
    are allocated as VMs and containers accumulate on a PVE host.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 保持关注主机的硬件规格，并时刻注意随着虚拟机和容器在PVE主机上的积累，资源是如何分配的。
- en: 'The next step is to start the newly created VM and install its operating system.
    First, let''s step section steps through controlling the state of a virtual machine:
    starting it, shutting it down, and abruptly stopping it.'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是启动新创建的虚拟机并安装其操作系统。首先，让我们通过控制虚拟机的状态来了解步骤：启动、关闭和强制停止虚拟机。
- en: Controlling the state of a virtual machine
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 控制虚拟机的状态
- en: 'At this point in the process, the freshly created VM appears in **Server View**
    in a powered off state:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在此过程中的此时，刚创建的虚拟机以关机状态出现在**服务器视图**中：
- en: '![Controlling the state of a virtual machine](img/image_04_007.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![控制虚拟机的状态](img/image_04_007.png)'
- en: The icon of a VM that is stopped
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 停止状态的虚拟机图标
- en: In the preceding screenshot, the only VM on the host has a VM ID of 101 and
    the name `fedora-ch4`. A stopped VM is represented by a monitor icon with a black
    display.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中，主机上唯一的虚拟机的VM ID是101，名称为`fedora-ch4`。停止的虚拟机通过一个显示黑色屏幕的监视器图标表示。
- en: 'If we select the VM in the left pane, buttons to control its state appear in
    the right pane, which is exactly what we saw with containers in the previous chapter:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在左侧窗格中选择虚拟机，控制其状态的按钮将出现在右侧窗格，这正是我们在上一章中看到的容器操作：
- en: '![Controlling the state of a virtual machine](img/image_04_008.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![控制虚拟机的状态](img/image_04_008.png)'
- en: Starting a VM
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 启动虚拟机
- en: The **Start** button will "power on" the VM and the boot process will begin.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '**启动**按钮将“开机”虚拟机，并开始启动过程。'
- en: Note
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: A running VM is represented by a monitor icon with a white screen that visually
    distinguishes it from the icon for a stopped VM.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 运行中的虚拟机通过一个带白色屏幕的监视器图标表示，这与停止状态的虚拟机图标在视觉上有所区别。
- en: Once started, we can open the VM's noVNC console to see what's going on during
    the boot process, from the BIOS options through the OS's first interaction with
    the user. The same tool works for graphical user interfaces and command line interfaces.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦启动，我们可以打开虚拟机的noVNC控制台，查看从BIOS选项到操作系统与用户的首次互动过程。这个工具同样适用于图形用户界面和命令行界面。
- en: '![Controlling the state of a virtual machine](img/image_04_009.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![控制虚拟机的状态](img/image_04_009.png)'
- en: Changing the state of a running VM
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 更改运行中虚拟机的状态
- en: To stop a virtual machine gracefully, use the **Shutdown** button that becomes
    available upon start. Alternatively, use **Stop** to shut down a VM abruptly.
    The **Reset** button will halt the virtual machine, much as a hardware reset button
    would.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 要优雅地停止虚拟机，请使用**关机**按钮，该按钮在启动后可用。或者，使用**停止**来强制关闭虚拟机。**重置**按钮将停止虚拟机，类似于硬件重置按钮的作用。
- en: To destroy a virtual machine, ensure first that it is in a stopped state, then
    press the **Remove** button to reveal a concerned warning that the process initiated
    is not reversible. PVE will offer the choice to **Cancel** and give the action
    additional consideration, or to follow through with the destruction of the machine.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 要销毁虚拟机，请首先确保虚拟机处于停止状态，然后按下**删除**按钮，系统会显示一个警告，告知该操作无法撤销。PVE将提供**取消**选项，允许你重新考虑该操作，或者继续执行销毁虚拟机的操作。
- en: Controlling a VM from the PVE command line
  id: totrans-123
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从PVE命令行控制虚拟机
- en: 'The `qm` command allows us to control the state of a VM from a Proxmox VE command
    line interface. In the following examples, the changes will be made to the virtual
    machine with VM ID 101:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: '`qm`命令使我们能够通过Proxmox VE命令行界面控制虚拟机的状态。在接下来的示例中，所有更改将应用于ID为101的虚拟机：'
- en: '`qm destroy 101`: This destroys the VM and deletes all of its used or owned
    volumes'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm destroy 101`：销毁虚拟机并删除其所有已使用或拥有的存储卷'
- en: '`qm reset 101`: This resets the VM'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm reset 101`：重置虚拟机'
- en: '`qm resume 101`: This resumes the VM (if it''s suspended)'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm resume 101`：恢复虚拟机（如果它被暂停）'
- en: '`qm shutdown 101`: This shuts down the VM'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm shutdown 101`：关机虚拟机'
- en: '`qm start 101`: This starts the VM'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm start 101`：启动虚拟机'
- en: '`qm stop 101`: This stops the VM'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm stop 101`：停止虚拟机'
- en: '`qm suspend 101`: This suspends the machine'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`qm suspend 101`：暂停虚拟机'
- en: Note
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The qm command offers full control of a VM, from creation to destruction. To
    learn more, visit the manual page at [https://pve.proxmox.com/wiki/Manual:_qm](https://pve.proxmox.com/wiki/Manual:_qm).
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: qm命令提供对虚拟机的全面控制，从创建到销毁。欲了解更多信息，请访问手册页面：[https://pve.proxmox.com/wiki/Manual:_qm](https://pve.proxmox.com/wiki/Manual:_qm)。
- en: 'In the sections that follow, the abstract outline and illustration of the VM-creation
    and configuration process will become more concrete and specific as we apply what
    we learned to building two virtual machines: first we''ll walk through the creation
    of a Windows Server 2012r2 VM, and then we''ll create a Fedora 23 Server virtual
    machine.'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的章节中，虚拟机创建和配置过程的概要和示意图将变得更加具体和详细，我们将应用所学内容来构建两个虚拟机：首先我们将介绍如何创建Windows Server
    2012r2虚拟机，然后我们将创建一个Fedora 23 Server虚拟机。
- en: Practicing the creation of virtual machines
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习创建虚拟机
- en: In this section and the next, we'll run through the entire VM creation process,
    from the acquisition of ISO images, to the configuration of the machines, and
    the installation of the operating systems.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节和下一节中，我们将演示整个虚拟机创建过程，从ISO镜像的获取，到虚拟机的配置，再到操作系统的安装。
- en: First, we'll step through the process for a Microsoft Windows Server 2012r2
    system. Afterwards, we'll look at the creation of a VM intended for Fedora 23
    Server.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将通过微软Windows Server 2012r2系统的过程。随后，我们将介绍如何创建一个Fedora 23 Server虚拟机。
- en: Virtualizing Windows Server 2012r2 with Proxmox VE
  id: totrans-138
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用Proxmox VE虚拟化Windows Server 2012r2
- en: If you want to precisely follow the installation process outlined here, it will
    require a Windows Server 2012r2 ISO image, perhaps from an existing DVD if necessary.
    If you have access to the Volume License Center, you're perhaps able to download
    the image file from Microsoft by visiting [https://www.microsoft.com/Licensing/servicecenter/default.aspx](https://www.microsoft.com/Licensing/servicecenter/default.aspx).
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想精确按照这里描述的安装过程进行操作，你将需要一个Windows Server 2012r2的ISO镜像，必要时可以使用现有的DVD。如果你可以访问批量许可中心，你或许能够通过访问[https://www.microsoft.com/Licensing/servicecenter/default.aspx](https://www.microsoft.com/Licensing/servicecenter/default.aspx)从微软下载镜像文件。
- en: 'At the time of writing, Windows Server 2012r2 is available for evaluation (limited
    to 180 days) at Microsoft''s TechNet Evaluation Center: [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2).'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 写本文时，Windows Server 2012r2可在微软的TechNet评估中心进行评估（评估期限为180天）：[https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2)。
- en: '![Virtualizing Windows Server 2012r2 with Proxmox VE](img/image_04_010.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![使用Proxmox VE虚拟化Windows Server 2012r2](img/image_04_010.png)'
- en: Microsoft's TechNet Evaluation Center
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 微软的TechNet评估中心
- en: '![Virtualizing Windows Server 2012r2 with Proxmox VE](img/image_04_011.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![使用Proxmox VE虚拟化Windows Server 2012r2](img/image_04_011.png)'
- en: Sign up, login, and download Mircrosoft Windows Server 2012r2
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 注册、登录并下载微软Windows Server 2012r2
- en: Download the ISO from a workstation on the same physical network as your Proxmox
    VE server, and then upload the image to PVE via the web interface as described
    in the preceding section.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 从与您的Proxmox VE服务器处于同一物理网络的工作站下载ISO文件，然后按照前一节中描述的方式，通过Web界面将映像上传到PVE。
- en: When the upload is complete, it should be visible in the **Content** tab of
    the local storage.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 上传完成后，它应该会出现在本地存储的**内容**标签页中。
- en: '![Virtualizing Windows Server 2012r2 with Proxmox VE](img/image_04_012.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![使用Proxmox VE虚拟化Windows Server 2012r2](img/image_04_012.png)'
- en: Viewing available image files
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 查看可用的映像文件
- en: Configuring and creating the virtual machine
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置和创建虚拟机
- en: 'To configure and create a Windows Server VM quickly, follow these steps:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 要快速配置和创建Windows Server虚拟机，请按照以下步骤操作：
- en: To get started, upload the Microsoft Windows Server from your workstation to
    the Proxmox VE server as described previously.
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，将Microsoft Windows Server从工作站上传到Proxmox VE服务器，如前所述。
- en: With the OS install media now available to PVE, we can click on the **Create
    VM** button to initiate the **Create:** Virtual Machine dialog as described previously.
    Complete the fields in the **General** tab, as illustrated in the following screenshot:![Configuring
    and creating the virtual machine](img/image_04_013.png)
  id: totrans-152
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，操作系统安装介质已可供PVE使用，我们可以点击**创建虚拟机**按钮，启动如前所述的**创建：虚拟机**对话框。完成**常规**标签页中的字段，如以下截图所示：![配置和创建虚拟机](img/image_04_013.png)
- en: Proceed to the **OS** tab of the dialog by clicking on **Next**. The left column
    of this dialog consists of options for Microsoft operating systems. Choose the
    top-most option, **Microsoft Windows 8/Server 2012**, and click on **Next** to
    continue to the **CD/DVD** tab.![Configuring and creating the virtual machine](img/image_04_014.png)
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击**下一步**，进入对话框的**操作系统（OS）**标签页。该对话框的左侧栏包含了微软操作系统的选项。选择最上面的选项，**Microsoft
    Windows 8/Server 2012**，然后点击**下一步**继续到**CD/DVD**标签页。![配置和创建虚拟机](img/image_04_014.png)
- en: On the **CD/DVD** tab, select the top option to choose an ISO file. With the **Storage**
    field set to local, use the drop-down menu for the **ISO Image** field to choose
    the uploaded 2012r2 image. Click on **Next** to continue.![Configuring and creating
    the virtual machine](img/image_04_015.png)
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**CD/DVD**标签页中，选择顶部选项以选择ISO文件。将**存储**字段设置为本地，使用**ISO映像**字段的下拉菜单选择已上传的2012r2映像。点击**下一步**继续。![配置和创建虚拟机](img/image_04_015.png)
- en: On the **Hard Disk** tab, stay mindful that Server 2012r2 requires at least
    32 GB of storage. Set an appropriate disk size and ensure that **Bus/Device**
    is set to **IDE**; avoid choosing **virtio**. Set the format to **QEMU image format
    (qcow2)** and click on **Next** to continue to the **CPU** tab.![Configuring and
    creating the virtual machine](img/image_04_016.png)
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**硬盘**标签页，记住Windows Server 2012r2至少需要32 GB的存储。设置合适的磁盘大小，并确保**总线/设备**设置为**IDE**，避免选择**virtio**。将格式设置为**QEMU映像格式（qcow2）**，然后点击**下一步**继续到**CPU**标签页。![配置和创建虚拟机](img/image_04_016.png)
- en: Tip
  id: totrans-156
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: We'll cover **Bus/Device** types in the next chapter.
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们将在下一章中介绍**总线/设备（Bus/Device）**类型。
- en: On the **CPU** tab, configure the number of sockets and the number of cores
    per socket to commit to the VM. For the purposes of this exercise, I've set **Sockets**
    to `1` and set the number of cores to `2`. The **Type** field should be set to **Default
    (kvm64)**. Keep in mind that we can change the CPU configuration later as necessary.
    Click on **Next** to configure the memory for the VM.![Configuring and creating
    the virtual machine](img/image_04_017.png)
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**CPU**标签页，配置要分配给虚拟机的插槽数和每个插槽的核心数。为了本练习的目的，我将**插槽**设置为`1`，并将核心数设置为`2`。**类型**字段应设置为**默认（kvm64）**。请记住，稍后我们可以根据需要更改CPU配置。点击**下一步**以配置虚拟机的内存。![配置和创建虚拟机](img/image_04_017.png)
- en: Windows Server 2012r2 requires a minimum of 512 MB of RAM. As illustrated in
    the following screenshot, PVE provides an option for using a fixed amount of RAM
    or automatically allocating RAM within a specified range.![Configuring and creating
    the virtual machine](img/image_04_018.png)
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Windows Server 2012r2至少需要512 MB的内存。如以下截图所示，PVE提供了固定内存大小或在指定范围内自动分配内存的选项。![配置和创建虚拟机](img/image_04_018.png)
- en: For the purposes of this exercise, a fixed amount of 2,048 MB of memory has
    been allocated, with the understanding that this can be easily changed later.
    When the memory is tuned the way you'd like, click on **Next** to configure the
    network.
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 出于本次练习的目的，已分配了固定的 2,048 MB 内存，理解这一设置稍后可以轻松更改。当内存调整到您希望的状态时，点击**下一步**以配置网络。
- en: As the following screenshot illustrates, the IP address of a VM can't be preconfigured
    like it can be with containers:![Configuring and creating the virtual machine](img/image_04_019.png)
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如下截图所示，虚拟机的 IP 地址不能像容器那样预先配置：![配置和创建虚拟机](img/image_04_019.png)
- en: As illustrated, **Bridged mode** is selected rather than **NAT mode**. This
    choice is deliberate. In this case, **NAT mode** would prevent us from accessing
    the virtual machine's desktop through Microsoft's, Remote Desktop Protocol or
    Remote Server Administration Tool.
  id: totrans-162
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如图所示，选择了**桥接模式**而不是**NAT模式**。这一选择是故意做出的。在这种情况下，**NAT模式**会阻止我们通过微软的远程桌面协议或远程服务器管理工具访问虚拟机的桌面。
- en: '**Bridged mode** provides more choices for accessing the VM, since it''s somewhat
    analogous to attaching a machine to a switch on the physical network. There are
    consequences for this decision in regard to isolation and security, especially
    with Proxmox''s firewall disabled.'
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**桥接模式**提供了更多访问虚拟机的选择，因为它有点类似于将计算机连接到物理网络中的交换机。做出这个决策时需要考虑隔离性和安全性，尤其是在 Proxmox
    防火墙禁用的情况下。'
- en: Tip
  id: totrans-164
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: To learn more about PVE's integrated firewall features, visit [https://pve.proxmox.com/wiki/Proxmox_VE_Firewall#Enabling_firewall_for_qemu_guest_and_openvz_veth](https://pve.proxmox.com/wiki/Proxmox_VE_Firewall#Enabling_firewall_for_qemu_guest_and_openvz_veth).
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要了解有关 PVE 集成防火墙功能的更多信息，请访问 [https://pve.proxmox.com/wiki/Proxmox_VE_Firewall#Enabling_firewall_for_qemu_guest_and_openvz_veth](https://pve.proxmox.com/wiki/Proxmox_VE_Firewall#Enabling_firewall_for_qemu_guest_and_openvz_veth)。
- en: Networking can be reconfigured at any point after the creation of the virtual
    machine.
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 网络设置可以在虚拟机创建后随时重新配置。
- en: When the **Network** tab is configured to your satisfaction, click on **Next**
    to view a configuration summary and to confirm the configuration.
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当**网络**选项卡配置到您满意的状态时，点击**下一步**以查看配置摘要并确认配置。
- en: The final tab, labeled **Confirm**, provides a summary of the VM's configuration
    and the opportunity to finally create the VM.![Configuring and creating the virtual
    machine](img/image_04_020.png)
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后一页标签为**确认**，提供了虚拟机配置的摘要，并可最终创建虚拟机。![配置和创建虚拟机](img/image_04_020.png)
- en: Click on the **Finish** button to confirm your configuration and create the
    virtual machine, but feel encouraged to use this opportunity to return to a prior
    step and adjust the configuration.
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 点击**完成**按钮以确认配置并创建虚拟机，但您可以利用这个机会返回上一步并调整配置。
- en: Keep in mind, however, that many of these settings can be changed even after
    the VM is created and the OS installed, sometimes without even rebooting the machine.
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请记住，许多这些设置即使在虚拟机创建和操作系统安装后仍可以更改，有时甚至无需重启计算机。
- en: 'Within 30 seconds, the new VM will appear in the left frame of the Web interface:'
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 30 秒内，新的虚拟机将在 Web 界面的左侧框架中出现。
- en: '![Configuring and creating the virtual machine](img/image_04_021.png)'
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![配置和创建虚拟机](img/image_04_021.png)'
- en: Tip
  id: totrans-173
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**There''s another way**'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '**还有另一种方式**'
- en: Note that in this chapter, the Windows Server VM is configured so we can quickly
    try Windows Server virtualization using a TechNet trial; the configuration is
    not optimized for performance and is not ideal for production. Ideally, a Windows
    Server virtual machine in Proxmox VE that is production ready will be configured
    to take advantage of paravirtualization; in PVE, this is just a matter of choosing
    **virtio** on two tabs. On the **Hard Disk** tab, consider choosing **virtio**
    instead of **IDE**; and on the **Network** tab, consider virtio rather than Intel
    E1000\. This does, however, complicate the Windows Server installation since it
    doesn't ship with virtio drivers. Consequently, we'd need to upload drivers on
    an ISO image to PVE and make them available to Windows Server early in the OS
    installation process. Fortunately, this configuration is well documented on the
    PVE wiki at [https://pve.proxmox.com/wiki/Windows_2012_guest_best_practices](https://pve.proxmox.com/wiki/Windows_2012_guest_best_practices).
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在本章中，Windows Server 虚拟机的配置目的是为了让我们能够快速试用 Windows Server 虚拟化，使用的是 TechNet
    试用版；该配置并未针对性能进行优化，因此不适合生产环境。理想情况下，在 Proxmox VE 中，生产就绪的 Windows Server 虚拟机应配置为利用半虚拟化技术；在
    PVE 中，只需在两个选项卡上选择 **virtio**。在 **硬盘** 选项卡中，考虑选择 **virtio** 而不是 **IDE**；在 **网络**
    选项卡中，考虑选择 **virtio** 而不是 Intel E1000。不过，这会让 Windows Server 的安装变得复杂，因为它不带有 virtio
    驱动程序。因此，我们需要将驱动程序上传到 PVE 的 ISO 镜像，并在操作系统安装过程中早期就让 Windows Server 可用这些驱动。幸运的是，这一配置在
    PVE 的维基中有详细文档，地址是 [https://pve.proxmox.com/wiki/Windows_2012_guest_best_practices](https://pve.proxmox.com/wiki/Windows_2012_guest_best_practices)。
- en: Tip
  id: totrans-176
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Downloading the example code**'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '**下载示例代码**'
- en: You can download the example code files for this book from your account at [http://www.packtpub.com](http://www.packtpub.com).
    If you purchased this book elsewhere, you can visit [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files e-mailed directly to you.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从 [http://www.packtpub.com](http://www.packtpub.com) 登录您的账户，下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问
    [http://www.packtpub.com/support](http://www.packtpub.com/support) 并注册以直接通过电子邮件获取文件。
- en: 'You can download the code files by following these steps:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按照以下步骤下载代码文件：
- en: Log in or register to our website using your e-mail address and password.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用您的电子邮件地址和密码登录或注册我们的网站。
- en: Hover the mouse pointer on the **SUPPORT** tab at the top.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将鼠标指针悬停在顶部的 **支持** 标签上。
- en: Click on **Code Downloads & Errata**.
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **代码下载与勘误**。
- en: Enter the name of the book in the **Search** box.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **搜索** 框中输入书名。
- en: Select the book for which you're looking to download the code files.
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您想要下载代码文件的书籍。
- en: Choose from the drop-down menu where you purchased this book from.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从下拉菜单中选择您购买本书的地方。
- en: Click on **Code Download**.
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **代码下载**。
- en: Tip
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'Once the file is downloaded, please make sure that you unzip or extract the
    folder using the latest version of:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 文件下载完成后，请确保使用最新版本的以下工具解压或提取文件夹：
- en: WinRAR / 7-Zip for Windows
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WinRAR / 7-Zip for Windows
- en: Zipeg / iZip / UnRarX for Mac
  id: totrans-190
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zipeg / iZip / UnRarX for Mac
- en: 7-Zip / PeaZip for Linux
  id: totrans-191
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 7-Zip / PeaZip for Linux
- en: Starting the VM and installing Windows Server
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 启动虚拟机并安装 Windows Server
- en: After the virtual machine is configured and available for use, select it in
    the **Server View** in the upper left pane of the web interface. Starting the
    VM is as simple as pressing the Start button that is revealed in the right pane
    as previously described.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 在虚拟机配置好并可供使用后，在 web 界面的左上方的 **服务器视图** 中选择它。启动虚拟机就像之前描述的那样，简单地按下右侧面板上显示的启动按钮。
- en: When the machine is started, its icon will change from a monitor with a black
    screen to one with a white screen.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 当虚拟机启动时，它的图标将从带黑屏的显示器变为带白屏的显示器。
- en: 'To access the machine''s display via noVNC, click on the **Console** button;
    a window will popup that allows you to watch the VM''s boot from the Windows Server
    2012r2 install disc and will eventually display the **Windows Setup** wizard:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 要通过 noVNC 访问虚拟机的显示，点击 **控制台** 按钮；一个弹窗将会出现，允许您观看虚拟机从 Windows Server 2012r2 安装盘启动，并最终显示
    **Windows 设置** 向导：
- en: '![Starting the VM and installing Windows Server](img/image_04_022.png)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![启动虚拟机并安装 Windows Server](img/image_04_022.png)'
- en: Follow the on-screen instructions to complete the installation and configuration
    of Windows Server 2012r2.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 按照屏幕上的指示完成 Windows Server 2012r2 的安装和配置。
- en: Tip
  id: totrans-198
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Support for installation of this OS is available at [https://technet.microsoft.com/en-us/library/jj134246.aspx](https://technet.microsoft.com/en-us/library/jj134246.aspx).
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 支持安装此操作系统的资料可以在[https://technet.microsoft.com/en-us/library/jj134246.aspx](https://technet.microsoft.com/en-us/library/jj134246.aspx)查看。
- en: Once the Windows Setup dialogs are complete, the installation will proceed and
    the machine will restart a few times until it is ready for a user to log in. Log
    in to the server to see the new desktop.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦Windows安装对话框完成，安装将继续，机器将重启几次，直到准备好供用户登录。登录到服务器查看新的桌面。
- en: '![Starting the VM and installing Windows Server](img/image_04_023.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![启动虚拟机并安装Windows Server](img/image_04_023.png)'
- en: Note that both the two preceding screenshots have double mouse-pointers. One
    for the local workstation and one for the desktop accessed via noVNC. This is
    awkward and cumbersome.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，前面两张截图都有两个鼠标指针。一个是本地工作站的，另一个是通过noVNC访问的桌面的。这种情况比较尴尬且笨重。
- en: Tip
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**noVNC**'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: '**noVNC**'
- en: The name noVNC is counterintuitive; noVNC provides, in fact, remote desktop
    access and desktop sharing using the VNC protocol.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: noVNC这个名字有些反直觉；事实上，noVNC通过VNC协议提供远程桌面访问和桌面共享。
- en: However, noVNC does distinguish itself; instead of connecting to a remote computer
    running a VNC server by configuring a client, choosing noVNC produces, from an
    HTML5- and JavaScript-enabled browser, a pop-up window that renders the remote
    desktop served by the virtual machine.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，noVNC确实有所不同；它并不像通过配置客户端连接到运行VNC服务器的远程计算机，而是选择noVNC后，通过支持HTML5和JavaScript的浏览器弹出一个窗口，渲染由虚拟机提供的远程桌面。
- en: 'There''s a simple solution, enable **Use tablet for pointer** in the VM''s **Options**
    tab if it''s not already enabled:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 有一个简单的解决方案，如果尚未启用，可以在虚拟机的**选项**标签中启用**使用平板电脑作为指针**：
- en: '![Starting the VM and installing Windows Server](img/image_04_024.png)'
  id: totrans-208
  prefs: []
  type: TYPE_IMG
  zh: '![启动虚拟机并安装Windows Server](img/image_04_024.png)'
- en: If that doesn't resolve the issue, ensure the **Display** field on the hardware
    tab is set to **Default** rather than **SPICE**.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这样无法解决问题，请确保硬件标签上的**显示**字段设置为**默认**，而不是**SPICE**。
- en: Creating a VM for Fedora 23 Server
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建Fedora 23服务器虚拟机
- en: In the previous sections, we detailed the configuration of a virtual machine
    intended for use with Windows Server 2012r2\. In this section, we'll build on
    our experience and apply what we learned to building a server running Fedora 23
    (Server). Creating this VM offers a simple way to practice using paravirtualization
    for the virtual network interface card and the virtual hard-disk interface.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的章节中，我们详细介绍了用于Windows Server 2012r2的虚拟机配置。在本节中，我们将在之前的经验基础上，运用所学知识来构建一台运行Fedora
    23（服务器版）的服务器。创建这个虚拟机提供了一种简单的方式来练习使用虚拟网络接口卡和虚拟硬盘接口的准虚拟化。
- en: Review Fedora 23 Server installation at [http://www.tecmint.com/installation-of-fedora-23-server-and-administration-with-cockpit-tool/](http://www.tecmint.com/installation-of-fedora-23-server-and-administration-with-cockpit-tool/).
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[http://www.tecmint.com/installation-of-fedora-23-server-and-administration-with-cockpit-tool/](http://www.tecmint.com/installation-of-fedora-23-server-and-administration-with-cockpit-tool/)查看Fedora
    23服务器的安装过程。
- en: Download the netinst ISO from [http://mirrors.rit.edu/fedora/fedora/linux/releases/23/Server/x86_64/iso/Fedora-Server-netinst-x86_64-23.iso](http://mirrors.rit.edu/fedora/fedora/linux/releases/23/Server/x86_64/iso/Fedora-Server-netinst-x86_64-23.iso).![Creating
    a VM for Fedora 23 Server](img/image_04_025.png)
  id: totrans-213
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从[http://mirrors.rit.edu/fedora/fedora/linux/releases/23/Server/x86_64/iso/Fedora-Server-netinst-x86_64-23.iso](http://mirrors.rit.edu/fedora/fedora/linux/releases/23/Server/x86_64/iso/Fedora-Server-netinst-x86_64-23.iso)下载netinst
    ISO文件。![创建Fedora 23服务器虚拟机](img/image_04_025.png)
- en: Downloading the Fedora 23 net installation image
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 下载Fedora 23的网络安装镜像
- en: Login to the PVE web interface.
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录PVE的Web界面。
- en: Upload the image to PVE's local storage as previously described.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如前所述，将镜像上传到PVE的本地存储。
- en: Click on **Create VM**, just as we did for Windows Server 2012r2.
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建虚拟机**，就像我们为Windows Server 2012r2所做的那样。
- en: 'In the **General** tab of the **Create: Virtual Machine** dialog, give the
    machine a well-considered name; in the following screenshot, `fedora-ch4` is used
    and the VM is assigned VM ID 101\. Proceed to the **OS** tab.![Creating a VM for
    Fedora 23 Server](img/image_04_026.png)'
  id: totrans-218
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**创建虚拟机**对话框的**常规**标签页中，给虚拟机取一个合适的名字；在以下截图中，使用了`fedora-ch4`，虚拟机被分配了VM ID 101。接着进入**操作系统**标签页。![创建Fedora
    23服务器虚拟机](img/image_04_026.png)
- en: On the **OS** tab, there are four options that aren't for Microsoft Windows;
    for Fedora 23, choose the **Linux 4.X/3.X/2.6 Kernel (I26)** radio button and
    proceed to the **CD/DVD** tab.![Creating a VM for Fedora 23 Server](img/image_04_027.png)
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**操作系统**选项卡中，有四个选项不是针对Microsoft Windows的；对于Fedora 23，选择**Linux 4.X/3.X/2.6内核（I26）**单选按钮，然后继续进入**CD/DVD**选项卡。![创建Fedora
    23 Server虚拟机](img/image_04_027.png)
- en: Choose the first option on the **CD/DVD** tab, the **Use CD/DVD disc image file
    (iso)** radio button; choose **local** in the **Storage** field and choose the
    image file uploaded in step 4 from the **ISO Image** drop-down menu:![Creating
    a VM for Fedora 23 Server](img/image_04_028.png)
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**CD/DVD**选项卡中选择第一个选项，选择**使用CD/DVD光盘镜像文件（iso）**单选按钮；在**存储**字段中选择**本地**，然后从**ISO镜像**下拉菜单中选择在第4步上传的镜像文件：![创建Fedora
    23 Server虚拟机](img/image_04_028.png)
- en: Selecting the Fedora install disk on the CD/DVD tab
  id: totrans-221
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在**CD/DVD**选项卡上选择Fedora安装磁盘
- en: Proceed to the **Hard Disk** tab to configure a virtual hard disk for the Fedora
    Server VM.
  id: totrans-222
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 进入**硬盘**选项卡，配置Fedora Server虚拟机的虚拟硬盘。
- en: On this virtual machine, we'll rely on paravirtualization for improved efficiency.
    On the **Hard Disk** tab, choose **VIRTIO** from the **Bus/Device** drop-down
    menu. Note that in the following screenshot, the **Disk size** field has changed
    from the default 32 GB to 64 GB; please choose a disk size at your discretion.
    When finished, continue to the **CPU** tab.![Creating a VM for Fedora 23 Server](img/image_04_029.png)
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这台虚拟机上，我们将依赖半虚拟化来提高效率。在**硬盘**选项卡中，从**总线/设备**下拉菜单中选择**VIRTIO**。请注意，在下图中，**磁盘大小**字段已从默认的32
    GB更改为64 GB；请根据需要选择磁盘大小。完成后，继续进入**CPU**选项卡。![创建Fedora 23 Server虚拟机](img/image_04_029.png)
- en: Configuring the Virtual Disk
  id: totrans-224
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 配置虚拟磁盘
- en: 'We''ll configure the **CPU** tab just as we did for the Windows Server 2012r2
    VM we created in the preceding section: allocate 1 socket and 2 cores, and specify **Default
    (KVM64)** in the **Type** drop-down menu. When the **CPU** tab is configured to
    your satisfaction, proceed to the Memory tab to allocate RAM for the VM.'
  id: totrans-225
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将按照前面部分中创建Windows Server 2012r2虚拟机时的配置方式来配置**CPU**选项卡：分配1个插槽和2个核心，并在**类型**下拉菜单中选择**默认（KVM64）**。当**CPU**选项卡配置完成后，继续进入内存选项卡为虚拟机分配RAM。
- en: Use your discretion on the **Memory** tab. In the screenshot below, a fixed-size
    memory of 1024 MB is specified. Once you've allocated RAM according to your preferences,
    continue to the **Network** tab.![Creating a VM for Fedora 23 Server](img/image_04_030.png)
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**内存**选项卡中根据需要调整。在下面的截图中，指定了一个固定大小的1024 MB内存。分配好内存后，继续进入**网络**选项卡。![创建Fedora
    23 Server虚拟机](img/image_04_030.png)
- en: Allocate RAM for the Fedora virtual machine on the Memory tab
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在内存选项卡中为Fedora虚拟机分配RAM
- en: On the network tab, let's configure Fedora so it's accessible to other machines
    on the physical network; just as we did with Microsoft Server, choose the **Bridged
    mode** radio button. If your PVE host has a single network interface, set the **Bridge**
    drop-down menu to `vmbr0`; otherwise, use your discretion to choose an appropriate
    bridge.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在网络选项卡中，我们将配置Fedora，使其可以被物理网络上的其他机器访问；就像我们为Microsoft Server所做的那样，选择**桥接模式**单选按钮。如果您的PVE主机只有一个网络接口，将**桥接**下拉菜单设置为`vmbr0`；否则，请根据需要选择一个适当的桥接。
- en: Then, in the right-hand column of the **Network** tab, select **VirtIO (paravirtualized)**
    as the **Model** of the virtual network interface. To review, **Intel E1000**
    is our most widely compatible choice, while **virtio** is the best-performing
    alternative; both are supported "out of the box" by Fedora Server.
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 然后，在**网络**选项卡的右侧列中，选择**VirtIO（半虚拟化）**作为虚拟网络接口的**模型**。回顾一下，**Intel E1000**是我们最兼容的选择，而**virtio**则是性能最好的替代选项；这两者都被Fedora
    Server原生支持。
- en: '![Creating a VM for Fedora 23 Server](img/image_04_031.png)'
  id: totrans-230
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![创建Fedora 23 Server虚拟机](img/image_04_031.png)'
- en: Configuring bridged mode network on the Network tab
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在网络选项卡中配置桥接模式网络
- en: Proceed to the **Confirm** tab and commit to the VM configuration; this is a
    good opportunity to make discretionary changes to the configuration before building
    the VM.
  id: totrans-232
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 进入**确认**选项卡并提交虚拟机配置；在构建虚拟机之前，这是一个对配置进行自定义更改的好机会。
- en: Tip
  id: totrans-233
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Keep in mind through this process that, in every case except that of the virtual
    hard disk, the resources allocated here can be changed later with minimal fuss.
  id: totrans-234
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 请记住，在整个过程中，除了虚拟硬盘的情况，其他所有分配的资源都可以稍后轻松更改。
- en: 'Click on **Finish** to create the virtual machine and close the **Create: Virtual
    Machine** dialog.'
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**完成**来创建虚拟机并关闭**创建：虚拟机**对话框。
- en: We used the default display option in the Windows Server machine we configured
    in the previous section. It's a great option that works with an established technology
    underlying PVE's noVNC console.
  id: totrans-236
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 我们在上一节配置的Windows Server机器中使用了默认的显示选项。这是一个与PVE的noVNC控制台底层技术兼容的绝佳选项。
- en: However, by installing additional software on Windows Server, we could have
    relied on SPICE instead.
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 但是，通过在Windows Server上安装额外的软件，我们本可以依赖SPICE来完成。
- en: Tip
  id: totrans-238
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**SPICE**'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '**SPICE**'
- en: This option appears in the menu as **SPICE** (the Simple Protocol for Independent
    Computing Environments), but it refers either to the SPICE protocol that's relied
    on, or to the dependence on a combination of SPICE components, including guest
    tools (installed on the VM) and the SPICE client installed on the Workstation.
    We can infer from this that making use of SPICE requires some post-installation
    work. SPICE is the only solution whose explicit mission is to provide remote access
    to VMs. Moreover, clients are available for mobile devices and several operating
    systems, and the protocol offers many options for both implementation and usage.
    Red Hat is the current developer of this open source solution, and it promotes
    it heavily as part of its KVM-QEMU virtualization platform. The spice-module is
    also, however, integrated into Proxmox VE for use with its own KVM-QEMU VMs. Since
    Fedora Server includes software to support the SPICE display, let's see what preparing
    for that is like.
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此选项在菜单中显示为**SPICE**（简单协议用于独立计算环境），但它指的是所依赖的SPICE协议，或者是依赖于一组SPICE组件的组合，包括安装在虚拟机上的客户工具以及安装在工作站上的SPICE客户端。我们可以从中推断出，使用SPICE需要一些安装后的工作。SPICE是唯一一个明确使命是提供远程访问虚拟机的解决方案。此外，SPICE客户端可用于移动设备和多个操作系统，并且该协议提供了许多实现和使用的选项。红帽是这一开源解决方案的当前开发者，并且它在其KVM-QEMU虚拟化平台中大力推广该解决方案。然而，spice-module也集成到Proxmox
    VE中，用于与其自己的KVM-QEMU虚拟机一起使用。由于Fedora Server包含支持SPICE显示的相关软件，接下来我们来看看为此做准备的步骤。
- en: While the Fedora Server virtual machine is still stopped, select its **Hardware**
    tab.
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当Fedora Server虚拟机仍然处于停止状态时，选择它的**硬件**选项卡。
- en: 'Double-click on the **Display** configuration; the **Edit: Display** dialog
    opens, with a drop-down menu labeled **Graphic Card**. Change the selection from **Default**
    to **SPICE** and click on the **OK** button:![Creating a VM for Fedora 23 Server](img/image_04_032.png)'
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 双击**显示**配置；**编辑：显示**对话框会打开，显示一个名为**显卡**的下拉菜单。将选择从**默认**更改为**SPICE**，然后点击**确定**按钮：![为
    Fedora 23 服务器创建虚拟机](img/image_04_032.png)
- en: Configuring the VM for use with the SPICE console
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 配置虚拟机以便使用SPICE控制台
- en: When you're ready to install Fedora 23 Server, select the VM in the left pane
    of the browser window.
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当你准备好安装Fedora 23 Server时，选择浏览器窗口左侧窗格中的虚拟机。
- en: Once selected, start the VM. Click on the arrow beside the console button to
    reveal a choice between the noVNC and SPICE consoles.![Creating a VM for Fedora
    23 Server](img/image_04_033.png)
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择后，启动虚拟机。点击控制台按钮旁边的箭头，以显示在noVNC和SPICE控制台之间的选择。![为 Fedora 23 服务器创建虚拟机](img/image_04_033.png)
- en: Choosing the SPICE console to access a running virtual machine
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 选择SPICE控制台以访问正在运行的虚拟机
- en: Select **SPICE** to launch a popup console browser window.
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**SPICE**以启动弹出控制台浏览器窗口。
- en: '![Creating a VM for Fedora 23 Server](img/image_04_034.png)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![为 Fedora 23 服务器创建虚拟机](img/image_04_034.png)'
- en: Initiating the installation of Fedora 23 on the virtual machine with the SPICE
    console
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 启动Fedora 23安装程序，使用SPICE控制台在虚拟机上进行安装
- en: Proceed with the installation by pressing *i* or navigating to **Install Fedora
    23** with the up and down cursor keys on the keyboard.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 通过按 *i* 键或使用键盘上的上下光标键导航到**安装 Fedora 23**来继续安装。
- en: After about 20 seconds, the graphical installer for Fedora 23 will begin to
    ask configuration questions, starting with the language to use with the installer,
    and moving on to the network configuration and host name. Ultimately, you'll also
    be asked to set the password of the root user and create additional accounts.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 大约20秒后，Fedora 23的图形安装程序将开始询问配置问题，从选择安装语言开始，然后进入网络配置和主机名设置。最终，系统还会要求你设置root用户的密码并创建其他账户。
- en: Tip
  id: totrans-252
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you have questions about network configuration for your new Fedora 23 VM,
    see the *Fedora 23 Networking Guide* at [https://docs.fedoraproject.org/en-US/Fedora/23/pdf/Networking_Guide/Fedora-23-Networking_Guide-en-US.pdf](https://docs.fedoraproject.org/en-US/Fedora/23/pdf/Networking_Guide/Fedora-23-Networking_Guide-en-US.pdf).
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你对新Fedora 23虚拟机的网络配置有疑问，请参阅*Fedora 23网络指南*，[https://docs.fedoraproject.org/en-US/Fedora/23/pdf/Networking_Guide/Fedora-23-Networking_Guide-en-US.pdf](https://docs.fedoraproject.org/en-US/Fedora/23/pdf/Networking_Guide/Fedora-23-Networking_Guide-en-US.pdf)。
- en: Follow the onscreen instructions to complete the Fedora 23 installation. The
    time spent on installation is contingent on how you allocated resources, how fast
    your Internet connection is, and what packages you choose to install during the
    initial Fedora 23 configuration process.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 按照屏幕上的指示完成Fedora 23的安装。安装所需的时间取决于你分配的资源、网络连接的速度，以及你在初始Fedora 23配置过程中选择安装的包。
- en: Tip
  id: totrans-255
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: '**Support for Fedora 23 Server installation**'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '**Fedora 23 Server安装的支持**'
- en: Fedora 23 Server features can be found at [https://getfedora.org/en/server/](https://getfedora.org/en/server/).
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在[https://getfedora.org/en/server/](https://getfedora.org/en/server/)找到Fedora
    23 Server的功能。
- en: The official Fedora 23 Server installation guide is at [https://docs.fedoraproject.org/en-US/Fedora/23/html/Installation_Guide/](https://docs.fedoraproject.org/en-US/Fedora/23/html/Installation_Guide/).
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 官方Fedora 23 Server安装指南请访问[https://docs.fedoraproject.org/en-US/Fedora/23/html/Installation_Guide/](https://docs.fedoraproject.org/en-US/Fedora/23/html/Installation_Guide/)。
- en: For post installation suggestions, go to [http://www.tecmint.com/things-to-do-after-fedora-23-installation/](http://www.tecmint.com/things-to-do-after-fedora-23-installation/).
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 有关安装后的建议，请访问[http://www.tecmint.com/things-to-do-after-fedora-23-installation/](http://www.tecmint.com/things-to-do-after-fedora-23-installation/)。
- en: Command line virtual machine creation
  id: totrans-260
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 命令行虚拟机创建
- en: We can use the `qm` create command to create a Proxmox VE virtual machine from
    the command line. This is a boon to command line users and those looking to script
    automated solutions.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用`qm`创建命令通过命令行创建Proxmox VE虚拟机。这对于命令行用户和寻求编写自动化解决方案的用户来说是一个福音。
- en: 'The bash script that follows creates a VM to run Fedora 23 Server:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 以下bash脚本创建了一个虚拟机来运行Fedora 23 Server：
- en: '[PRE0]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Tip
  id: totrans-264
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: See [https://pve.proxmox.com/wiki/Manual:_qm](https://pve.proxmox.com/wiki/Manual:_qm)
    to learn more about creating virtual machines from the Proxmox VE command line
    interface.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅[https://pve.proxmox.com/wiki/Manual:_qm](https://pve.proxmox.com/wiki/Manual:_qm)了解更多关于如何通过Proxmox
    VE命令行界面创建虚拟机的信息。
- en: Summary
  id: totrans-266
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概述
- en: To the shrewd administrator, the capability to utilize containers in conjunction
    with virtual machines in production environments offers flexibility and increased
    opportunities for professional discretion and informed choices. System virtualization
    continues to have a currency in the datacenter.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 对于精明的管理员而言，在生产环境中将容器与虚拟机结合使用的能力提供了灵活性，并增加了职业判断和明智选择的机会。系统虚拟化在数据中心仍然具有很大的价值。
- en: Consequently, we began this chapter with a high-level overview of the VM creation
    and configuration process with Proxmox VE—from obtaining the install media, to
    configuring the VM, and installing the operating system.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们以Proxmox VE的虚拟机创建和配置过程的高级概述开始了本章内容——从获取安装介质，到配置虚拟机，再到安装操作系统。
- en: 'Afterwards, we took that abstract outline and applied it to two concrete cases:
    the creation of a Microsoft Windows Server 2012r2 and Fedora 23 Server virtual
    machines.'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 此后，我们将该抽象大纲应用于两个具体案例：创建Microsoft Windows Server 2012r2和Fedora 23 Server虚拟机。
- en: In [Chapter 5](ch05.html "Chapter 5. Working with Virtual Disks"), *Working
    with Virtual Drives*, you will learn all you need to know to make informed choices
    when determining what format best suits our virtual hard drives.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第5章](ch05.html "第5章：使用虚拟磁盘")《使用虚拟驱动器》中，你将学习到所有必要的知识，以便在确定最适合我们虚拟硬盘的格式时做出明智的选择。
- en: We'll give particular attention to making use of VMs created with Oracle's VirtualBox,
    VMware Player, and VMware workstation in our new Proxmox virtual environments.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将特别关注如何在新的Proxmox虚拟环境中使用Oracle的VirtualBox、VMware Player和VMware Workstation创建的虚拟机。
- en: There's a certain satisfaction in repurposing something that was never intended
    for our scenario.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在将某些本不为我们的场景设计的东西重新利用时，总会有一种满足感。
- en: Let's experience that thrill next.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们接下来体验一下这种兴奋感。
