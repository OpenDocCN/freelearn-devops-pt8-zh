- en: Azure App Service
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 应用服务
- en: Azure App Service is one of the biggest and most commonly used services available
    in the Azure cloud. It allows for easy development of web applications with multiple
    features available (such as support for different platforms, including .NET, PHP,
    and Java), manual and automated scaling, and different performance options. It's
    a general platform and runtime that fuels other services, such as WebJobs and
    Azure Functions.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 应用服务是 Azure 云中最大、最常用的服务之一。它允许轻松开发带有多种功能的 Web 应用程序（例如支持不同平台，包括 .NET、PHP
    和 Java），手动和自动扩展，以及不同的性能选项。它是一个通用平台和运行时，支持 WebJobs 和 Azure Functions 等其他服务。
- en: 'In this chapter, you will learn about the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容包括：
- en: Creating and deploying Azure App Service
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建并部署 Azure 应用服务
- en: Working with different operating systems and platforms
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与不同操作系统和平台的兼容性
- en: Choosing the right App Service Plan and what their features are
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择合适的 App Service Plan 以及它们的功能
- en: Securing App Service using different security providers
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用不同的安全提供商来确保应用服务的安全
- en: Diagnosing and monitoring your applications
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 诊断和监控您的应用程序
- en: Technical requirements
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To perform the exercises in this chapter, you will need the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 要执行本章的练习，您需要以下内容：
- en: Access to an Azure subscription
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问 Azure 订阅
- en: Visual Studio 2017 with Azure development workload installed
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装了 Azure 开发工作负载的 Visual Studio 2017
- en: Visual Studio Code installed (available at [https://code.visualstudio.com/](https://code.visualstudio.com/))
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装 Visual Studio Code（可通过 [https://code.visualstudio.com/](https://code.visualstudio.com/)
    下载）
- en: Creating and deploying Azure App Service
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建并部署 Azure 应用服务
- en: To get started with Azure App Service, you have to learn how to create that
    service and deploy your code. You will see how Azure provides many different ways
    for doing so, and each path can be easier or harder, depending on your current
    needs and the specification of your application. However, the strength of a cloud
    and **Platform as a Service** (**PaaS**) offering lies in the straightforward
    and intuitive process of provisioning new components of your system.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始使用 Azure 应用服务，您需要学习如何创建该服务并部署代码。您将看到 Azure 提供了许多不同的方式来完成此操作，每条路径的难易程度取决于您的当前需求和应用程序的具体要求。然而，云和**平台即服务**（**PaaS**）的强大之处在于提供了一个直接且直观的过程，用于配置系统的新组件。
- en: Creating Azure App Service using the Azure Portal
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure 门户创建 Azure 应用服务
- en: To begin with App Service, I will show you how you can create your very first
    web app using the Azure Portal. In fact, all you need is your mouse and keyboard
    (because each application has to have a name)—neither external hardware nor detailed
    configuration information is required here, because Azure will do everything for
    you.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我将向您展示如何使用 Azure 门户创建您的第一个 Web 应用。事实上，您只需要鼠标和键盘（因为每个应用都需要一个名称）——这里不需要外部硬件或详细的配置信息，因为
    Azure 会为您完成所有操作。
- en: Selecting Azure Web App from available services
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从可用服务中选择 Azure Web App
- en: 'To create Azure App Service in the Azure Portal, you first have to find it
    in the list of available services. The easiest way to do so is to click on + Create
    a resource button and search for `Web App`:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 Azure 门户中创建 Azure 应用服务，首先需要在可用服务列表中找到它。最简单的方法是点击 + 创建资源 按钮并搜索 `Web App`：
- en: '![](img/d25025a9-6da7-46da-a085-d5c4df60ac68.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d25025a9-6da7-46da-a085-d5c4df60ac68.png)'
- en: Instead of using the + Create a resourcebutton, you can click on App Services—it
    will forward you to a different view, where you can create an App Service by clicking
    on the + Addbutton. This is true for all of the most popular Azure services, such
    as SQL databases, virtual machines, and storage accounts.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以选择点击 App Services，而不是使用 + 创建资源 按钮——这会将您带到不同的视图，在那里您可以通过点击 + 添加 按钮来创建一个应用服务。这适用于所有最流行的
    Azure 服务，如 SQL 数据库、虚拟机和存储账户。
- en: 'As you can see, the Azure Portal tries to help you find the service most relevant
    to the search string. When you click on the Web Appitem, you will see another
    screen containing multiple similar items, all related in some way to the one you
    are searching for:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，Azure 门户会尽量帮助您找到与搜索字符串最相关的服务。当您点击 Web App 项时，会看到另一个屏幕，其中包含多个类似项，这些项在某种程度上都与您正在搜索的内容相关：
- en: '![](img/771e53e1-40c7-4474-a6c9-38cb3d536f89.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](img/771e53e1-40c7-4474-a6c9-38cb3d536f89.png)'
- en: For the purpose of this exercise, select Web App*, *and then click on the Create
    button at the right bottom of the screen.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次练习中，选择 Web App*，然后点击屏幕右下方的 创建 按钮。
- en: In the beginning, it is always easier to select the most generic option when
    it comes to choosing a service. When you gain more experience and become more
    familiar with available services, you will see that Azure offers many useful preconfigured
    setups (such as an integrated Web App and SQL database), which can be used to
    shorten development and configure all services in one place.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 刚开始时，选择最通用的选项来选择服务通常会更容易。当你积累更多经验并且对可用的服务更熟悉时，你会发现Azure提供了许多有用的预配置设置（例如集成Web应用和SQL数据库），这些可以用来缩短开发时间，并在一个地方配置所有服务。
- en: Configuring an Azure web app
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置Azure Web应用
- en: 'When you click on the Create button, you will see a screen where you can enter
    all the information needed to create a web app. All required fields are marked
    using an * (asterisk) symbol:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击“创建”按钮时，你将看到一个屏幕，你可以在其中输入创建Web应用所需的所有信息。所有必填字段都标有*（星号）符号：
- en: '![](img/3e19505b-02ec-4a46-9718-e0c32ebd700f.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3e19505b-02ec-4a46-9718-e0c32ebd700f.png)'
- en: 'As you can see, when creating a web app, we have to fill almost all fields
    (with a little exception regarding the Application Insightsradio button, which
    we will cover in the next chapters). Let''s focus on each field separately, so
    we have a better understanding of how they work:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，在创建Web应用时，我们几乎需要填写所有字段（关于“应用程序洞察”单选按钮有一个小例外，我们将在接下来的章节中讲解）。让我们单独关注每个字段，以便更好地理解它们是如何工作的：
- en: App name: This field represents the domain name of your application. It is important
    to select both a unique and valid name, as it cannot be changed later on. Please
    note that you can easily attach your own custom domain if needed.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用名称：此字段表示你应用的域名。选择一个唯一且有效的名称很重要，因为它以后不能更改。请注意，如果需要，你可以轻松地绑定自己的自定义域名。
- en: Subscription: If you have access to more than one subscription, you will be
    given an opportunity to select the right one for this particular resource. Thanks
    to that, you will be able to differentiate the cost between, for example, different
    projects.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅：如果你拥有多个订阅，你将有机会选择适合此特定资源的订阅。通过这种方式，你将能够区分不同项目之间的费用。
- en: Resource Group: In Azure, each resource has to be a part of a logic container,
    called a resource group. This does not imply any additional cost by itself, so
    you do not have to worry about creating multiple resource groups.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 资源组：在Azure中，每个资源必须属于一个逻辑容器，称为资源组。这本身不会产生额外的费用，所以你不必担心创建多个资源组的问题。
- en: 'OS: Currently in Azure, you can create a web app using the different operating
    systems of Windows, Linux, or Docker containers. This choice can impact both cost
    and performance, so make sure you have chosen the right operating system for your
    needs.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统：目前，在Azure中，你可以使用不同的操作系统（Windows、Linux或Docker容器）来创建Web应用。这个选择会影响成本和性能，所以确保你选择了适合你需求的操作系统。
- en: App Service plan/Location: App Services in Azure are directly linked to App
    Service Plans, which provide different features and performance depending on the
    option you choose.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用服务计划/位置：Azure中的应用服务直接与应用服务计划相关联，应用服务计划根据你选择的选项提供不同的功能和性能。
- en: It is always a good practice to leverage resource groups and separate your resources
    using a specific filter, such as the lifetime of resources, or the given environment
    (that is, production, staging, or testing). Resource groups gives you better control
    over deployed services and allows for more granular control over who can access
    a resource.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，利用资源组并使用特定的过滤器（如资源的生命周期或给定的环境，例如生产、暂存或测试环境）来分隔资源是一个好习惯。资源组能让你更好地控制已部署的服务，并对谁可以访问某个资源进行更细粒度的控制。
- en: Since you are just starting with Azure, you probably do not have any App Service
    Planscreated. As we cannot create an App Service without an App Service Plan,
    we will sort this now.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 由于你刚开始使用Azure，你可能还没有创建任何应用服务计划。由于我们不能在没有应用服务计划的情况下创建应用服务，我们现在来进行排序。
- en: Creating an App Service Plan
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建应用服务计划
- en: 'When you click on App Service plan/Location,you will see a screen with the +
    Create newbutton, allowing for the creation of a new App Service Plan. It should
    look like this:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击“应用服务计划/位置”时，你将看到一个屏幕，其中有一个“+ 创建新计划”按钮，允许你创建一个新的应用服务计划。它应该是这样的：
- en: '![](img/1acd596c-c079-47e0-ba22-7c53cc59b574.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1acd596c-c079-47e0-ba22-7c53cc59b574.png)'
- en: 'As you can see, we have to enter three fields:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，我们需要输入三个字段：
- en: App Service plan: This is the name of your App Service Plan, which has to be
    unique within a resource group.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用服务计划：这是你的**应用服务计划**的名称，必须在一个资源组内唯一。
- en: Location: Thanks to this setting, we can locate our App Service Planin a specific
    region. This sometimes implies different features are available.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 位置：通过这个设置，我们可以将我们的**应用服务计划**定位在特定区域。这有时意味着不同的功能可用。
- en: 'Pricing tier: When you click on this item, you will see another screen presenting
    available features for different available tiers. This choice is really important
    feature-wise, and will depend in most cases on the environmental characteristics
    you are planning (such as Dev / Test environments, Production applications, whether
    you need deployment slots or not, and so on):'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定价层级：当你点击此项时，你将看到另一个屏幕，展示不同层级的可用功能。这个选择在功能上非常重要，并且大多数情况下会依赖于你规划的环境特性（例如开发/测试环境、生产应用程序，是否需要部署槽等）：
- en: '![](img/edd53982-1497-4613-bf74-1c81e19b9245.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/edd53982-1497-4613-bf74-1c81e19b9245.png)'
- en: 'As you can see in the preceding screenshot, we have three categories of App
    Service Plans:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 如你在前面的截图中看到的，我们有三种**应用服务计划**类别：
- en: 'Dev / Test: This one contains F, D, and B tiers (which stand for free, shared,
    and basic). They are designed for simple dev/test scenarios and lightweight web
    applications that do not need features such as autoscaling or backups.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发/测试：这一层级包括F、D和B层（分别代表免费、共享和基础）。它们设计用于简单的开发/测试场景以及不需要自动缩放或备份等功能的轻量级网页应用。
- en: 'Production: This offers powerful machines and advanced features that are useful
    in many realistic scenarios, such as APIs, e-commerce, and popular portals.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生产模式：这个模式提供强大的机器和先进的功能，适用于许多实际场景，例如API、电子商务和热门门户网站。
- en: Isolated: This uses the same hardware as the Production tier, but with even
    more features and possibilities to isolate your web apps from external access.
    This is the most expensive category, but can be helpful when creating systems
    that cannot be made available publicly.
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 隔离模式：这个模式使用与**生产**层相同的硬件，但提供更多的功能和可能性，使你的网页应用能够隔离于外部访问。这是最昂贵的类别，但在创建无法公开访问的系统时可能会非常有用。
- en: It is important to remember that tiers F and D have a limited amount of computing
    time per day. That means that once you exceed the limit (60 minutes for the F
    tier, and 240 minutes for the D tier) of your processing time, your application
    will become unavailable and be suspended until the next day.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要记住，F和D层级每天的计算时间是有限的。这意味着一旦超过了处理时间的限制（F层为60分钟，D层为240分钟），你的应用将变得不可用，并会被暂停，直到第二天。
- en: 'For the purpose of this exercise, I would recommend selecting any tier from
    the Dev / Testcategory. Once you are satisfied with the option you''ve selected,
    you can click the Apply button. My configuration, for example, looks like this:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 为了这个练习，我建议选择**开发/测试**类别中的任何一个层级。选择好你满意的选项后，你可以点击“应用”按钮。例如，我的配置如下所示：
- en: '![](img/b9ca6d80-e7b8-43f8-a4ec-7d9ae54dbbb8.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b9ca6d80-e7b8-43f8-a4ec-7d9ae54dbbb8.png)'
- en: Remember that you can always upgrade (or scale up) the instance of your App
    Service Plan, for example, when you need a specific feature or the popularity
    of your application has grown. This is one of the biggest advantages of cloud
    over on-premises, where you would have to buy and set up new machines on your
    own.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，你可以随时升级（或扩展）你的**应用服务计划**实例，例如，当你需要某个特定功能或应用程序的受欢迎程度增长时。这是云计算相比于本地部署的一大优势，在本地部署中，你必须自己购买并设置新机器。
- en: 'Now, you can click OK, and you will return to the Web Appblade, where you can
    enter missing fields. Here, you can see the whole configuration of my web app:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你可以点击“确定”，你将返回到Web Appblade页面，在这里你可以输入缺失的字段。这里，你可以看到我网页应用的完整配置：
- en: '![](img/341e2e9e-587f-4f68-a505-7a8d334a420f.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/341e2e9e-587f-4f68-a505-7a8d334a420f.png)'
- en: 'Now the only thing left is to click on the Create button and wait several seconds
    for the creation of a new resource. During this time, Azure will validate the
    template and parameters, and orchestrate multiple underlying controllers to create
    a service. Once a new resource is created, you should see a notification and be
    able to see in your resources. To quickly validate this, click on the All resourcesbutton
    on the left and filter all of them using, for example, the name of the App Serviceyou
    have created:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 现在只需点击**创建**按钮，等待几秒钟即可创建一个新资源。在此期间，Azure 会验证模板和参数，并协调多个底层控制器来创建服务。一旦新资源创建完成，您应该会看到通知，并能在您的资源中看到它。为了快速验证，点击左侧的**所有资源**按钮，并使用例如您创建的**应用服务**的名称进行筛选：
- en: '![](img/2f37303d-c5eb-473e-bc8e-951577adbaf9.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2f37303d-c5eb-473e-bc8e-951577adbaf9.png)'
- en: Creating an Azure App Service using Visual Studio
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Visual Studio 创建 Azure 应用服务
- en: If you do not want to create your web apps using the Azure Portal, you can use
    Microsoft Visual Studio, which has built-in integration for many different Azure
    services.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不想使用**Azure 门户**来创建 Web 应用程序，您可以使用 Microsoft Visual Studio，它内置了对许多不同 Azure
    服务的集成。
- en: This exercise was created using Microsoft Visual Studio 2017 (15.6.4) with Azure
    workloads installed. If you want to configure your instance and ensure everything
    is set up correctly, please follow the short tutorial available at [https://docs.microsoft.com/en-us/dotnet/azure/dotnet-tools?view=azure-dotnet&tabs=windows](https://docs.microsoft.com/en-us/dotnet/azure/dotnet-tools?view=azure-dotnet&tabs=windows).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 本练习是使用已安装 Azure 工作负载的 Microsoft Visual Studio 2017（15.6.4）创建的。如果您想配置您的实例并确保一切设置正确，请按照
    [https://docs.microsoft.com/en-us/dotnet/azure/dotnet-tools?view=azure-dotnet&tabs=windows](https://docs.microsoft.com/en-us/dotnet/azure/dotnet-tools?view=azure-dotnet&tabs=windows)
    上的简短教程操作。
- en: 'In Visual Studio, click on File | New Project. This will display a New Projectwindow,
    where you can find plenty of different templates for starting with a new application.
    Because we are interested in cloud projects, let''s start with the Cloud category:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Visual Studio 中，点击**文件 | 新建 | 项目**。这将显示一个**新建项目**窗口，您可以在其中找到许多用于开始新应用程序的不同模板。因为我们感兴趣的是云项目，所以我们从**云**类别开始：
- en: '![](img/aeb13a1b-55c3-47e1-9634-f2d04dbb9f25.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aeb13a1b-55c3-47e1-9634-f2d04dbb9f25.png)'
- en: Since we are working with App Services in this chapter, the template we are
    interested in is ASP.NET Web Application (.NET Framework). The other valid option
    here is also ASP.NET Core Web Application—feel free to use it if you feel confident
    enough to work with the latest .NET releases, as we will cover both scenarios.
    When you are satisfied with your choice, click OK.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们在本章中处理的是**应用服务**，我们感兴趣的模板是**ASP.NET Web 应用程序（.NET Framework）**。另一个有效的选项是**ASP.NET
    Core Web 应用程序**——如果您足够自信可以使用最新的 .NET 版本，可以随意选择，因为我们会涵盖这两种场景。当您对选择满意时，点击**确定**。
- en: 'The next step is the selection of the proper template. Here, you have multiple
    options, such as the following:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是选择合适的模板。在这里，您有多个选项，例如：
- en: Empty: The most simple option, which lets you have full control over installed
    packages and overall structure
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 空模板：最简单的选项，允许您完全控制已安装的包和整体结构
- en: Web Forms: The oldest available framework for building web applications, using
    many built-in controls with data access
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web Forms：用于构建 Web 应用程序的最古老框架，使用许多内置控件并具有数据访问功能
- en: 'MVC: A well-known **model-view-controller** (**MVC**) architecture, which took
    the place of Web Forms'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MVC：一个众所周知的**模型-视图-控制器**（**MVC**）架构，它取代了**Web Forms**
- en: 'Web API: A template for creating RESTful HTTP services using the .NET programming
    stack'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web API：用于使用 .NET 编程栈创建 RESTful HTTP 服务的模板
- en: Single Page Application:This template comes with plenty of additional tools
    for building client-side interactions
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单页面应用程序：此模板带有许多用于构建客户端交互的附加工具
- en: 'All the preceding options should be more or less familiar to you. However,
    thanks to installing the Azure toolset, you should have access to two additional
    templates:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 以上所有选项您应该都比较熟悉。不过，感谢安装了 Azure 工具集，您应该能够访问另外两个模板：
- en: Azure API App: This offers additional integrations with different Azure services
    such as Azure AD, API Management, and Logic apps
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure API 应用程序：提供与不同 Azure 服务的附加集成，如 Azure AD、API 管理和逻辑应用
- en: 'Azure Mobile App: A template for building mobile backends'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 移动应用：用于构建移动后端的模板
- en: However, we will cover those two in the next sections of this chapter. For now,
    to proceed, let's select MVC, as this is the most common and simplest of all templates
    listed here. Use the default options for this template and click OK.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 不过，我们将在本章的后续部分讨论这两者。现在，为了继续操作，让我们选择 MVC，因为这是这里列出的所有模板中最常见且最简单的。使用该模板的默认选项并点击 确定（OK）。
- en: You have probably noticed an additional button, which I have not described, Change
    Authentication. It allows for selecting the method used for authenticating access
    to your web application. We will cover that feature in the section describing
    the security of web apps in Azure.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能已经注意到一个附加按钮，我之前没有描述过，**更改身份验证**（Change Authentication）。它允许选择用于验证访问你 Web 应用的方式。我们将在接下来的
    Azure Web 应用安全性部分中讲解该功能。
- en: After several seconds, Visual Studio should generate a project based on the
    selected template. I believe it should look familiar to you, as it is not that
    different to a traditional web application created from an MVC template. I am
    sure you cannot wait to see whether it works—do not wait any longer, and press *F5*
    to start the application.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 几秒钟后，Visual Studio 应该会基于所选模板生成一个项目。我相信它看起来对你来说很熟悉，因为它和从 MVC 模板创建的传统 Web 应用并没有太大区别。我敢肯定，你迫不及待地想看看它是否能正常运行——不要再等了，按下
    *F5* 启动应用。
- en: 'You should see a screen similar to mine:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该会看到一个类似于我屏幕上的画面：
- en: '![](img/6f739326-3727-49fe-8c8a-170e349b1112.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6f739326-3727-49fe-8c8a-170e349b1112.png)'
- en: As you can see, it is the same generic template that you would see when starting
    with a traditional project. The question is, how can we deploy it to Azure to
    have our website working in the cloud?
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，它是一个传统项目开始时会看到的通用模板。问题是，我们如何将其部署到 Azure 以使我们的站点能够在云中运行？
- en: 'Let''s stop our website running locally and go back to Visual Studio for a
    moment. When you right-click on a project icon, you will see a context menu. There,
    between multiple different options, you can click on Publish...:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们停止本地运行的站点，回到 Visual Studio。在项目图标上右击，你会看到一个上下文菜单。在多个不同的选项中，你可以点击 发布（Publish...）。
- en: '![](img/16afcf0b-dd55-4989-864d-ccff48f53076.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/16afcf0b-dd55-4989-864d-ccff48f53076.png)'
- en: 'Since this is a cloud project, you will see additional options besides IIS,
    FTP, and Folder:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这是一个云项目，你会看到除了 IIS、FTP 和 文件夹之外的额外选项：
- en: 'App Service: This is for deploying your application to a PaaS service'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: App Service：用于将应用程序部署到 PaaS 服务。
- en: 'Azure Virtual Machines: This is for deploying your application to a virtual
    machine that you have configured'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 虚拟机：用于将应用程序部署到你已配置的虚拟机。
- en: Because the topic of this book is PaaS services, we will not cover deploying
    a web app to a virtual machine. However, if you are interested in doing so, proper
    instructions are available at [https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/create-asp-net-vm-with-webdeploy.md](https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/create-asp-net-vm-with-webdeploy.md).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 由于本书的主题是 PaaS 服务，我们将不讨论如何将 Web 应用部署到虚拟机。不过，如果你有兴趣这么做，相关的操作指南可以在 [https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/create-asp-net-vm-with-webdeploy.md](https://github.com/aspnet/Tooling/blob/AspNetVMs/docs/create-asp-net-vm-with-webdeploy.md)
    上找到。
- en: 'For now, let''s select App Service. You should see two different options:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，让我们选择 App Service。你应该能看到两个不同的选项：
- en: 'Create new: For deploying an application to a freshly created App Service'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建新应用（Create new）：用于将应用程序部署到新创建的 App Service。
- en: Select existing: This option is only useful if you have already deployed your
    site
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 选择现有： 此选项仅在你已经部署了站点时有效。
- en: 'Because we are just starting, the option we are interested in is Create new.
    After clicking on Publish..., you will see another screen, where you can enter
    all the required parameters. If you read the previous section about creating an
    App Service using the Azure Portal, some fields should look familiar—in fact,
    you are doing the very same thing as you would do in the portal. If you skipped
    this section, I strongly recommend that you go back and read the descriptions.
    After configuring my web app, my screen looks like this:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我们刚刚开始，所以我们关注的选项是 创建新应用（Create new）。点击 发布（Publish...）后，你将看到另一个屏幕，在那里你可以输入所有必填参数。如果你阅读了前一节关于如何使用
    Azure 门户创建 App Service 的内容，那么某些字段应该是熟悉的——实际上，你正在做的事情和在门户中操作是一样的。如果你跳过了这一节，强烈建议你返回并阅读相关描述。配置完我的
    Web 应用后，我的屏幕如下所示：
- en: '![](img/183d65d2-ea81-4327-9875-1fe3cc95a308.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/183d65d2-ea81-4327-9875-1fe3cc95a308.png)'
- en: Remember that you can create both resource groups and App Service Plans directly
    from the preceding screen. If you do not like the options listed there, you can
    click on the New...button, which will guide you through the process of creating
    a new resource. This is another advantage of tools such as Visual Studio, as you
    do not have to leave your programming environment to work with Azure.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，你可以直接从前面的页面创建资源组和 App Service 计划。如果你不喜欢那里列出的选项，你可以点击 **新建...** 按钮，这将引导你完成创建新资源的过程。这也是像
    Visual Studio 这样的工具的另一大优势，因为你无需离开编程环境就能使用 Azure。
- en: 'If you are satisfied with the current configuration, the last thing left is
    to click on the Create button and wait a moment for the application deployment
    to complete. Additionally, Visual Studio will prepare a publish profile that you
    can reuse whenever you want to. We will have a look at it, as it will help us
    in the next section of this chapter. Once deployment is completed, you should
    see your web application open automatically in your default browser:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你对当前配置满意，最后一步就是点击 **创建** 按钮，并稍等片刻，直到应用部署完成。此外，Visual Studio 会准备一个发布配置文件，你可以随时重复使用它。我们会查看它，因为它将在本章的下一部分帮助我们。部署完成后，你应该会看到你的
    Web 应用自动在默认浏览器中打开：
- en: '![](img/b8c8ef3f-2beb-4407-b5e8-5d56b52a8325.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8c8ef3f-2beb-4407-b5e8-5d56b52a8325.png)'
- en: 'Congratulations! You have just created and deployed your very first App Service. If
    you take a look at the URL, you''ll see that it contains the name you set in the
    Visual Studio wizard. All web apps in Azure can be accessed using the following
    URL format:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你刚刚创建并部署了你的第一个 App Service。如果你查看 URL，你会看到它包含了你在 Visual Studio 向导中设置的名称。所有
    Azure 中的 Web 应用都可以通过以下 URL 格式访问：
- en: '`http(s)://{appservicename}.azurewebsites.net`'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '`http(s)://{appservicename}.azurewebsites.net`'
- en: 'This also explains why a name has to be unique: since, by default, all web
    applications hosted as Azure Web Apps are available publicly, you have to select
    a name that is not already in use in another URL. In the next section, we will
    try to use FTP to deploy our application, as an alternative to using Visual Studio.'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 这也解释了为什么名称必须是唯一的：由于默认情况下，所有作为 Azure Web 应用托管的 Web 应用都是公开可用的，你必须选择一个在其他 URL 中尚未使用的名称。在下一部分，我们将尝试使用
    FTP 部署我们的应用，作为使用 Visual Studio 的替代方法。
- en: Deploying Azure App Service using FTP
  id: totrans-94
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 FTP 部署 Azure 应用服务
- en: Using Visual Studio for deployments is a good idea for testing things and development,
    but for sure, it cannot be used for deploying production environments. The easiest
    option to upload files to App Service is FTP, which is already integrated with
    this particular Azure resource.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Visual Studio 进行部署对于测试和开发来说是一个不错的选择，但肯定不能用于生产环境的部署。上传文件到 App Service 最简单的方式是使用
    FTP，且该 Azure 资源已集成 FTP。
- en: Deploying Azure App Service with user-level credentials
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用用户级凭据部署 Azure 应用服务
- en: 'When you go to the Azure Portal and select the Web App you created previously,
    take a look at the Overview screen—you will see plenty of information regarding
    this service, such as current Status, Location, and URL. Among all that information,
    there is an FTP section containing three different parameters:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 当你进入 Azure 门户并选择之前创建的 Web 应用时，查看 **概述** 页面，你将看到许多关于此服务的信息，如当前状态、位置和 URL。在这些信息中，有一个
    FTP 部分，包含三个不同的参数：
- en: FTP/deployment username: A name that you will use when connecting to your Web
    App using FTP client
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FTP/部署用户名：用于通过 FTP 客户端连接到 Web 应用时所使用的用户名
- en: FTP hostname: A host that should be used when creating an FTP connection
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FTP 主机名：用于创建 FTP 连接时应使用的主机
- en: 'FTPS hostname: The same host as the previous one, but allowing for secure connection'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FTPS 主机名：与之前相同的主机，但允许安全连接
- en: 'My App Service currently looks like this:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我的 App Service 目前看起来是这样的：
- en: '![](img/978663e6-b2ce-4cb1-9181-8a2d65d58517.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/978663e6-b2ce-4cb1-9181-8a2d65d58517.png)'
- en: 'All FTP information can be found in the bottom-right corner of the whole section.
    What we need now is the FTP client that we will use to connect to the server.
    I do not have any particular recommendation when it comes to selecting such an
    application. Personally, I prefer using FileZilla for managing my FTP connections
    and file transfers. You can, however, use whichever client you like, as all are
    quite similar regarding functionality. Before we start uploading files to the
    server, we need one more thing, a password for the user. To generate a new password,
    go to the Deployment credentialsblade, which can be found on the left in the DEPLOYMENT section
    of App Servicefeatures:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 所有 FTP 信息可以在整个页面的右下角找到。现在我们需要的是用于连接服务器的 FTP 客户端。对于选择这类应用程序，我没有特别的推荐。就个人而言，我偏好使用 FileZilla 来管理我的
    FTP 连接和文件传输。然而，你可以使用任何你喜欢的客户端，因为它们在功能上都非常相似。在我们开始将文件上传到服务器之前，还需要一件事，那就是为用户设置密码。要生成新密码，前往 Deployment
    credentialsblade，位置在 App Servicefeatures 的左侧 DEPLOYMENT 部分：
- en: '![](img/87297fca-c084-423e-8cd9-8fcdca858e88.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/87297fca-c084-423e-8cd9-8fcdca858e88.png)'
- en: 'Here, you can set two fields:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以设置两个字段：
- en: Username for FTP user
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FTP 用户的用户名
- en: Password for this particular user
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该用户的密码
- en: 'You may wonder how this is connected to the previous username, which can be
    found on the Overview screen. The difference is quite simple: using Deployment
    credentials,you are creating a new user that will be used for all applications
    in all subscriptions associated with your Microsoft Azure account. This has the
    implication that you will be able to use the very same credentials for each App
    Service you deploy. This is not ideal for every scenario you will face, but for
    the purpose of this exercise, let''s set a user and use it for deployment. In
    the next part of this section, I will show you how to retrieve credentials from
    a Publish Profile generated by Visual Studio. Once you enter a username and a
    password, press Save. Now, we can go to the FTP client and use these credentials
    for setting a connection. Here, you can see my configuration (note that your username
    has to be in the following format: `<appservicename>\<ftpusername>`):'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会想知道这如何与之前在 Overview 屏幕上找到的用户名相关。区别其实很简单：使用 Deployment credentials，你是在创建一个新的用户，该用户将用于你
    Microsoft Azure 帐户关联的所有应用程序和订阅。这意味着你将能够使用相同的凭证来部署每一个 App Service。对于你将遇到的每种场景，这并不是理想的选择，但对于本练习的目的，我们设定一个用户并用于部署。在本节的下一部分，我将向你展示如何从
    Visual Studio 生成的发布配置文件中获取凭证。一旦你输入用户名和密码，点击 Save。现在，我们可以打开 FTP 客户端，并使用这些凭证来建立连接。在这里，你可以看到我的配置（请注意，用户名必须采用以下格式：`<appservicename>\<ftpusername>`）：
- en: '![](img/2bdd1d05-5ceb-46bd-8da2-7c66a8156418.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2bdd1d05-5ceb-46bd-8da2-7c66a8156418.png)'
- en: 'Once you connect to a server, you will see a list of available directories.
    The very first level contains the following:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你连接到服务器，你将看到一个可用目录的列表。最顶层包含以下内容：
- en: '`LogFiles`: Files containing diagnostic information regarding running App Service'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`LogFiles`: 包含有关运行中的 App Service 的诊断信息文件'
- en: '`site`**:** Your Web App working files are stored here'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`site`**:** 你的 Web 应用工作文件存储在这里'
- en: 'We will cover `LogFiles` in the next sections of this chapter, describing monitoring
    and diagnosing an application. For now, we are interested in the `site` folder.
    When you enter it, you will see other directories: `deployments`, `locks`, and `wwwroot`.
    The last one should be familiar for those of you who have worked with IIS, as
    this is the most common name of the folder containing a web application. In fact,
    this is the working directory of your App Service, where all necessary files should
    be uploaded. Here, you have the full structure of an empty web app:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在本章的后续部分介绍 `LogFiles`，它涉及监控和诊断应用程序。目前，我们关注的是 `site` 文件夹。当你进入该文件夹时，你会看到其他目录：`deployments`、`locks`
    和 `wwwroot`。对于那些曾经使用过 IIS 的朋友来说，最后一个目录应该比较熟悉，因为它是存放 Web 应用程序的最常见文件夹名称。实际上，这就是你的
    App Service 的工作目录，所有必要的文件都应上传到此处。这里是一个空的 Web 应用程序的完整目录结构：
- en: '![](img/843f9e08-7b23-4939-920f-680c6d0538c3.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/843f9e08-7b23-4939-920f-680c6d0538c3.png)'
- en: Now that you know how App Service is structured, you can deploy your files and
    see whether or not it works. If you want, you can reuse a project from the previous
    exercise, or upload a brand new website.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，你已经了解了 App Service 的结构，你可以部署你的文件并查看它是否能正常工作。如果你愿意，你可以复用之前练习中的项目，或者上传一个全新的网站。
- en: If you want to reuse files, you can publish a project once again, but this time,
    instead of publishing it directly to Azure, create a new Publish Profile and use
    a folder as the target. Once Visual Studio finishes creating the package, simply
    copy files from the output directory to the FTP location using your FTP client.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想重新使用文件，你可以再次发布项目，但这次，不是直接发布到 Azure，而是创建一个新的发布配置并使用文件夹作为目标。Visual Studio
    完成创建包之后，只需使用 FTP 客户端将文件从输出目录复制到 FTP 位置。
- en: 'Here are the files from a previous project of mine uploaded to my FTP server:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我之前项目中的文件，已上传到我的 FTP 服务器：
- en: '![](img/3586dd63-2c54-40bc-b4c1-06fc1e498303.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3586dd63-2c54-40bc-b4c1-06fc1e498303.png)'
- en: 'Now, when I go to the URL of my website, I will see a working application:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当我访问我的网站 URL 时，我会看到一个正在运行的应用程序：
- en: '![](img/e34dcfcc-4b1d-4f04-a647-4780e28147b2.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e34dcfcc-4b1d-4f04-a647-4780e28147b2.png)'
- en: Great—you have just learned how to leverage the FTP feature of App Services to
    deploy an application from any location and environment. However, as I mentioned
    earlier, we are using user-level credentials, which will be the same for all web
    apps that you deploy within your subscription. How do we achieve the same result
    using an app-level username and password?
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 很好——你刚刚学会了如何利用应用服务的 FTP 功能，从任何位置和环境部署应用程序。然而，正如我之前提到的，我们正在使用用户级凭据，这些凭据对于你在订阅中部署的所有
    web 应用程序都是相同的。那么，如何使用应用级用户名和密码来实现相同的结果呢？
- en: Deploying Azure App Service using app-level credentials
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用应用级凭据部署 Azure App Service
- en: 'There are two ways to deploy an application using app-level credentials:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用应用级凭据部署应用程序有两种方式：
- en: Download them from the Azure Portal
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 Azure 门户下载它们
- en: Configure WebDeploy in Visual Studio
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Visual Studio 中配置 WebDeploy
- en: Downloading app-level credentials from the Azure Portal
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 从 Azure 门户下载应用级凭据
- en: 'When you go to your App Service and click on the Overview blade, you will see
    the Get publish profilebutton at the top, as shown in the following screenshot:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 当你进入你的`应用服务`并点击`概览`面板时，你将看到顶部有一个`获取发布配置`按钮，如下截图所示：
- en: '![](img/6e246ee7-9b44-4cac-a7f0-12b9d1a867f2.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6e246ee7-9b44-4cac-a7f0-12b9d1a867f2.png)'
- en: 'Now, when you click on it, your browser will download a `.PublishProfile`file.
    Please open it to check its content. Here is an example file from my web app:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当你点击它时，浏览器将下载一个`.PublishProfile`文件。请打开它查看其内容。这是我从我的 web 应用中获取的一个示例文件：
- en: '[PRE0]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: As you can see, it is a simple XML file containing plenty of useful information.
    What we are interested in currently is both the `userName` and `userPWD` properties.
    Those are what we have been searching for—app-level credentials automatically
    created on App Servicecreation. You can use these instead of the user-level ones
    that we created previously.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这是一个简单的 XML 文件，包含大量有用的信息。我们目前关注的是`userName`和`userPWD`属性。这些就是我们一直在寻找的——在应用服务创建时自动生成的应用级凭据。你可以使用这些凭据，而不是我们之前创建的用户级凭据。
- en: Configuring WebDeploy in Visual Studio
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Visual Studio 中配置 WebDeploy
- en: To check how to configure **WebDeploy **in Visual Studio, please go through
    all steps from the beginning of *Creating an Azure App Service using Visual Studio*
    section about publishing an application from this IDE. If you have done that,
    go once more to the Publish screen.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 要查看如何在 Visual Studio 中配置**WebDeploy**，请参考从*使用 Visual Studio 创建 Azure App Service*部分开始的所有步骤，这一部分关于从这个
    IDE 发布应用程序。如果你已经完成了这些步骤，再次返回到`发布`屏幕。
- en: If you want to import a publish profile from the previous section, then on the Publish screen,
    you can click on the New Profile...button and then select the Import Profile...option,
    which allows you to select a profile file generated previously.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想从前一部分导入发布配置文件，则在`发布`屏幕上，点击`新建配置...`按钮，然后选择`导入配置...`选项，这样你就可以选择先前生成的配置文件。
- en: 'When you click on the Configure button, you will see another window containing
    the whole configuration of your deployment:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击`配置`按钮时，你将看到另一个窗口，里面包含了你部署的完整配置：
- en: '![](img/f0cd688f-39a8-43f1-b8e5-c07f0164051f.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f0cd688f-39a8-43f1-b8e5-c07f0164051f.png)'
- en: As you can see, it contains a completely different set of information, which
    does not reflect the user-level settings you have configured.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，它包含了一组完全不同的信息，且不反映你已配置的用户级设置。
- en: Please do remember the difference between user-level and app-level credentials.
    Note that multiple users with access to a given app can use their own user-level
    credentials individually. What is more, to be able to use app-level credentials,
    you have to have at least a Contributor role on a specific App Service. If you
    are only a Reader, you will not able to access those credentials.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住用户级凭证和应用级凭证之间的区别。注意，多个具有访问权限的用户可以分别使用自己的用户级凭证。此外，要使用应用级凭证，你至少需要在特定的应用服务上具有**贡献者**角色。如果你只有**阅读者**角色，则无法访问这些凭证。
- en: The choice between app-level and user-level credentials depends solely on the
    process of delivering your application. In most cases, you don't need to check by
    checking and setting them, as tools such as Visual Studio or Azure DevOps (formerly
    Visual Studio Team Services) obtain and use them implicitly. App-level credentials
    are often only used when we are in need of manual deployment.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在应用级凭证和用户级凭证之间的选择完全取决于你交付应用程序的过程。在大多数情况下，你无需检查和设置这些凭证，因为像 Visual Studio 或 Azure
    DevOps（前身为 Visual Studio Team Services）这样的工具会隐式地获取和使用它们。应用级凭证通常只有在我们需要手动部署时才会使用。
- en: You can always reset app-level credentials (for instance, if current ones should
    be revoked, because of some kind of security issue) from the Overview blade. Next
    to the Get publish profilebutton, you can find the Reset publish profile option,
    which will set a new username and password.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以随时从**概述**面板重置应用级凭证（例如，如果当前凭证因为某种安全问题需要被撤销）。在**获取发布配置文件**按钮旁边，你可以找到**重置发布配置文件**选项，它会设置一个新的用户名和密码。
- en: Creating Azure App Services using Visual Studio Code
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Visual Studio Code 创建 Azure 应用服务
- en: 'Microsoft Visual Studio is not the only available IDE that allows you to work
    with Azure App Services. Because this Azure service supports different technology
    stacks, including .NET, JS, PHP, Java, and so on, you can easily leverage its
    capabilities to host different websites using different runtimes. For instance,
    let''s assume that we have the following PHP code that displays a `Hello World`
    message:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft Visual Studio 不是唯一可以与 Azure 应用服务一起使用的 IDE。由于此 Azure 服务支持不同的技术栈，包括
    .NET、JS、PHP、Java 等，你可以轻松利用它的能力来托管不同的使用不同运行时的网站。例如，假设我们有以下 PHP 代码来显示一个 `Hello World`
    消息：
- en: '[PRE1]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Such a simple PHP application can be easily created in any available IDE that
    supports the PHP language. For the purpose of this exercise, I chose Visual Studio
    Code, an open source editor, as it can easily be extended using many different
    plugins. To make things easier, you can install the following extensions:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 这样一个简单的 PHP 应用程序可以在任何支持 PHP 语言的 IDE 中轻松创建。为了完成本次练习，我选择了 Visual Studio Code 这一开源编辑器，因为它可以通过许多不同的插件轻松扩展。为了简化操作，你可以安装以下扩展：
- en: '![](img/e213c125-f54c-43ce-a198-d28d15adb053.png)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e213c125-f54c-43ce-a198-d28d15adb053.png)'
- en: With this plugin installed, you will be able to easily deploy your applications
    from within the IDE, without the need to go to the portal or use other methods.
    To push the application to the cloud, you have to go to the AZURE tab and find
    the APP SERVICEsection.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 安装此插件后，你将能够轻松地从 IDE 内部部署应用程序，无需前往门户或使用其他方法。要将应用程序推送到云端，你需要进入**AZURE**选项卡并找到**APP
    SERVICE**部分。
- en: Before the first use of these extensions, you may need to authenticate them.
    Follow the displayed instructions and Visual Studio Code will connect to your
    subscriptions.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在首次使用这些扩展时，你可能需要进行身份验证。请按照显示的指示操作，Visual Studio Code 将连接到你的订阅。
- en: 'Before we deploy our simple PHP application, we have to create an Azure App
    Service. To do so, you will have to click on the Create New Web App...button:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们部署简单的 PHP 应用程序之前，必须先创建一个 Azure 应用服务。为此，你需要点击 **创建新 Web 应用**...按钮：
- en: '![](img/7689d233-0ff5-4d2b-bbe0-d3bf1b03816b.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7689d233-0ff5-4d2b-bbe0-d3bf1b03816b.png)'
- en: 'The wizard is a little bit different than in Microsoft Visual Studio, as it
    acts similarly to a command line, where you provide all fields and information
    one after another. In Visual Studio Code, you will have to enter the following:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 向导与 Microsoft Visual Studio 略有不同，它更像是命令行，要求你依次提供所有字段和信息。在 Visual Studio Code
    中，你需要输入以下内容：
- en: The Azure App Service name
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 应用服务名称
- en: The operating system of your choice
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你选择的操作系统
- en: The runtime version
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行时版本
- en: 'In this particular example, I specified the following:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个特定的示例中，我指定了以下内容：
- en: '`handsonazure-euw-appservice`'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`handsonazure-euw-appservice`'
- en: Linux
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux
- en: PHP 7.2
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PHP 7.2
- en: 'Once the provisioning is complete, Visual Studio Code will ask you whether
    to deploy the application. Select OK,and then choose the folder to deploy to:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦配置完成，Visual Studio Code 会询问你是否要部署应用程序。选择“确定”，然后选择要部署到的文件夹：
- en: '![](img/25bb7477-17dc-434d-b7ea-7c9195c15211.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/25bb7477-17dc-434d-b7ea-7c9195c15211.png)'
- en: 'Once everything is set and ready, you will see a notification informing you
    that you are now able to browse the website:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 一切设置就绪后，你将看到一个通知，告知你现在可以浏览该网站：
- en: '![](img/bd67d5a7-a495-4469-9717-322512740203.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bd67d5a7-a495-4469-9717-322512740203.png)'
- en: 'When you click on the Browse Websitebutton, you will be forwarded to the freshly
    deployed web application. Note that this extension allows you to directly manage
    the service from within the IDE, and gives you access to different features, including
    application settings, deployment slots, and Azure WebJobs (the latter of which
    is described in [Chapter 2](9d2dde2d-9d55-4da6-b914-aa66281f1d80.xhtml), *Azure
    WebJobs*). Here, you can see the working example hosted within Azure:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击“浏览网站”按钮时，你将被转发到刚刚部署的 Web 应用程序。请注意，这个扩展允许你直接在 IDE 中管理该服务，并提供不同的功能，包括应用设置、部署槽和
    Azure WebJobs（后者在[第2章](9d2dde2d-9d55-4da6-b914-aa66281f1d80.xhtml)，*Azure WebJobs*
    中有描述）。在这里，你可以看到托管在 Azure 中的实际示例：
- en: '![](img/aaac4515-da58-477f-82c0-ba3a286714fa.png)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aaac4515-da58-477f-82c0-ba3a286714fa.png)'
- en: The important thing here is that by using the same path, you will be able to
    host a variety of different runtimes inside different Azure App Services. It doesn't
    matter whether it is a Java application, a Python script, or a Node.js backend—they
    are all supported and can be easily developed using IDEs such as Visual Studio
    Code.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这里重要的是，通过使用相同的路径，你将能够在不同的 Azure 应用服务中托管多种不同的运行时。无论是 Java 应用程序、Python 脚本，还是 Node.js
    后端，它们都被支持，并且可以通过像 Visual Studio Code 这样的 IDE 容易开发。
- en: 'When using Visual Studio Code with the presented extension, you might want to
    have more control over the creation of a resource. To enable Advanced Creation,
    go to the File | Preferences | Settings window, find the Extensionssection, and
    then click on the App Service: Advanced Creation checkbox.'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用带有扩展的 Visual Studio Code 时，你可能希望对资源的创建拥有更多控制。要启用“高级创建”，请进入 文件 | 首选项 | 设置
    窗口，找到 扩展 部分，然后点击“应用服务：高级创建”复选框。
- en: Working with different operating systems and platforms
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用不同操作系统和平台
- en: 'Currently, App Services supports a couple of different configurations when
    it comes to selecting operating system, runtime, and a platform. The following
    are some of the possible options for running your website using App Services:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，应用服务在选择操作系统、运行时和平台时支持几种不同的配置。以下是使用应用服务运行网站的一些可能选项：
- en: .NET Core
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: .NET Core
- en: .NET Framework
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: .NET Framework
- en: Node.js
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Node.js
- en: PHP
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PHP
- en: Java
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Java
- en: Python
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python
- en: Static HTML website
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 静态 HTML 网站
- en: Additionally, you can select a platform (32-bitor 64-bit), HTTP version (1.1 or 2.0),
    and underlying operating system (Windows, Linux, or Container). Let's start by
    selecting a proper operating system for our application.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，你还可以选择平台（32 位或 64 位）、HTTP 版本（1.1 或 2.0）以及底层操作系统（Windows、Linux 或容器）。让我们从为应用程序选择合适的操作系统开始。
- en: Selecting an operating system
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择操作系统
- en: To select an operating system to run your web app, we have to create a new application
    in Azure. Currently, there is no possibility to change this setting after an App
    Service is created. To create a new website, go to the Azure Portal and click
    on + Create a resource. On the new screen, search for `Web App`and select the
    first item displayed (or just return to the beginning of the *Selecting Azure
    Web App from available services* section and perform all the steps mentioned there).
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 要选择一个操作系统来运行你的 Web 应用程序，我们必须在 Azure 中创建一个新应用。目前，在创建应用服务后，无法更改此设置。要创建一个新网站，进入
    Azure 门户并点击“+ 创建资源”。在新屏幕上，搜索`Web App`并选择第一个显示的项目（或者直接返回到 *从可用服务中选择 Azure Web App*
    部分，并执行那里提到的所有步骤）。
- en: 'On the Web App - Createscreen, you have an OS field. You''ll have three options:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 在“Web 应用 - 创建”屏幕上，你会看到一个操作系统（OS）字段。你将有三个选项：
- en: Windows: The most common option for .NET applications, suitable for running
    .NET Framework, Java, Node.js, or PHP sites.
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Windows: 适用于 .NET 应用程序的最常见选项，适合运行 .NET Framework、Java、Node.js 或 PHP 网站。'
- en: Linux: If you have an application written in .NET Core, you can leverage this
    operating system and its unique features. Additionally, you can run Java, Node.js,
    PHP, and Python applications as well.
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Linux：如果您有用 .NET Core 编写的应用程序，可以利用这个操作系统及其独特的功能。此外，您还可以运行 Java、Node.js、PHP 和
    Python 应用程序。
- en: 'Docker: Offers Web App for Containers, which we''ll cover later in this book.
    Besides running all of the previous platforms, it allows hosting applications
    written in languages not currently supported in App Services (such as Go, for
    example).'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Docker：提供 Web 应用容器，我们将在本书后面详细介绍。除了运行所有前述平台，它还允许托管用目前在应用服务中不支持的语言编写的应用程序（例如 Go）。
- en: 'The choice is yours. Each operating system has different characteristics: Linuxis
    perfect for running Python applications, as Windows has some performance issues
    regarding this language; on the other hand, you may have many websites written
    in .NET Framework, which are optimized for Windows systems. Each of the operating
    system options also has different pricing. Let''s compare Windows and Linux here:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 选择权在您。每个操作系统都有不同的特点：Linux 非常适合运行 Python 应用程序，而 Windows 在处理这种语言时有一些性能问题；另一方面，您可能有许多用
    .NET Framework 编写的网站，这些网站已经针对 Windows 系统进行了优化。每个操作系统选项的定价也有所不同。让我们在这里比较 Windows
    和 Linux：
- en: '|  | BASIC | STANDARD | PREMIUM | ISOLATED |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '|  | 基础 | 标准 | 高级 | 隔离 |'
- en: '| Price per hour (Linux) | $0.071 | $0.095 | $0.19 | N/A |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 每小时价格 (Linux) | $0.071 | $0.095 | $0.19 | 不适用 |'
- en: '| Price per hour (Windows) | $0.075 | $0.10 | $0.20 | $0.40 |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| 每小时价格 (Windows) | $0.075 | $0.10 | $0.20 | $0.40 |'
- en: As you can see, there are small differences between these two operating systems.
    More importantly, Linux does not currently support the Free and Shared tiers.
    The Isolated tier is currently in public preview, and should not be used for production
    workloads, but this, of course, can change in the future. When you have considered
    all the pros and cons, you can create an App Service powered by the operating
    system of your choice.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，这两种操作系统之间存在一些小差异。更重要的是，Linux 当前不支持免费和共享层。隔离层目前处于公开预览阶段，不应在生产工作负载中使用，但这当然未来可能会改变。当您考虑了所有优缺点后，便可以创建由您选择的操作系统提供支持的应用服务。
- en: Selecting different platforms
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 选择不同的平台
- en: 'In the previous section, you learned how to choose a proper operating system
    for your application. This is, of course, not everything needed to run a website—you
    have to also enable a specific language if you want to deploy, for example, PHP
    code. To do so, go to your App Service (you have many options by which to do this:
    either choose App Servicesfrom the Azure Portal menu on the left and select your Web
    App, or go to the resource groupyou created by choosing it from **R**esource Groupsblade)
    and then select the Application settings blade:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一部分中，您学会了如何选择适合您应用程序的操作系统。当然，这并不是运行网站所需的全部——如果您想部署例如 PHP 代码，您还需要启用特定的语言。为此，请前往您的应用服务（有多种方法可以做到这一点：可以从
    Azure 门户左侧菜单中选择“应用服务”，然后选择您的 Web 应用，或从 **资源组** 窗格中选择您创建的资源组）并选择应用程序设置窗格：
- en: '![](img/30e6556d-dad5-4462-b998-093703f180fc.png)'
  id: totrans-189
  prefs: []
  type: TYPE_IMG
  zh: '![](img/30e6556d-dad5-4462-b998-093703f180fc.png)'
- en: Initially, you could feel a bit overwhelmed by all those options available,
    but soon, as you gain more and more experience, all will become clear. You might
    have noticed the Upgrade to enablelinks here—some features, such as Platform or Always
    On,are only available from the B1tier upward.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 一开始，您可能会对这些可用的选项感到有些不知所措，但很快，随着经验的积累，一切都会变得清晰。您可能注意到了这里的“升级以启用链接”——一些功能，如平台或始终开启，仅从
    B1 等级开始可用。
- en: Remember that the Always Onfeature could become crucial in some specific scenarios,
    as it defines whether your application is always running or not (so it can become
    idle when no one uses it). As you will learn in the coming sections, setting Always
    On to On is required when running, for example, continuous Web Jobs or Azure Functions.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 记住，“始终开启”功能在某些特定场景中可能变得至关重要，因为它定义了您的应用程序是否始终运行（因此，当没有人使用时，它可以变得空闲）。正如您将在接下来的部分中学到的，设置“始终开启”为开启是运行例如持续
    Web 作业或 Azure 函数时所必需的。
- en: 'Currently, we are interested in all options mentioning a programming language.
    These options include the following:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，我们对所有提到编程语言的选项感兴趣。这些选项包括以下内容：
- en: .NET Framework version
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: .NET Framework 版本
- en: PHP version
  id: totrans-194
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PHP 版本
- en: Python version
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 版本
- en: Java version
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Java 版本
- en: By default, your App Service supports two languages: .NET Framework version and
    PHP version. To run, for instance, Python or Java, you would have to set an appropriate
    setting to a specific version such as enable Java support using Java version dropdown.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，你的App服务支持两种语言：.NET Framework版本和PHP版本。例如，要运行Python或Java，你必须设置适当的设置为特定版本，例如使用Java版本下拉菜单启用Java支持。
- en: As mentioned earlier, always select the correct operating system powering your App
    Service, depending on the language that you chose for your application. While
    it is possible to run PHP or Python on Windows, selecting Linux, is recommended,
    could be recommended, as many libraries and packages can run only under this particular
    operating system.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，始终根据你为应用程序选择的语言选择正确的操作系统来支持你的App服务。虽然可以在Windows上运行PHP或Python，但建议选择Linux，因为许多库和包只能在这个特定的操作系统上运行。
- en: Working with application settings
  id: totrans-199
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用应用程序设置
- en: 'The Application settingsblade offers more than simply enabling or disabling
    available features. When you scroll down, you will see additional sections, including
    the following:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序设置页面提供的不仅仅是启用或禁用可用功能。当你向下滚动时，你会看到其他部分，包括以下内容：
- en: 'Debugging: If you want to enable remote debugging, you can toggle the Remote
    debuggingoption to On. This will allow you to set the Visual Studio version that
    you would like to use to debug your application locally.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调试：如果你想启用远程调试，可以将远程调试选项切换为开启。这样你就可以设置你希望用来在本地调试应用程序的Visual Studio版本。
- en: Application settings: This section contains settings used by your application
    while running.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序设置：此部分包含在应用程序运行时使用的设置。
- en: 'Connection strings: You can define a connection string for your website directly
    in the Azure Portal.'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接字符串：你可以直接在Azure门户中为你的网站定义连接字符串。
- en: Default documents: If you would like to have a custom default document (that
    is, the starting point of your application), you can set it in this section.
  id: totrans-204
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认文档：如果你希望有一个自定义的默认文档（即应用程序的起始点），你可以在此部分进行设置。
- en: 'Handler mappings: Sometimes, you need to specify a custom handler for a specific
    file extension or URL. Here, you can add the appropriate configuration to do so.'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 处理程序映射：有时你需要为特定的文件扩展名或URL指定自定义处理程序。在这里，你可以添加相应的配置来实现。
- en: Virtual applications and directories: If you need to have multiple applications
    in your App Service, you can map virtual paths to a physical path here.
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 虚拟应用程序和目录：如果你需要在你的App服务中拥有多个应用程序，你可以在这里将虚拟路径映射到物理路径。
- en: Remember that Application settingsfor .NET applications are injected at runtime
    and will override existing settings stored in your `web.config`. When it comes
    to other platforms (.NET, Java, Node.js), settings from this section will be injected
    as environment variables, to which you can refer. This is also true for Connection strings.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，.NET应用程序的应用程序设置在运行时注入，并且会覆盖存储在`web.config`中的现有设置。对于其他平台（如.NET、Java、Node.js），该部分的设置将作为环境变量注入，你可以引用它们。连接字符串也遵循这一规则。
- en: Application settings in Azure are always encrypted when stored. What is more,
    you can easily secure them by disallowing all users from accessing them.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: Azure中的应用程序设置在存储时始终是加密的。而且，你可以通过禁止所有用户访问它们来轻松保护它们。
- en: Connection strings for platforms other than .NET are always prefixed with appropriate
    connection type. There are four possibilities: `SQLCONNSTR_`, `MYSQLCONNSTR_`, `SQLAZURECONNSTR_`,
    and `CUSTOMCONNSTR_`.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 针对.NET以外的平台的连接字符串始终以适当的连接类型作为前缀。有四种可能性：`SQLCONNSTR_`、`MYSQLCONNSTR_`、`SQLAZURECONNSTR_`和`CUSTOMCONNSTR_`。
- en: Different App Service Plans and features
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 不同的App服务计划和功能
- en: We touched on this topic at the beginning of this chapter, so you should have
    an idea of what we are going to cover now. As you remember, when App Service is
    created, you have to select (or create) an App Service Plan, which defines both
    available performance and additional features. Let's cover all three categories,
    this time focusing on the differences between each tier.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本章开始时提到过这个话题，所以你应该对接下来要讨论的内容有所了解。正如你记得的那样，当创建App服务时，你必须选择（或创建）一个App服务计划，该计划定义了可用的性能和附加功能。让我们覆盖所有三个类别，这次重点介绍每个层级之间的差异。
- en: Dev/Test App Service Plans
  id: totrans-212
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开发/测试App服务计划
- en: 'App Service Plans designed for development and testing environments can be
    found in the Dev / Testcategory:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 专为开发和测试环境设计的App服务计划可以在Dev / Test类别中找到：
- en: '![](img/31d3eab0-f5a8-45cb-856e-5d03459fa3de.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![](img/31d3eab0-f5a8-45cb-856e-5d03459fa3de.png)'
- en: 'We have three different tiers available:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有三种不同的层级可供选择：
- en: '**F1 (Free)**: The most basic option, with shared infrastructure, 1 GB of memory
    available, and 60 minutes of compute per day. When using shared tiers, some features
    of App Services are unavailable (such as Always on, or your selected platform).
    F1 is perfect for quick-testing or deploying an application for a presentation
    or demonstration. You will not be charged for using this App Service Plan.'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**F1（免费）**：最基本的选项，使用共享基础设施，提供1 GB内存和每天60分钟的计算时间。使用共享层时，一些应用服务的功能不可用（例如常开功能，或你选择的平台）。F1非常适合快速测试或部署用于演示的应用程序。使用此应用服务计划不会收取费用。'
- en: '**D1 (Shared)**: Similar to F1, but this also allows for setting a custom domain
    for your App Service. What is more, you can run your application four times longer
    than when using the free tier. Still, this is shared infrastructure, so some features
    cannot be used.'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**D1（共享）**：与F1类似，但这还允许为你的应用服务设置自定义域名。更重要的是，你可以比使用免费层时多运行应用四倍的时间。不过，这仍然是共享基础设施，因此一些功能无法使用。'
- en: '**B1**: The first tier recommended for running production workloads. It guarantees
    dedicated A-series machines, and more memory and storage. It is also the first
    tier that you can scale—although only manually. The Basic tier comes with additional
    versions (B2 and B3), which provide more compute power.'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**B1**：建议用于运行生产工作负载的第一个层级。它保证了专用的A系列机器，并提供更多的内存和存储空间。它还是第一个可以进行扩展的层级——尽管只是手动扩展。**基础**层还提供了额外的版本（B2和B3），它们提供了更强的计算能力。'
- en: If you are obligated to run your application in Azure in services defined by
    a **service level agreement** (**SLA**), remember that you cannot use the Free or Shared tiers,
    as they do not support this.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要在Azure中运行符合**服务级别协议**（**SLA**）定义的服务，请记住，不能使用**免费**或**共享**层，因为它们不支持此协议。
- en: Production App Service Plans
  id: totrans-220
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 生产应用服务计划
- en: 'In this category, there are many more options when it comes to choosing different
    features available. Remember that, in terms of hardware, the Basic tier offers
    the very same performance as the Standard tier:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一类别中，选择不同可用功能的选项更多。请记住，在硬件方面，**基础**层提供的性能与**标准**层完全相同：
- en: '![](img/0310b053-421f-458b-973d-c10243faeeaa.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0310b053-421f-458b-973d-c10243faeeaa.png)'
- en: 'Here, we can choose between the following:'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们可以选择以下几种：
- en: '**Standard (S1)**: The same A-series as B1\. What we are getting here is autoscaling,
    staging slots, backups, and the possibility to use Traffic Manager (which will
    be described in coming chapters). This is the best tier for most production applications,
    as it supports blue-green deployment scenarios and can handle a bigger load (thanks
    to integration with Traffic Manager). If you need more compute power, you can
    choose either S2 or S3.'
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**标准 (S1)**：与B1使用相同的A系列。我们在这里得到的是自动扩展、预发布槽、备份以及使用流量管理器的可能性（将在后续章节中描述）。这是大多数生产应用程序的最佳层级，因为它支持蓝绿部署场景，并能处理更大的负载（感谢与流量管理器的集成）。如果你需要更强的计算能力，可以选择S2或S3。'
- en: '**Premium (P1v2)**: This is the new recommended option replacing P1, with new Dv2-series
    virtual machines underneath. It offers better performance and higher limits when
    it comes to scaling (a maximum of 20 instances, compared to 10 in Standard) and
    staging slots. You also have the option to choose P2or P3.'
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**高级 (P1v2)**：这是新推荐的选项，替代了P1，底层使用新的Dv2系列虚拟机。它在扩展方面提供了更好的性能和更高的限制（最多支持20个实例，而**标准**层为10个实例），并且支持更多的预发布槽。你还可以选择P2或P3。'
- en: Remember that the maximum amount of instances in particular tiers is subject
    to availability. In most cases, these are only soft limits that can be raised
    after contacting support.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，特定层级中的最大实例数量取决于可用性。在大多数情况下，这些只是软限制，联系支持后可以提升。
- en: In general, Standard should meet most requirements when it comes to performance,
    reliability, and automation possibilities. However, if you are going to run a
    very popular website in Azure, you may need Premium, as it offers more flexibility
    and better scalability.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，**标准**层应满足大多数在性能、可靠性和自动化可能性方面的需求。然而，如果你计划在Azure中运行一个非常受欢迎的网站，可能需要**高级**层，因为它提供了更多的灵活性和更好的可扩展性。
- en: 'One of the most important things to remember is how scaling affects the pricing. In
    general, you have two options: either you scale up (changing tier to a higher
    one) or scale out (by deploying multiple instances of the same application). If
    you are paying, for example, $40 for an S1 instance, when you scale out to 10
    instances, you will pay $400 in total—$40 for each instance running.'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 需要记住的一个重要事项是，如何扩展会影响定价。通常，您有两种选择：要么向上扩展（将层级更改为更高的一个），要么横向扩展（通过部署多个相同应用实例）。例如，如果您为一个S1实例支付40美元，当您将其扩展到10个实例时，总共需要支付400美元——每个实例40美元。
- en: Isolated App Service Plans
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 隔离版应用服务计划
- en: 'Sometimes you need even more than the Premium tier has to offer. Maybe you
    have to isolate your application from an external network. Maybe you would like
    to offer access only to some specific users. Maybe 20 instances are still not
    enough. This is why Azure introduced the Isolated category:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 有时您可能需要比Premium层提供的更多功能。也许您需要将应用程序从外部网络隔离。也许您只希望为某些特定用户提供访问权限。也许20个实例仍然不够。这就是为什么Azure引入了隔离版类别：
- en: '![](img/8bc3bdba-cca3-46ad-bfc8-2e029c961323.png)'
  id: totrans-231
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8bc3bdba-cca3-46ad-bfc8-2e029c961323.png)'
- en: 'In this category, we have only one tier divided into three versions:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个类别中，我们只有一个层级，分为三个版本：
- en: '**Isolated (I1/I2/I3)**: The same virtual machines as in the Premium tier (Dv2).
    Also includes huge storage to store your files (1 TB), private app access, an
    integrated virtual network (so you can access, for example, internal applications),
    and a more stable environment. This is the most expensive tier, but offers the
    most when it comes to functionality and the range of features provided.'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**隔离版 (I1/I2/I3)**：与Premium层（Dv2）中的虚拟机相同。还包括大量存储空间来存储您的文件（1 TB）、私有应用访问、集成虚拟网络（例如，您可以访问内部应用程序），以及更稳定的环境。这是最昂贵的层级，但在功能性和提供的特性范围方面提供了最多。'
- en: In general, the Isolated tier is the most stable one when it comes to handling
    a huge load. While Standard or Premiumtiers become unresponsive pretty quickly
    when utilization hits 100%, Isolated App Services need more time to return the `HTTP
    503 Service Unavailable` response. Take this into account if you need a really
    reliable service that cannot be broken easily.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，隔离版层级在处理巨大负载时是最稳定的。当Standard或Premium层级的利用率达到100%时，它们会迅速变得无响应，而隔离版应用服务则需要更多时间才会返回`HTTP
    503 服务不可用`的响应。如果您需要一个非常可靠、不会轻易崩溃的服务，请考虑这一点。
- en: Securing App Services using different security providers
  id: totrans-235
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用不同安全提供商保护应用服务
- en: Most web applications have to be secured in some way, either by using your own
    security system or third-party identity providers, such as Facebook, Google, or
    Twitter. While working with the traditional application hosted on-premises, you
    often have to configure everything on your own. PaaS solutions, such as Azure
    App Services, already possess this functionality and make it easily accessible,
    thanks to the Authentication / Authorizationfeature. In this section, you will
    learn how to set it up so users will be prompted to log in.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数网页应用程序必须以某种方式进行安全保护，要么使用您自己的安全系统，要么使用第三方身份提供商，如Facebook、Google或Twitter。在传统的本地托管应用中，您通常需要自己配置所有内容。PaaS解决方案，如Azure应用服务，已经具备此功能，并且通过身份验证/授权功能轻松访问。在本节中，您将学习如何设置它，以便提示用户登录。
- en: Configuring authentication/authorization in the Azure Portal
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在Azure门户中配置身份验证/授权
- en: As with most PaaS services, you can configure the features of App Services directly
    from the portal. Thanks to such an approach, you have all options in one place
    and can easily switch between them.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 与大多数PaaS服务一样，您可以直接从门户配置应用服务的功能。由于这种方式，您可以将所有选项集中在一个地方，并轻松在它们之间切换。
- en: Using Azure Active Directory to secure App Services
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Azure Active Directory保护应用服务
- en: 'Go to your App Service and the find Authentication / Authorizationblade on
    the left, next to Application settings as mentioned previously. When you click
    on it, you will see a screen for configuration:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 转到您的应用服务，然后在左侧找到“身份验证/授权”面板，位于之前提到的“应用设置”旁边。点击它后，您将看到一个配置屏幕：
- en: '![](img/b0ba9ede-94cf-4148-bbd9-992babd591ad.png)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b0ba9ede-94cf-4148-bbd9-992babd591ad.png)'
- en: 'As you can see, it is currently disabled. When you toggle the App Service Authenticationfeature
    to On, you will see new options available, with which you can configure authentication
    for your web app:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，它目前处于禁用状态。当您将应用服务身份验证功能切换到“开”时，您将看到可用的新选项，您可以通过这些选项为您的网页应用配置身份验证：
- en: '![](img/cacac686-cce8-4e64-8286-edc9d4634693.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cacac686-cce8-4e64-8286-edc9d4634693.png)'
- en: 'Change the Action to take when request is not authenticated field to any value
    available. The portal will display the following information:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 将请求未通过身份验证时的操作字段更改为任何可用的值。门户将显示以下信息：
- en: '`To enable Authentication / Authorization please ensure all your custom domains
    have corresponding SSL bindings .net version is configured to "4.5" and manage
    pipeline mode is set to "Integrated".`'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: '`要启用身份验证 / 授权，请确保所有自定义域已绑定相应的 SSL，并且 .net 版本设置为 "4.5"，管理管道模式设置为 "集成"。`'
- en: Since we do not have a custom domain now, no action needs to be taken. The same
    applies to the .NET version and pipeline mode—if you have not changed the default
    parameters of your application, everything should be set correctly already. Let's
    now select one authentication provider and configure it—we will start with Azure
    Active Directory.
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们现在没有自定义域，因此无需执行任何操作。同样适用于 .NET 版本和管道模式—如果你没有更改应用程序的默认参数，一切应该已经正确设置。现在，让我们选择一个身份验证提供者并进行配置——我们将从
    Azure Active Directory 开始。
- en: You do not have to be an expert with Azure Active Directory to use it with App
    Service, especially now there is the possibility to let the Azure Portal configure
    it for you. However, if you would like to learn more about this service, the best
    place to start is its documentation: [https://docs.microsoft.com/en-us/azure/active-directory/active-directory-whatis](https://docs.microsoft.com/en-us/azure/active-directory/active-directory-whatis).
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure Active Directory 来与 App Service 配合工作并不需要你成为专家，特别是现在可以让 Azure Portal
    为你配置它。然而，如果你想了解更多关于这个服务的信息，最好的起点是它的文档：[https://docs.microsoft.com/en-us/azure/active-directory/active-directory-whatis](https://docs.microsoft.com/en-us/azure/active-directory/active-directory-whatis)。
- en: 'When you click on the Azure Active Directoryoption, you will see a new screen
    where you can configure integration. Firstly, you have to select the Management
    Mode:'
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击 Azure Active Directory 选项时，系统会显示一个新屏幕，你可以在其中配置集成。首先，你需要选择管理模式：
- en: Off: Azure Active Directory authentication is disabled.
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关闭：Azure Active Directory 身份验证已禁用。
- en: Express: A quick way to configure authentication for your App Service using Azure
    AD. You will have to either select an already existing Azure Active Directory application
    or let the Azure Portal create a new one for you.
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Express：使用 Azure AD 配置 App Service 身份验证的快捷方式。你需要选择一个已有的 Azure Active Directory
    应用程序，或者让 Azure Portal 为你创建一个新的应用程序。
- en: Advanced: If Express is not enough for you, you can always enter all necessary
    parameters on your own. With this option, you will be able to configure integration
    by providing information about Client ID, Issuer URL, and optionally, Client Secret.
    All of these parameters can be found when browsing your Azure Active Directory application.
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高级：如果 Express 不足以满足你的需求，你可以自行输入所有必要的参数。通过此选项，你将能够通过提供 Client ID、Issuer URL，以及可选的
    Client Secret 来配置集成。所有这些参数都可以在浏览 Azure Active Directory 应用程序时找到。
- en: 'To start, I recommend using the Express option, as configuring applications
    in Azure Active Directory is beyond scope of this book. For now, you only need
    to provide a name for the application and click OK. You will go back to the previous
    screen, where you should be able to see that one authentication provider is already
    configured:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我建议使用 Express 选项，因为在 Azure Active Directory 中配置应用程序超出了本书的范围。目前，你只需要为应用程序提供一个名称并点击
    OK。你将回到前一个屏幕，此时你应该可以看到已经配置了一个身份验证提供者：
- en: '![](img/da5b0ab5-905a-4477-9208-88f69e761e2f.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/da5b0ab5-905a-4477-9208-88f69e761e2f.png)'
- en: Now, let's click the Save button. After a moment, everything should be set and
    you can now access your application to see whether securing it works. Go to the Overview blade
    and click on the URL link, or enter it directly in your browser. When a default
    page is loaded, you will not see it, but rather will be redirected to the login
    page.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，点击保存按钮。稍等片刻，一切应该设置完毕，你现在可以访问你的应用程序，看看安全配置是否生效。前往概览面板并点击 URL 链接，或者直接在浏览器中输入它。当加载默认页面时，你不会看到页面内容，而是会被重定向到登录页面。
- en: For this particular exercise, I have assumed that you have your application
    already deployed. If you have not, please go back to the previous sections and
    deploy your code with either Visual Studio or FTP.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个特定的练习，我假设你已经部署了你的应用程序。如果没有，请回到前面的章节，使用 Visual Studio 或 FTP 部署你的代码。
- en: Since we configured Azure Active Directory as our authentication provider, a
    user will be asked to give this particular application consent to access their
    information.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: '由于我们将Azure Active Directory配置为身份验证提供者，因此系统会要求用户同意此特定应用程序访问他们的信息。  '
- en: Using other authentication providers
  id: totrans-257
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '使用其他身份验证提供者  '
- en: 'As you can see, Azure Active Directory is not the only security provider available
    for App Services. We can select Facebook, Google, or even Twitter to handle authentication
    and authorization for us. This is especially helpful when you have a public application
    for people using different social media websites, as they can use their accounts
    from other applications and quickly sign in when entering your website. To use
    other authentication providers than Azure Active Directory, you have to create
    an application in one of the mentioned portals. In fact, there is no difference
    whether you select Facebook, Google, or Twitter—you will have to provide two fields:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: '如您所见，Azure Active Directory并不是唯一可用于应用服务的安全提供者。我们可以选择Facebook、Google，甚至Twitter来为我们处理身份验证和授权。当您有一个面向公众的应用程序，供使用不同社交媒体网站的人们使用时，这一点尤其有帮助，因为他们可以使用来自其他应用程序的账户，并在进入您的网站时快速登录。要使用Azure
    Active Directory以外的身份验证提供者，您必须在其中一个提到的门户中创建一个应用程序。实际上，无论您选择Facebook、Google还是Twitter，都没有区别——您需要提供两个字段：  '
- en: An App ID and App Secretfor Facebook
  id: totrans-259
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Facebook的应用ID和应用密钥  '
- en: A Client Id and Client Secretfor Google
  id: totrans-260
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Google的客户端ID和客户端密钥  '
- en: An API Key and API Secretfor Twitter
  id: totrans-261
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Twitter的API密钥和API密钥  '
- en: We will not cover in this book how to create an application in other authentication
    providers. However, proper instructions can be found at [https://developers.facebook.com/docs/apps/register/](https://developers.facebook.com/docs/apps/register/), [https://developers.google.com/identity/sign-in/web/sign-in](https://developers.google.com/identity/sign-in/web/sign-in), [https://developer.twitter.com/en/docs/basics/authentication/guides/access-tokens.html](https://developer.twitter.com/en/docs/basics/authentication/guides/access-tokens.html).
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: '本书不会介绍如何在其他身份验证提供者中创建应用程序。然而，您可以在[https://developers.facebook.com/docs/apps/register/](https://developers.facebook.com/docs/apps/register/)、[https://developers.google.com/identity/sign-in/web/sign-in](https://developers.google.com/identity/sign-in/web/sign-in)、[https://developer.twitter.com/en/docs/basics/authentication/guides/access-tokens.html](https://developer.twitter.com/en/docs/basics/authentication/guides/access-tokens.html)找到相关的详细说明。  '
- en: Diagnostics and monitoring of App Services
  id: totrans-263
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '应用服务的诊断和监控  '
- en: The last section of this chapter will show you how you can diagnose and monitor App
    Services that you've deployed. Those operations are crucial when you have a working
    application, as errors and performance issues always crop up, especially in popular
    services. Thanks to multiple integrated tools in Azure Web Apps, you can be sure
    that you'll always have enough information to find and fix a problem.
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: '本章的最后一部分将展示如何诊断和监控您已部署的应用服务。这些操作在应用程序正常运行时至关重要，因为错误和性能问题总是会出现，特别是在热门服务中。借助Azure
    Web Apps中的多个集成工具，您可以确保始终拥有足够的信息来发现并解决问题。  '
- en: The Overview blade
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '概览面板  '
- en: 'The very first thing you probably already noticed is the charts visible in
    the Overview blade:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: '您可能已经注意到的第一件事是“概览”面板中可见的图表：  '
- en: '![](img/8ad509a0-6f14-48dd-a8c8-54e6368bee46.png)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8ad509a0-6f14-48dd-a8c8-54e6368bee46.png)  '
- en: They provide basic insight into the behavior of your application, such as data
    transfer, the number of requests, or HTTP 500 errors. Let's click on any of those
    charts—you will see another important screen, which we will look at now.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 它们提供了关于应用程序行为的基本洞察，例如数据传输、请求数量或HTTP 500错误。让我们点击任何一个图表——您将看到另一个重要的界面，我们现在来看一下。
- en: Metrics
  id: totrans-269
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '度量标准  '
- en: The Metrics blade gives you more detailed information and a better view of a
    specific parameter. On the left, there are many different metrics to choose from.
    You create your own chart by selecting more than only one parameter.
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: '度量标准面板为您提供更详细的信息，并且能够更好地查看特定参数。在左侧，您可以选择许多不同的度量标准。通过选择多个参数，您可以创建自己的图表。  '
- en: Remember that you can only choose metrics of the same unit—there is no possibility,
    for example, to connect the number of loaded assemblies and average response time.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: '请记住，您只能选择相同单位的度量标准——例如，无法将加载的组件数量与平均响应时间连接起来。  '
- en: On this screen, you can also change the chart's time range. This is very useful
    when searching for related issues (such as Data Inand Memory working setto check
    how much memory your application needs to handle incoming data).
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 在此屏幕上，您还可以更改图表的时间范围。这在查找相关问题时非常有用（例如，使用 数据输入 和 内存工作集 来检查应用程序处理传入数据所需的内存量）。
- en: Monitoring
  id: totrans-273
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 监控
- en: Let's go back to the main screen of App Service. There, when you scroll down,
    you will see a MONITORING section containing even more useful features.
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们返回到 应用服务 的主屏幕。在那里，当您向下滚动时，您将看到一个包含更多有用功能的 监控 部分。
- en: 'Click on the Log streamblade. You will see a black screen with the following
    information:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 日志流 面板。你将看到一个黑色的屏幕，显示以下信息：
- en: '`Application logs are switched off. You can turn them on using the ''Diagnostic
    logs'' settings.`'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: '`应用程序日志已关闭。您可以通过“诊断日志”设置将其打开。`'
- en: 'Apparently, we do not have this feature available for now. Let''s go to the Diagnostic
    logblade. It offers some interesting features regarding logging, including the
    following:'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，目前我们没有此功能。让我们进入 诊断日志 面板。它提供了一些关于日志的有趣功能，包括以下内容：
- en: Application logging (filesystem): Collects diagnostic traces
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序日志（文件系统）：收集诊断追踪
- en: Application logging (blog): The same as the filesystem option, but this time
    logs are stored within the *Azure Storage* account
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序日志（博客）：与文件系统选项相同，但这次日志存储在 *Azure Storage* 账户中。
- en: 'Web server logging: Gathers diagnostics about a web server'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web 服务器日志：收集有关 Web 服务器的诊断信息。
- en: 'Detailed error messages: If you feel current messages are not sufficient, you
    can turn on this feature to get more information'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 详细错误消息：如果您觉得当前的消息不足以解决问题，可以启用此功能以获取更多信息。
- en: 'Failed request tracing: Gathers information about failed requests'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 失败请求追踪：收集关于失败请求的信息。
- en: 'Additionally, you can find the FTP location of all logs with user information
    to log in. Since we need Application logging for Log stream, let''s turn this
    feature on. Now, we can go back to Log streamto see what kind of information we
    are gathering:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以找到所有日志的FTP位置，并包含用户登录信息。由于我们需要 应用程序日志 来查看 日志流，因此让我们启用此功能。现在，我们可以返回 日志流 查看我们正在收集的信息：
- en: '![](img/d45c939f-6bba-48ec-92f5-cf38033d41f6.png)'
  id: totrans-284
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d45c939f-6bba-48ec-92f5-cf38033d41f6.png)'
- en: If you do not see any information in Log stream, make sure you have set the
    correct level of logging. For all information possible, use Verbose.
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您在 日志流 中看不到任何信息，请确保您已设置正确的日志记录级别。为了获取所有可能的信息，请使用 详细信息。
- en: Summary
  id: totrans-286
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you have learned what App Services are, and how to build and
    deploy a simple application that can easily be pushed to Azure. Learning the basics
    of this particular service is crucial for understanding other topics mentioned
    in this book, such as WebJobs or Azure Functions. Always remember that you can
    initially use the Free tier to avoid paying for an application when testing or
    developing, and then scale up when you need to do so. I strongly recommend you
    play around a little bit with Web Apps, as the cloud component has a lot more
    to it, and some other features are not that obvious initially. We will cover more
    advanced features such as integration with Traffic Manager, Azure SQL database,
    and scaling scenarios in the next chapters.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您了解了什么是应用服务，以及如何构建并部署一个可以轻松推送到Azure的简单应用程序。了解此特定服务的基础知识对理解本书中提到的其他主题至关重要，例如
    WebJobs 或 Azure Functions。请始终记住，在测试或开发时，您可以先使用 免费版 来避免为应用程序支付费用，然后在需要时进行扩展。我强烈建议您多尝试一下
    Web 应用程序，因为云组件有很多内容，某些其他功能最初并不那么显而易见。我们将在接下来的章节中介绍更高级的功能，如与 Traffic Manager、Azure
    SQL 数据库的集成和扩展场景。
- en: Questions
  id: totrans-288
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Do the terms "App Service" and "Web App" refer to the same Azure service?
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: “应用服务”和“Web 应用程序”是否指的是相同的 Azure 服务？
- en: How many categories of App Service Plans are there currently in Azure?
  id: totrans-290
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 目前在Azure中有多少种类别的 应用服务计划？
- en: Why should Free and Shared tiers not be used for running production workloads?
  id: totrans-291
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为什么不应该使用 免费版 和 共享版 来运行生产工作负载？
- en: How many authentication providers can you set up in App Services?
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以在 应用服务 中设置多少个身份验证提供程序？
- en: Is there any difference in hardware between the Basic, Standard, and Premium tiers?
  id: totrans-293
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 基础版、标准版和高级版 之间，硬件有何不同？
- en: What do you need to enable to see logs in the Log stream?
  id: totrans-294
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要启用什么功能才能在 日志流 中查看日志？
- en: Can you attach a custom domain to each tier available in App Services?
  id: totrans-295
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以将自定义域名附加到 应用服务 中的每个版本上吗？
- en: Can you attach more than one App Service to an App Service Plan?
  id: totrans-296
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以将多个 应用服务 附加到一个应用服务计划中吗？
- en: Which operating systems are available for App Services?
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: App 服务支持哪些操作系统？
- en: Can you change operating system after App Service creation?
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 App 服务后，是否可以更改操作系统？
- en: Is it possible to deploy application files to App Services using FTPS? Where
    can you find the proper location address?
  id: totrans-299
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 是否可以使用 FTPS 将应用程序文件部署到 App 服务？可以在哪找到正确的位置地址？
- en: What is the difference between user-level and app-level credentials in App Services?
  id: totrans-300
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 App 服务中，用户级凭据与应用级凭据有什么区别？
- en: What is the difference between scaling up and scaling out?
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 扩展和横向扩展有什么区别？
- en: Let's say that you pay $50 for one instance of App Service per month. How much
    will you pay if you scale up to 10 instances?
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 假设你每月为一个 App 服务实例支付 50 美元。如果你将实例规模扩展到 10 个实例，你需要支付多少钱？
- en: What is the purpose of using the Isolated tier in App Services?
  id: totrans-303
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 App 服务中使用 Isolated 层的目的是什么？
- en: Is it possible to run a Go application in App Services?
  id: totrans-304
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 是否可以在 App 服务中运行 Go 应用程序？
- en: Further reading
  id: totrans-305
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'Azure App Service documentation: [https://docs.microsoft.com/en-us/azure/app-service/](https://docs.microsoft.com/en-us/azure/app-service/)'
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure App Service 文档：[https://docs.microsoft.com/en-us/azure/app-service/](https://docs.microsoft.com/en-us/azure/app-service/)
- en: Best practices for Azure App Service: [https://docs.microsoft.com/en-us/azure/app-service/app-service-best-practices](https://docs.microsoft.com/en-us/azure/app-service/app-service-best-practices)
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure App Service 最佳实践：[https://docs.microsoft.com/en-us/azure/app-service/app-service-best-practices](https://docs.microsoft.com/en-us/azure/app-service/app-service-best-practices)
- en: Reference architectures for Web Apps: [https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/basic-web-app)
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web 应用的参考架构：[https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/](https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/app-service-web-app/basic-web-app)
- en: Deployment slots: [https://docs.microsoft.com/en-us/azure/app-service/web-sites-staged-publishing](https://docs.microsoft.com/en-us/azure/app-service/web-sites-staged-publishing)
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署槽：[https://docs.microsoft.com/en-us/azure/app-service/web-sites-staged-publishing](https://docs.microsoft.com/en-us/azure/app-service/web-sites-staged-publishing)
