- en: '8'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '8'
- en: OpenShift Security
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: OpenShift 安全
- en: Throughout this book, you have been able to follow some important aspects that
    involve processes, people, and all the technology involved to maintain a powerful,
    resilient, and fault-tolerant platform. A product of this magnitude with a vast
    structure, from its creation to customizations that will keep it fully functional,
    also requires a great division of responsibilities and skills for each step taken.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，您将能够跟随一些涉及流程、人员和所有技术的关键方面，以维护一个强大、具有韧性和容错能力的平台。如此大规模的产品，从其创建到保持其完全功能所需的定制，也需要在每个步骤中进行良好的责任和技能分工。
- en: Security has always been and will always be a top concern in any enterprise,
    even more so now with the advent of things such as ransomware, malicious crypto-mining,
    malware, and other types of attacks. According to a *Gartner* study, by 2025,
    90% of organizations that don’t control public cloud usage properly will inadvertently
    share sensitive data. When it comes to Kubernetes security, we also have seen
    a number of vulnerabilities and attacks recently. In the *Further reading* section
    of this chapter, you can check out some vulnerabilities and security incidents
    related to Kubernetes that happened in the last few years.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 安全一直是任何企业最重要的关注点，尤其是在如今勒索病毒、恶意加密货币挖矿、恶意软件和其他类型的攻击层出不穷的情况下。根据*Gartner*的研究，到2025年，90%的未能妥善控制公共云使用的组织将无意中共享敏感数据。在
    Kubernetes 安全方面，我们最近也看到了一些漏洞和攻击。在本章的*进一步阅读*部分，您可以查看一些近年来与 Kubernetes 相关的漏洞和安全事件。
- en: For this reason, we decided to dedicate an entire chapter to security-related
    aspects involving OpenShift. The main focus of this chapter is not to be a complete
    security guide, though, but rather a minimal collection of topics you should consider
    and review to have a secure container strategy.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 基于此，我们决定专门用一章来讨论与 OpenShift 相关的安全方面。本章的主要目的是不是成为一份完整的安全指南，而是为您提供一系列最低限度的主题，供您考虑和审视，以确保拥有一个安全的容器战略。
- en: 'In this chapter, you will find the following topics:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍以下主题：
- en: Container security
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容器安全
- en: AuthN and AuthZ
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 身份验证（AuthN）和授权（AuthZ）
- en: Certificates in OpenShift
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenShift 中的证书
- en: etcd encryption
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: etcd 加密
- en: Container isolation
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 容器隔离
- en: Network isolation
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络隔离
- en: Red Hat Container Catalog
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Red Hat 容器目录
- en: Let’s get started!
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 开始吧！
- en: Container security
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 容器安全
- en: Container adoption grows exponentially, and with that also the number of vulnerabilities
    and potential attacks against all the container ecosystem. That being said, security
    is an important aspect you need to consider in your container strategy. Red Hat
    is well known for the high level of security of its products, which is one of
    the characteristics that has always been a differentiator for them in the industry,
    since the robust **Red Hat Enterprise Linux** (**RHEL**), which was (and still
    is!) the foundation of the company up to emerging technologies, such as Red Hat
    OpenShift. They have been named leaders in the container security space due to
    a number of security features that Red Hat defined as default (and required) with
    OpenShift that are optional in many other Kubernetes-based platforms, which also
    makes OpenShift more secure than other options. One example of it is **Security-Enhanced
    Linux** (**SELinux**), which is always enabled in any OpenShift worker nodes and
    prevents a number of vulnerabilities and exploits.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 容器的采用呈指数级增长，随之而来的是容器生态系统中各种漏洞和潜在攻击的增多。也就是说，安全是您在容器战略中需要考虑的重要方面。Red Hat 因其产品的高安全性而广受认可，这也是它们在行业中始终保持竞争力的特点之一，从坚实的**Red
    Hat Enterprise Linux**（**RHEL**）——公司发展的基础——到如 Red Hat OpenShift 这样的新兴技术。由于 Red
    Hat 在 OpenShift 中将许多安全特性设定为默认（且必需），这些特性在许多其他基于 Kubernetes 的平台中是可选的，这使得 OpenShift
    在安全性方面优于其他选择。一个例子是**安全增强 Linux**（**SELinux**），它始终在任何 OpenShift 工作节点上启用，防止了许多漏洞和攻击。
- en: Did you know?
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 您知道吗？
- en: 'Did you know that there are now probably somewhere about 380,000 Kubernetes
    **application programming interfaces** (**APIs**) open on the internet for some
    form of access that are probably exposed to some sort of attack or data leak?
    That is what *The Shadowserver Foundation* found in this research: [https://www.shadowserver.org/news/over-380-000-open-kubernetes-api-servers/](https://www.shadowserver.org/news/over-380-000-open-kubernetes-api-servers/).'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 你知道吗？现在互联网上大约有38万个Kubernetes **应用程序编程接口** (**APIs**) 对外开放，可能暴露于某种攻击或数据泄露的风险中？这就是*The
    Shadowserver Foundation*在其研究中发现的：[https://www.shadowserver.org/news/over-380-000-open-kubernetes-api-servers/](https://www.shadowserver.org/news/over-380-000-open-kubernetes-api-servers/)。
- en: 'Interested in seeing more? In this *Container Security* report, you will find
    some great research related to security on Kubernetes: [https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1](https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1).'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 想了解更多吗？在这份*容器安全*报告中，你将找到一些与Kubernetes安全相关的重要研究：[https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1](https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1)。
- en: 'Here, you can view the *State of Kubernetes security report*: [https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview](https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview).'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，你可以查看*Kubernetes安全状态报告*：[https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview](https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview)。
- en: 'You can also consult the *Is the Cloud Secure?* *Gartner* study at the following
    link: [https://www.gartner.com/smarterwithgartner/is-the-cloud-secure](https://www.gartner.com/smarterwithgartner/is-the-cloud-secure).'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以参考以下链接中的*云安全性是否可靠？* *Gartner* 研究：[https://www.gartner.com/smarterwithgartner/is-the-cloud-secure](https://www.gartner.com/smarterwithgartner/is-the-cloud-secure)。
- en: 'The key to having a secure environment and applications resides in the ability
    that a company has to do the following:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有安全环境和应用程序的关键在于公司能够做到以下几点：
- en: '**Control**: Secure the **application life cycle management** (**ALM**) to
    detect and fix vulnerabilities before it goes live'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**控制**：保护**应用程序生命周期管理** (**ALM**)，以在发布前检测并修复漏洞。'
- en: '**Protect**: Ability to assess and protect the platform and infrastructure
    to avoid vulnerabilities being exploited'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**保护**：评估和保护平台与基础设施的能力，以避免漏洞被利用。'
- en: '**Detect and respond**: Detect and mitigate vulnerabilities by limiting their
    impact on systems and environments'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**检测与响应**：通过限制系统和环境的影响，检测和缓解漏洞。'
- en: 'In the following diagram, you will see some aspects of these three factors
    we mentioned:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，你将看到我们提到的这三个因素的一些方面：
- en: '![Figure 8.1 – Container security strategy ](img/B18015_08_01.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.1 – 容器安全策略](img/B18015_08_01.jpg)'
- en: Figure 8.1 – Container security strategy
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.1 – 容器安全策略
- en: In this chapter, we will walk through some important things to consider about
    each of these factors.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将详细讲解关于这些因素的一些重要考虑事项。
- en: Control
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 控制
- en: 'To secure the container software supply chain, a few common steps can be performed,
    as follows:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保容器软件供应链的安全，可以执行以下几个常见步骤：
- en: '**Vulnerability analysis**: Scan the container images to find known vulnerabilities.
    This topic will be covered in detail in [*Chapter 12*](B18015_12.xhtml#_idTextAnchor251),
    *OpenShift Multi-Cluster Security*.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漏洞分析**：扫描容器镜像以发现已知漏洞。这个主题将在[*第12章*](B18015_12.xhtml#_idTextAnchor251) *OpenShift
    多集群安全*中详细介绍。'
- en: '**Trusted images and contents**: Do you know everything that is running inside
    your containers and applications? Every application these days uses many dependencies
    from different projects, many of them open source. It is crucial to use trusted
    sources to avoid running compromised base packages and images. Red Hat provides
    the Red Hat **Universal Base Image** (**UBI**), which is the robust, secure, and
    stable version of RHEL that you can use as a base for your container images. Red
    Hat also provides a comprehensive list of certified container images through its
    Red Hat Container Catalog that are safe to use and maintains a Container Health
    Index that helps to assess the security risk of a container image.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**受信任的镜像和内容**：您知道容器和应用程序中运行的所有内容吗？如今每个应用程序都依赖于来自不同项目的许多依赖项，其中许多是开源的。使用受信任的来源至关重要，以避免运行被破坏的基础包和镜像。红帽提供了红帽
    **通用基础镜像**（**UBI**），它是 RHEL 的强大、安全和稳定的版本，可以作为容器镜像的基础。红帽还通过其红帽容器目录提供了经过认证的容器镜像列表，这些镜像是安全可用的，并维护了一个容器健康指数，用于评估容器镜像的安全风险。'
- en: '**ALM and continuous integration/continuous deployment (CI/CD) pipeline**:
    Security should be an integral part of your development workflow. A modern development
    life cycle requires that security be a shared responsibility among all teams,
    from end to end. **Development-security-operations** (**DevSecOps**) is the new
    norm, and that means automating security gates to integrate security into the
    **development-operations** (**DevOps**) processes. Things such as **integrated
    development environment** (**IDE**) plugins and CI/CD pipeline security tasks
    are must-haves to achieve this.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ALM 和持续集成/持续部署（CI/CD）管道**：安全应成为开发工作流的一个重要组成部分。现代开发生命周期要求安全是所有团队之间的共同责任，从头到尾都要考虑到。**开发-安全-运维**（**DevSecOps**）已成为新常态，这意味着要自动化安全控制，确保将安全融入
    **开发-运维**（**DevOps**）过程。诸如 **集成开发环境**（**IDE**）插件和 CI/CD 管道安全任务等工具是实现这一目标的必备条件。'
- en: Of course, these are only a few items among a much bigger set. It is not the
    main focus of this book to cover a comprehensive list of security-related aspects,
    but we will highlight what we consider are some important factors you should take
    care of with your container strategy.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，这些只是一个更大集合中的一部分。虽然本书的主要重点不是全面覆盖与安全相关的所有方面，但我们将突出一些您在容器策略中应该关注的重要因素。
- en: Protect
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 保护
- en: To protect your platform and infrastructure, it is important to have policies
    in place for authentication and authorization, deployment, certificate management,
    compliance assessment, and policy enforcement. Later in this chapter, we will
    cover in depth the authentication and authorization aspects of an OpenShift cluster.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保护您的平台和基础设施，制定身份验证和授权、部署、证书管理、合规性评估以及政策执行等相关政策至关重要。在本章后续内容中，我们将深入探讨 OpenShift
    集群的身份验证和授权方面。
- en: Detect and respond
  id: totrans-37
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 检测与响应
- en: Even with all actions taken to control and protect the infrastructure, you need
    to be able to detect and mitigate security risks. It is important, then, to have
    monitoring practices in place, but also other policies that may limit the impact
    of any vulnerabilities or breaches such as container and network isolation. In
    this chapter, you will also see some more information about container and network
    isolation.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 即使采取了所有措施来控制和保护基础设施，您仍然需要能够检测和缓解安全风险。因此，制定监控措施以及其他可能限制漏洞或泄露影响的政策至关重要，例如容器和网络隔离。在本章中，您还将看到有关容器和网络隔离的更多信息。
- en: Let’s start by looking at authentication and authorization in more detail. Continue
    reading to learn more about them.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先更详细地了解身份验证和授权。继续阅读以了解更多内容。
- en: AuthN and AuthZ
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: AuthN 和 AuthZ
- en: '**AuthN** and **AuthZ** are related concepts but with different goals. **AuthN**
    is an abbreviation of **a**uthe**n**tication and is related to the process to
    confirm who a user is and validate their credentials to grant access to the platform.
    In this process, we deal with **identity providers** (**IdPs**) on OpenShift to
    configure the authentication provider that will check the user credentials, which
    we will cover shortly.'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**AuthN** 和 **AuthZ** 是相关的概念，但其目标不同。**AuthN** 是 **身份验证**（authentication）的缩写，涉及确认用户身份并验证其凭据以授予平台访问权限的过程。在此过程中，我们将与
    OpenShift 上的 **身份提供者**（**IdPs**）打交道，配置将检查用户凭据的身份验证提供者，我们将在稍后详细介绍。'
- en: In turn, **AuthZ** stands for **a**uthori**z**ation and is directly linked to
    giving the user only what they really should have access to, after the authentication
    process.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 反过来，**AuthZ**代表**授权**（authorization），它与在认证过程之后仅授予用户他们真正应有的访问权限直接相关。
- en: These two concepts are seen as confusing or similar from the point of view of
    just logging in to OpenShift. To clarify the concepts, we will now discuss the
    different objects and processes related to authentication and authorization.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 从仅仅登录OpenShift的角度来看，这两个概念被认为是混淆或相似的。为了澄清这些概念，我们将讨论与认证和授权相关的不同对象和过程。
- en: Authentication
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 认证
- en: 'OpenShift works with the following set of objects as part of the authentication
    process:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift在认证过程中使用以下一组对象：
- en: '![](img/B18015_08_Table_01.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18015_08_Table_01.jpg)'
- en: These are the objects used in OpenShift that, combined, authenticate a user
    in the platform. In order to understand how authentication works, you need to
    define IdPs on OpenShift—see more information about them next.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是OpenShift中用于组合验证用户的对象。为了理解认证如何工作，您需要在OpenShift上定义IdP——接下来会有更多关于它们的信息。
- en: IdPs
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: IdP
- en: IdPs are entities that integrate OpenShift with authentication providers, with
    the purpose of creating a chain of custody over who can log on to the platform.
    To avoid the privilege of one product over another when it comes to managing users,
    OpenShift creates a very flexible option that allows multiple IdPs to integrate
    with OpenShift at the same time.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: IdP是将OpenShift与认证提供者集成的实体，目的是创建一个追踪谁可以登录平台的链条。为了避免在管理用户时某个产品对另一个产品的特权，OpenShift创建了一个非常灵活的选项，允许多个IdP同时与OpenShift集成。
- en: 'The following table contains a list of supported IdPs allowed for OpenShift
    integration:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格列出了允许与OpenShift集成的受支持IdP：
- en: '![](img/B18015_08_Table_02.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18015_08_Table_02.jpg)'
- en: 'In the OpenShift documentation, you will find detailed information about how
    to configure each of these providers: [https://docs.openshift.com/container-platform/latest/authentication/index.html](https://docs.openshift.com/container-platform/latest/authentication/index.html).'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在OpenShift文档中，您将找到如何配置每个认证提供者的详细信息：[https://docs.openshift.com/container-platform/latest/authentication/index.html](https://docs.openshift.com/container-platform/latest/authentication/index.html)。
- en: OpenShift uses a **role-based access control** (**RBAC**) model to perform the
    authorization process and give a user the appropriate set of permissions they
    should have, as you will see now.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift使用**基于角色的访问控制**（**RBAC**）模型来执行授权过程，并授予用户他们应拥有的适当权限集，正如您现在看到的那样。
- en: Authorization – RBAC
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 授权 – RBAC
- en: 'In an RBAC system, you will have a set of permissions represented as a *role*
    that users and groups will use to have those permissions granted. On OpenShift,
    we have the following objects to configure RBAC permissions:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在RBAC系统中，您将拥有一组权限，表示为*角色*，用户和组将使用这些角色来获得这些权限。在OpenShift中，我们有以下对象来配置RBAC权限：
- en: '![](img/B18015_08_Table_03.jpg)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18015_08_Table_03.jpg)'
- en: 'A role can be either cluster- or local-scoped, which means that it can be applied
    for all projects or only for a specific project. In the following example, you
    can see a command to create a *local* role that will allow a user to get and update
    a pod in the namespace test:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 角色可以是集群范围或本地范围，这意味着它可以应用于所有项目或仅应用于特定项目。在以下示例中，您可以看到一个命令来创建一个*本地*角色，允许用户在命名空间test中获取并更新一个pod：
- en: '[PRE0]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'You can check the role created by running the following command:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过运行以下命令来检查创建的角色：
- en: '[PRE1]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Similarly, to create a *cluster* role, you need to use the `oc create role`
    command, like so:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，要创建一个*集群*角色，您需要使用`oc create role`命令，如下所示：
- en: '[PRE2]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'To create a role binding to add this role to a user or group, the following
    commands can be used:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建角色绑定并将此角色添加到用户或组，您可以使用以下命令：
- en: '[PRE3]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'You can also remove a role from a user or group using the following commands:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用以下命令从用户或组中删除角色：
- en: '[PRE4]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Continue reading for hints to troubleshoot issues you may have related to the
    access-control feature.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 继续阅读以获取关于访问控制功能的故障排除提示。
- en: Access-control troubleshooting
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 访问控制故障排除
- en: It is important you notice that after you change the cluster OAuth custom resource,
    the authentication operator will apply the change; due to that, you may observe
    temporary unavailability of the OpenShift authentication. Allow some minutes for
    the operator to finish applying the changes.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，在更改集群 OAuth 自定义资源后，认证操作员将应用更改；因此，您可能会观察到 OpenShift 认证的暂时不可用。请等待几分钟，直到操作员完成应用更改。
- en: 'Even if you face issues with OpenShift authentication, we recommend you check
    out this helpful article: [https://access.redhat.com/articles/5900841](https://access.redhat.com/articles/5900841).'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 即使您在使用 OpenShift 认证时遇到问题，我们仍建议您查看这篇有用的文章：[https://access.redhat.com/articles/5900841](https://access.redhat.com/articles/5900841)。
- en: Certificates in OpenShift
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: OpenShift 中的证书
- en: 'OpenShift uses several different certificates to make the platform secure.
    In this section, we will walk through the main certificate chains OpenShift uses.
    These are presented here:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift 使用多个不同的证书来确保平台安全。在本节中，我们将介绍 OpenShift 使用的主要证书链。这些证书如下所示：
- en: '`https://api. <cluster-name>.<domain>:6443/`.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`https://api.<cluster-name>.<domain>:6443/`。'
- en: '`*.apps.<cluster-name>.<domain>`.'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`*.apps.<cluster-name>.<domain>`。'
- en: '**Node certificates**: Managed automatically by the cluster and don’t require
    any user intervention. Automatically rotated.'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**节点证书**：由集群自动管理，无需用户干预。自动轮换。'
- en: '**etcd certificates**: Used to encrypt communication between etcd cluster members.
    Automatically managed and rotated by the cluster itself.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**etcd 证书**：用于加密 etcd 集群成员之间的通信。由集群自动管理和轮换。'
- en: 'OpenShift creates self-signed certificates with the platform installation.
    Most enterprises require those certificates to be replaced by custom certificates.
    To do so, refer to the OpenShift documentation, as follows:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: OpenShift 在平台安装时会创建自签名证书。大多数企业要求将这些证书替换为自定义证书。为此，请参考 OpenShift 文档，具体如下：
- en: 'To replace the ingress certificate: [https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html](https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html)'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要替换入口证书，请参阅：[https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html](https://docs.openshift.com/container-platform/latest/security/certificates/replacing-default-ingress-certificate.html)
- en: 'To replace the API server: [https://docs.openshift.com/container-platform/4.10/security/certificates/api-server.html](https://docs.openshift.com/container-platform/4.10/security/certificates/api-server.html)'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要替换 API 服务器证书，请参阅：[https://docs.openshift.com/container-platform/4.10/security/certificates/api-server.html](https://docs.openshift.com/container-platform/4.10/security/certificates/api-server.html)
- en: If you replace the certificates, you may also need to add a trusted **certificate
    authority** (**CA**), if you use a private CA. The next section describes how
    to do this.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您替换证书，您可能还需要添加一个受信任的 **证书颁发机构** (**CA**)，如果您使用的是私有 CA。下一部分将描述如何操作。
- en: Trusted CA
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 受信任的 CA
- en: 'You may need to add a custom CA that you use within your organization, to make
    API calls possible between OpenShift components and other external systems. To
    do so, you need to create a config map with the certificate chain on the `openshift-config`
    namespace, like so:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能需要添加您在组织中使用的自定义 CA，以便在 OpenShift 组件与其他外部系统之间进行 API 调用。为此，您需要在 `openshift-config`
    命名空间中创建一个带有证书链的配置映射，如下所示：
- en: '[PRE5]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Then, update the cluster-wide proxy to use the config map just created, as
    follows:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，更新集群范围的代理，使用刚刚创建的配置映射，具体如下：
- en: '[PRE6]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: One important piece of any Kubernetes cluster is the etcd database. You may
    decide to encrypt it to keep secrets and other objects encrypted in the database.
    Check out next how to do this.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: Kubernetes 集群中的一个重要部分是 etcd 数据库。您可以决定加密它，以保持数据库中的机密和其他对象加密。接下来请查看如何操作。
- en: etcd encryption
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: etcd 加密
- en: The etcd database, by default, is not encrypted. However, you can easily enable
    etcd encryption to have an extra layer of data security in your cluster. When
    etcd encryption is enabled, things such as secrets and config maps are stored
    encrypted, which makes your cluster even more secure.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，etcd 数据库是未加密的。然而，您可以轻松启用 etcd 加密，在集群中增加一层数据安全性。当启用 etcd 加密时，诸如机密和配置映射等内容将以加密形式存储，这使您的集群更加安全。
- en: 'To enable etcd encryption, proceed as follows:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用 etcd 加密，请按照以下步骤进行：
- en: 'Edit the `apiserver` object, like so:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 编辑 `apiserver` 对象，如下所示：
- en: '[PRE7]'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Set the `encryption` field, as follows:'
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 `encryption` 字段，具体如下：
- en: '[PRE8]'
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Save the file to apply the changes.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存文件以应用更改。
- en: Note that it may take up to 15 minutes or so to enable the encryption after
    you have applied the changes.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，应用更改后启用加密可能需要大约 15 分钟的时间。
- en: Container isolation
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 容器隔离
- en: We already discussed aspects such as user authentication and permissions, as
    well as certificates, but how do you make sure your containers can only do what
    they are supposed to do and nothing more, and as such, cannot escalate privileges
    on the host?
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了用户认证、权限以及证书等方面，但如何确保容器仅能执行其应有的操作，而无法在主机上提升权限呢？
- en: We are going to discuss in this section some of the concepts implemented as
    part of the **operating system** (**OS**) to securely run containers and also
    some aspects implemented on OpenShift related to this.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将讨论作为**操作系统**（**OS**）一部分实现的一些概念，以安全地运行容器，同时也会讨论 OpenShift 中与此相关的一些实现。
- en: 'In the following table, you see some concepts related to containers:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在下表中，你将看到一些与容器相关的概念：
- en: '![](img/B18015_08_Table_04.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18015_08_Table_04.jpg)'
- en: 'In the following diagram, you can see a graphical representation of these concepts:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，你可以看到这些概念的图示：
- en: '![Figure 8.2 – Container isolation](img/B18015_08_02.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![图 8.2 – 容器隔离](img/B18015_08_02.jpg)'
- en: Figure 8.2 – Container isolation
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8.2 – 容器隔离
- en: While it is important to understand these concepts, you don’t really need to
    work directly with any of them, as OpenShift abstracts those configurations for
    you. Instead, you need to understand what **security context constraints** (**SCCs**)
    are—these are the objects you will need to use to give broader permissions to
    containers when needed. Read on to find out what SCCs are and how to configure
    them.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然理解这些概念很重要，但你不需要直接操作其中任何一个，因为 OpenShift 会为你抽象化这些配置。相反，你需要理解什么是**安全上下文约束**（**SCCs**）——这些是你在需要时为容器授予更广泛权限所需使用的对象。继续阅读，了解什么是
    SCCs 以及如何配置它们。
- en: SCCs
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SCCs
- en: 'SCCs are OpenShift objects that control the actions that a pod or container
    can do with the host resources. By default, any pod uses the **restricted** SCC,
    which is the most restricted permission that prevents it from running as root
    and escalating privileges on the host. Besides the restricted SCC, the most usual
    ones are noted here:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: SCCs 是 OpenShift 中的对象，用于控制 Pod 或容器与主机资源交互的权限。默认情况下，任何 Pod 使用**restricted** SCC，这是最受限制的权限，防止其作为
    root 运行并提升主机上的权限。除了 restricted SCC，以下是常见的几种：
- en: '`anyuid`: This has the same permissions as the restricted SCC, allowing a container
    to run as any `0` UID—the root user.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`anyuid`：具有与 restricted SCC 相同的权限，允许容器作为任何 `0` UID（root 用户）运行。'
- en: '`hostaccess`: Gives permissions for a container to access all host namespaces.
    It should be used only with trusted sources as it gives very broad permissions
    within a worker node—use only if really necessary.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hostaccess`：授予容器访问所有主机命名空间的权限。只应与可信来源一起使用，因为它在工作节点中赋予了非常广泛的权限——仅在真正必要时使用。'
- en: '`hostnetwork`: Allows a container to access the worker node underlying the
    network directly. Use with caution to decrease the risk of a network breach.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`hostnetwork`：允许容器直接访问底层工作节点的网络。请谨慎使用，以降低网络漏洞的风险。'
- en: '`privileged`: Most relaxed SCC and gives all privileges to the host. Should
    be avoided at all costs and used only if really necessary.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`privileged`：最放宽的 SCC，赋予主机所有权限。应避免使用，只有在绝对必要时才使用。'
- en: 'Besides all the security-related features we already covered so far, we cannot
    miss a very important topic: network policies. A network policy is a great feature
    to make sure your pods and projects can only communicate with what they are supposed
    to. In the following section, you will see what you can do with network policies
    and why they are so important when it comes to network security.'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 除了我们已经讨论的所有与安全相关的功能外，还有一个非常重要的话题：网络策略。网络策略是确保你的 Pods 和项目只能与它们应当通信的对象进行通信的一个极好功能。在接下来的章节中，你将了解网络策略的作用以及它们在网络安全中的重要性。
- en: Network isolation
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络隔离
- en: Firewalls are well known and have been used for a long time in any kind of infrastructure.
    When it comes to OpenShift, we need to have in mind that we are now working with
    a software-defined platform and, as such, we have software features to implement
    some of the same concepts we have had for a long time in a data center—it is no
    different with a firewall. As we have seen in the previous chapter, Network Policies
    are nothing more than rules you define to allow or block network communication
    between pods and projects on OpenShift, similar to what a firewall provides in
    a physical network.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 防火墙是众所周知并且在各种基础设施中被广泛使用的技术。在 OpenShift 中，我们需要牢记，当前我们所使用的是一个软件定义的平台，因此，我们拥有一些软件功能来实现数据中心中长期存在的概念——防火墙也不例外。正如我们在前一章中所看到的，网络策略实际上就是您定义的规则，用于允许或阻止
    OpenShift 中不同 pod 和项目之间的网络通信，这与物理网络中的防火墙提供的功能类似。
- en: 'By default, all pods in a project are accessible from other pods and network
    endpoints from any project. To isolate pods and projects, you need to create network
    policies, such as the following:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，项目中的所有 pod 都可以从任何项目中的其他 pod 和网络端点进行访问。为了隔离 pod 和项目，您需要创建网络策略，如下所示：
- en: '[PRE9]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'The previous network policy denies all traffic for pods in a project. In order
    for a project to be accessed from outside the cluster using the OpenShift ingress,
    you will need to allow connections from the ingress project, as you can see in
    the following snippet:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 前述的网络策略禁止项目中所有 pod 的流量。为了使一个项目能够通过 OpenShift 的入口从集群外部访问，您需要允许来自入口项目的连接，如下片段所示：
- en: '[PRE10]'
  id: totrans-117
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'You may also create custom network policies using labels for specific pods.
    For instance, the following YAML Ain’t Markup Language (YAML) could be used to
    limit pods with an `app=web` label to be accessed on the accessed on the HTTPS
    port (`443`) onlyport only:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以使用标签为特定的 pod 创建自定义网络策略。例如，以下 YAML Ain’t Markup Language (YAML) 代码可以用来限制只有带有
    `app=web` 标签的 pod 只能通过 HTTPS 端口（`443`）进行访问：
- en: '[PRE11]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'There is a world of possibilities for using network policies to set your projects
    and pods with proper network access. A common and recommended practice is to create
    a set of standard network policies and configure the OpenShift template so that
    those network policies will be automatically applied to any new projects created.
    You can find out how to customize the OpenShift template to add those network
    policies in the OpenShift documentation: [https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html](https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html).'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 使用网络策略来为项目和 pod 设置适当的网络访问权限有着广阔的可能性。一个常见且推荐的做法是创建一套标准的网络策略，并配置 OpenShift 模板，使这些网络策略能够自动应用于任何新创建的项目。您可以在
    OpenShift 文档中了解如何自定义 OpenShift 模板以添加这些网络策略：[https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html](https://docs.openshift.com/container-platform/latest/networking/network_policy/default-network-policy.html)。
- en: Another important thing you may consider in your security strategy is about
    using safe container base images. The following section covers what the Red Hat
    Container Catalog is and how it can help you with this important topic.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 另一件您可能会在安全策略中考虑的重要事项是使用安全的容器基础镜像。以下部分将介绍什么是 Red Hat 容器目录，以及它如何帮助您处理这个重要话题。
- en: Red Hat Container Catalog
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Red Hat 容器目录
- en: Most enterprises, at some point, need to use containers from different sources,
    either as off-the-shelf products or only as dependencies for workloads. Red Hat
    has an interesting tool that aims to help you to make sure you use secure containers.
    The Red Hat Container Catalog is a repository of container images that have been
    tested and certified by Red Hat and partners, and therefore are trusted images.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数企业在某个阶段都需要使用来自不同来源的容器，这些容器可能是现成的产品，也可能仅仅是工作负载的依赖项。Red Hat 提供了一款有趣的工具，旨在帮助您确保使用安全的容器。Red
    Hat 容器目录是一个容器镜像库，里面的镜像经过 Red Hat 和合作伙伴的测试与认证，因此是可信的镜像。
- en: 'As part of the Container Catalog, Red Hat provides the Container Health Index.
    The Container Health Index is a rating system for container images available in
    the Red Hat Container Catalog, which goes from Grade A to F, in which Grade A
    is the most up-to-date image in terms of critical errata. You can find all the
    grades available and how they are defined at this link: [https://access.redhat.com/articles/2803031](https://access.redhat.com/articles/2803031).
    This feature helps a lot to assess the security risk you are associated with when
    using a certain image version.'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 作为容器目录的一部分，Red Hat 提供了容器健康指数（Container Health Index）。容器健康指数是 Red Hat 容器目录中可用容器镜像的评分系统，评分从
    A 到 F，其中 A 代表在关键错误修复方面最为最新的镜像。你可以通过以下链接查看所有可用评分及其定义：[https://access.redhat.com/articles/2803031](https://access.redhat.com/articles/2803031)。该功能有助于评估使用某个镜像版本时可能面临的安全风险。
- en: In the Red Hat Container Catalog, you can find the Red Hat UBI, which may comprise
    an important aspect of your container strategy. You'll find out more about this
    next.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Red Hat 容器目录中，你可以找到 Red Hat UBI，这可能是你容器策略中的一个重要方面。接下来你将了解更多内容。
- en: Red Hat UBI
  id: totrans-126
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Red Hat UBI
- en: Defining a base image for your containers is an important step that you need
    to consider to have a portable and secure container delivery process. Depending
    on the decision you make, you may see yourself locked in some specific Linux versions
    and distributions that the container base image supports. The base image is also
    critical to keep your workloads secure—many vulnerabilities are found every week
    on Linux, but they are usually fixed really fast, using a mature and robust base
    image such as RHEL which is fundamental in keeping your workloads more secure.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 为你的容器定义基础镜像是一个重要步骤，这是你需要考虑的内容，以确保具有便携性和安全性的容器交付过程。根据你做出的决定，你可能会被锁定在某些特定的 Linux
    版本和发行版中，而这些版本和发行版正是该容器基础镜像所支持的。基础镜像对于保持工作负载的安全性也至关重要——每周都有许多 Linux 漏洞被发现，但它们通常会得到非常快速的修复，使用像
    RHEL 这样成熟且稳健的基础镜像，对于确保工作负载更加安全至关重要。
- en: 'Red Hat UBI is based on RHEL, available at no additional cost, and has a minimal
    footprint (something between 10 **megabytes** (**MB**) and 100 MB, depending on
    the image type). There are four image types you can choose from, depending on
    your needs, as outlined here:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: Red Hat UBI 基于 RHEL，免费提供，并且占用最小空间（大小介于 10 **兆字节** (**MB**) 和 100 MB 之间，具体取决于镜像类型）。你可以根据需求从以下四种镜像类型中选择：
- en: '![](img/B18015_08_Table_05.jpg)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B18015_08_Table_05.jpg)'
- en: Besides the options mentioned, Red Hat also provides some UBIs with language
    runtimes included, such as Node.js, .NET, and Java. All the base images are available
    for download from the Red Hat Container Catalog.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 除了上述选项外，Red Hat 还提供了一些包含语言运行时的 UBI，例如 Node.js、.NET 和 Java。所有基础镜像都可以从 Red Hat
    容器目录下载。
- en: Once you have a list of trusted sources that contain secure container images,
    we recommend you limit OpenShift to only running images from these trusted sources.
    You'll see next how to do this.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你有了包含安全容器镜像的受信任源列表，我们建议你限制 OpenShift 仅运行来自这些受信任源的镜像。接下来你将看到如何操作。
- en: Limiting image registry sources
  id: totrans-132
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 限制镜像注册源
- en: 'You can easily block or allow image registries that OpenShift can use with
    the following procedure:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过以下程序轻松地阻止或允许 OpenShift 使用的镜像注册源：
- en: 'Run the following command to edit the `image.config.openshift.io/cluster` object:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令编辑 `image.config.openshift.io/cluster` 对象：
- en: '[PRE12]'
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'In the object’s YAML, set the `allowedRegistriesForImport` and `registrySources`
    fields with the desired image registries. `AllowedRegistriesForImport` defines
    the image registries to which a user can import images using image streams (the
    `oc import-image` command). In the `registrySources` block, you can define allowed
    registries (`allowedRegistries`) or blocked registries (`blockedRegistries`),
    but not both. Have a look at the following example:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在对象的 YAML 文件中，设置 `allowedRegistriesForImport` 和 `registrySources` 字段，指定所需的镜像注册源。`AllowedRegistriesForImport`
    定义了用户可以通过镜像流（`oc import-image` 命令）导入镜像的镜像注册源。在 `registrySources` 块中，你可以定义允许的注册源（`allowedRegistries`）或阻止的注册源（`blockedRegistries`），但不能同时定义两者。请查看以下示例：
- en: '[PRE13]'
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This concludes the main security aspects that we believe any company needs to
    think about. We encourage you to carefully review the topics we covered in this
    chapter and define/implement policies to keep all your clusters secure.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 这总结了我们认为每个公司需要考虑的主要安全方面。我们鼓励你仔细审查我们在本章中讨论的内容，并定义/实施政策以确保你所有的集群都安全。
- en: Summary
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: We have seen in this chapter some of the things you may consider to have secure
    OpenShift clusters. While OpenShift is considered a secure platform based on Kubernetes,
    how you manage it, of course, matters a lot. Consider establishing policies for
    access control, certificates, container and network isolation, development, and
    CI/CD pipelines.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在本章中已经看到了你可能考虑的一些使 OpenShift 集群安全的事项。虽然 OpenShift 被认为是基于 Kubernetes 的安全平台，但如何管理它当然至关重要。可以考虑为访问控制、证书、容器和网络隔离、开发及
    CI/CD 流水线制定相关策略。
- en: A secure platform starts with proper planning to define and implement efficient
    policies to control what is being developed and deployed into the platform, protect
    it against unnecessary risks, and—finally—isolate workloads and networks as much
    as possible to mitigate the impacts that a breach could have on the environment.
    In [*Chapter 11*](B18015_11.xhtml#_idTextAnchor229), *OpenShift Multi-Cluster
    GitOps and Management*, you will see how to use Advanced Cluster Management to
    apply policies at scale to several clusters and make sure that all of them are
    compliant and safe, no matter where they are running.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 一个安全的平台始于适当的规划，以定义并实施高效的策略来控制平台中开发和部署的内容，保护其免受不必要的风险，并最终尽可能地隔离工作负载和网络，以减轻安全漏洞对环境造成的影响。在[*第
    11 章*](B18015_11.xhtml#_idTextAnchor229)，*OpenShift 多集群 GitOps 和管理*，你将看到如何使用高级集群管理（ACM）对多个集群应用策略，并确保它们无论在哪个环境中运行，都符合安全要求。
- en: In the next chapter, we will explore how to work with Kubernetes native pipelines
    on OpenShift using the Tekton project, which you can use to not only have a cloud-native
    CI/CD process to build and deploy your application but also add an extra layer
    of security in your application supply chain.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将探索如何在 OpenShift 上使用 Tekton 项目与 Kubernetes 原生流水线进行协作，Tekton 项目不仅可以为你提供云原生
    CI/CD 流程来构建和部署应用程序，还可以为你的应用程序供应链增加一层额外的安全防护。
- en: Further reading
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'If you want more information related to the concepts we covered in this chapter,
    check out the following references:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想要更多与本章内容相关的信息，可以参考以下资源：
- en: '*Is the Cloud Secure?*—*Gartner* study: [https://www.gartner.com/smarterwithgartner/is-the-cloud-secure](https://www.gartner.com/smarterwithgartner/is-the-cloud-secure)'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*云安全吗？*—*Gartner*研究：[https://www.gartner.com/smarterwithgartner/is-the-cloud-secure](https://www.gartner.com/smarterwithgartner/is-the-cloud-secure)'
- en: '*Kubernetes vulnerabilities and attacks reported*:'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Kubernetes 漏洞和报告的攻击*：'
- en: '[https://thenewstack.io/unfixable-kubernetes-security-hole-means-potential-man-in-the-middle-attacks/](https://thenewstack.io/unfixable-kubernetes-security-hole-means-potential-man-in-the-middle-attacks/)'
  id: totrans-147
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://thenewstack.io/unfixable-kubernetes-security-hole-means-potential-man-in-the-middle-attacks/](https://thenewstack.io/unfixable-kubernetes-security-hole-means-potential-man-in-the-middle-attacks/)'
- en: '[https://threatpost.com/kubernetes-cyberattacks-argo-workflows/167997/](https://threatpost.com/kubernetes-cyberattacks-argo-workflows/167997/)'
  id: totrans-148
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://threatpost.com/kubernetes-cyberattacks-argo-workflows/167997/](https://threatpost.com/kubernetes-cyberattacks-argo-workflows/167997/)'
- en: '*Most Common Kubernetes Security Issues and Concerns to Address* (blog post):
    [https://cloud.redhat.com/blog/most-common-kubernetes-security-issues-and-concerns-to-address](https://cloud.redhat.com/blog/most-common-kubernetes-security-issues-and-concerns-to-address)'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*最常见的 Kubernetes 安全问题和关注点*（博客文章）：[https://cloud.redhat.com/blog/most-common-kubernetes-security-issues-and-concerns-to-address](https://cloud.redhat.com/blog/most-common-kubernetes-security-issues-and-concerns-to-address)'
- en: '*Container Security* report: [https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1](https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1)'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*容器安全*报告：[https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1](https://www.kuppingercole.com/reprints/b1e948f62d5394353f996e43a89cde4a#heading8.1)'
- en: '*State of Kubernetes security report*: [https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview](https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview)'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Kubernetes 安全状态报告*：[https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview](https://www.redhat.com/en/resources/kubernetes-adoption-security-market-trends-overview)'
- en: '*OpenShift authentication guide*: [https://docs.openshift.com/container-platform/latest/authentication/index.html](https://docs.openshift.com/container-platform/latest/authentication/index.html)'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*OpenShift 身份验证指南*：[https://docs.openshift.com/container-platform/latest/authentication/index.html](https://docs.openshift.com/container-platform/latest/authentication/index.html)'
- en: '*Troubleshooting OpenShift authentication*:[https://access.redhat.com/articles/5900841](https://access.redhat.com/articles/5900841)'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*故障排除 OpenShift 身份验证*：[https://access.redhat.com/articles/5900841](https://access.redhat.com/articles/5900841)'
- en: '*Defining default network policies*: [https://docs.openshift.com/container-platform/4.10/networking/network_policy/default-network-policy.html](https://docs.openshift.com/container-platform/4.10/networking/network_policy/default-network-policy.html)'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*定义默认网络策略*：[https://docs.openshift.com/container-platform/4.10/networking/network_policy/default-network-policy.html](https://docs.openshift.com/container-platform/4.10/networking/network_policy/default-network-policy.html)'
- en: '*Red Hat Universal Base Images*: [https://developers.redhat.com/products/rhel/ubi](https://developers.redhat.com/products/rhel/ubi)'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Red Hat 通用基础镜像*：[https://developers.redhat.com/products/rhel/ubi](https://developers.redhat.com/products/rhel/ubi)'
- en: '*Container Health Index grades*: [https://access.redhat.com/articles/2803031](https://access.redhat.com/articles/2803031
    )'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*容器健康指数等级*：[https://access.redhat.com/articles/2803031](https://access.redhat.com/articles/2803031)'
- en: '*Detailed information about* `htpasswd` (Apache project): [https://httpd.apache.org/docs/2.4/programs/htpasswd.html](https://httpd.apache.org/docs/2.4/programs/htpasswd.html)'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*关于* `htpasswd`（Apache 项目）的详细信息：[https://httpd.apache.org/docs/2.4/programs/htpasswd.html](https://httpd.apache.org/docs/2.4/programs/htpasswd.html)'
- en: '*OpenID Connect*:[https://developers.google.com/identity/protocols/oauth2/openid-connect](https://developers.google.com/identity/protocols/oauth2/openid-connect)'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*OpenID Connect*：[https://developers.google.com/identity/protocols/oauth2/openid-connect](https://developers.google.com/identity/protocols/oauth2/openid-connect)'
- en: '*Container isolation*: [https://www.nginx.com/blog/what-are-namespaces-cgroups-how-do-they-work/](https://www.nginx.com/blog/what-are-namespaces-cgroups-how-do-they-work/)'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*容器隔离*：[https://www.nginx.com/blog/what-are-namespaces-cgroups-how-do-they-work/](https://www.nginx.com/blog/what-are-namespaces-cgroups-how-do-they-work/)'
- en: Part 3 – Multi-Cluster CI/CD on OpenShift Using GitOps
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第三部分 – 使用 GitOps 在 OpenShift 上实现多集群 CI/CD
- en: In this part, you will be introduced to new concepts and technologies related
    to CI/CD and GitOps. You will learn how to build CI/CD pipelines that are resilient
    to your enterprise strategy and designed to easily be maintained using Tekton
    and ArgoCD. You will also see how to deploy an application into multiple clusters
    at the same time as using Argo CD and Advanced Cluster Management.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，你将了解与 CI/CD 和 GitOps 相关的新概念和技术。你将学习如何构建与企业战略相匹配的 CI/CD 管道，并且这些管道设计为易于维护，使用
    Tekton 和 ArgoCD。你还将看到如何同时使用 Argo CD 和高级集群管理（ACM）将应用部署到多个集群中。
- en: 'This part of the book comprises the following chapters:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 本书的这一部分包括以下章节：
- en: '[*Chapter 9*](B18015_09.xhtml#_idTextAnchor176), *OpenShift Pipelines – Tekton*'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第9章*](B18015_09.xhtml#_idTextAnchor176)，*OpenShift Pipelines – Tekton*'
- en: '[*Chapter 10*](B18015_10.xhtml#_idTextAnchor204), *OpenShift GitOps – Argo
    CD*'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第10章*](B18015_10.xhtml#_idTextAnchor204)，*OpenShift GitOps – Argo CD*'
- en: '[*Chapter 11*](B18015_11.xhtml#_idTextAnchor229), *OpenShift Multi-Cluster
    GitOps and Management*'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[*第11章*](B18015_11.xhtml#_idTextAnchor229)，*OpenShift 多集群 GitOps 与管理*'
