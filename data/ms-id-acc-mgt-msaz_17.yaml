- en: Understanding Encryption Key Management Strategies
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 理解加密密钥管理策略
- en: 'In this chapter, you''ll learn to use the three different key deployment models
    to address different compliance requirements and understand what role the Azure
    Key Vault service plays in this. We''ll discuss the three Azure Rights Management
    Services flows for a better understanding of how keys are used in the complete
    **Azure Information Protection** (**AIP**) solution to address the correct implementation
    and to help you troubleshooting the solution. This chapter will be divided into
    the following sections:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将学习使用三种不同的密钥部署模型来满足不同的合规性要求，并了解 Azure 密钥保管库服务在其中扮演的角色。我们将讨论三种 Azure 权利管理服务流程，以便更好地理解密钥在完整的
    **Azure 信息保护** (**AIP**) 解决方案中如何使用，从而确保正确实施，并帮助您排查解决方案中的问题。本章将分为以下几个部分：
- en: 'Azure Information Protection key basics:'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 信息保护密钥基础知识：
- en: Key deployment models
  id: totrans-3
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥部署模型
- en: What is a **hardware security module** (**HSM**)?
  id: totrans-4
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是 **硬件安全模块** (**HSM**)？
- en: What is the Azure Key Vault?
  id: totrans-5
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是 Azure 密钥保管库？
- en: 'How Azure RMS works under the hood:'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure RMS 的工作原理：
- en: Algorithms and key lengths
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 算法和密钥长度
- en: User environment-initialization flow
  id: totrans-8
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户环境初始化流程
- en: Content protection flow
  id: totrans-9
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内容保护流程
- en: Content consumption flow
  id: totrans-10
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内容消费流程
- en: Let's start with the AIP key basics!
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从 AIP 密钥基础知识开始！
- en: Azure Information Protection key basics
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 信息保护 密钥基础知识
- en: The Azure **Rights Management Service** (**RMS**) is part of the AIP solution
    of Microsoft. The Rights Management web service provides protection functionality,
    including administration, account certification, and licensing. Certification
    refers to the account certification and activation activities performed by Azure
    RMS. Each user must acquire a set of certificates and associated keys to be able
    to participate. Licensing refers to the set of operations by which Azure RMS grants
    access to protected content to authorized users. The Azure RMS service grants
    a use license (usage rights) for each document to authorized users.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Azure **权利管理服务** (**RMS**) 是微软 AIP 解决方案的一部分。权利管理网页服务提供保护功能，包括管理、账户认证和许可。认证是指由
    Azure RMS 执行的账户认证和激活活动。每个用户必须获取一组证书和相关密钥才能参与。许可是指 Azure RMS 通过一系列操作，授予授权用户访问受保护内容的权限。Azure
    RMS 服务为每个文档授予使用许可证（使用权限）给授权用户。
- en: The Azure RMS service exposes **Simple Object Access Protocol** (**SOAP**) interfaces
    that are used by clients to interact with Azure RMS
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS 服务公开了 **简单对象访问协议** (**SOAP**) 接口，供客户端与 Azure RMS 交互。
- en: The Azure Rights Management web service also uses rights management templates,
    which specify a predefined set of rights and conditions that can be applied to
    protect content. In AIP, the rights-management templates are associated with labels.
    To support other classification solutions, rights-management templates can also
    be configured without the association of a label. We already dived into these
    topics in [Chapter 13](bf7343f1-51f5-4e33-a9a6-e6e682e58071.xhtml), *Identifying
    and Detecting Sensitive Data*.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 权利管理网页服务还使用权利管理模板，这些模板指定了一组预定义的权限和条件，可以应用于保护内容。在 AIP 中，权利管理模板与标签相关联。为了支持其他分类解决方案，权利管理模板也可以在没有标签关联的情况下进行配置。我们已经在[第13章](bf7343f1-51f5-4e33-a9a6-e6e682e58071.xhtml)，*识别和检测敏感数据*中深入探讨了这些主题。
- en: The web service provides by default the needed high availability with a **Service
    Level Agreement** (**SLA**) of 99.9% uptime.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 该网页服务默认提供所需的高可用性，并具有 **服务水平协议** (**SLA**) 99.9% 的正常运行时间。
- en: Azure RMS is an Azure service that provides information protection by using
    encryption to help secure documents, files, emails, and other content.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS 是一个 Azure 服务，通过加密提供信息保护，帮助保护文档、文件、电子邮件和其他内容。
- en: By default, AIP and the rights-management part generate the tenant key and manage
    most aspects of the tenant key life cycle. This is the simplest option with the
    lowest administrative overhead. In most cases, organizations with no additional
    or special security requirements will use this deployment model. They just sign
    up for AIP and the key-management process is handled by Microsoft.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，AIP 和权利管理部分会生成租户密钥并管理租户密钥生命周期的大部分方面。这是最简单的选项，具有最低的管理开销。在大多数情况下，没有额外或特殊安全需求的组织会使用此部署模型。他们只需注册
    AIP，密钥管理过程由微软处理。
- en: Alternatively, organizations might want to have complete control over their
    tenant key due to security or compliance requirements. For this reason, Microsoft
    provides a separate deployment model called **bring your own key** (**BYOK**).
    Typical customers are based in the insurance or health sector. In this deployment
    model, customers can create hardware- or software-based keys. Hardware-based keys
    will be created on an HSM, which is the recommended option, and will be securely
    transferred to and stored in Azure Key Vault. AIP will be configured to use customer
    keys. Many large organizations already have the hardware, software, and processes
    in place to manage their key material—this is typical on HSM. Most of them prefer
    to extend the HSM infrastructure to the cloud.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，出于安全性或合规要求，组织可能希望完全控制其租户密钥。为此，微软提供了一个名为**自带密钥**（**BYOK**）的单独部署模型。典型客户通常来自保险或医疗行业。在此部署模型中，客户可以创建硬件或软件密钥。基于硬件的密钥将创建在HSM（硬件安全模块）上，这是推荐的选项，并将安全地传输并存储在Azure密钥库中。AIP将配置为使用客户密钥。许多大型组织已经有了管理密钥材料的硬件、软件和流程——这通常发生在HSM上。大多数组织更倾向于将HSM基础设施扩展到云端。
- en: The third deployment model is called **hold your own key** (**HYOK**). This
    model requires an isolated on-premise **Active Directory Rights Management Service**
    (**AD RMS**) instance to be installed on a Windows Server. The AD RMS instance
    will work with a different private key to protect secret data. Protection using
    this AD RMS instance is based on labels. AD RMS, by default, doesn't provide any
    labeling capabilities.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 第三种部署模型被称为**自持密钥**（**HYOK**）。此模型需要在Windows Server上安装一个孤立的本地**活动目录权限管理服务**（**AD
    RMS**）实例。AD RMS实例将使用不同的私钥来保护敏感数据。基于此AD RMS实例的保护是基于标签的。默认情况下，AD RMS不提供任何标签功能。
- en: 'Choosing between the different models is driven by your organization''s compliance
    requirements, which are as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在不同模型之间的选择取决于贵组织的合规要求，具体如下：
- en: Contracts with your customers with a specific requirement for cryptography and
    audit
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与您的客户签订的具有特定加密和审计要求的合同
- en: Industry, corporate, and regulation requirements
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行业、企业和监管要求
- en: Data-sovereignty laws, which bring place regulations and key placement
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据主权法律，涉及规定和密钥位置
- en: Data classification, which defines what sensitive data can't be stored in the
    cloud
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据分类，定义了哪些敏感数据不能存储在云中
- en: 'The following diagram shows the three deployment models:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了三种部署模型：
- en: '![](img/54409845-b171-443d-a501-b43f301227e5.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/54409845-b171-443d-a501-b43f301227e5.png)'
- en: Azure RMS deployment models
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS部署模型
- en: 'Within the following licenses, you can use the three deployment models:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下许可证中，您可以使用三种部署模型：
- en: '| **Scenario** | **Office 365 E3 or higher** | **AIP P1 or EMS E3/M365 E3**
    | **AIP P2 or EMS E5/M365 E3** |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| **场景** | **Office 365 E3 或更高版本** | **AIP P1 或 EMS E3/M365 E3** | **AIP P2
    或 EMS E5/M365 E3** |'
- en: '| Microsoft-managed | X | X | X |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
  zh: '| 微软管理 | X | X | X |'
- en: '| BYOK | X | X | X |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
  zh: '| BYOK | X | X | X |'
- en: '| HYOK |  |  | X |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
  zh: '| HYOK |  |  | X |'
- en: There is also an option to use service encryption with a customer key in Office
    365 to provide and control the encryption keys for your at-rest Office 365 data
    at the application level.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 也可以选择在Office 365中使用服务加密与客户密钥，提供并控制应用层上存储在Office 365中的加密密钥。
- en: 'The following tenant key actions are available:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 以下租户密钥操作可用：
- en: '| **Action** | **Microsoft-managed** | **Customer-managed** |'
  id: totrans-36
  prefs: []
  type: TYPE_TB
  zh: '| **操作** | **微软管理** | **客户管理** |'
- en: '| Revoke |  | X |'
  id: totrans-37
  prefs: []
  type: TYPE_TB
  zh: '| 撤销 |  | X |'
- en: '| Rekey | X | X |'
  id: totrans-38
  prefs: []
  type: TYPE_TB
  zh: '| Rekey | X | X |'
- en: '| Back up and recover |  | X |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| 备份与恢复 |  | X |'
- en: '| Export | X |  |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| 导出 | X |  |'
- en: '| Breach response | X | X |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| 违约响应 | X | X |'
- en: To find out more about service encryption with Customer Key for Office 365,
    visit [https://bit.ly/2SxCJW5](https://bit.ly/2SxCJW5).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 若要了解有关使用客户密钥进行Office 365服务加密的更多信息，请访问[https://bit.ly/2SxCJW5](https://bit.ly/2SxCJW5)。
- en: 'Also shown in the preceding diagram are the three keys that matter in the main
    protection flow:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 上述图表中还显示了在主要保护流程中重要的三个密钥：
- en: '**Red**: The tenant private key (asymmetric), which is used for the decryption
    of the publishing license'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**红色**：租户私钥（非对称），用于解密发布许可证'
- en: '**Orange**: The tenant public key (asymmetric), which is used for the encryption
    of the publishing license'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**橙色**：租户公钥（非对称），用于发布许可证的加密'
- en: '**Green**: The document-specific key (symmetric), which is used for encryption/decryption
    of the content'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**绿色**：文档特定密钥（对称），用于加密/解密内容'
- en: 'To understand this better, check out the main functionality of the **Rights
    Management Services** in the following diagram:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 要更好地理解这一点，请查看以下图示中的**权限管理服务**的主要功能：
- en: '![](img/2d0e9279-5e7b-4e06-b1fb-c6f64f11f34d.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2d0e9279-5e7b-4e06-b1fb-c6f64f11f34d.png)'
- en: Azure RMS basic functionality
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS基本功能。
- en: 'The process starts with protecting information and ends with consuming it with
    the applied permissions from the data owner or the classification level:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程从保护信息开始，最终通过数据所有者或分类级别应用的权限进行使用：
- en: The document will be created, labeled, and protected with RMS—for this, we need
    to be authenticated against the rights-management service
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文档将被创建、标记并使用RMS保护—为此，我们需要通过身份验证与权限管理服务进行认证。
- en: The label-associated rights and the key material will be requested transparently
    from the user
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 与标签相关的权限和关键材料将透明地从用户那里请求。
- en: The key material will be received transparently by the user
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关键材料将由用户透明地接收。
- en: The document will be protected with the chosen rights
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文档将使用所选权限进行保护。
- en: The document will be distributed to the required recipients
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文档将分发给需要的接收者。
- en: The document will be received from the recipient, so the recipient needs to
    be authenticated against the Rights Management Service by Single-Sign-On or Single Login
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文档将由接收者接收，因此接收者需要通过单一登录（SSO）或单一登录方式认证身份，以访问权限管理服务。
- en: The key material and the usage rights will be requested transparent to the recipient
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关键材料和使用权将对接收者透明地请求。
- en: The key material will be received, and the recipient can access the information
    with the appropriated rights, otherwise the user will get an access denied message
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 关键材料将被接收，接收者可以在适当的权限下访问信息，否则用户将收到访问拒绝消息。
- en: Be sure to plan your key deployment carefully.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 确保仔细规划你的密钥部署。
- en: Next, we will discuss the Microsoft-managed key-deployment model.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将讨论微软托管密钥部署模型。
- en: Microsoft-managed keys
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 微软托管的密钥。
- en: 'If AIP gets activated, a new tenant key be generated, stored, and managed by
    the Azure Information Protection services. In this default case, the key type
    is referred to as a Microsoft-managed key. The following diagram shows the deployment
    model:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果激活AIP，将生成一个新的租户密钥，并由Azure信息保护服务存储和管理。在这种默认情况下，密钥类型被称为微软托管密钥。以下图示展示了该部署模型：
- en: '![](img/9961f090-c6f5-4336-8200-20143c5d59d1.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9961f090-c6f5-4336-8200-20143c5d59d1.png)'
- en: Microsoft Services key model
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 微软服务密钥模型。
- en: 'You should use this deployment model if Microsoft''s security and controls
    are adequate for your organization. This model is available by default and doesn''t
    need any additional subscription or configuration. There are also no special plans
    needed for capacity, performance, or scale. For most organizations, this is the
    best option. The deployment model has the following features:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 如果微软的安全性和控制措施足够满足你的组织需求，你应该使用这种部署模型。该模型默认可用，不需要额外的订阅或配置。对于容量、性能或规模，也无需特别的计划。对大多数组织来说，这是最佳选择。该部署模型具有以下特点：
- en: Completely-managed tenant private key
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 完全托管的租户私钥。
- en: Tenant private key is encrypted at rest and handled as customer data
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 租户私钥在静态状态下加密并作为客户数据处理。
- en: Default key length is 2,048 bit RSA
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 默认的密钥长度是2,048位RSA。
- en: 'Now, we will verify the `Microsoft-managed` key that''s used by our tenant
    with the following cmdlets:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们将使用以下命令验证我们租户使用的`Microsoft-managed`密钥：
- en: '[PRE0]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The following screenshot shows the expected result of a freshly-activated tenant:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了一个新激活租户的预期结果：
- en: '![](img/7c255bd4-0a0b-4840-806b-faf635afe55a.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7c255bd4-0a0b-4840-806b-faf635afe55a.png)'
- en: Actual RMS key information
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 实际的RMS密钥信息。
- en: 'Another important factor is where your Azure RMS service is provisioned for
    choosing an Azure Key Vault location in a BYOK-deployment for latency reasons.
    We can gather this information with the following cmdlet:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个重要因素是你部署的Azure RMS服务所在的位置，这有助于选择在BYOK部署中的Azure密钥库位置，以减少延迟。我们可以通过以下命令收集此信息：
- en: '[PRE1]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'In our case, the Azure RMS tenant is provisioned in Europe, which we can see
    in the following screenshot:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的案例中，Azure RMS租户部署在欧洲，我们可以从以下截图中看到：
- en: '![](img/8bf78a30-8b1a-4bb1-8038-a42184208f5d.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8bf78a30-8b1a-4bb1-8038-a42184208f5d.png)'
- en: Azure RMS actual configuration overview
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS实际配置概述。
- en: Next, we will take a deeper look into the BYOK deployment model.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将深入了解BYOK部署模型。
- en: Bring your own key
  id: totrans-80
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自带密钥（BYOK）。
- en: If you use Azure Key Vault to store key, which indicates that you use the BYOK deployment,
    you can import keys from your on-premises HSM or generate keys inside the **Azure
    Key Vault** that are stored in an HSM. Keys never leave the HSM boundaries.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 Azure 密钥保管库存储密钥，表示你使用的是 BYOK 部署，你可以从本地 HSM 导入密钥或在**Azure 密钥保管库**内生成密钥，并将其存储在
    HSM 中。密钥永远不会离开 HSM 的边界。
- en: At the time of writing, Microsoft provides a public preview using dedicated
    HSMs. You can find more information at [https://bit.ly/2KFnJT7](https://bit.ly/2KFnJT7).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写时，Microsoft 提供了使用专用 HSM 的公共预览版。你可以在 [https://bit.ly/2KFnJT7](https://bit.ly/2KFnJT7)
    找到更多信息。
- en: 'You should use the **BYOK** deployment model if you need to fulfill additional
    compliance requirements, such as data residency or specific cryptographic regulations.
    The following diagram shows the architecture of the deployment:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要满足额外的合规性要求，如数据驻留或特定的加密法规，应使用 **BYOK** 部署模型。下图展示了该部署的架构：
- en: '![](img/419b751c-c4fb-4b44-8bf6-3e96cb205085.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](img/419b751c-c4fb-4b44-8bf6-3e96cb205085.png)'
- en: Bring your own key model
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 自带密钥模型
- en: 'The following key facts are related to BYOK:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是与 BYOK 相关的关键事实：
- en: Azure Information Protection doesn't have visibility over the private key; there
    is a clear separation of duties with the usage of **Azure Key Vault**
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 信息保护无法查看私钥；通过使用**Azure 密钥保管库**，职责得到了明确分离。
- en: Cryptographic operations are done completely within Azure Key Vault
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密操作完全在 Azure 密钥保管库内完成
- en: The tenant private key is stored in Azure Key Vault
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 租户私钥存储在 Azure 密钥保管库中
- en: With the configuration part, we'll take a closer look at HSMs and the Azure
    Key Vault. We'll configure our Azure-Key-Vault-based key and change to the BYOK
    deployment.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置部分，我们将更深入地了解 HSM 和 Azure 密钥保管库。我们将配置基于 Azure 密钥保管库的密钥，并切换到 BYOK 部署。
- en: What is an HSM?
  id: totrans-91
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是 HSM？
- en: 'HSMs are physical devices that provide a hardened, tamper-resistant environment
    to manage and securely store digital keys used in Azure RMS and other applications.
    HSMs provide organizations with the ability to securely manage their private keys
    on-premises. The following diagram, provided by Thales, shows the BYOK-integration
    scenario:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: HSM 是提供加固、抗篡改环境的物理设备，用于管理和安全存储在 Azure RMS 及其他应用程序中使用的数字密钥。HSM 使组织能够在本地安全地管理其私钥。以下由
    Thales 提供的图示展示了 BYOK 集成场景：
- en: '![](img/278c4371-22ea-47e9-8051-aebd1fe62542.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/278c4371-22ea-47e9-8051-aebd1fe62542.png)'
- en: Thales HSM integration
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: Thales HSM 集成
- en: 'The following table provides a summary of the benefits of implementing a **Thales** HSM
    in the Azure RMS deployment:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格总结了在 Azure RMS 部署中实现**Thales** HSM 的好处：
- en: '| **Secure key storage** | HSMs provide a tamper-resistant environment for
    the storage of private keys. All Thales HSMs are certified to meet the highest
    security standards. |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
  zh: '| **安全密钥存储** | HSM 提供了一个抗篡改的环境，用于存储私钥。所有 Thales HSM 都已获得认证，符合最高的安全标准。 |'
- en: '| **Compliance** | HSMs are FIPS 140-2 Level 3 Standard, which is the most
    widely accepted benchmark for hardware security in both enterprise and government
    environments. |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
  zh: '| **合规性** | HSM 符合 FIPS 140-2 Level 3 标准，这是企业和政府环境中广泛接受的硬件安全基准。 |'
- en: '| **Extensibility** | Using a Thales HSM for key storage allows the Azure RMS
    environment to be extensible to on-premises for future migrations. |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
  zh: '| **可扩展性** | 使用 Thales HSM 存储密钥可以使 Azure RMS 环境具有可扩展性，支持未来向本地迁移。 |'
- en: You can also use Gemalto HSMs for this scenario. You can find an example at [https://bit.ly/2GW3t1d](https://bit.ly/2GW3t1d).
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以使用 Gemalto HSM 进行此场景。你可以在 [https://bit.ly/2GW3t1d](https://bit.ly/2GW3t1d)
    找到一个示例。
- en: What is the Azure Key Vault?
  id: totrans-100
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是 Azure 密钥保管库？
- en: 'Azure Key Vault can be best described as a Key Management Service that is based
    on FIPS 140-2 validated HSMs, which also provides secrets and certificate-management
    services. Azure Key Vault is used for Azure RMS BYOK deployments. The service
    itself provides the following capabilities:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 密钥保管库可以最好地描述为基于 FIPS 140-2 验证的 HSM 的密钥管理服务，它还提供秘密和证书管理服务。Azure 密钥保管库用于
    Azure RMS 的 BYOK 部署。该服务本身提供以下功能：
- en: Centralized secret management
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集中化的秘密管理
- en: Compliance through Software/Hardware HSM protection
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过软件/硬件 HSM 保护实现合规性
- en: Read/Write management over REST API/SDK/PowerShell and CLI
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 REST API/SDK/PowerShell 和 CLI 进行读/写管理
- en: Access and usage monitoring
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问和使用监控
- en: Automated distribution, logging inspection, and deployments
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动化分发、日志检查和部署
- en: Throttling and Versioning
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 节流与版本控制
- en: SLA 99.9% and 6 persistent copies (3 copies same region/3 additional copies
    secondary region)
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SLA 99.9%和6个持久副本（3个副本在同一区域/3个副本在其他区域）
- en: For Azure RMS and BYOK, you need to use the P1 Premium option to import your
    keys from on-premises or create keys directly in Azure Key Vault. The term BYOK
    is used both times. For production environments, we recommend using an on-premises
    HSM, and you can work through the following source to configure your environment: [https://bit.ly/2wma4Yl](https://bit.ly/2wma4Yl).
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 对于Azure RMS和BYOK，您需要使用P1 Premium选项从本地导入密钥或直接在Azure Key Vault中创建密钥。此术语BYOK在两种情况下都使用。对于生产环境，我们建议使用本地HSM，您可以通过以下资源配置您的环境：[https://bit.ly/2wma4Yl](https://bit.ly/2wma4Yl)。
- en: For demonstration purposes, we are using keys that were generated in Azure Key
    Vault, because we don't think you want to invest many thousands of dollars into
    your personal HSM.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 出于演示目的，我们使用在Azure Key Vault中生成的密钥，因为我们认为您不想为您的个人HSM投入成千上万的美元。
- en: 'Perform the following steps to test the BYOK deployment in your demo environment:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 执行以下步骤以测试您的演示环境中的BYOK部署：
- en: 'Open [https://portal.azure.com](https://portal.azure.com) as a global administrator,
    choose Key Vaults, and click Create key vault:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为全局管理员打开[https://portal.azure.com](https://portal.azure.com)，选择Key Vaults，点击“创建密钥保险库”：
- en: '![](img/da90872a-1a67-4eea-ac16-170218a972e0.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/da90872a-1a67-4eea-ac16-170218a972e0.png)'
- en: Key Vault creation
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 创建Key Vault
- en: 'Fill in the following information:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写以下信息：
- en: Use the Premium Pricing Tier
  id: totrans-116
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用高级定价层
- en: Use the Location near your service to avoid network-latency issues
  id: totrans-117
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用靠近您服务的区域，以避免网络延迟问题
- en: 'Leave the access policy and the Virtual Network Access defaults for now:'
  id: totrans-118
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目前暂时保留访问策略和虚拟网络访问的默认设置：
- en: '![](img/c352eb16-6bed-43e7-8377-4074ea134e21.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c352eb16-6bed-43e7-8377-4074ea134e21.png)'
- en: Key Vault properties
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: Key Vault属性
- en: 'Generate the key using the Generate/Import option:'
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用“生成/导入”选项生成密钥：
- en: '![](img/c0963dae-1e9e-4b6e-bb17-e10aa3655aee.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c0963dae-1e9e-4b6e-bb17-e10aa3655aee.png)'
- en: Key creation process
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 密钥创建过程
- en: 'Use the following options:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用以下选项：
- en: Key Type RSA-HSM with a key size of 2048 bit
  id: totrans-125
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥类型：RSA-HSM，密钥大小为2048位
- en: 'Copy the Key Identifier to a notepad for later:'
  id: totrans-126
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将密钥标识符复制到记事本中以备后用：
- en: '![](img/684f2f09-db3c-44a7-a284-b47eb8d2b0e1.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![](img/684f2f09-db3c-44a7-a284-b47eb8d2b0e1.png)'
- en: Key properties
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 密钥属性
- en: 'Add the Microsoft Rights Management Services principal to your access policy:'
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将Microsoft Rights Management Services主体添加到您的访问策略中：
- en: '![](img/4db5ecbe-4627-429e-9f87-db3c50828dba.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4db5ecbe-4627-429e-9f87-db3c50828dba.png)'
- en: Service Principal assignment
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 服务主体分配
- en: 'Assign the following minimal permissions:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 分配以下最小权限：
- en: 'Key Management Operations: Get and List'
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥管理操作：获取和列出
- en: 'Cryptographic Operations: Decrypt and Sign:'
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密操作：解密和签名：
- en: '![](img/e20b30bf-7940-4c3a-b531-9b3171c1b539.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e20b30bf-7940-4c3a-b531-9b3171c1b539.png)'
- en: Permission assignment
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 权限分配
- en: 'Optionally, you can limit the access to your vault by using a new feature set—a
    firewall in front:'
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可选地，您可以通过使用一个新功能集（即前置的防火墙）来限制对您的保险库的访问：
- en: '![](img/f10df736-5afd-4ec9-8f55-f184db6ade95.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f10df736-5afd-4ec9-8f55-f184db6ade95.png)'
- en: Key Vault firewall options
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: Key Vault防火墙选项
- en: 'Configure the `Azure RMS` service to use our freshly-created key:'
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置`Azure RMS`服务以使用我们新创建的密钥：
- en: '[PRE2]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The output of the preceding command will look as follows:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令输出将如下所示：
- en: '![](img/76d1a0b0-b8bf-4aaf-a2b6-5b43cc1b0c7b.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/76d1a0b0-b8bf-4aaf-a2b6-5b43cc1b0c7b.png)'
- en: Change key usage to the newly created one
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 将密钥使用更改为新创建的密钥
- en: 'Set the key to the `Active` state:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 将密钥设置为`Active`状态：
- en: '[PRE3]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The output of the preceding command will look as follows:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令输出将如下所示：
- en: '![](img/d6cc9724-e938-4e0e-b719-9df5abd1b922.png)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d6cc9724-e938-4e0e-b719-9df5abd1b922.png)'
- en: Activating the key
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 激活密钥
- en: 'Your Azure Key Vault stored key is in use:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的Azure Key Vault存储密钥正在使用中：
- en: '![](img/d26a3710-65c4-4f57-b045-a2a3a21a25ba.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d26a3710-65c4-4f57-b045-a2a3a21a25ba.png)'
- en: Actual used keys overview
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 实际使用的密钥概览
- en: 'You can change back to the `Microsoft-managed key` with the following command:'
  id: totrans-153
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以使用以下命令切换回`Microsoft-managed key`：
- en: '[PRE4]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Now that we know about HSMs, Azure Key Vault, and how to configure a BYOK deployment,
    we'll jump into the HYOK deployment model in the next section.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了HSM、Azure Key Vault以及如何配置BYOK部署，接下来我们将进入HYOK部署模型部分。
- en: Hold your own key
  id: totrans-156
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 持有自己的密钥
- en: HYOK uses an isolated on-premises AD RMS instance that provides the RMS templates
    based on the second different private key that's driven by an AIP label. This
    deployment model should be chosen for high security and compliance requirements.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: HYOK 使用一个隔离的本地 AD RMS 实例，基于由 AIP 标签驱动的第二个不同私钥提供 RMS 模板。此部署模型应选择用于高安全性和合规性要求。
- en: 'Most of the time, this us used for data that can''t be stored on a public cloud.
    This sensitive data needs to be stored and protected on-premises. Keep in mind
    that HYOK-protected data is typically between 3 to 5% of an organization''s protected
    data. The following diagram shows the deployment model:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数时候，这用于不能存储在公共云上的数据。这些敏感数据需要存储并保护在本地。请记住，HYOK 保护的数据通常占组织受保护数据的 3% 到 5%。以下图表显示了部署模型：
- en: '![](img/ff76c651-8232-49a3-b1a5-ff21edc231f4.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ff76c651-8232-49a3-b1a5-ff21edc231f4.png)'
- en: Hold your own key model
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 持有您自己的密钥模型
- en: 'The following limitations/benefits are available by design:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 以下限制/优势是按设计提供的：
- en: External sharing configuration isn't available through the Azure Information
    Protection service
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过 Azure 信息保护服务无法进行外部共享配置
- en: External sharing is only possible in a controlled manner with known and named
    partners
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 外部共享仅在受控方式下与已知且命名的合作伙伴进行
- en: Office 365 services cannot provide indexing or search capabilities; Exchange
    Online transport rules and Office 365 DLP can't decrypt the content and inspect
    it
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Office 365 服务无法提供索引或搜索功能；Exchange Online 传输规则和 Office 365 DLP 无法解密内容并检查它
- en: Sharing and the access logs aren't disclosed to anyone
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 共享和访问日志不会透露给任何人
- en: Data remains encrypted always, inaccessible even to Microsoft services
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据始终保持加密，甚至 Microsoft 服务也无法访问
- en: 'To use the on-premises AD RMS infrastructure in your AIP labels, you need to
    choose the HYOK (AD RMS) option in the protection options. You can choose between
    two options:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 要在 AIP 标签中使用本地 AD RMS 基础设施，您需要在保护选项中选择 HYOK（AD RMS）选项。您可以选择两个选项：
- en: Set AD RMS template details (template GUID and licensing URL)
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置 AD RMS 模板详情（模板 GUID 和授权 URL）
- en: Set user-defined permissions (Preview)
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 设置用户定义的权限（预览）
- en: 'The following screenshot shows the template-based approach:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图显示了基于模板的方法：
- en: '![](img/366df71f-23dc-4b35-8651-3d10ecda6d0f.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![](img/366df71f-23dc-4b35-8651-3d10ecda6d0f.png)'
- en: HYOK template configuration in a label
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在标签中配置 HYOK 模板
- en: To configure the HYOK deployment in your demo environment, we'll need to add
    an additional virtual machine to your existing domain to install and configure
    AD RMS.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在您的演示环境中配置 HYOK 部署，我们需要向现有域添加一个额外的虚拟机以安装和配置 AD RMS。
- en: 'Keep in mind that the following configuration is just for proof-of-concept
    or demo purposes:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，以下配置仅用于概念验证或演示目的：
- en: For production environments, we recommend that you use a SQL Server for AD RMS
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对于生产环境，我们建议使用 SQL Server 作为 AD RMS
- en: Use the identity federation option to support external sharing if needed
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果需要，使用身份联合选项来支持外部共享
- en: Use a dedicated administrative account
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用专用的管理员帐户
- en: Publish the service endpoints through a firewall or reverse proxy
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过防火墙或反向代理发布服务端点
- en: 'With the following steps, we start the configuration of a local AD RMS infrastructure:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤，我们开始配置本地 AD RMS 基础设施：
- en: 'Create a Windows Server 2016/2019 Server virtual machine like the following:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个 Windows Server 2016/2019 服务器虚拟机，如下所示：
- en: '![](img/4be0d6b5-c129-4bee-89b3-60acca7e23bf.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4be0d6b5-c129-4bee-89b3-60acca7e23bf.png)'
- en: VM creation to hold the AD RMS service
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 创建虚拟机以承载 AD RMS 服务
- en: Create a CNAME entry in your public DNS configuration—in our example, this is
    it's `rms.inovitdemos.ch CNAME inodemosrms01.westeurope.cloudapp.azure.com`.
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在您的公共 DNS 配置中创建一个 CNAME 条目——在我们的示例中，`rms.inovitdemos.ch CNAME inodemosrms01.westeurope.cloudapp.azure.com`。
- en: 'Open the virtual machine directly for HTTPS (PoC/Demo):'
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 直接打开虚拟机以进行 HTTPS（概念验证/演示）：
- en: '![](img/0eb7cb33-87a7-4a07-a596-8dba8c84036a.png)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0eb7cb33-87a7-4a07-a596-8dba8c84036a.png)'
- en: Firewall configuration to accept HTTPS traffic on the VM
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 防火墙配置以接受虚拟机上的 HTTPS 流量
- en: 'You need a public SSL certificate at least with the RMS cluster URL included:'
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您需要一个至少包含 RMS 集群 URL 的公共 SSL 证书：
- en: We use a wildcard certificate—`*.inovitdemos.ch`
  id: totrans-188
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们使用通配符证书—`*.inovitdemos.ch`
- en: Be sure that you join your virtual machine to your domain and install the certificate
    into the local machine store! For demo purposes, you can also run with an HTTP
    configuration.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 确保将您的虚拟机加入域并将证书安装到本地计算机存储！为了演示目的，您也可以使用 HTTP 配置运行。
- en: Prepare the Active Directory objects as a domain administrator on the domain
    controller for the configuration.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为域管理员，在域控制器上准备活动目录对象进行配置。
- en: 'Create the RMS cluster service account:'
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 RMS 集群服务帐户：
- en: '[PRE5]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Create the RMS superusers group and apply an email address to recover protected
    data:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 RMS 超级用户组并应用电子邮件地址以恢复受保护的数据：
- en: '[PRE6]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Create a test group such as `Executives`, for the RMS template and configure
    an email address—fill in the group with the users you want to test:'
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个测试组，例如 `Executives`，用于 RMS 模板，并配置一个电子邮件地址——将需要测试的用户添加到该组：
- en: '[PRE7]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Create an internal DNS entry for your RMS endpoints:'
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为 RMS 端点创建一个内部 DNS 条目：
- en: '[PRE8]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Log in as a domain administrator to the new server that's hosting the AD RMS
    server.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以域管理员身份登录到托管 AD RMS 服务器的新服务器。
- en: 'Open the server manager and add the Active Directory Rights Management Services:'
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开服务器管理器，添加活动目录 Rights Management 服务：
- en: 'Click Add Features:'
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 点击“添加功能”：
- en: '![](img/edc065c6-2efb-451c-85b6-6b674f69e576.png)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![](img/edc065c6-2efb-451c-85b6-6b674f69e576.png)'
- en: AD RMS role installation
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: AD RMS 角色安装
- en: 'Leave all the defaults as is and click Next:'
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保持所有默认设置不变，点击“下一步”：
- en: '![](img/d8021a23-bbd9-4812-a20e-13771e6ff174.png)'
  id: totrans-205
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d8021a23-bbd9-4812-a20e-13771e6ff174.png)'
- en: Role service installation
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 角色服务安装
- en: Configure AD RMS by clicking Next on the welcome screen.
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在欢迎屏幕上点击“下一步”配置 AD RMS。
- en: 'Create the RMS cluster ("cluster" is a specific term in AD RMS that indicates
    that you can have more than one RMS server—it doesn''t mean a Windows Server cluster):'
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建 RMS 集群（“集群”是 AD RMS 中的特定术语，表示你可以有多个 RMS 服务器——这并不意味着 Windows 服务器集群）：
- en: '![](img/ec0277ca-ba87-4457-99ae-75fe4eedcf05.png)'
  id: totrans-209
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ec0277ca-ba87-4457-99ae-75fe4eedcf05.png)'
- en: RMS cluster creation process
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: RMS 集群创建过程
- en: 'Choose the database deployment—for production environments, use a dedicated
    SQL server:'
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择数据库部署——对于生产环境，使用专用 SQL 服务器：
- en: '![](img/25547208-8dec-4746-90ad-981c0e887b96.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](img/25547208-8dec-4746-90ad-981c0e887b96.png)'
- en: Database configuration for the AD RMS cluster
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: AD RMS 集群的数据库配置
- en: 'Configure the service account we created previously, that is, `svcrmscluster@inovitdemos.ch`:'
  id: totrans-214
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置我们之前创建的服务帐户，即 `svcrmscluster@inovitdemos.ch`：
- en: '![](img/38bfb0f8-6cf7-4255-987f-b418bebcb330.png)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![](img/38bfb0f8-6cf7-4255-987f-b418bebcb330.png)'
- en: Service account usage for AD RMS
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: AD RMS 的服务帐户使用
- en: 'Configure the following options, as follows:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置以下选项，如下所示：
- en: 'Cryptographic Mode: Mode 2'
  id: totrans-218
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密模式：模式 2
- en: 'Cluster Key Storage: Use AD RMS'
  id: totrans-219
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集群密钥存储：使用 AD RMS
- en: 'Cluster Key Password: Choose your cluster key word like `455A#aasdd+!`'
  id: totrans-220
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集群密钥密码：选择你的集群密钥词，例如 `455A#aasdd+!`
- en: 'Cluster Web Site: Use the default website'
  id: totrans-221
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 集群网站：使用默认网站
- en: 'Configure the cluster address:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置集群地址：
- en: '![](img/06306972-cb8c-40e4-af96-f1286e2353e4.png)'
  id: totrans-223
  prefs: []
  type: TYPE_IMG
  zh: '![](img/06306972-cb8c-40e4-af96-f1286e2353e4.png)'
- en: AD RMS Cluster address configuration
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: AD RMS 集群地址配置
- en: If you don't want to use HTTPS, change to HTTP for PoC/Demo purposes.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想使用 HTTPS，可以改为 HTTP 用于 PoC/Demo 目的。
- en: Choose your certificate if you configured HTTPS in the previous step.
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果你在上一步配置了 HTTPS，选择你的证书。
- en: Give your Licensor Certificate a name. We recommend using the organization name,
    such as `INOVITDEMOS`.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 给你的许可证书命名。我们建议使用组织名称，例如 `INOVITDEMOS`。
- en: Don't register the SCP. If you're already on an existing infrastructure, you
    must change the option to not use an SCP.
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 不注册 SCP。如果你已经在现有的基础架构上，必须更改选项以不使用 SCP。
- en: 'We''ve almost finished the configuration of our AD RMS instance. We need to
    log out and log in again to complete the configuration:'
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们已经完成了 AD RMS 实例的配置。我们需要注销并重新登录以完成配置：
- en: '![](img/9d418f1a-406f-49d7-9d40-6172c2cb2fe9.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9d418f1a-406f-49d7-9d40-6172c2cb2fe9.png)'
- en: AD RMS Installation result overview
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: AD RMS 安装结果概览
- en: Configure the last options by opening the AD RMS management console.
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开 AD RMS 管理控制台配置最后的选项。
- en: 'Open Properties and configure the Extranet URLs, like the Intranet URLs:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开“属性”并像配置内部网络 URL 一样配置外部网络 URL：
- en: '![](img/764dc3ab-bf1d-4823-87c9-315f22d9bc5b.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](img/764dc3ab-bf1d-4823-87c9-315f22d9bc5b.png)'
- en: Configuring AD RMS Extranet URLs
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 AD RMS 外部网络 URL
- en: 'Configure the AD RMS Super User Group:'
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置 AD RMS 超级用户组：
- en: '![](img/56941b59-7fb1-4e6c-9bb6-e20d96e8348c.png)'
  id: totrans-237
  prefs: []
  type: TYPE_IMG
  zh: '![](img/56941b59-7fb1-4e6c-9bb6-e20d96e8348c.png)'
- en: Providing the AD RMS Super User group
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 提供 AD RMS 超级用户组
- en: 'Open the registry editor to set the GICURL REG_SZ entry—`http or https rms
    cluster name /_wmcs/certification/certification.asmx`:'
  id: totrans-239
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开注册表编辑器，设置 GICURL REG_SZ 项——`http 或 https rms 集群名称 /_wmcs/certification/certification.asmx`：
- en: '![](img/04f1ada6-a04a-42dd-82ab-42aba642e96b.png)'
  id: totrans-240
  prefs: []
  type: TYPE_IMG
  zh: '![](img/04f1ada6-a04a-42dd-82ab-42aba642e96b.png)'
- en: Setting the HYOK registry keys
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 设置 HYOK 注册表项
- en: 'Configure the RMS Template for HYOK:'
  id: totrans-242
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置 HYOK 的 RMS 模板：
- en: '![](img/3c698b72-f1af-4807-9494-11c9c9a1f0a9.png)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3c698b72-f1af-4807-9494-11c9c9a1f0a9.png)'
- en: HYOK RMS template settings
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: HYOK RMS 模板设置
- en: 'Define some example rights and the group you created previously to test its
    functionality:'
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 定义一些示例权限和你之前创建的组来测试其功能：
- en: '![](img/da75aade-9e73-4295-9e82-c2b7e47b5645.png)'
  id: totrans-246
  prefs: []
  type: TYPE_IMG
  zh: '![](img/da75aade-9e73-4295-9e82-c2b7e47b5645.png)'
- en: Assignment of the executive's group
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 执行人员组的分配
- en: Finish the configuration and open a PowerShell to gather the related information
    so that you can configure the Azure Information Protection label.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成配置后，打开 PowerShell 以收集相关信息，这样你就可以配置 Azure 信息保护标签。
- en: 'Run the following commands to get the RMS template GUID:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 运行以下命令以获取 RMS 模板 GUID：
- en: '[PRE9]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Log into [https://portal.azure.com](https://portal.azure.com) to configure
    a new sub-label to test the HYOK configuration—add a new sub-label under Highly
    Confidential:'
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 [https://portal.azure.com](https://portal.azure.com) 配置新的子标签以测试 HYOK 配置——在“高度机密”下添加一个新的子标签：
- en: '![](img/233bb822-fa4f-48ac-b258-304f2ff1602b.png)'
  id: totrans-252
  prefs: []
  type: TYPE_IMG
  zh: '![](img/233bb822-fa4f-48ac-b258-304f2ff1602b.png)'
- en: AIP Global Policy overview
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: AIP 全局策略概览
- en: 'Configure the label so:'
  id: totrans-254
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置标签如下：
- en: '![](img/788bb88f-b896-4c00-9a6d-25b5a606712d.png)'
  id: totrans-255
  prefs: []
  type: TYPE_IMG
  zh: '![](img/788bb88f-b896-4c00-9a6d-25b5a606712d.png)'
- en: Configuring the HYOK label
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 HYOK 标签
- en: 'Enable the new sub-label for the global policy, which the test users will be
    able to choose:'
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为全局策略启用新的子标签，测试用户将能够选择该标签：
- en: '![](img/cbad3039-14b8-48b6-808d-ffda148a6f71.png)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cbad3039-14b8-48b6-808d-ffda148a6f71.png)'
- en: Adding the label to the global policy
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 将标签添加到全局策略
- en: Open one of the Azure-Information-Protection-enabled internal domain-joined
    test clients from [Chapter 13](bf7343f1-51f5-4e33-a9a6-e6e682e58071.xhtml), *Identifying
    and Detecting Sensitive Data*.
  id: totrans-260
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 [第13章](bf7343f1-51f5-4e33-a9a6-e6e682e58071.xhtml) *识别和检测敏感数据* 中打开一台启用了 Azure
    信息保护的内部域加入测试客户端。
- en: 'Create a new document and choose the HYOK label. Save the document and you
    should get the following message the first time you use the new label:'
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建一个新文档并选择 HYOK 标签。保存文档后，首次使用新标签时，你应该会看到以下消息：
- en: '![](img/754a42a5-c62f-4729-9edc-f3a0174d708a.png)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![](img/754a42a5-c62f-4729-9edc-f3a0174d708a.png)'
- en: First-time use message for the local RMS template
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 本地 RMS 模板的首次使用消息
- en: 'The document should be protected with the HYOK RMS template permissions:'
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 文档应使用 HYOK RMS 模板权限进行保护：
- en: '![](img/bc14993e-71a9-4ac5-b567-73366ad96c21.png)'
  id: totrans-265
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bc14993e-71a9-4ac5-b567-73366ad96c21.png)'
- en: HYOK protected document
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: HYOK 受保护文档
- en: You've successfully implemented an HYOK deployment in your test environment.
    Now that we've had a complete walk-through for all three deployment methods, we'll
    take a closer look at the Azure RMS functionality itself.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 你已成功在测试环境中实施 HYOK 部署。现在，我们已经全面走完了所有三种部署方法的流程，接下来我们将更详细地查看 Azure RMS 的功能。
- en: How Azure RMS works under the hood
  id: totrans-268
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure RMS 背后的工作原理
- en: It's quite important to how RMS works it delivers the data protection service
    of the complete Azure Information Protection solution. First of all, the protected
    data will never be transferred to the Azure Information Protection or Rights Management
    service itself. Basically, the data is encrypted at the application level and
    includes a policy that defines who is authorized and which usage rights are applied
    for these users. Keep in mind that group memberships are cached for three hours.
    So, if you change permissions, remember this to avoid misinterpreted results.
    To get a better understanding of the three typical flows, let's explore the flows
    in this section. But first, we'll look at the algorithms and key lengths used
    by Azure RMS.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 了解 RMS 的工作原理非常重要，它提供了完整的 Azure 信息保护解决方案的数据保护服务。首先，受保护的数据永远不会被传输到 Azure 信息保护或权限管理服务本身。基本上，数据在应用程序级别被加密，并包括一个定义谁有权限以及为这些用户应用哪些使用权限的策略。请记住，组成员资格会缓存三小时。因此，如果你更改了权限，请记得这一点，以免产生误解的结果。为了更好地理解三种典型的流程，让我们在本节中深入探讨这些流程。但首先，我们将看看
    Azure RMS 使用的算法和密钥长度。
- en: Algorithms and key lengths
  id: totrans-270
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 算法和密钥长度
- en: 'Azure RMS uses the following cryptographic controls in the different usage
    scenarios. The following table gives you the needed information if you get asked
    in a project or workshop:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: Azure RMS 在不同的使用场景中使用以下加密控制。以下表格为你提供了在项目或研讨会上可能被问到的必要信息：
- en: '| **Cryptographic controls** | **Azure RMS usage** |'
  id: totrans-272
  prefs: []
  type: TYPE_TB
  zh: '| **加密控制** | **Azure RMS 使用情况** |'
- en: '| **Algorithm**: AES **Key length**: 128/256 bits | Documentation protection**Used
    by**:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: '| **算法**：AES **密钥长度**：128/256 位 | 文档保护**使用者**：'
- en: Azure Information Protection client
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 信息保护客户端
- en: Rights Management sharing application
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 权限管理共享应用程序
- en: '|'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '| **Algorithm**: RSA**Key length**: 2,048 bits/*1,024 bits | Key protection'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: '| **算法**: RSA **密钥长度**: 2,048 位 / *1,024 位* | 密钥保护'
- en: Migration from AD RMS running Cryptographic Mode 1
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从 AD RMS 加密模式 1 迁移
- en: Migration with AD RMS and Exchange Online usage
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AD RMS 和 Exchange Online 的迁移
- en: Archived keys (on-premises) before the migration
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迁移前的归档密钥（本地）
- en: 'BYOK supports 1024/2048 bits - recommended: 2,048 bits'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'BYOK 支持 1024/2048 位 - 推荐: 2,048 位'
- en: '|'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: '|'
- en: '| SHA-256 | Certificate-signing |'
  id: totrans-283
  prefs: []
  type: TYPE_TB
  zh: '| SHA-256 | 证书签名 |'
- en: Now that we have a clear picture of the cryptographic controls, we can go further
    into the first use flow, or user environment-initialization.
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经对加密控制有了清晰的了解，可以进一步探讨第一次使用流程，或用户环境初始化。
- en: User environment-initialization flow
  id: totrans-285
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 用户环境初始化流程
- en: The user environment-initialization is also called the bootstrapping process.
    The process starts when the Azure Information Protection client is installed on
    the client and a user opens an Office application, for example. It runs if a user
    consumes protected content or protects a newly-created document.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 用户环境初始化也称为引导过程。该过程从安装 Azure 信息保护客户端并且用户打开 Office 应用程序（例如）时开始。如果用户访问受保护内容或保护新创建的文档时，它将会运行。
- en: Keep in mind that if the user moves to another machine or another user uses
    the same machine, the process always runs the first time it's used.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，如果用户换到另一台机器，或者另一位用户使用同一台机器，过程总是会在首次使用时运行。
- en: 'During this process, many things happen in the background, and if the user
    is provided by Single-Sign-On in a federated environment, they don''t recognize
    the steps overall. After a successful authentication to the RMS service, the three
    main certificates will be received:'
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 在此过程中，后台发生了许多事情，如果用户在联合环境中通过单点登录提供认证，他们并不会识别出整体步骤。成功认证到 RMS 服务后，三张主要证书将会被接收：
- en: The Security Processor Certificate (SPC)
  id: totrans-289
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全处理器证书（SPC）
- en: The Client Licensor Certificate (CLC)
  id: totrans-290
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户端许可证书（CLC）
- en: The Rights Account Certificate (**RAC**), formerly known as Group Identity Certificate
    (GIC)
  id: totrans-291
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 权限账户证书 (**RAC**)，前身为组身份证书（GIC）
- en: These are all valid for 31 days and authenticate the user to the Azure Active
    Directory.
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 这些证书有效期为 31 天，并验证用户到 Azure Active Directory。
- en: Also, the Rights Management templates from the organization will be received.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，组织的权限管理模板也将被接收。
- en: 'The following diagram shows the main components during this process:'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表展示了此过程中的主要组件：
- en: '![](img/41f1e112-fb62-472b-8600-81588cdf84d7.png)'
  id: totrans-295
  prefs: []
  type: TYPE_IMG
  zh: '![](img/41f1e112-fb62-472b-8600-81588cdf84d7.png)'
- en: Main components and actors on the bootstrapping process
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 启动过程中的主要组件和参与者
- en: Many other things happen during this process. If you need more details about
    the bootstrap process, you can find them at [https://bit.ly/2FbcxNt](https://bit.ly/2FbcxNt)
    and [https://bit.ly/2RxtcRR](https://bit.ly/2RxtcRR).
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 在此过程中还会发生许多其他事情。如果你需要更多关于引导过程的详细信息，可以参考 [https://bit.ly/2FbcxNt](https://bit.ly/2FbcxNt)
    和 [https://bit.ly/2RxtcRR](https://bit.ly/2RxtcRR)。
- en: 'Here are some other helpful sources:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些其他有用的资源：
- en: '**AIP Client Admin Guide**: [https://bit.ly/2Txpoxr](https://bit.ly/2Txpoxr)'
  id: totrans-299
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AIP 客户端管理员指南**: [https://bit.ly/2Txpoxr](https://bit.ly/2Txpoxr)'
- en: '***Th*e Evolution of AD RMS to Azure Information Protection Part 6 by Matt
    Felton**: [https://bit.ly/2AwGR1Q](https://bit.ly/2AwGR1Q)'
  id: totrans-300
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '***AD RMS 到 Azure 信息保护的演变 第 6 部分，作者：Matt Felton**: [https://bit.ly/2AwGR1Q](https://bit.ly/2AwGR1Q)'
- en: '**Logging and analyzing usage**:[ https://bit.ly/2RdJ3Wf](https://bit.ly/2RdJ3Wf)'
  id: totrans-301
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**记录和分析使用情况**：[https://bit.ly/2RdJ3Wf](https://bit.ly/2RdJ3Wf)'
- en: Next, we'll look into the content-protection flow.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将探讨内容保护流程。
- en: Content-protection flow
  id: totrans-303
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 内容保护流程
- en: 'The next is the content-protection flow, which is that happens if a user protects
    a document or email. The RMS client creates a random content key and encrypts
    the document using an AES symmetric-encryption algorithm. The flow is shown in
    full in the following diagram. Let''s highlight just a few points:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是内容保护流程，即当用户保护文档或电子邮件时发生的情况。RMS 客户端创建一个随机内容密钥，并使用 AES 对称加密算法对文档进行加密。流程在以下图中完整展示。我们仅强调几点：
- en: The main attribute to identify users or groups is the `ProxyAddresses` attribute;
    always keep old email addresses to be able to use older protected content
  id: totrans-305
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别用户或组的主要属性是 `ProxyAddresses` 属性；始终保留旧的电子邮件地址，以便能够使用较旧的受保护内容
- en: If the `ProxyAddresses` are empty, `UserPrincipalName` will be used instead
  id: totrans-306
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果 `ProxyAddresses` 为空，则会使用 `UserPrincipalName`。
- en: The RMS client uses the organization's key to encrypt the policy and the content
    key
  id: totrans-307
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RMS 客户端使用组织的密钥来加密策略和内容密钥
- en: The RMS client signs the policy with the user's certificate
  id: totrans-308
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RMS 客户端使用用户证书签署策略
- en: The protection level stays always with the content
  id: totrans-309
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保护级别始终与内容一起存在
- en: 'In the following diagram, you can see the content-protection flow:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 在下图中，你可以看到内容保护流程：
- en: '![](img/4e9d2804-7323-4934-8e21-8a6c840b9e7d.png)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4e9d2804-7323-4934-8e21-8a6c840b9e7d.png)'
- en: Content-protection flow
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 内容保护流程
- en: Next, we will jump into the content-consumption flow.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将深入探讨内容消费流程。
- en: Content-consumption flow
  id: totrans-314
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 内容消费流程
- en: 'Content consumption happens if a user tries to open an RMS-protected document
    or email. The process always starts by requesting access to the Azure Rights Management
    service. Let''s highlight the most important points:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户尝试打开一个 RMS 保护的文档或电子邮件时，就会发生内容消费。这个过程始终从请求访问 Azure 权限管理服务开始。让我们重点突出几个关键点：
- en: The authenticated user sends the document policy and the user's certificates
    to the Azure Rights Management service
  id: totrans-316
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 认证用户将文档策略和用户的证书发送到 Azure 权限管理服务
- en: The policy will be decrypted and evaluated by the service
  id: totrans-317
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 策略将由服务解密并评估
- en: The service builds the rights for every user identification through the `ProxyAddresses`
    or `UserPrincipalName` attribute
  id: totrans-318
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务通过 `ProxyAddresses` 或 `UserPrincipalName` 属性为每个用户身份构建权限
- en: The content key gets extracted from the decrypted policy; the key will be encrypted
    with the user's public key
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 内容密钥从解密后的策略中提取；密钥将使用用户的公钥进行加密
- en: The encrypted use license contains the re-encrypted content key
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密的使用许可证包含重新加密的内容密钥
- en: The RMS client decrypts the encrypted use license with its own private key
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RMS 客户端使用自己的私钥解密加密的使用许可证
- en: The RMS client decrypts the documents body and the rights list will be enforced
    by the application
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: RMS 客户端解密文档正文，应用程序将执行权限列表
- en: 'The following view shows the content-consumption flow:'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 以下视图展示了内容消费流程：
- en: '![](img/5e60023f-96e8-486e-984d-850718e7fc5d.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5e60023f-96e8-486e-984d-850718e7fc5d.png)'
- en: Content-consumption flow
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 内容消费流程
- en: With this flow, we've finished our journey through the Azure RMS flows. Well
    done!
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这个流程，我们已经完成了 Azure RMS 流程的讲解。做得好！
- en: Summary
  id: totrans-327
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you received all the necessary information to map your requirements
    to the correct key-deployment model. We looked at the pros and cons of using HYOK.
    With the provided configuration examples, we gathered practical experience, which
    you can now share or use in your next project or workshop. We learned about the
    main Azure RMS flows, which are helpful in understanding how Azure RMS works under
    the hood. You can use this knowledge to support deployments or troubleshoot common
    issues because many errors happen on the environment-initialization (bootstrapping)
    process or in the deployment.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你已获得了所有必要的信息，将你的需求映射到正确的密钥部署模型。我们探讨了使用 HYOK 的优缺点。通过提供的配置示例，我们积累了实践经验，现可以在你的下一个项目或研讨会中分享或使用这些经验。我们了解了主要的
    Azure RMS 流程，这有助于理解 Azure RMS 如何在后台工作。你可以利用这些知识支持部署或排查常见问题，因为许多错误发生在环境初始化（引导）过程或部署过程中。
- en: In the next chapter, we'll finish configuring the example Azure Information
    Protection solution, and then you'll be fully prepared for your journey with this
    nice technology.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将完成示例 Azure 信息保护解决方案的配置，之后你就可以为这项技术的应用之旅做好充分准备。
