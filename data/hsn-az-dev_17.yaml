- en: Big Data Storage - Azure Data Lake
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 大数据存储 - Azure Data Lake
- en: Sometimes, we have to store unlimited amounts of data. That scenario covers
    most big data platforms, where having even a soft limit for the maximum capacity
    could cause problems with the active development and maintenance of our application.
    Thanks to Azure Data Lake, we have limitless possibilities when it comes to storing
    both structured and unstructured data, all with an efficient security model and
    great performance.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，我们需要存储无限量的数据。这种情况涵盖了大多数大数据平台，其中即便是一个软限制最大容量也可能会在应用的积极开发和维护中引发问题。得益于Azure
    Data Lake，我们在存储结构化和非结构化数据方面拥有无限的可能性，所有这些都拥有高效的安全模型和出色的性能。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Azure Data Lake Store fundamentals
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure Data Lake Store基础
- en: Storing data in Azure Data Lake Store
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储数据到Azure Data Lake Store
- en: Security features and concerns
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全特性与关注点
- en: Best practices for working with Azure Data Lake Store
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Azure Data Lake Store的最佳实践
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'To perform the exercises in this chapter, you will need:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成本章的练习，你将需要：
- en: Access to an Azure subscription
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问Azure订阅
- en: Understanding Azure Data Lake Store
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解Azure Data Lake Store
- en: When considering your storage solution, you have to take into account the amount
    of data you want to store. Depending on your answer, you may choose a different
    option from services available in Azure—Azure Storage, Azure SQL, or Azure Cosmos
    DB. There is also a variety of databases available as images for VMs (such as
    Cassandra or MongoDB); the ecosystem is quite rich so everyone can find what they
    are looking for. The problem arises when you do not have an upper limit for the
    amount of data stored or, considering the characteristics of today's applications,
    that amount grows so rapidly that there is no possibility to declare a safe limit,
    which we will never hit. For those kinds of scenario, there is a separate kind
    of storage named Data Lakes. They allow you to store data in its natural format,
    so it does not imply any kind of structure over information stored. In Azure,
    a solution for that kind of problem is named Azure Data Lake Store; in this chapter,
    you will learn the basics of this service, which allows you to dive deeper into
    the service and adjust it to your needs.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在考虑存储解决方案时，你必须考虑你希望存储的数据量。根据你的需求，你可能会选择Azure中不同的服务选项——Azure Storage、Azure SQL或Azure
    Cosmos DB。也有各种数据库可以作为虚拟机的镜像（如Cassandra或MongoDB）；这个生态系统相当丰富，所以每个人都能找到所需的东西。当你没有存储数据量的上限，或者在考虑到当今应用的特点时，数据量增长得如此迅速，以至于没有可能声明一个永远不会达到的安全上限时，就会出现问题。对于这种情况，有一种专门的存储方式，叫做Data
    Lakes。它们允许你以数据的自然格式存储数据，因此不需要对存储的信息进行任何结构化。在Azure中，针对这种问题的解决方案叫做Azure Data Lake
    Store；在本章中，你将学习该服务的基础知识，从而能够深入了解并根据自己的需求进行调整。
- en: Azure Data Lake Store fundamentals
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure Data Lake Store基础
- en: 'Azure Data Lake Store is called a hyper-scale repository for data for a reason—there
    is no limit when it comes to storing files. It can have any format, be any size,
    and store information structured differently. This is also a great model for big
    data analytics as you can store files in the way that is the best for your processing
    services (some prefer a small number of big files, some prefer many small files
    – choose what suits you the most). This is not possible for other storage solutions
    such as relational, NoSQL, or graph databases, as they always have some restrictions
    when it comes to saving unstructured data. Let''s check an example comparison
    between Azure Data Lake Store and Azure Storage:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Data Lake Store被称为超大规模数据存储库并非没有原因——在存储文件时没有限制。它可以支持任何格式、任何大小，并存储以不同方式结构化的信息。这也是大数据分析的一个理想模型，因为你可以根据自己的处理服务需求来存储文件（有些人更喜欢少量的大文件，有些人则喜欢很多小文件——选择最适合你的方式）。对于关系型、NoSQL或图形数据库等其他存储解决方案来说，这是不可行的，因为它们在保存非结构化数据时总是存在某些限制。让我们看一个关于Azure
    Data Lake Store与Azure Storage的比较示例：
- en: '|  | **AZDS** | **Azure Storage** |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '|  | **AZDS** | **Azure Storage** |'
- en: '| **Limits** | No file size/number of files limits | Maximum account capacity
    of 500 TBs, the maximum size of files |'
  id: totrans-15
  prefs: []
  type: TYPE_TB
  zh: '| **限制** | 无文件大小/文件数量限制 | 最大账户容量为500 TB，文件的最大大小 |'
- en: '| **Redundancy** | LRS | LRS/ZRS/GRS/RA-GRS |'
  id: totrans-16
  prefs: []
  type: TYPE_TB
  zh: '| **冗余** | LRS | LRS/ZRS/GRS/RA-GRS |'
- en: '| **API** | WebHDFS | Azure Blob Storage API |'
  id: totrans-17
  prefs: []
  type: TYPE_TB
  zh: '| **API** | WebHDFS | Azure Blob Storage API |'
- en: 'The important thing here is the redundancy—for now, the only model which Azure
    Data Lake Store supports is LRS. That means that, in the event of a disaster,
    you may lose data stored inside a single data center. To avoid that, you will
    have to implement your own policy to copy data to a replica. In fact, you have
    available two models—synchronous replication, as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 这里最重要的是冗余——目前，Azure Data Lake Store 支持的唯一模型是 LRS。这意味着在发生灾难时，可能会丢失存储在单个数据中心的数据。为了避免这种情况，你必须实施自己的策略将数据复制到副本中。实际上，你有两种模型可以选择——同步复制，如下所示：
- en: '![](img/6e7bb730-f268-497e-afff-f01ac1910c0d.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6e7bb730-f268-497e-afff-f01ac1910c0d.png)'
- en: 'Or you have asynchronous, as follows:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 或者你可以选择异步复制，如下所示：
- en: '![](img/b4b4b501-74a0-4c00-9593-0513251b8e01.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b4b4b501-74a0-4c00-9593-0513251b8e01.png)'
- en: 'There are some obvious pros and cons of both solutions:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种解决方案有一些明显的优缺点：
- en: '**Synchronous**: Ensures that a copy of data was saved to a replica, more difficult
    to handle when considering duplicates, and lower performance.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**同步**：确保数据已保存到副本中，考虑到重复数据时更难处理，且性能较低。'
- en: '**Asynchronous**: Data can be lost (because you will not move data to a replica
    before a disaster), better performance (because you just save without waiting
    for replication), and easier to handle.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**异步**：数据可能会丢失（因为在灾难发生之前，你不会将数据移到副本），但性能更好（因为你只需保存数据而不等待复制），且更容易处理。'
- en: 'While replication may look better for Azure Storage, remember that the Azure
    Data Lake Store filesystem is based on HDFS—this allows for a seamless integration
    with many OSS tools, such as:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然复制看起来对 Azure Storage 更有利，但请记住，Azure Data Lake Store 文件系统基于 HDFS——这使得与许多开源工具的无缝集成成为可能，例如：
- en: Apache Hive
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Hive
- en: Apache Storm
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Storm
- en: Apache Spark
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Spark
- en: MapReduce
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: MapReduce
- en: Apache Pig
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache Pig
- en: And many more...!
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 还有更多...！
- en: This gives you a much better ecosystem, tool-wise. If you want to store data
    inside Azure Data Lake Store and prefer to use HDInsights to perform analysis
    and transformations over your files, instead of other Azure tools, you can easily
    connect to your instance and start working on them.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这为你提供了一个更好的生态系统和工具。如果你想将数据存储在 Azure Data Lake Store 中，并希望使用 HDInsights 来对你的文件进行分析和转换，而不是使用其他
    Azure 工具，你可以轻松连接到你的实例并开始工作。
- en: Note that for now, ADLS supports HDInsight 3.2, 3.4, 3.5, and 3.6 distributions.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，目前 ADLS 支持 HDInsight 3.2、3.4、3.5 和 3.6 版本。
- en: 'When it comes to accessing files stored inside an instance of Azure Data Lake
    Store, it leverages the POSIX-style permissions model; you basically operate on
    three different permissions, which can be applied to a file or a folder:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在访问存储在 Azure Data Lake Store 实例中的文件时，它采用了类似 POSIX 的权限模型；你基本上会操作三种不同的权限，这些权限可以应用于文件或文件夹：
- en: '**Read (R)**: For reading data'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**读取 (R)**：用于读取数据'
- en: '**Write (W)**: For writing data'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**写入 (W)**：用于写入数据'
- en: '**Execute (E)**: Applicable to a folder, used to give read/write permissions
    in a folder context (such as creating children or listing files)'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**执行 (E)**：适用于文件夹，用于授予文件夹上下文中的读写权限（例如创建子文件夹或列出文件）'
- en: We will cover more security concepts in the security section.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在安全部分讨论更多的安全概念。
- en: Creating an Azure Data Lake Store instance
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建一个 Azure Data Lake Store 实例
- en: 'To create an Azure Data Lake Store instance, you will need to search for `Azure
    Data Lake`in the portal and fill in the following form:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个 Azure Data Lake Store 实例，你需要在门户中搜索 `Azure Data Lake`，并填写以下表格：
- en: '![](img/cfd77d09-ca4d-4a30-b11b-9895e7882c57.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cfd77d09-ca4d-4a30-b11b-9895e7882c57.png)'
- en: 'However, you need to take into consideration the following facts:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，你需要考虑以下几点：
- en: 'Location: Currently there are four different locations available—Central US,
    East US 2, North Europe, and West Europe. Do remember that transferring data between
    DCs costs you extra money, so if you plan to use this service, plan your architecture
    carefully.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 位置：目前有四个不同的可用位置——美国中部、美国东部 2、北欧和西欧。请记住，在数据中心之间传输数据会额外收费，所以如果计划使用此服务，请仔细规划您的架构。
- en: 'Pricing package: There are two pricing models available—Pay-as-You-Go and fixed
    Monthly commitment. They have pros and cons (fixed pricing is in general cheaper
    but it is not that flexible when your application grows, it is difficult sometimes
    to plan required capacity ahead), so try to understand as best you can the characteristics
    of your applications using that service to choose whatever suits you the most.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 定价包：有两种可用的定价模型——按使用付费和固定月度承诺。它们各有优缺点（固定定价通常更便宜，但当您的应用程序增长时，它不那么灵活，有时很难提前规划所需的容量），因此请尽量了解您的应用程序使用该服务的特性，以选择最适合您的那种。
- en: 'Encryption settings: By default, encryption of your data is Enabled for a new
    account. While it is possible to disable it, in most cases you will stay with
    the default settings. What is more, there are two models of encryption—either
    you let the service  manage encryption keys for you, or you provide your own keys
    (stored inside Azure Key Vault).'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密设置：默认情况下，新帐户的数据加密已启用。虽然可以禁用它，在大多数情况下您将保持默认设置。此外，有两种加密模式——要么让服务为您管理加密密钥，要么提供您自己的密钥（存储在
    Azure 密钥保管库中）。
- en: Since it is a good idea to rotate encryption keys, you may face the issue when,
    due to a failure, even redundant copies of your data are inaccessible. While it
    is possible to recover from backup data, you will need an old key to decrypt it.
    Because of that, it is advisable to store a copy of old keys in case of unexpected
    outages.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 由于轮换加密密钥是个好主意，您可能会遇到问题，即使由于故障，您的数据的冗余副本也无法访问。虽然可以从备份数据中恢复，但您需要一个旧密钥来解密它。因此，建议在意外中断时存储旧密钥的副本。
- en: 'When you click on the Create button, your service will be provisioned—you can
    access it to see the overview:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 当您点击“创建”按钮时，您的服务将被配置好—您可以访问它以查看概览：
- en: '![](img/782a7941-5ce3-4aea-9220-ffdeb94d048a.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/782a7941-5ce3-4aea-9220-ffdeb94d048a.png)'
- en: 'Since it is freshly created, we cannot see different metrics which describe
    how much data we are storing. What is more, the current cost is 0 USD—this is,
    of course, something we expected as no file was uploaded to the service. From
    the UI perspective, there is not much that we can do for now; some additional
    features such as Firewall will be described later in that chapter. Besides the
    portal, you can also easily access your instance of Azure Data Lake Store by using
    Microsoft Azure Storage Explorer:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 由于它是新创建的，我们看不到描述我们存储了多少数据的不同指标。而且，当前成本为 0 美元——这当然是我们预期的，因为没有文件上传到服务中。从用户界面的角度来看，目前我们无法做太多事情；一些额外功能，如“防火墙”，将在本章后面描述。除了门户，您还可以通过使用
    Microsoft Azure 存储资源管理器轻松访问您的 Azure 数据湖存储实例：
- en: '![](img/a023fcf9-5bae-4f31-b7f1-2f872bb76899.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a023fcf9-5bae-4f31-b7f1-2f872bb76899.png)'
- en: It makes things much easier when you have multiple files and folders and you
    try to navigate through them.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 当您有多个文件和文件夹并尝试浏览它们时，这将使事情变得更加容易。
- en: Storing data in Azure Data Lake Store
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Azure 数据湖存储中存储数据
- en: Because Azure Data Lake Store is all about storing data, in this section of
    the chapter you will see how you can store different files, use permissions to
    restrict access to them, and organize your instance. The important thing to remember
    here is the fact that you are not limited to using big data tools to store or
    access data stored within a service—if you manage to communicate with the Azure
    Data Lake Store protocol, you can easily operate on files using C#, JavaScript,
    or any other kind of programming language.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 因为 Azure 数据湖存储的全部关注点是存储数据，在本章的这一部分中，您将看到如何存储不同的文件，使用权限限制对其的访问，并组织您的实例。在这里需要记住的重要事情是，您不仅限于使用大数据工具来存储或访问存储在服务中的数据——如果您设法与
    Azure 数据湖存储协议通信，您可以轻松地使用 C#、JavaScript 或任何其他类型的编程语言操作文件。
- en: Using the Azure portal to navigate
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure 门户进行导航
- en: 'To get started with working with files in the Azure portal, you will have to
    click on the Data explorerbutton:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始在 Azure 门户中使用文件，您需要点击“数据浏览器”按钮：
- en: '![](img/14d96ccb-3be3-409b-a16d-10fb860d12af.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/14d96ccb-3be3-409b-a16d-10fb860d12af.png)'
- en: 'Once you click on it, you will see a new screen, where you are given many different
    options for creating a folder, uploading files, or changing access properties.
    While this tool is not the best way to manage thousands of files, it gives you
    some insight into what is stored and how:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您点击它，您将看到一个新屏幕，在那里您可以选择许多不同选项来创建文件夹、上传文件或更改访问属性。虽然这个工具不是管理成千上万个文件的最佳方式，但它可以让您了解存储了什么以及如何存储：
- en: '![](img/fc95ca29-aa07-461b-bd70-cf4fbaf0f1ca.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc95ca29-aa07-461b-bd70-cf4fbaf0f1ca.png)'
- en: The downside of the UI available in the portal is the fact that it has a tendency
    to hang, especially if you have hundreds of files. Some options (such as deleting
    a folder) also tend to fail if you have stored gigabytes of data. In that scenario,
    it is better to either use PowerShell or custom procedures to perform an operation.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 门户中提供的用户界面的缺点是，它有时会卡顿，尤其是在你拥有数百个文件时。如果你存储了数GB的数据，一些操作（如删除文件夹）也可能会失败。在这种情况下，最好使用
    PowerShell 或自定义流程来执行操作。
- en: Now we will discuss options available on the UI.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将讨论用户界面上可用的选项。
- en: Filter
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 筛选器
- en: 'When you click on the Filter button, you will see a screen that tells you what
    files you are interested in:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 当你点击“筛选器”按钮时，你将看到一个屏幕，显示你感兴趣的文件：
- en: '![](img/0c4d2f79-0835-4149-af31-6bc499ef594d.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0c4d2f79-0835-4149-af31-6bc499ef594d.png)'
- en: It is the easiest way to quickly limit files displayed within a folder, but
    of course it has some caveats—for example, you cannot use a wildcard to filter
    only a specific file extension.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 这是快速限制文件夹内显示文件的最简单方法，但当然也有一些限制——例如，你不能使用通配符只筛选特定的文件扩展名。
- en: To remove a filter, click on the Reset button on the Filter screen.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 要移除筛选器，请点击筛选器屏幕上的重置按钮。
- en: New folder
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 新文件夹
- en: 'This simple option gives you the possibility to create a new folder:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这个简单的选项让你有可能创建一个新文件夹：
- en: '![](img/15eee2c6-2190-4bd4-b9e3-7f94d401553b.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/15eee2c6-2190-4bd4-b9e3-7f94d401553b.png)'
- en: Note that by default a new folder can be accessed only by you—to make it visible
    to others (and to allow them to read it), you will have to assign a particular
    group of users explicitly to it.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，默认情况下，只有你可以访问新文件夹——为了让其他人可见（并允许他们读取），你必须显式地为其分配特定的用户组。
- en: Upload
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 上传
- en: 'With the Upload function, you can upload files directly from your local machine
    to the cloud:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 使用“上传”功能，你可以直接从本地计算机将文件上传到云端：
- en: '![](img/0e65e259-6129-43b9-a178-ee3f3b71cc19.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0e65e259-6129-43b9-a178-ee3f3b71cc19.png)'
- en: 'The files you choose will be uploaded to the folder you are currently browsing.
    There is also the possibility of allowing overwriting existing files; if you decide
    not to do so and upload a duplicate, you will see the following error:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 你选择的文件将被上传到你当前浏览的文件夹中。还可以选择允许覆盖现有文件；如果你决定不覆盖并上传重复文件，你将看到以下错误：
- en: '![](img/9c921855-8494-4b9f-b8eb-524a6fed15ad.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9c921855-8494-4b9f-b8eb-524a6fed15ad.png)'
- en: Access
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 访问权限
- en: 'One of the most important features of Azure Data Lake Store is the ability
    to fully declare access to a specific resource stored inside it:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 数据湖存储的最重要特点之一是能够完全声明对存储在其中的特定资源的访问权限：
- en: '![](img/d36c0bb8-9efa-47c1-84c0-defca584e7e9.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d36c0bb8-9efa-47c1-84c0-defca584e7e9.png)'
- en: 'By default, only you can access a file or a folder. To add a new user or a
    group, you can click on the + Addbutton:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，只有你可以访问文件或文件夹。要添加新的用户或组，可以点击“+ 添加”按钮：
- en: '![](img/71b4f4a8-fb81-43cc-8957-3b8f5fbb14ce.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](img/71b4f4a8-fb81-43cc-8957-3b8f5fbb14ce.png)'
- en: 'There are important things I would like to cover here:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我想在这里讨论一些重要的内容：
- en: 'Permissions: Remember that to grant somebody access to list files inside a
    folder, you will have to assign two permissions: Read and Execute. The same applies
    to creating children inside a folder.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 权限：请记住，要授予某人列出文件夹内文件的权限，你需要分配两个权限：读取和执行。创建文件夹内的子项时也适用相同的要求。
- en: 'Add to: It is possible to propagate a particular set of permissions, not only
    to a single folder but also to all folders inside it. This is especially helpful
    when you can quickly allow somebody to list files and folders inside some parent
    directory.'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加到：可以将特定权限集传播到不仅是单个文件夹，而是文件夹内的所有文件夹。当你希望快速允许某人列出某个父目录下的文件和文件夹时，这尤其有用。
- en: 'Add as: You can add a set of permissions, either as a default permission entry
    (which will be assigned by default to all other users of a folder) or as an access
    entry (which specifies how somebody can access it). You can also combine both
    to speed things up.'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加为：你可以将一组权限添加为默认权限条目（默认分配给文件夹的所有其他用户）或访问权限条目（指定某人如何访问它）。你也可以结合使用这两种方式以加快操作。
- en: Files and folders
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 文件和文件夹
- en: 'Next to each file and folder visible, you can see an icon, which displays a
    menu with additional options:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个可见的文件和文件夹旁边，你可以看到一个图标，点击该图标会显示一个菜单，提供额外的选项：
- en: '![](img/859cc1cb-fc6c-4335-8e2c-26204d145102.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](img/859cc1cb-fc6c-4335-8e2c-26204d145102.png)'
- en: In fact, these are the same options we have just covered—they just apply to
    a specific folder and file.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 事实上，这些选项与我们刚刚讨论的相同——它们只是应用于特定的文件夹和文件。
- en: Microsoft Azure Storage Explorer
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Microsoft Azure Storage Explorer
- en: 'Most of the preceding options can be performed using Microsoft Azure Storage
    Explorer:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数前述选项都可以通过Microsoft Azure Storage Explorer来执行：
- en: '![](img/b7acd5e9-c1d3-43e3-b1f6-64945ffec5c7.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b7acd5e9-c1d3-43e3-b1f6-64945ffec5c7.png)'
- en: Unfortunately, it does not give you the possibility to assign permissions to
    files and folders. It is, however, a much better option for browsing stored data—what
    is more it automatically displays a set of required permissions assigned to an
    item.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，它不提供为文件和文件夹分配权限的功能。不过，它在浏览存储数据时是一个更好的选择——更重要的是，它会自动显示分配给项目的一组所需权限。
- en: Using SDKs
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用SDK
- en: 'The most flexible (and the most advanced) option to manage files and your Azure
    Data Lake Store instance is using an SDK for a language you are using. Currently,
    there are three different languages officially supported:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 管理文件和你的 Azure Data Lake Store 实例的最灵活（也是最先进）选项是使用适合你当前语言的SDK。目前，官方支持三种不同的语言：
- en: .NET platform
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: .NET平台
- en: Java
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Java
- en: Python
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python
- en: 'There is also the possibility of using a REST API, so basically you can connect
    with it using any language you want. Here, The following code snippet allows you
    to connect to the service:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 还可以使用REST API，基本上你可以使用任何语言连接它。以下代码片段可以让你连接到服务：
- en: '[PRE0]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'There are two options available when it comes to authenticating to connect
    to your service:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行身份验证以连接到你的服务时，有两种可用的选项：
- en: End-user authentication
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 终端用户身份验证
- en: Service-to-service authentication
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务到服务的身份验证
- en: 'Both scenarios are described in detail in the documentation available in the *Further
    reading*section. Whichever option you choose, you will end up with using a generated
    OAuth 2.0 token. Here, you can find a simple provider to a service that leverages
    the described methods and allows you to easily create a new folder and append
    data to a file:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这两种场景在*进一步阅读*部分的文档中有详细描述。无论你选择哪种选项，最终都会使用生成的OAuth 2.0令牌。在这里，你可以找到一个简单的服务提供者，它利用了所描述的方法，并允许你轻松创建新文件夹并向文件中追加数据：
- en: '[PRE1]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: You can read more about writing such a provider in the blog post mentioned in
    the *Further reading*section.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在*进一步阅读*部分提到的博客文章中阅读更多关于如何编写这种提供者的内容。
- en: The important thing about using SDKs is the ability to abstract many operations
    and automate them—you can easily delete files recursively or dynamically create
    them. Such operations are unavailable when using UIs and most serious project
    developers would rather code stuff than rely on manual file management.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 使用SDK的一个重要优点是能够抽象化许多操作并自动化它们——你可以轻松地递归删除文件或动态创建文件。使用UI时，这些操作是无法实现的，而大多数严肃的项目开发人员宁愿编写代码，也不愿依赖手动文件管理。
- en: Security
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全性
- en: Azure Data Lake Store offers a bit of a different security model than other
    storage options available for Azure. In fact, it offers you a complex solution
    that consists of authentication, authorization, network isolation, data protection,
    and auditing. As it is designed to be the very base of data-driven systems, it
    has to extend common capabilities when it comes to securing who (or what) and
    how to access information stored. In this section, we will cover different security
    features available and describe them in detail, so you are familiar with them
    and know how to use them.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Data Lake Store 提供了一种与其他Azure存储选项不同的安全模型。实际上，它为你提供了一个复杂的解决方案，包含身份验证、授权、网络隔离、数据保护和审计。由于它被设计为数据驱动系统的基础，因此在保护谁（或什么）以及如何访问存储的信息时，必须扩展常见的功能。本节将介绍不同的安全功能并详细描述它们，让你熟悉它们并了解如何使用。
- en: Authentication and authorization
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 身份验证和授权
- en: To authenticate who or what can access data stored, Azure Data Lake Store uses Azure
    Active Directory to know what the current entity accessing data is. To authorize
    it, it leverages both **role-based access control**(**RBAC**), to secure the resource
    itself, and POSIX ACL to secure data.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 为了验证谁或什么可以访问存储的数据， Azure Data Lake Store 使用 Azure Active Directory 来识别当前访问数据的实体。为了授权它，Azure通过
    **基于角色的访问控制**（**RBAC**）来保护资源本身，并使用POSIX ACL来保护数据。
- en: 'It is important to understand the distinction between these two terms:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 了解这两个术语之间的区别非常重要：
- en: '**Authentication**: This determines who or what tries to access a particular
    resource.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证**：这决定了谁或什么尝试访问特定的资源。'
- en: '**Authorization**: This secures a resource by limiting access to it to those
    who have been assigned a particular set of permissions.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**授权**：通过限制仅将资源的访问权限分配给已被分配特定权限集的人员，从而保护资源。'
- en: It is important to remember that if you have multiple subscriptions hosting
    different resources that would like to access Azure Data Lake Store, you have
    to assign the same Azure AD instance to all of them—if you fail to do so, some
    will not be able to access data, as only users and services defined within a directory
    assigned to ADLS can be authenticated and given access to it.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是要记住，如果你有多个订阅承载着不同的资源，并希望它们访问Azure Data Lake Store，你必须将相同的Azure AD实例分配给它们所有——如果没有这样做，其中一些将无法访问数据，因为只有在分配给ADLS的目录中定义的用户和服务才能通过身份验证并获得访问权限。
- en: Let's check the difference between the RBAC and POSIX models.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们查看RBAC和POSIX模型之间的区别。
- en: RBAC
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: RBAC
- en: 'RBAC controls who can access an Azure resource. It is a separate set of roles
    and permissions, that has nothing to do with the data stored. To check this feature,
    click on the Access control (IAM)blade:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: RBAC控制谁可以访问Azure资源。它是一个独立的角色和权限集合，与存储的数据无关。要检查此功能，请点击**访问控制（IAM）**刀片：
- en: '![](img/30fc62be-cd45-4d9f-99c9-0c28c7902cd0.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/30fc62be-cd45-4d9f-99c9-0c28c7902cd0.png)'
- en: 'On the preceding screen, you can see that I have three different apps (services)
    and one user assigned to the resource. They also have different roles:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的屏幕上，你可以看到我为资源分配了三个不同的应用程序（服务）和一个用户。他们还具有不同的角色：
- en: 'Owner: Full access including determining who can access the resource'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 所有者：完全访问权限，包括确定谁可以访问该资源
- en: Contributor: Full access excluding determining who can access the resource
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 贡献者：完全访问权限，除非确定谁可以访问该资源
- en: 'If you click the Roles button, you will see a full list of possible roles for
    the ADLS:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你点击**角色**按钮，你将看到ADLS可能角色的完整列表：
- en: '![](img/d075c409-8ef7-4988-8f16-4c41ba0116ce.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d075c409-8ef7-4988-8f16-4c41ba0116ce.png)'
- en: Using the Access Control (IAM)blade, you can easily control who can access your
    instance of Azure Data Lake Store and how—use it any time you want to change permissions
    or the set of users/services accessing it.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用**访问控制（IAM）**刀片，你可以轻松控制谁能访问你的Azure Data Lake Store实例以及如何访问——每当你想更改权限或访问它的用户/服务集合时，使用它。
- en: A good idea is to manage groups rather than individual entities—this allows
    you to add/remove a user or an entity in one place (Azure AD) instead of browsing
    resources and their RBAC.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一个好的做法是管理组而不是单独的实体——这让你可以在一个地方（Azure AD）添加/移除用户或实体，而不必浏览资源及其RBAC。
- en: POSIX ACL
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: POSIX ACL
- en: 'As described previously, you can manage access to data stored within your instance
    of ADLS by providing a set of permissions defined as Read, Write,and Execute.
    They are the part of the POSIX **access control list** (**ACL**) that is a feature
    of Hadoop HDFS, which is the part of the engine of this Azure service. If you
    have used, for example FTP servers, you probably have worked with filesystem permissions;
    they were described as numbers or strings containing the letters `r`, `w`, `x`,
    and the character `-`. The following is an example:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，你可以通过提供一组定义为**读取**、**写入**和**执行**的权限来管理对你实例中数据的访问。它们是POSIX **访问控制列表**（**ACL**）的一部分，而ACL是Hadoop
    HDFS的一部分，HDFS是此Azure服务的引擎之一。如果你曾使用过FTP服务器，可能已经处理过文件系统权限；它们通常被描述为包含`r`、`w`、`x`和字符`-`的数字或字符串。以下是一个示例：
- en: '`-rwx------`is equal to `0700` and declares read, write, and execute permissions
    only for the owner.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-rwx------`等同于`0700`，并仅声明所有者具有读取、写入和执行权限。'
- en: '`-rwxrwxrwx`is equal to `0777` and declares read, write, and execute permissions
    for everyone.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-rwxrwxrwx`等同于`0777`，并声明每个人都可以读取、写入和执行权限。'
- en: '`-rw-rw-rw-`is equal to `0666` and declares read and write permissions for
    everyone.'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-rw-rw-rw-`等同于`0666`，并声明所有人均可读取和写入权限。'
- en: You can find more about the POSIX ACL model in the *Further reading*section.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在**进一步阅读**部分中找到更多关于POSIX ACL模型的信息。
- en: Network isolation
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络隔离
- en: 'I mentioned the Firewall blade earlier, but we skipped it so you could learn
    something about it once you are familiar with the service. When you click on the Firewall blade,
    you will see a screen that allows you to specify which IP address can access your
    instance:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 我之前提到了**防火墙**刀片，但我们跳过了它，目的是让你在熟悉该服务后能学到一些东西。当你点击**防火墙**刀片时，你会看到一个屏幕，允许你指定哪些IP地址可以访问你的实例：
- en: '![](img/1902c0b2-ee17-4201-8ae4-4d129fcd0dbc.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1902c0b2-ee17-4201-8ae4-4d129fcd0dbc.png)'
- en: The important thing here is the ability to block other Azure services from accessing
    your data—this can be helpful if you have requirements that force you to disallow
    anyone from reading any information stored in ADLS. You can find out more about
    security features in the link provided in the *Further reading*section.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 这里最重要的是能够阻止其他 Azure 服务访问您的数据——如果您有要求必须禁止任何人读取存储在 ADLS 中的信息，这一点非常有用。您可以在 *进一步阅读*
    部分的链接中了解更多关于安全功能的信息。
- en: Best practices
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最佳实践
- en: Azure Data Lake Store is a bit different when it comes to accessing data stored
    and performing read and writes. As this service is designed for storing petabytes
    of data, it is important to know the best practices for doing so, to avoid problems
    such as the need to reorganize all files or slow reads/writes. This also includes
    security features (as discussed earlier), as this is an important part of the
    whole solution. In this section, we will focus on multiple advice regarding ADLS,
    so you will use it consciously and leverage the best practices.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Data Lake Store 在访问存储的数据以及执行读写操作时与其他服务有所不同。由于此服务旨在存储 PB 级别的数据，了解如何存储数据的最佳实践非常重要，这样可以避免像需要重新组织所有文件或读取/写入速度慢等问题。这还包括安全功能（如前所述），因为它是整个解决方案的重要组成部分。在本节中，我们将重点讨论多个关于
    ADLS 的建议，帮助您在使用时更加得心应手，并能够利用最佳实践。
- en: Performance
  id: totrans-137
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 性能
- en: 'One important feature of many storage solutions is their performance. In general,
    we expect that our databases will work without a problem whether the load is low
    or high and a single record is big or small. When it comes to ADLS, you have to
    take into account the following factors:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 许多存储解决方案的一个重要特性是它们的性能。通常，我们期望无论负载高低、单个记录大小如何，数据库都能正常工作。对于 ADLS，您需要考虑以下因素：
- en: '**Parallelism**: As stated in the documentation, it is important to ensure,
    that you provide a certain level of parallelism when performing reads/writes.
    The ideal number of threads per one core is defined as 8-12.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**并行性**：正如文档中所述，在执行读写操作时，确保提供一定程度的并行性非常重要。每个核心的理想线程数被定义为 8-12。'
- en: '**File size**: While different data analytics solutions may work differently
    with different file sizes, it is also important to know that ADLS also has an
    optimal file size to work with. As it is based on HDFS and leverages the POSIX
    model for permissions, it promotes bigger files (several hundred megabytes) instead
    of smaller ones to avoid problems with replication, connections, and authentication
    checks.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文件大小**：虽然不同的数据分析解决方案可能会根据文件大小的不同而有不同的表现，但同样重要的是要知道，ADLS 也有一个最佳的文件大小。由于它基于
    HDFS，并利用 POSIX 模型来处理权限，它更倾向于使用较大的文件（几百兆字节）而不是较小的文件，以避免在复制、连接和身份验证检查时出现问题。'
- en: '**I/O limits**: While some hard limits when it comes to throughput are not
    enabled on Azure Data Lake Store, you still can face some problems when your jobs
    are very demanding, capacity-wise. It is important to remember that even in this
    service, you can still face some soft limits that can be removed after contacting
    Azure support. If you face a 429 error, throttling may be the case.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**I/O 限制**：虽然 Azure Data Lake Store 在吞吐量方面没有启用硬性限制，但当您的作业在容量上非常苛刻时，仍然可能会遇到一些问题。重要的是要记住，即使在这个服务中，您仍然可能会遇到一些软限制，这些限制可以在联系
    Azure 支持后解除。如果遇到 429 错误，可能是由于限流。'
- en: '**Batching**: As in many cases where you face high throughput, it may be beneficial
    to use batching to lower write operations. In ADLS, the optimal size for a batch
    is defined as 4 MBs – by performing writes of that size, you can lower the required
    IOPS and improve the overall performance of the service.'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**批处理**：在许多面对高吞吐量的情况下，使用批处理来减少写入操作可能是有益的。在 ADLS 中，批处理的最佳大小被定义为 4 MB —— 通过执行这种大小的写入操作，您可以减少所需的
    IOPS，并提升服务的整体性能。'
- en: Security
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全性
- en: 'We discussed this topic a little previously, but here we summarize it. When
    using ADLS and considering its security features (such as authentication, authorization,
    and access to files), it is important to remember the following things:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们之前稍微讨论过这个话题，在这里我们做个总结。当使用 ADLS 并考虑其安全功能（如身份验证、授权和文件访问）时，重要的是要记住以下几点：
- en: '**Prefer groups over users/services**: While, initially, it is easier to assign
    an individual user to a resource or a folder, you will quickly face problems when
    the number of people interested in data starts to grow rapidly. This is why it
    is better to use Azure AD groups to both determine RBAC access to the resource
    itself and POSIX ACL for files and folders. It also improves the performance of
    the solution, as it is quicker to check whether an entity belongs to a group than
    to traverse through a long list of users.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**优先使用组而不是用户/服务**：虽然最初将单个用户分配到资源或文件夹可能更容易，但一旦对数据感兴趣的人数迅速增长，您将迅速面临问题。这就是为什么最好使用
    Azure AD 组来确定对资源本身的 RBAC 访问以及对文件和文件夹的 POSIX ACL。它还提高了解决方案的性能，因为检查实体是否属于组比遍历长用户列表更快。'
- en: '**The minimum set of permissions**: As in other services, always start with
    a minimum set of permissions required by someone who accesses your instance of Azure
    Data Lake Store. Do not assign a Write permission to somebody who only reads data,
    or Execute to a service that reads only a single file in a folder.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最小权限集合**：与其他服务一样，始终从访问您的 Azure 数据湖存储实例所需的最小权限集合开始。不要为仅读取数据的用户分配**写入**权限，或者为仅在文件夹中读取单个文件的服务分配**执行**权限。'
- en: '**Enable the firewall**: In general, you do not want to allow anyone to access
    data stored inside ADLS. To secure your solution, so that only a subset of IP
    addresses can access information, enable the firewall so anyone outside the list
    will be rejected.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**启用防火墙**：通常情况下，您不希望允许任何人访问存储在 ADLS 中的数据。为了保护您的解决方案，使只有子集 IP 地址能够访问信息，启用防火墙，以便拒绝名单之外的任何人。'
- en: Resiliency
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 弹性
- en: It is crucial to ensure, that your data is stored in a safe manner and will
    not be lost in the case of any issue inside the DC. As mentioned at the very beginning
    of this chapter, ADLS does not support geo-redundancy—you have to implement it
    on your own. To do so, you have to incorporate a tool that will allow you to replicate
    data in the way you need. There are three different tools mentioned in the documentation—Distcp,
    Azure Data Factory, and AdlsCopy, but of course, you can use any other tool that
    can connect to Azure Data Lake Store and integrate with the service.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 确保数据安全存储并且在 DC 内部出现问题时不会丢失是至关重要的。正如本章开头所提到的，ADLS 不支持地理冗余性——您必须自行实施。为此，您必须集成一个工具，允许您按照需要复制数据。文档中提到了三种不同的工具——Distcp、Azure
    数据工厂和 AdlsCopy，当然，您也可以使用任何其他能够连接到 Azure 数据湖存储并与服务集成的工具。
- en: When considering DR or HA for Azure Data Lake Store, take into consideration
    factors such as RPO, inconsistency, and complex data merging problems in the event
    of performing a failover. Sometimes, it is better to wait for a service to recover
    instead of switching to the secondary replica.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 在考虑 Azure 数据湖存储的灾难恢复（DR）或高可用（HA）时，考虑诸如 RPO、不一致性和执行故障切换时的复杂数据合并问题等因素。有时，等待服务恢复而不是切换到次要副本可能更好。
- en: Data structure
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据结构
- en: 'You will choose a different data structure for different use scenarios—for
    IoT data it will be very granular:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 您将根据不同的使用场景选择不同的数据结构——对于 IoT 数据，它将非常细粒度：
- en: '[PRE2]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'On the other hand, for storing user data, the structure may be completely different:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，用于存储用户数据的结构可能完全不同：
- en: '[PRE3]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: It all depends on your current requirements. The data structure is extremely
    important when you plan to perform an analysis on the files stored—it directly
    affects the size of files and their number, which can further affect the possible
    toolset for your activities.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这完全取决于您当前的需求。在计划对存储的文件执行分析时，数据结构至关重要——它直接影响文件的大小和数量，进而可能影响您的活动可能工具集。
- en: Another important thing here is the legal requirements—if you use any kind of
    sensitive data as a folder or a filename, you will have to be able to perform
    a clean up efficiently if a user tells you that he/she wants to be forgotten or
    asks for an account to be removed.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 这里另一个重要的事项是法律要求——如果您使用任何敏感数据作为文件夹或文件名，您必须能够在用户告诉您希望被遗忘或要求删除账户时有效地执行清理。
- en: Summary
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 概要
- en: In this chapter, you have learned a bit about Azure Data Lake Store, an Azure
    service designed to store an almost unlimited amount of data without affecting
    its structure. We have covered things such as data structure, security features,
    and best practices, so you should be able to get started on your own and build
    your very first solution based on this particular Azure component. Bear in mind
    that what can easily replace Azure Storage for example—it all depends on your
    requirements and expectations. If you're looking for a more flexible security
    model, better performance, and better limits, ADLS is for you. This ends this
    part of the book, which included services for storing data, monitoring services,
    and performing communication between them. In the next chapter, you will learn
    more about scaling, performance, and maintainability in Azure.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，你已经学习了一些关于Azure Data Lake Store的知识，它是一个旨在存储几乎无限数据量的Azure服务，并且不影响数据的结构。我们已经讨论了数据结构、安全功能和最佳实践等内容，因此你应该能够开始构建自己的解决方案，基于这个特定的Azure组件。请记住，Azure
    Storage可能很容易替代它——这完全取决于你的需求和期望。如果你需要更灵活的安全模型、更好的性能和更高的限制，ADLS就是你的选择。这部分书籍到此结束，涵盖了存储数据的服务、监控服务以及它们之间的通信。下一章，你将学习更多关于Azure的扩展性、性能和可维护性方面的知识。
- en: Questions
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which security model is better—managing security groups or individual entities,
    and why?
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪种安全模型更好——管理安全组还是单独管理实体？为什么？
- en: What is the difference between RBAC and POSIX ACL?
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: RBAC和POSIX ACL之间有什么区别？
- en: What is the maximum size of a file in ADLS?
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ADLS中的文件最大可以有多大？
- en: Which data structure is better—a single folder containing thousands of files
    or a hierarchy of folders containing several files each?
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪种数据结构更好——一个包含成千上万文件的单一文件夹，还是一个包含多个文件的文件夹层级结构？
- en: Can Azure Data Lake Store be used with any programming language?
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Azure Data Lake Store可以与任何编程语言一起使用吗？
- en: What is the difference between ADLS and Azure Storage?
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ADLS和Azure Storage有什么区别？
- en: How do you ensure that your solution based on ADLS is geo-redundant?
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如何确保基于ADLS的解决方案具有地理冗余性？
- en: Further reading
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: End-user authentication: [https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-end-user-authenticate-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-end-user-authenticate-net-sdk)
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 终端用户认证：[https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-end-user-authenticate-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-end-user-authenticate-net-sdk)
- en: Service-to-service authentica**tion**: [https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-service-to-service-authenticate-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-service-to-service-authenticate-net-sdk)
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 服务到服务认证**(authentication)**：[https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-service-to-service-authenticate-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-service-to-service-authenticate-net-sdk)
- en: Writing a Data Lake Store provider: [http://blog.codenova.pl/post/azure-functions-webjobs-and-data-lake-writing-a-custom-extension-2](http://blog.codenova.pl/post/azure-functions-webjobs-and-data-lake-writing-a-custom-extension-2)
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 编写Data Lake Store提供程序：[http://blog.codenova.pl/post/azure-functions-webjobs-and-data-lake-writing-a-custom-extension-2](http://blog.codenova.pl/post/azure-functions-webjobs-and-data-lake-writing-a-custom-extension-2)
- en: Data Lake Store operations .NET: [https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-operations-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-operations-net-sdk)
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Data Lake Store操作.NET：[https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-operations-net-sdk](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-data-operations-net-sdk)
- en: POSIX ACL: [https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html#ACLs_Access_Control_Lists](https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html#ACLs_Access_Control_Lists)
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: POSIX ACL：[https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html#ACLs_Access_Control_Lists](https://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html#ACLs_Access_Control_Lists)
- en: Security overview: [https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview)
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安全概述：[https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview)
- en: Best practices: [https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-best-practices](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-best-practices)
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最佳实践：[https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-best-practices](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-best-practices)
