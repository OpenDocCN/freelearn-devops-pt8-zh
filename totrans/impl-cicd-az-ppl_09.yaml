- en: '9'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '9'
- en: Implementing CI/CD for Azure Services
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 实现 Azure 服务的 CI/CD
- en: In this chapter, you are going to put everything you have learned so far into
    an end-to-end solution, deploying a group of applications and promoting it from
    a test environment to a production environment. From the simplest to the most
    complex solution architecture, this chapter showcases the flexibility of Azure
    Pipelines to handle the provisioning, configuration, and deployment of applications
    in Azure, no matter the different services involved and the programming languages
    used in your applications.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您将把迄今为止学到的所有知识应用于一个端到端的解决方案，部署一组应用程序，并将其从测试环境推广到生产环境。从最简单到最复杂的解决方案架构，本章展示了
    Azure Pipelines 在处理 Azure 中应用程序的配置、部署和资源管理时的灵活性，无论涉及不同的服务和编程语言。
- en: 'The following topics will be covered:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Introducing the solution architecture
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 介绍解决方案架构
- en: Building and packaging applications and **infastruture as** **code** (**IaC**)
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 构建和打包应用程序以及**基础设施即代码**（**IaC**）
- en: Creating environments
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建环境
- en: Deploying a Python catalog service to **Azure Kubernetes** **Service** (**AKS**)
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 Python 目录服务到**Azure Kubernetes 服务**（**AKS**）
- en: Deploying a Node.js cart service to **Azure Container** **Apps** (**ACA**)
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 Node.js 购物车服务到**Azure 容器应用**（**ACA**）
- en: Deploying a .NET checkout service to **Azure Container** **Instances** (**ACI**)
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署 .NET 结账服务到**Azure 容器实例**（**ACI**）
- en: Deploying an Angular frontend app to **Azure App** **Service** (**AAS**)
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将 Angular 前端应用部署到**Azure 应用服务**（**AAS**）
- en: Approving environment deployments
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 批准环境部署
- en: Let’s first take care of the technical requirements for this chapter.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先处理本章的技术要求。
- en: Technical requirements
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'You will need to have handy the following URL to the GitHub repository, which
    will be the base for this chapter: [https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch09](https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch09).'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要准备好以下 GitHub 仓库的 URL，作为本章的基础：[https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch09](https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch09)。
- en: Like in the previous chapter, you must have access to an Azure account to complete
    the steps in this chapter; if you don’t have one, you can create a free one at
    [https://azure.microsoft.com/en-us/free/](https://azure.microsoft.com/en-us/free/).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 和上一章一样，您必须拥有一个 Azure 账户才能完成本章中的步骤；如果您没有账户，可以在[https://azure.microsoft.com/en-us/free/](https://azure.microsoft.com/en-us/free/)创建一个免费的账户。
- en: That’s it for the technical requirements; now, let’s get started with this chapter.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 技术要求部分就到这里；现在我们开始本章内容。
- en: Getting started
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入门
- en: The first thing you must do is import the sample repository; let’s get to it.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 首先您需要做的是导入示例仓库；我们来开始吧。
- en: Importing the sample repository
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 导入示例仓库
- en: You will need to import the application and IaC sources from GitHub for this
    book, to be able to complete the end-to-end pipelines in this chapter and the
    next.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要从 GitHub 导入本书所用的应用程序和 IaC 源代码，以便能够完成本章和下一章的端到端流水线。
- en: 'You can do this from the **Azure Repos** | **Files** section in the navigation
    menu, clicking on the repository dropdown on the top part of the screen and then
    clicking on the **Import repository** option, as shown in the following screenshot:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以从**Azure Repos** | **文件**部分开始操作，在屏幕顶部的仓库下拉菜单中点击，然后选择**导入仓库**选项，具体操作如截图所示：
- en: '![Figure 9.1 – Import repository](img/B18875_09_1.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.1 – 导入仓库](img/B18875_09_1.jpg)'
- en: Figure 9.1 – Import repository
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.1 – 导入仓库
- en: 'Enter [https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines.git](https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines.git)
    in the `Implementing-CI-CD-Using-Azure-Pipeline` in the **Name** field, and then
    hit the **Import** button:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在**名称**字段中输入[https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines.git](https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines.git)，然后点击**导入**按钮：
- en: '![Figure 9.2 – Importing the sample repository](img/B18875_09_2.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.2 – 导入示例仓库](img/B18875_09_2.jpg)'
- en: Figure 9.2 – Importing the sample repository
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.2 – 导入示例仓库
- en: After a few minutes, the process will be complete, and then you will be able
    to browse all the code in the repository. Everything you need will be in the `e2e`
    directory.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 几分钟后，流程将完成，您将能够浏览仓库中的所有代码。您所需的一切都将在`e2e`目录中。
- en: With the repository imported, let’s understand the sample architecture.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 导入仓库后，我们来了解一下示例架构。
- en: Introducing the solution architecture
  id: totrans-29
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 介绍解决方案架构
- en: 'For our sample architecture, you will use a fictitious Packt store made up
    of four different applications, which represents a complex distributed architecture
    where teams working with different programming languages can use different Azure
    platform services to deliver their capabilities:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的示例架构，您将使用一个虚构的Packt商店，由四个不同的应用程序组成，代表了一个复杂的分布式架构，在这个架构中，使用不同编程语言的团队可以利用不同的Azure平台服务来交付他们的功能。
- en: An Angular frontend application, the user interface of the store
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Angular前端应用程序，即商店的用户界面。
- en: A Python product catalog service, implemented as a REST API
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Python产品目录服务，作为REST API实现。
- en: A Node.js shopping cart service, implemented as a REST API
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个Node.js购物车服务，作为REST API实现。
- en: An ASP.NET checkout service, implemented as a REST API
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个ASP.NET结账服务，作为REST API实现。
- en: 'The following solution diagram depicts how an environment for the web store
    looks, where each of the applications independently runs in a different Azure
    service:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 以下解决方案图展示了一个网络商店的环境，其中每个应用程序独立地运行在不同的Azure服务中：
- en: '![Figure 9.3 – The solution diagram](img/B18875_09_3.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.3 – 解决方案图](img/B18875_09_3.jpg)'
- en: Figure 9.3 – The solution diagram
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.3 – 解决方案图
- en: 'Later in the chapter, you will implement the Azure Pipeline with the following
    steps for each application:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章稍后部分，您将为每个应用程序实施Azure Pipeline，步骤如下：
- en: Build and package the application and its corresponding IaC.
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 构建和打包应用程序及其相应的IaC。
- en: Deploy them to a test environment.
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将它们部署到测试环境中。
- en: Deploy them to a production environment, including a manual approval check.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将它们部署到生产环境中，包括手动审批检查。
- en: 'The following diagram depicts the CI/CD process:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图示展示了CI/CD过程：
- en: '![Figure 9.4 – The CI/CD end-to-end process](img/B18875_09_4.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.4 – CI/CD端到端过程](img/B18875_09_4.jpg)'
- en: Figure 9.4 – The CI/CD end-to-end process
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.4 – CI/CD端到端过程
- en: Important note
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: During this chapter, no details about the code in the applications will be covered,
    as that is not relevant to CI/CD. We will focus instead on the Azure Pipelines
    details needed to make the CI/CD process work.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，应用程序中的代码细节将不会涉及，因为那与CI/CD无关。我们将重点介绍使CI/CD过程正常运行所需的Azure Pipelines的细节。
- en: 'To implement the CI/CD process, you will be take advantage of multi-stage pipelines
    with environments and templates:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现CI/CD过程，您将利用具有环境和模板的多阶段流水线：
- en: '**Stages** allow us to encapsulate all the jobs that need to happen together
    in a logical way and control dependencies, but they also provide the ability to
    execute jobs in parallel; this will help us reduce the total time when needed'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**阶段**允许我们以逻辑方式封装所有需要一起发生的工作，并控制依赖关系，同时还提供并行执行工作的能力；这将帮助我们在需要时减少总时间。'
- en: '**Environments** are linked to jobs and allow us to add additional controls,
    such as manual approval in this case, to ensure that the deployment proceeds to
    production only when a human intervenes and approves it'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**环境**与作业相关联，并允许我们添加额外的控制，例如本例中的手动审批，以确保部署只有在人工干预并批准后才会继续到生产环境。'
- en: '**Templates** were introduced in [*Chapter 1*](B18875_01.xhtml#_idTextAnchor014);
    here, you will put them into practice to demonstrate how to use them, to build
    modular and reusable pipelines'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**模板**在[*第1章*](B18875_01.xhtml#_idTextAnchor014)中介绍；在这里，您将实践它们，展示如何使用模板来构建模块化和可重用的流水线。'
- en: 'Let’s look at the following pipeline definition; create this file in `ch09/azure/azure-pipeline.yml`,
    inside the `Implementing-CI-CD-Using-Azure-Pipeline` repository you imported:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一下以下流水线定义；在您导入的`Implementing-CI-CD-Using-Azure-Pipeline`仓库中的`ch09/azure/azure-pipeline.yml`文件中创建此文件：
- en: '[PRE0]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Let’s break this code down:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们分解这段代码：
- en: The `build` stage has no dependencies and includes jobs from templates in the
    `build-apps.yml` and `build-iac.yml` files. You will review these later in the
    *Building and packaging applications and* *IaC* section.
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`build`阶段没有依赖关系，包含来自`build-apps.yml`和`build-iac.yml`文件的模板中的工作。稍后您将在*构建和打包应用程序和*
    *基础设施即代码（IaC）*部分中查看这些内容。'
- en: The `deployTest` stage must wait for the build stage to complete and will run
    the jobs in the `deploy.yml` template, passing a parameter of `envName` with the
    `test` value to uniquely identify this environment.
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`deployTest`阶段必须等待构建阶段完成，并将运行`deploy.yml`模板中的作业，传递一个`envName`参数，其值为`test`，以唯一标识此环境。'
- en: The `deployProduction` stage, in turn, waits for the `deployTest` stage to complete
    and uses the same `deploy.yml` template, passing a value of production for the
    `envName` parameter.
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`deployProduction` 阶段会等待 `deployTest` 阶段完成，并使用相同的 `deploy.yml` 模板，传递一个名为 `envName`
    的生产环境值。'
- en: This pipeline definition demonstrates the flexibility of templates and the ability
    to break into smaller portions the work that needs to be done, which provides
    a way for teams to focus on different stages of the pipeline, based on their responsibilities.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 该管道定义展示了模板的灵活性，以及将需要执行的工作拆分成更小部分的能力，这为团队根据其责任专注于管道的不同阶段提供了一种方式。
- en: Once the file is in the repository, add it as a new pipeline and rename it `E2E-Azure`.
    You will have to add some security configuration for everything to ultimately
    work.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 文件添加到仓库后，作为新管道添加并将其重命名为 `E2E-Azure`。为了使一切顺利运行，您还需要添加一些安全配置。
- en: 'If you have not renamed a pipeline before, click on the sub-menu on the far-right
    side of the **Recently run pipelines** screen, as shown in the following screenshot,
    and rename it:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您之前没有重命名过管道，请点击 **最近运行的管道** 屏幕右侧的子菜单，如下图所示，然后重命名它：
- en: '![Figure 9.5 – Renaming a pipeline](img/B18875_09_5.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![图 9.5 – 重命名管道](img/B18875_09_5.jpg)'
- en: Figure 9.5 – Renaming a pipeline
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 9.5 – 重命名管道
- en: A pro tip about templates
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 关于模板的小贴士
- en: When using `job.template` to reference a template defined in another file, make
    sure to create that file with at least one step defined in it before referencing
    it from the parent template. An easy way to accomplish this is to use a `script`
    task that runs an `echo` command, such as `echo hello`.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用 `job.template` 引用另一个文件中定义的模板时，请确保在引用该模板之前先创建该文件，并在文件中至少定义一个步骤。一个简单的实现方法是使用
    `script` 任务运行 `echo` 命令，例如 `echo hello`。
- en: Let’s now move on to the build stage.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们进入构建阶段。
- en: Building and packaging applications and IaC
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建和打包应用程序以及基础设施即代码（IaC）
- en: The applications in this solution are all container-enabled, a standard packaging
    mechanism that includes all operating system dependencies to allow them to run
    in many different hosting environments, making them extremely lightweight and
    portable.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 该解决方案中的所有应用程序都支持容器化，这是一个标准的打包机制，包含所有操作系统依赖项，以使它们能够在多种不同的托管环境中运行，使得它们非常轻量且易于移植。
- en: For simplicity, the repository includes a `docker-compose.yml` file, which facilitates
    working with applications made of multiple services that must run at the same
    time.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化，仓库中包含一个 `docker-compose.yml` 文件，该文件便于处理由多个服务组成且必须同时运行的应用程序。
- en: This file defines the services and the location of their corresponding `Dockerfile`,
    the file that defines how the container must be built, and several other things,
    such as the ports or environment variables needed for the container to run.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 该文件定义了服务以及它们对应的 `Dockerfile` 的位置，`Dockerfile` 文件定义了容器的构建方式，以及其他一些内容，例如容器运行所需的端口或环境变量。
- en: In this chapter, the `SUB_ID` placeholder is the ID of the Azure subscription
    you have access to; make sure to replace it when appropriate.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，`SUB_ID` 占位符是您可以访问的 Azure 订阅的 ID；请在适当的时候替换它。
- en: 'Before you can proceed, you must have an **Azure Container Registry** available
    for the pipeline to store the container images. You can create one easily with
    the following Azure CLI command:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，您必须拥有一个可用的 **Azure 容器注册表**，供管道存储容器镜像。您可以使用以下 Azure CLI 命令轻松创建一个：
- en: '[PRE1]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We will also need to ensure that the service principal we created previously
    in the *Creating a service connection to AWS* section of [*Chapter 8*](B18875_08.xhtml#_idTextAnchor103)
    has permissions to manage user access to this service; you can do this with the
    following commands in the PowerShell window:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还需要确保我们在 [*第 8 章*](B18875_08.xhtml#_idTextAnchor103) 中 *创建 AWS 服务连接* 部分创建的服务主体具有管理此服务的用户访问权限；您可以通过在
    PowerShell 窗口中运行以下命令来实现：
- en: '[PRE2]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'parameters:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 'parameters:'
- en: '- name: azureSubscription'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '- name: azureSubscription'
- en: 'type: string'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 'type: string'
- en: 'default: ''azure-packt-rg'''
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 'default: ''azure-packt-rg'''
- en: '- name: azureContainerRegistry'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: '- name: azureContainerRegistry'
- en: 'type: string'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 'type: string'
- en: 'default: ''{"loginServer":"packtadocicd.azurecr.io", "id" : "/subscriptions/SUB_ID/resourceGroups/packt/providers/Microsoft.ContainerRegistry/registries/packtadocicd"}'''
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 'default: ''{"loginServer":"packtadocicd.azurecr.io", "id" : "/subscriptions/SUB_ID/resourceGroups/packt/providers/Microsoft.ContainerRegistry/registries/packtadocicd"}'''
- en: 'jobs:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 'jobs:'
- en: '- job: BuildAndPushContainers'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '- job: BuildAndPushContainers'
- en: 'displayName: Build and Push Containers'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: 构建并推送容器'
- en: 'steps:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 'steps:'
- en: '- task: DockerCompose@0'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: '- task: DockerCompose@0'
- en: 'displayName: ''Build Containers'''
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''构建容器'''
- en: 'inputs:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'containerregistrytype: ''Azure Container Registry'''
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 'containerregistrytype: ''Azure 容器注册表'''
- en: 'azureSubscription: ${{parameters.azureSubscription}}'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{parameters.azureSubscription}}'
- en: 'azureContainerRegistry: ${{parameters.azureContainerRegistry}}'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureContainerRegistry: ${{parameters.azureContainerRegistry}}'
- en: 'dockerComposeFile: ''docker-compose.yml'''
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 'dockerComposeFile: ''docker-compose.yml'''
- en: 'projectName: ''packt-store'''
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 'projectName: ''packt-store'''
- en: 'action: ''Build services'''
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 'action: ''构建服务'''
- en: 'additionalImageTags: ''$(Build.BuildNumber)'''
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 'additionalImageTags: ''$(Build.BuildNumber)'''
- en: 'includeLatestTag: true'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 'includeLatestTag: true'
- en: '[PRE3]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '- task: DockerCompose@0'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '- task: DockerCompose@0'
- en: 'displayName: ''Push Containers'''
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''推送容器'''
- en: 'inputs:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'containerregistrytype: ''Azure Container Registry'''
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 'containerregistrytype: ''Azure 容器注册表'''
- en: 'azureSubscription: ${{parameters.azureSubscription}}'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{parameters.azureSubscription}}'
- en: 'azureContainerRegistry: ${{parameters.azureContainerRegistry}}'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureContainerRegistry: ${{parameters.azureContainerRegistry}}'
- en: 'dockerComposeFile: ''docker-compose.yml'''
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 'dockerComposeFile: ''docker-compose.yml'''
- en: 'projectName: ''packt-store'''
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 'projectName: ''packt-store'''
- en: 'action: ''Push services'''
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 'action: ''推送服务'''
- en: 'additionalImageTags: ''$(Build.BuildNumber)'''
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 'additionalImageTags: ''$(Build.BuildNumber)'''
- en: 'includeLatestTag: true'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 'includeLatestTag: true'
- en: '[PRE4]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'name: $(Date:yyyyMMdd).$(Rev:r)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 'name: $(Date:yyyyMMdd).$(Rev:r)'
- en: '[PRE5]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'name: 1.0.$(Rev:r)'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 'name: 1.0.$(Rev:r)'
- en: '[PRE6]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'parameters:'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'parameters:'
- en: '- name: azureSubscription'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- name: azureSubscription'
- en: 'type: string'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'type: string'
- en: 'default: ''azure-packt-rg'''
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'default: ''azure-packt-rg'''
- en: '- name: resourceGroupName'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- name: resourceGroupName'
- en: 'type: string'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'type: string'
- en: 'default: ''packt'''
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'default: ''packt'''
- en: '- name: location'
  id: totrans-120
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- name: location'
- en: 'type: string'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'type: string'
- en: 'default: ''East US'''
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'default: ''东部美国'''
- en: '[PRE7]'
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'jobs:'
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'jobs:'
- en: '- job: VerifyAndPackageIaC'
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- job: VerifyAndPackageIaC'
- en: 'displayName: Verify and Package IaC'
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: 验证和打包基础设施即代码 (IaC)'
- en: 'steps:'
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'steps:'
- en: '[PRE8]'
  id: totrans-128
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '- task: AzureResourceManagerTemplateDeployment@3'
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: AzureResourceManagerTemplateDeployment@3'
- en: 'displayName: ''Validate Catalog Template'''
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''验证目录模板'''
- en: 'inputs:'
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'deploymentScope: ''Resource Group'''
  id: totrans-132
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'deploymentScope: ''资源组'''
- en: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
- en: 'resourceGroupName: ${{parameters.resourceGroupName}}'
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{parameters.resourceGroupName}}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'templateLocation: ''关联的构件'''
- en: 'csmFile: ''e2e/iac/azure/catalog/template.json'''
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csmFile: ''e2e/iac/azure/catalog/template.json'''
- en: 'deploymentMode: ''Validation'''
  id: totrans-137
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'deploymentMode: ''验证'''
- en: 'location: ${{parameters.location}}'
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'location: ${{parameters.location}}'
- en: '- task: PublishPipelineArtifact@1'
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: PublishPipelineArtifact@1'
- en: 'displayName: ''Publish Catalog Artifacts'''
  id: totrans-140
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''发布目录构件'''
- en: 'inputs:'
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetPath: ''e2e/iac/azure/catalog'''
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'targetPath: ''e2e/iac/azure/catalog'''
- en: 'artifact: catalog-iac'
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'artifact: catalog-iac'
- en: 'publishLocation: ''pipeline'''
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'publishLocation: ''管道'''
- en: '[PRE9]'
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '- script: |'
  id: totrans-146
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- script: |'
- en: docker run --rm -v $(pwd):/manifests stackrox/kube-linter lint /manifests --config
    /manifests/.kube-linter.yml
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: docker run --rm -v $(pwd):/manifests stackrox/kube-linter lint /manifests --config
    /manifests/.kube-linter.yml
- en: 'displayName: ''Lint Catalog Helm Chart'''
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''Lint 目录 Helm 图表'''
- en: 'workingDirectory: e2e/iac/helm-charts/catalog'
  id: totrans-149
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'workingDirectory: e2e/iac/helm-charts/catalog'
- en: '- task: HelmInstaller@1'
  id: totrans-150
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: HelmInstaller@1'
- en: 'displayName: ''Install Helm'''
  id: totrans-151
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''安装 Helm'''
- en: '- task: HelmDeploy@0'
  id: totrans-152
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: HelmDeploy@0'
- en: 'displayName: ''Package Catalog Helm Chart'''
  id: totrans-153
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''打包目录 Helm 图表'''
- en: 'inputs:'
  id: totrans-154
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'command: package'
  id: totrans-155
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'command: package'
- en: 'chartPath: e2e/iac/helm-charts/catalog'
  id: totrans-156
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'chartPath: e2e/iac/helm-charts/catalog'
- en: 'destination: $(Build.ArtifactStagingDirectory)'
  id: totrans-157
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'destination: $(Build.ArtifactStagingDirectory)'
- en: '- task: PublishPipelineArtifact@1'
  id: totrans-158
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: PublishPipelineArtifact@1'
- en: 'displayName: ''Publish Catalog Helm Chart'''
  id: totrans-159
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''发布目录 Helm 图表'''
- en: 'inputs:'
  id: totrans-160
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetPath: $(Build.ArtifactStagingDirectory)'
  id: totrans-161
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'targetPath: $(Build.ArtifactStagingDirectory)'
- en: 'artifact: catalog-helm-chart'
  id: totrans-162
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'artifact: catalog-helm-chart'
- en: 'publishLocation: ''pipeline'''
  id: totrans-163
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'publishLocation: ''管道'''
- en: '[PRE10]'
  id: totrans-164
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '- task: AzureResourceManagerTemplateDeployment@3'
  id: totrans-165
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: AzureResourceManagerTemplateDeployment@3'
- en: 'displayName: ''Validate Cart Template'''
  id: totrans-166
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''验证购物车模板'''
- en: 'inputs:'
  id: totrans-167
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'deploymentScope: ''Resource Group'''
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'deploymentScope: ''资源组'''
- en: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
  id: totrans-169
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
- en: 'resourceGroupName: ${{parameters.resourceGroupName}}'
  id: totrans-170
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{parameters.resourceGroupName}}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-171
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'templateLocation: ''关联的构件'''
- en: 'csmFile: ''e2e/iac/azure/cart/template.json'''
  id: totrans-172
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csmFile: ''e2e/iac/azure/cart/template.json'''
- en: 'deploymentMode: ''Validation'''
  id: totrans-173
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'deploymentMode: ''验证'''
- en: 'location: ${{parameters.location}}'
  id: totrans-174
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'location: ${{parameters.location}}'
- en: '- task: PublishPipelineArtifact@1'
  id: totrans-175
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: PublishPipelineArtifact@1'
- en: 'displayName: ''Publish Cart Artifacts'''
  id: totrans-176
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''发布购物车构件'''
- en: 'inputs:'
  id: totrans-177
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetPath: ''e2e/iac/azure/cart'''
  id: totrans-178
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'targetPath: ''e2e/iac/azure/cart'''
- en: 'artifact: cart-iac'
  id: totrans-179
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'artifact: cart-iac'
- en: 'publishLocation: ''pipeline'''
  id: totrans-180
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'publishLocation: ''管道'''
- en: '[PRE11]'
  id: totrans-181
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '- task: AzureResourceManagerTemplateDeployment@3'
  id: totrans-182
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: AzureResourceManagerTemplateDeployment@3'
- en: 'displayName: ''Validate Checkout Template'''
  id: totrans-183
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''验证结账模板'''
- en: 'inputs:'
  id: totrans-184
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'deploymentScope: ''Resource Group'''
  id: totrans-185
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'deploymentScope: ''资源组'''
- en: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
  id: totrans-186
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
- en: 'resourceGroupName: ${{parameters.resourceGroupName}}'
  id: totrans-187
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{parameters.resourceGroupName}}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-188
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '模板位置: ''链接的工件'''
- en: 'csmFile: ''e2e/iac/azure/checkout/template.json'''
  id: totrans-189
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csm文件: ''e2e/iac/azure/checkout/template.json'''
- en: 'deploymentMode: ''Validation'''
  id: totrans-190
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署模式: ''验证'''
- en: 'location: ${{parameters.location}}'
  id: totrans-191
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '位置: ${{parameters.location}}'
- en: '- task: PublishPipelineArtifact@1'
  id: totrans-192
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: PublishPipelineArtifact@1'
- en: 'displayName: ''Publish Checkout Artifacts'''
  id: totrans-193
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''发布结账工件'''
- en: 'inputs:'
  id: totrans-194
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetPath: ''e2e/iac/azure/checkout'''
  id: totrans-195
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '目标路径: ''e2e/iac/azure/checkout'''
- en: 'artifact: checkout-iac'
  id: totrans-196
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '工件: checkout-iac'
- en: 'publishLocation: ''pipeline'''
  id: totrans-197
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '发布位置: ''管道'''
- en: '[PRE12]'
  id: totrans-198
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '- task: AzureResourceManagerTemplateDeployment@3'
  id: totrans-199
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: AzureResourceManagerTemplateDeployment@3'
- en: 'displayName: ''Validate Frontend Template'''
  id: totrans-200
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''验证前端模板'''
- en: 'inputs:'
  id: totrans-201
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'deploymentScope: ''Resource Group'''
  id: totrans-202
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署范围: ''资源组'''
- en: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
  id: totrans-203
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureResourceManagerConnection: ${{parameters.azureSubscription}}'
- en: 'resourceGroupName: ${{parameters.resourceGroupName}}'
  id: totrans-204
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{parameters.resourceGroupName}}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-205
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '模板位置: ''链接的工件'''
- en: 'csmFile: ''e2e/iac/azure/frontend/template.json'''
  id: totrans-206
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csm文件: ''e2e/iac/azure/frontend/template.json'''
- en: 'deploymentMode: ''Validation'''
  id: totrans-207
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署模式: ''验证'''
- en: 'location: ${{parameters.location}}'
  id: totrans-208
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '位置: ${{parameters.location}}'
- en: 'overrideParameters: ''-catalogAppUrl catalogAppUrl.com -cartAppUrl cartAppUrl.com
    -checkoutAppUrl checkoutAppUrl.com'''
  id: totrans-209
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '覆盖参数: ''-catalogAppUrl catalogAppUrl.com -cartAppUrl cartAppUrl.com -checkoutAppUrl
    checkoutAppUrl.com'''
- en: '- task: PublishPipelineArtifact@1'
  id: totrans-210
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: PublishPipelineArtifact@1'
- en: 'displayName: ''Publish Frontend Artifacts'''
  id: totrans-211
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''发布前端工件'''
- en: 'inputs:'
  id: totrans-212
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetPath: ''e2e/iac/azure/frontend'''
  id: totrans-213
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '目标路径: ''e2e/iac/azure/frontend'''
- en: 'artifact: frontend-iac'
  id: totrans-214
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '工件: frontend-iac'
- en: 'publishLocation: ''pipeline'''
  id: totrans-215
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '发布位置: ''管道'''
- en: '[PRE13]'
  id: totrans-216
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'parameters:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: '参数:'
- en: '- name: envName'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: '- 名称: envName'
- en: 'type: string'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: '类型: 字符串'
- en: 'default: ''test'''
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: '默认值: ''test'''
- en: '- name: azureSubscription'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: '- 名称: azureSubscription'
- en: 'type: string'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '类型: 字符串'
- en: 'default: ''azure-packt-rg'''
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: '默认值: ''azure-packt-rg'''
- en: '- name: resourceGroupName'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '- 名称: resourceGroupName'
- en: 'type: string'
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: '类型: 字符串'
- en: 'default: ''packt'''
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: '默认值: ''packt'''
- en: '- name: location'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: '- 名称: 位置'
- en: 'type: string'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: '类型: 字符串'
- en: 'default: ''East US'''
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: '默认值: ''东部美国'''
- en: 'jobs:'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '作业:'
- en: '- deployment: deployment_${{ parameters.envName }}'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '- 部署: deployment_${{ parameters.envName }}'
- en: 'displayName: Deploy to ${{ parameters.envName }}'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: '显示名称: 部署到 ${{ parameters.envName }}'
- en: 'environment: ${{ parameters.envName }}'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: '环境: ${{ parameters.envName }}'
- en: 'strategy:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: '策略:'
- en: 'runOnce:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: '运行一次:'
- en: 'deploy:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: '部署:'
- en: 'steps:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: '步骤:'
- en: '[PRE14]'
  id: totrans-238
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '- download: current'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 下载: 当前'
- en: 'displayName: ''Download catalog iac'''
  id: totrans-240
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''下载目录 iac'''
- en: 'artifact: catalog-iac'
  id: totrans-241
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '工件: catalog-iac'
- en: '[PRE15]'
  id: totrans-242
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '- task: AzureResourceGroupDeployment@2'
  id: totrans-243
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: AzureResourceGroupDeployment@2'
- en: 'name: catalogInfra'
  id: totrans-244
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '名称: catalogInfra'
- en: 'displayName: ''Deploy catalog Infra'''
  id: totrans-245
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''部署目录基础设施'''
- en: 'inputs:'
  id: totrans-246
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'azureSubscription: ${{ parameters.azureSubscription }}'
  id: totrans-247
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{ parameters.azureSubscription }}'
- en: 'action: ''Create Or Update Resource Group'''
  id: totrans-248
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '动作: ''创建或更新资源组'''
- en: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
  id: totrans-249
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
- en: 'location: ${{ parameters.location }}'
  id: totrans-250
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '位置: ${{ parameters.location }}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-251
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '模板位置: ''链接的工件'''
- en: 'csmFile: ''$(Pipeline.Workspace)/catalog-iac/template.json'''
  id: totrans-252
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csm文件: ''$(Pipeline.Workspace)/catalog-iac/template.json'''
- en: 'overrideParameters: ''-environmentName ${{ parameters.envName }}'''
  id: totrans-253
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '覆盖参数: ''-environmentName ${{ parameters.envName }}'''
- en: 'deploymentMode: ''Incremental'''
  id: totrans-254
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署模式: ''增量'''
- en: 'deploymentName: ''catalog-$(Build.BuildNumber)'''
  id: totrans-255
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署名称: ''catalog-$(Build.BuildNumber)'''
- en: 'deploymentOutputs: ''catalogInfraOutputs'''
  id: totrans-256
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署输出: ''catalogInfraOutputs'''
- en: '[PRE16]'
  id: totrans-257
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '- task: PowerShell@2'
  id: totrans-258
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: PowerShell@2'
- en: 'displayName: ''Get AKS clusterName'''
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''获取 AKS 集群名称'''
- en: 'inputs:'
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetType: ''inline'''
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '目标类型: ''内联'''
- en: 'script: |'
  id: totrans-262
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '脚本: |'
- en: $var=ConvertFrom-Json '$(catalogInfraOutputs)'
  id: totrans-263
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $var=ConvertFrom-Json '$(catalogInfraOutputs)'
- en: $value=$var.clusterName.value
  id: totrans-264
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value=$var.clusterName.value
- en: 'Write-Host "AKS Cluster Name: $value"'
  id: totrans-265
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Write-Host "AKS 集群名称: $value"'
- en: Write-Host "##vso[task.setvariable variable=clusterName;]$value"
  id: totrans-266
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Write-Host "##vso[task.setvariable variable=clusterName;]$value"
- en: '[PRE17]'
  id: totrans-267
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '- download: current'
  id: totrans-268
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 下载: 当前'
- en: 'displayName: ''Download catalog helm chart'''
  id: totrans-269
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''下载目录 Helm 图表'''
- en: 'artifact: catalog-helm-chart'
  id: totrans-270
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '工件: catalog-helm-chart'
- en: '[PRE18]'
  id: totrans-271
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '- task: HelmInstaller@1'
  id: totrans-272
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: HelmInstaller@1'
- en: 'displayName: ''Install Helm'''
  id: totrans-273
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''安装 Helm'''
- en: 'inputs:'
  id: totrans-274
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'helmVersionToInstall: 3.11.3'
  id: totrans-275
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '要安装的 Helm 版本: 3.11.3'
- en: '[PRE19]'
  id: totrans-276
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '- task: HelmDeploy@0'
  id: totrans-277
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: HelmDeploy@0'
- en: 'displayName: Deploy Catalog App to AKS'
  id: totrans-278
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: 将目录应用部署到 AKS'
- en: 'inputs:'
  id: totrans-279
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'connectionType: ''Azure Resource Manager'''
  id: totrans-280
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '连接类型: ''Azure 资源管理器'''
- en: 'azureSubscription: ${{ parameters.azureSubscription }}'
  id: totrans-281
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{ parameters.azureSubscription }}'
- en: 'azureResourceGroup: ${{ parameters.resourceGroupName }}'
  id: totrans-282
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureResourceGroup: ${{ parameters.resourceGroupName }}'
- en: 'kubernetesCluster: $(clusterName)'
  id: totrans-283
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'kubernetesCluster: $(clusterName)'
- en: 'releaseName: catalog'
  id: totrans-284
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '发布名称: catalog'
- en: 'chartType: FilePath'
  id: totrans-285
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图表类型: 文件路径'
- en: 'chartPath: "$(Pipeline.Workspace)/catalog-helm-chart/packt-store-catalog-1.0.0.tgz"'
  id: totrans-286
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '图表路径: "$(Pipeline.Workspace)/catalog-helm-chart/packt-store-catalog-1.0.0.tgz"'
- en: 'overrideValues: ''image.tag=$(Build.BuildNumber)'''
  id: totrans-287
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '覆盖值: ''image.tag=$(Build.BuildNumber)'''
- en: 'command: upgrade'
  id: totrans-288
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'command: upgrade'
- en: 'install: true'
  id: totrans-289
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'install: true'
- en: 'waitForExecution: true'
  id: totrans-290
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'waitForExecution: true'
- en: '"##vso[task.setvariable variable=name;]value"'
  id: totrans-291
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '"##vso[task.setvariable variable=name;]value"'
- en: '[PRE20]'
  id: totrans-292
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE20]'
- en: '- download: current'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '- download: current'
- en: 'displayName: ''Download cart iac'''
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''下载购物车 iac'''
- en: 'artifact: cart-iac'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 'artifact: cart-iac'
- en: '- task: AzureResourceGroupDeployment@2'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: '- task: AzureResourceGroupDeployment@2'
- en: 'name: cartInfra'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 'name: cartInfra'
- en: 'displayName: ''Deploy cart Infra'''
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''部署购物车基础设施'''
- en: 'inputs:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'azureSubscription: ${{ parameters.azureSubscription }}'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{ parameters.azureSubscription }}'
- en: 'action: ''Create Or Update Resource Group'''
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 'action: ''创建或更新资源组'''
- en: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
- en: 'location: ${{ parameters.location }}'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 'location: ${{ parameters.location }}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 'templateLocation: ''链接的工件'''
- en: 'csmFile: ''$(Pipeline.Workspace)/cart-iac/template.json'''
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 'csmFile: ''$(Pipeline.Workspace)/cart-iac/template.json'''
- en: 'overrideParameters: ''-environmentName ${{ parameters.envName }} -containerTag
    "$(Build.BuildNumber)"'''
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 'overrideParameters: ''-environmentName ${{ parameters.envName }} -containerTag
    "$(Build.BuildNumber)"'''
- en: 'deploymentMode: ''Incremental'''
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentMode: ''增量'''
- en: 'deploymentName: ''cart-$(Build.BuildNumber)'''
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentName: ''cart-$(Build.BuildNumber)'''
- en: 'deploymentOutputs: ''cartInfraOutputs'''
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentOutputs: ''cartInfraOutputs'''
- en: '[PRE21]'
  id: totrans-310
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: '- download: current'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '- download: current'
- en: 'displayName: ''Download checkout iac'''
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''下载结账 iac'''
- en: 'artifact: checkout-iac'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 'artifact: checkout-iac'
- en: '- task: AzureResourceGroupDeployment@2'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: '- task: AzureResourceGroupDeployment@2'
- en: 'name: checkoutInfra'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 'name: checkoutInfra'
- en: 'displayName: ''Deploy checkout Infra'''
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 'displayName: ''部署结账基础设施'''
- en: 'inputs:'
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'azureSubscription: ${{ parameters.azureSubscription }}'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{ parameters.azureSubscription }}'
- en: 'action: ''Create Or Update Resource Group'''
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 'action: ''创建或更新资源组'''
- en: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
- en: 'location: ${{ parameters.location }}'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 'location: ${{ parameters.location }}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
  zh: 'templateLocation: ''链接的工件'''
- en: 'csmFile: ''$(Pipeline.Workspace)/checkout-iac/template.json'''
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 'csmFile: ''$(Pipeline.Workspace)/checkout-iac/template.json'''
- en: 'overrideParameters: ''-environmentName ${{ parameters.envName }} -containerTag
    "$(Build.BuildNumber)"'''
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 'overrideParameters: ''-environmentName ${{ parameters.envName }} -containerTag
    "$(Build.BuildNumber)"'''
- en: 'deploymentMode: ''Incremental'''
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentMode: ''增量'''
- en: 'deploymentName: ''checkout-$(Build.BuildNumber)'''
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentName: ''checkout-$(Build.BuildNumber)'''
- en: 'deploymentOutputs: ''checkoutInfraOutputs'''
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 'deploymentOutputs: ''checkoutInfraOutputs'''
- en: '[PRE22]'
  id: totrans-328
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '- download: current'
  id: totrans-329
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- download: current'
- en: 'displayName: ''Download frontend iac'''
  id: totrans-330
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''下载前端 iac'''
- en: 'artifact: frontend-iac'
  id: totrans-331
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'artifact: frontend-iac'
- en: '[PRE23]'
  id: totrans-332
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '- task: AzureCLI@2'
  id: totrans-333
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: AzureCLI@2'
- en: 'displayName: ''Get Catalog App IP from AKS'''
  id: totrans-334
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''从 AKS 获取目录应用程序 IP'''
- en: 'inputs:'
  id: totrans-335
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'azureSubscription: ''azure-packt-rg'''
  id: totrans-336
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureSubscription: ''azure-packt-rg'''
- en: 'scriptType: ''bash'''
  id: totrans-337
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'scriptType: ''bash'''
- en: 'scriptLocation: ''inlineScript'''
  id: totrans-338
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'scriptLocation: ''inlineScript'''
- en: 'inlineScript: |'
  id: totrans-339
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inlineScript: |'
- en: az aks get-credentials -g ${{ parameters.resourceGroupName }} -n $(clusterName)
    --overwrite-existing
  id: totrans-340
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: az aks get-credentials -g ${{ parameters.resourceGroupName }} -n $(clusterName)
    --overwrite-existing
- en: ip=`kubectl get service catalog-packt-store-catalog -o json | jq ".status.loadBalancer.ingress[0].ip"`
  id: totrans-341
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ip=`kubectl get service catalog-packt-store-catalog -o json | jq ".status.loadBalancer.ingress[0].ip"`
- en: 'echo "Catalog App IP: $ip"'
  id: totrans-342
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'echo "目录应用程序 IP: $ip"'
- en: echo «##vso[task.setvariable variable=catalogAppIp;]$ip"
  id: totrans-343
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: echo «##vso[task.setvariable variable=catalogAppIp;]$ip"
- en: '[PRE24]'
  id: totrans-344
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '- task: PowerShell@2'
  id: totrans-345
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: PowerShell@2'
- en: 'displayName: ''Set App URLs'''
  id: totrans-346
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''设置应用程序 URL'''
- en: 'inputs:'
  id: totrans-347
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'targetType: ''inline'''
  id: totrans-348
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'targetType: ''inline'''
- en: 'script: |'
  id: totrans-349
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'script: |'
- en: '# Set the catalog app url'
  id: totrans-350
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '# 设置目录应用程序 URL'
- en: $value="http://" + $(catalogAppIp) + ":5050/"
  id: totrans-351
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value="http://" + $(catalogAppIp) + ":5050/"
- en: 'Write-Host "Catalog App Url: $value"'
  id: totrans-352
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Write-Host "目录应用程序 URL: $value"'
- en: Write-Host "##vso[task.setvariable variable=catalogAppUrl;]$value"
  id: totrans-353
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Write-Host "##vso[task.setvariable variable=catalogAppUrl;]$value"
- en: '# Set the cart app url'
  id: totrans-354
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '# 设置购物车应用程序 URL'
- en: $var=ConvertFrom-Json '$(cartInfraOutputs)'
  id: totrans-355
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $var=ConvertFrom-Json '$(cartInfraOutputs)'
- en: $value=$var.containerAppFqdn.value
  id: totrans-356
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value=$var.containerAppFqdn.value
- en: $value="https://" + $var.containerAppFqdn.value + "/"
  id: totrans-357
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value="https://" + $var.containerAppFqdn.value + "/"
- en: 'Write-Host "Cart App Url: $value"'
  id: totrans-358
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Write-Host "购物车应用程序 URL: $value"'
- en: Write-Host "##vso[task.setvariable variable=cartAppUrl;]$value"
  id: totrans-359
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Write-Host "##vso[task.setvariable variable=cartAppUrl;]$value"
- en: '# Set the checkout app url'
  id: totrans-360
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '# 设置结账应用程序 URL'
- en: $var=ConvertFrom-Json '$(checkoutInfraOutputs)'
  id: totrans-361
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $var=ConvertFrom-Json '$(checkoutInfraOutputs)'
- en: $value="http://" + $var.containerFQDN.value + ":5015/"
  id: totrans-362
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value="http://" + $var.containerFQDN.value + ":5015/"
- en: 'Write-Host "Checkout App Url: $value"'
  id: totrans-363
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Write-Host "结账应用程序 URL: $value"'
- en: Write-Host "##vso[task.setvariable variable=checkoutAppUrl;]$value"
  id: totrans-364
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Write-Host "##vso[task.setvariable variable=checkoutAppUrl;]$value"
- en: '[PRE25]'
  id: totrans-365
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '- task: AzureResourceGroupDeployment@2'
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- task: AzureResourceGroupDeployment@2'
- en: 'name: frontendInfra'
  id: totrans-367
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'name: frontendInfra'
- en: 'displayName: ''Deploy frontend Infra'''
  id: totrans-368
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'displayName: ''部署前端基础设施'''
- en: 'inputs:'
  id: totrans-369
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'inputs:'
- en: 'azureSubscription: ${{ parameters.azureSubscription }}'
  id: totrans-370
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'azureSubscription: ${{ parameters.azureSubscription }}'
- en: 'action: ''Create Or Update Resource Group'''
  id: totrans-371
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'action: ''创建或更新资源组'''
- en: 'resourceGroupName: ${{ parameters.resourceGroupName }}'
  id: totrans-372
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '资源组名称: ${{ parameters.resourceGroupName }}'
- en: 'location: ${{ parameters.location }}'
  id: totrans-373
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '位置: ${{ parameters.location }}'
- en: 'templateLocation: ''Linked artifact'''
  id: totrans-374
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '模板位置: ''链接的工件'''
- en: 'csmFile: ''$(Pipeline.Workspace)/frontend-iac/template.json'''
  id: totrans-375
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'csm 文件: ''$(Pipeline.Workspace)/frontend-iac/template.json'''
- en: 'overrideParameters: ''-environmentName ${{ parameters.envName }} -containerTag
    "$(Build.BuildNumber)" -catalogAppUrl $(catalogAppUrl) -cartAppUrl $(cartAppUrl)
    -checkoutAppUrl $(checkoutAppUrl)'''
  id: totrans-376
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '覆盖参数: ''-environmentName ${{ parameters.envName }} -containerTag "$(Build.BuildNumber)"
    -catalogAppUrl $(catalogAppUrl) -cartAppUrl $(cartAppUrl) -checkoutAppUrl $(checkoutAppUrl)'''
- en: 'deploymentMode: ''Incremental'''
  id: totrans-377
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署模式: ''增量'''
- en: 'deploymentName: ''frontend-$(Build.BuildNumber)'''
  id: totrans-378
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署名称: ''frontend-$(Build.BuildNumber)'''
- en: 'deploymentOutputs: ''frontendInfraOutputs'''
  id: totrans-379
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '部署输出: ''frontendInfraOutputs'''
- en: '[PRE26]'
  id: totrans-380
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '- task: PowerShell@2'
  id: totrans-381
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '- 任务: PowerShell@2'
- en: 'displayName: ''Get Frontend URL'''
  id: totrans-382
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '显示名称: ''获取前端网址'''
- en: 'inputs:'
  id: totrans-383
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '输入:'
- en: 'targetType: ''inline'''
  id: totrans-384
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '目标类型: ''内联'''
- en: 'script: |'
  id: totrans-385
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '脚本: |'
- en: '# Get the frontend app url'
  id: totrans-386
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '# 获取前端应用网址'
- en: $var=ConvertFrom-Json '$(frontendInfraOutputs)'
  id: totrans-387
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $var=ConvertFrom-Json '$(frontendInfraOutputs)'
- en: $value=$var.frontendUrl.value
  id: totrans-388
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: $value=$var.frontendUrl.value
- en: 'Write-Host "Frontend Url: $value"'
  id: totrans-389
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 'Write-Host "前端网址: $value"'
- en: Write-Host "##vso[task.setvariable variable=frontendAppUrl;]$value"
  id: totrans-390
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Write-Host "##vso[task.setvariable variable=frontendAppUrl;]$value"
- en: '[PRE27]'
  id: totrans-391
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE27]'
- en: az group delete -n packt -y
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: az group delete -n packt -y
- en: '[PRE28]'
  id: totrans-393
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
