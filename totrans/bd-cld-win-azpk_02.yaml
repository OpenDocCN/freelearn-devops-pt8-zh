- en: Chapter 2. Getting the Cloud Fabric Ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Fabric is one of the most important and crucial part of any traditional data
    center or cloud solution. Cloud fabric essentially includes, but is not limited
    to compute, network, storage, and hypervisors. Well designed and deployed fabric
    infrastructure is the way towards smooth operations of any cloud or traditional
    data center. In this chapter, we will cover all aspects of planning and deploying
    cloud fabric for our Windows Azure Pack-based cloud solution. It will help you
    understand fabric requirements and deployment practices for a WAP-based cloud
    solution. We will also include installation and configuration of major components
    such as SQL DB, SCVMM, SPF, and so on. We will be covering planning guidelines
    for both organizations' private cloud as well as for service providers' cloud.
    This fabric infrastructure will be used to deliver IaaS services in our WAP cloud.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover the following topics in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Cloud fabric infrastructure planning
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V deployment best practices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up virtual machines for cloud management fabric
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and deploying SQL Server for cloud management DB
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing and configuring **System Center Virtual Machine Manager** (**SCVMM**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and configuring cloud compute hypervisor layer with SCVMM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and configuring cloud network with SCVMM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and configuring cloud storage with SCVMM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and deploying System Center Service Provider Foundation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cloud fabric infrastructure planning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Planning a cloud fabric infrastructure involves practice and involvement of
    business and technical decision makers. Cloud fabric has to be planned in such
    a manner that ensures that services are available for the business in a reliable
    and efficient manner. Current infrastructure assessment, forecasting and future
    resource planning, cloud service catalogues, along with strategic vision and financials
    are the key facts to consider while planning for cloud infrastructure. Let's have
    a look at the foundation and basic principles for planning a WAP-based cloud fabric
    infrastructure for delivering IaaS services.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing the hardware
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'While choosing hardware for your cloud infrastructure, there is a long list
    of precautions to be taken care of. The following are some of these precautions:'
  prefs: []
  type: TYPE_NORMAL
- en: Follow the Microsoft certified hardware and software supportability and compatibility
    list. It is not a mandatory requirement as a WAP-based solution can be installed
    on almost any x86 based virtualization supported hardware, however, it is recommended
    to go with Microsoft certified hardware to avoid any glitches at a later stage
    in production. Getting support could be challenging sometimes while using non-supported
    hardware.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While going for commodity hardware, check for compatibility and features of
    individual pieces of server such as NIC cards and so on.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use latest hardware supporting new features such as RDMA and other hardware
    offloading capabilities to take advantage of all capabilities of your hypervisor
    and cloud layer.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Check for the scalability flexibilities, sufficient number of processors, memory,
    PCI slots can be helpful in increasing resources as and when required.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hardware failure happens, it's a good idea to check for hardware vendor support
    and SLAs in case of hardware failure part replacement and more.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While comparing multiple hardware options for your cloud, include data center
    physical requirements (space, power, cooling, and so on) as one of the parameters,
    physical requirements usually become constraints in the real world.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While all preceding points are valid, today's data center technologies trends
    include software defined strategy. Using commodity hardware with best of breed
    software runs the data centers. It is fairly possible and good to use commodity
    hardware in your WAP cloud solution, though building the commodity hardware has
    to be planned very carefully.
  prefs: []
  type: TYPE_NORMAL
- en: For example, using non-supported disk drives leads to IOPS related performance
    issues, and the same goes for NIC speed and features. Follow the industry best
    practice guideline along with Microsoft Hyper-V compatibility and features support
    while designing commodity hardware.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing a combination of both proprietary and commodity hardware is also not
    uncommon; organizations can choose to run critical workload on proprietary hardware
    to ensure performance and support, whereas use commodity hardware for less critical
    or test and development workloads.
  prefs: []
  type: TYPE_NORMAL
- en: Enabling commodity hardware options is helping small and midsized businesses
    (SMBs) to utilize enterprise class virtualization and cloud technologies for their
    IT needs in a limited budget. The same goes for the cloud service providers, small
    vendors with budget constraints can also get into the cloud services market using
    commodity hardware.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The Microsoft supportability and compatibility list can be accessed at [https://www.windowsservercatalog.com/](https://www.windowsservercatalog.com/).
  prefs: []
  type: TYPE_NORMAL
- en: Sizing the hardware
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: After choosing the hardware, the next thing which comes is sizing. Sizing for
    a cloud fabric for a private cloud and service provider cloud is an altogether
    different science with a common foundation of data center infrastructures sizing
    practice. Projecting future needs is the most important aspect while sizing any
    cloud hardware that is cloud should be able to handle hardware needs for the next
    *X* years, depending upon businesses strategy. Microsoft provides MAP toolkit
    (Microsoft Assessment and Planning) which can be utilized by organizations and
    service providers for accessing current infra and planning for target infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Let's have a look at few major sizing best practices and procedures for both
    private clouds and service providers' cloud.
  prefs: []
  type: TYPE_NORMAL
- en: 'Sizing the cloud hardware for private cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: Assess current workload requirements and plan hardware as per Hyper-V Server
    Virtualization sizing guidelines pertaining to virtual CPUs, memory, and more.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Utilize MAP toolkit to assess current running workload in traditional computing.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Perform server consolidation planning if P2V or hardware refresh is also planned.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: List down the expected new workload requirements (like new application planned
    in the near future and so on.)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: List down the expected resources increment in the coming *X* years in terms
    of compute, network, and storage.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Analyze isolated infrastructure requirements if any (a few apps may need to
    be isolated from each other in terms of network/server due to compliance and more.)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Factor for **Business Continuity and Disaster Recovery** (**BCDR**) planning.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bring all collected details together and size the hardware as per Hyper-V virtualization
    and IT infrastructure sizing guidelines.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Add hardware requirements for cloud management infrastructure depending upon
    workload to be managed.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Sizing the cloud hardware for service provider cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: Access customer needs and technological requirements in service providers' technology
    space
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Define technology offering and flexibilities in terms of infra and apps with
    their fabric requirements
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Set business goals like having *X* number of resources/customers in the coming
    *X* years as per service provider's strategy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bring all collected details and strategy decisions together and size the hardware
    as per Hyper-V virtualization and IT infrastructure sizing guidelines
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Add hardware requirements for cloud management infrastructure depending upon
    the workload to be managed as planned here.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Sizing the hardware for cloud or any traditional data center is an altogether
    different detailed study and practice. The above mentioned guidelines are to help
    readers in understanding the base foundation for cloud fabric hardware planning.
    Refer to product and practice specific technical and economical guidelines for
    a production sizing.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing hypervisor's deployment options and editions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Microsoft added a variety of all enterprise class virtualization features to
    Windows Server 2012\. With Windows Server 2012 / R2 Hyper-V becomes the enterprise
    class proven virtualization platform supporting greater flexibility and scalability.
  prefs: []
  type: TYPE_NORMAL
- en: 'Microsoft Windows Server 2012 R2 Hyper-V provides an enterprise class virtualization
    platform for WAP-based cloud solution. Hyper-V can be deployed in three ways:'
  prefs: []
  type: TYPE_NORMAL
- en: Windows Server 2012 R2 Server with GUI with Hyper-V role
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows Server 2012 R2 Server Core with Hyper-V role
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V Server 2012 R2 (free)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **Server with GUI** option installs and configures all user interface options,
    such as server manager, desktop experience, and so on. It installs Windows Server
    also in the same traditional manner with all features and functionality available.
  prefs: []
  type: TYPE_NORMAL
- en: The **Server Core** version is a stripped down version of full installation,
    in this no GUI components gets installed. It has to be managed via a command line,
    PowerShell or remote server management options. Benefits of deploying the Server
    Core version includes but is not limited to less resource consumption, less disk
    footprint, better security by reducing attack surface of eliminated components
    in comparison to the Server with GUI option, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: It is recommended to deploy Server Core in a cloud infrastructure for hypervisor's
    as these servers shall be used for running VMs only. This can take advantage of
    server core deployment benefits in large infrastructures.
  prefs: []
  type: TYPE_NORMAL
- en: With Windows Server 2012 and R2, it is possible to switch between full editions
    and core edition after deployment. Administrators can choose to install the Server
    with GUI initially and switch to the core version post configuration for easy
    deployment.
  prefs: []
  type: TYPE_NORMAL
- en: Windows Server editions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'There are multiple editions of Windows Server such as Essentials, Foundation,
    and so on, but majorly for any virtualization needs below two editions are used:'
  prefs: []
  type: TYPE_NORMAL
- en: Windows Server Standard edition
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows Server Data center edition
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Both Standard and Data center editions of Windows Server is licensed on processor
    basis, one license per two processors. Both Standard and Data center editions
    provide the same set of features, the difference lies in the virtualization rights.
    Standard edition allows you to run two virtual machines with Windows Server OS,
    in the case of Data center edition the number goes unlimited. Taking a scenario
    Windows Server 2012 R2 Standard edition licensed hypervisor hosts allows you to
    create two virtual machines with Windows Server 2012/R2 Standard Guest OS without
    purchasing any additional licensing. Licensing downgrade rights apply for running
    VM with Windows Server 2008 R2 OS.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing the right edition for your cloud
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Choosing the right edition depends upon the type and number of operating systems
    in the cloud infrastructure. It's recommended to go with the Data center edition
    if virtualized workload includes Windows as Guest OS majorly. Standard edition
    can be helpful and budgetary while the number of virtual machines with Windows
    OS isn't high.
  prefs: []
  type: TYPE_NORMAL
- en: As a best possible solution, in a large infrastructure combination of both Standard
    and Data center editions can be utilized depending on the OS of virtualized workload.
  prefs: []
  type: TYPE_NORMAL
- en: While for organizations it will depend on workload nature if it is Windows or
    non-Windows to choose the right edition, server providers can use a combination
    of both Data center/Standard edition to service customers' requests for both Windows
    and non-Windows infra requirements.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Refer to the Windows Server 2012 product and edition comparison guide on [http://www.microsoft.com/](http://www.microsoft.com/)
    for detailed comparison between various Windows editions.
  prefs: []
  type: TYPE_NORMAL
- en: Free Microsoft Hyper-V Server 2012 R2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Microsoft Hyper-V Server 2012 R2 (also known as Standalone Hyper-V) is a free
    (yes, completely free) edition of Microsoft's proprietary hypervisor. It is a
    stripped down version of Windows Server operating system comprising only hypervisor
    and virtualization capabilities, Windows Server drivers, and supporting components
    such as cluster capabilities. Free Hyper-V version doesn't include any additional
    Windows feature apart from hypervisor, making it available with less footprint,
    management burden, and attack surface.
  prefs: []
  type: TYPE_NORMAL
- en: Free Hyper-V Server 2012 R2 provides free access to Hyper-V virtualization capabilities
    only, virtual machine guest OS licensing has to be separately considered. If you
    are running Windows Server OS inside a virtual machine, it's a good idea to use
    Standard or Data center edition depending upon the count of Windows VMs. This
    edition can be helpful in scenarios where Guest OS inside VMs wouldn't be Windows.
  prefs: []
  type: TYPE_NORMAL
- en: A major use case of free Hyper-V Server is to be utilized by organizations or
    service providers for hosting non-Windows workloads.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Ensure to check for the supportability of the free Hyper-V version while extending
    WAP cloud solution with custom offerings or partner provided solutions.
  prefs: []
  type: TYPE_NORMAL
- en: Microsoft Hyper-V is the best choice for a WAP-based cloud solution, though
    there are integration possibilities with other hypervisor's vendors such as VMware
    and Citrix. See product specific guidelines to choose the edition and deployment
    model along with the supportability matrix of features while choosing VMware or
    Citrix.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing the system center deployment options and edition
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Microsoft System Center 2012 R2 is the core management component for delivering
    cloud services in a WAP-based cloud solution. System Center products can be deployed
    in multiple ways such as:'
  prefs: []
  type: TYPE_NORMAL
- en: Physical or virtual machines
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Standalone or high availability mode (product dependent)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: System Center components requires Windows Server as an operating system to run.
    It can be in a virtual machine or a physical server. Since we virtualize every
    piece of our cloud management and tenant workload, it doesn't make sense to keep
    system center components on physical servers unless there is some specific requirement
    or exception.
  prefs: []
  type: TYPE_NORMAL
- en: For both organizations and service providers, it is recommended to deploy system
    center components inside virtual machines to take the advantage of hypervisor
    level HA and other capabilities.
  prefs: []
  type: TYPE_NORMAL
- en: Along with hypervisor HA, deploying servers in Guest OS or app level HA adds
    additional benefits such as application level failure detection and load balancing.
  prefs: []
  type: TYPE_NORMAL
- en: System Center products can be deployed in OS/app level cluster or redundant
    mode.
  prefs: []
  type: TYPE_NORMAL
- en: Organizations or service providers can choose a combination of standalone or
    HA mode products depending upon their availability business and technical requirements.
  prefs: []
  type: TYPE_NORMAL
- en: System Center editions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: System Center is available as a suite in two editions. When you buy a System
    Center suite you are entitled to use all components (except SCCM) depending upon
    licensing.
  prefs: []
  type: TYPE_NORMAL
- en: 'The two editions of the System Center suites are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: System Center Standard edition
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: System Center Data center edition
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Licensing is required only for a number of endpoints being managed by system
    center components. There is no licensing required for running the system center
    components. Licensing is available in a similar fashion with Windows Server that
    is a processor-based licensing (two products per license). There is no difference
    in terms of features with Standard and Data center editions; the difference lies
    in the number of virtual instances you can manage with Standard and Data center
    editions. With Standard edition, two **OSEs** (**Operating System Environments**)
    can be managed by the System Center and is unlimited in the case of Data center
    edition. Microsoft licensing policy may change from time to time and depending
    upon agreements such as EA/SA and so on. It is recommended to touch base with
    Microsoft for planning licenses and editions.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Refer the *How to buy System Center 2012 R2* page on Microsoft's official website
    to know more on licensing and comparisons.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing the right edition for System Center for organizations and service providers
    directly corresponds to the edition chosen for Windows Server. It's good to go
    with System Center Data center edition to manage Windows Server Data center edition
    and vice versa to enable a consistent feature set and flexibilities.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The licensing details given are up to the date of writing this chapter; licensing
    policies may change in future, and it is advised to consult while planning for
    licensing and editions.
  prefs: []
  type: TYPE_NORMAL
- en: Cloud management infra and tenant workload infrastructure
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'A cloud infrastructure is usually segregated in two categories, cloud management
    and tenant workload. Let''s have a look at these two:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Cloud Management Infrastructure**: Management infrastructure or management
    cluster is used to host virtual machines for cloud management components such
    as Windows Azure Pack server and system center components. It is recommended to
    have a separate hypervisor cluster dedicatedly for hosting cloud management workload.
    The sizing of the management cluster would depend upon the number of services
    offered and the size of tenant workload to be managed.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Tenant Workload Infrastructure**: Tenant workload infrastructure is used
    for hosting customers'' cloud resources such as virtual machines and databases.
    Tenant workload infrastructure has to be designed keeping available cloud services,
    QoS and SLAs in mind.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Core MS infrastructure services planning
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Microsoft''s WAP-based cloud solution uses core Microsoft core infrastructure
    services such as Active Directory, DNS, DHCP, and so on for foundation operations
    such as authentication and more. These core infrastructure services have to be
    deployed with product specific guidelines and industry best practices to ensure
    availability and efficiency . Let''s have a look at the core services and the
    deployment best practices:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Active Directory**: Microsoft AD is the most critical component of most of
    MS infrastructure solutions including WAP cloud solution. AD is used for authentication,
    authorization along with other capabilities in WAP cloud. AD deployment can be
    planned with redundancy (deploying additional domain controllers) and security
    best practices. Regular backup and disaster recovery should be planned for Active
    Directory infrastructure.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**DNS**: Usually co-located with AD, DNS provides name resolution for the entire
    cloud. DNS failure may cause entire cloud failure, hence it needs to be planned
    to ensure every time availability and security from attacks. Regular backup and
    DR should be planned.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NTP**: Another crucial component of any cloud or any IT solution, NTP ensures
    time synchronization among all cloud resources. Time lag may cause the entire
    cloud solution to fail as well as incorrect billing. The NTP device must be highly
    available as well as accurate. All components should be configured to use the
    same NTP device. Domain joined Windows operating systems utilize the domain controller
    (PDC role) for time synchronization.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
- en: Follow Microsoft's guidelines while virtualizing domain controllers holding
    NTP role. See [https://technet.microsoft.com/en-us/library/virtual_active_directory_domain_controller_virtualization_hyperv%28v=ws.10%29.aspx](https://technet.microsoft.com/en-us/library/virtual_active_directory_domain_controller_virtualization_hyperv%28v=ws.10%29.aspx)
    to know more.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**DHCP**: Dynamic Host Configuration Protocol can be utilized for Dynamic IP
    address allocation and management. The deployment of DHCP should be highly available
    and efficient for serving cloud IP address requirements.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Other infrastructure supporting services (PXE Boot server, IPAM and so on)**:
    Depending upon deployment and use cases other MS services such as PXE boot and
    deployment server for bare metal provisioning or network boot, WSUS or SCCM for
    patch management, IPAM for IP address management, jump servers for centralized
    access, security products should be deployed in an efficient and highly available
    manner as applicable.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Planning and deployment options for cloud network and storage shall be discussed
    in the coming topics in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Hyper-V deployment best practices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hypervisor is the core foundation of WAP-based cloud infrastructure as every
    virtual machine including management workload VMs such as WAP admin/tenant portal
    VM, SCVMM, SPF will be running inside a VM on Hyper-V host only. Let's have a
    look at a few of the deployment best practices of Hyper-V Server.
  prefs: []
  type: TYPE_NORMAL
- en: It is recommended to maintain symmetry in terms of configuration, best practices
    applied across all Hyper-V hosts. SCVMM and AD group policies can be used to configure
    and manage Hyper-V configurations and policies across all the hosts.
  prefs: []
  type: TYPE_NORMAL
- en: Centralized management is the key element in every cloud solution.
  prefs: []
  type: TYPE_NORMAL
- en: Hyper-V installation best practices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Though Windows Server 2012 R2 Hyper-V installation is quite straightforward.
    It's recommended to follow best practices of Hyper-V installation for a smooth
    and stable virtualized infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: 'Best practices for hypervisor installation are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Supported hardware and latest hardware firmware**: It is recommended to use
    supported hardware for proven performance and stability. Always ensure to update
    the firmware of the server''s hardware or chassis or blades as applicable.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Install OS using hardware vendor provided tools**: Major server hardware
    vendors provide their proprietary tools for installing operating system such as
    HP intelligent provisioning. This ensures that the hypervisor is deployed with
    proper hardware-specific drivers and integration tools.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Choose correct deployment option**: In a cloud infrastructure, it is recommended
    to use the Server Core version to utilize the benefits of the Server Core deployment,
    such as less disk footprint and attack surface, which reduces management and updates
    burden. If you deploy the Server with GUI, it is advised to remove all unnecessary
    components.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Latest device drivers**: Use the latest device drivers for hardware devices
    regardless of the proprietary and commodity hardware.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows updates**: Ensure to update the hypervisor with the latest patches
    and service packs that are available. It is recommended to have patch management
    solutions deployed for ensuring the continuous deployment of the latest hot fixes.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Page file**: Hyper-V server automatically manages page file size as per the
    physical memory that is installed in the system. It should be set to **System
    Managed**.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows firewall**: Configure Windows firewall rules as per environmental
    requirements. An organization may choose to disable the firewall if the port level
    access is being managed by network firewalls.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Hypervisor hardening and VA**: Apply standard security policies as per the
    organization''s defined standard. Perform necessary vulnerability assessments
    and remediation as per the organization''s policies.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Naming convention and domain**: Ensure to follow the proper hostname convention
    and join the domain wherever applicable. For cluster nodes, it is required to
    join hosts to the domain.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V networking best practices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Best practices for Hyper-V networking are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Separate network for Hyper-V and VM network traffic**: A separate physical
    and logical network should be considered for management traffic such as host management
    and live migration, and another for virtual machine traffic as per the VM network
    zone such as internal, DMZ, and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Configure redundancy at physical network path**: Configure at least two NIC
    adaptors connecting to two different network switch in each network team. Ensure
    not to have any single point of failure.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Configure teaming and load balancing policies**: Windows Server 2012 /R2
    provides multiple load balancing policies(Hyper-V port, address hash, dynamic
    balancing, and so on) which provides maximum performance and reliability for Hyper-V
    network. Ensure to configure proper NIC teaming load balancing policies.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Separate network for IP storage traffic**: It is recommended to use a separate
    physical and logical network for IP based storage traffic such as iSCSI, SMB,
    and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Implement network QoS**: Use the Hyper-V network **Quality of Service** (**QoS**)
    feature to ensure that no single VM becomes the network bandwidth constraints
    for other VMs. It becomes important to implement QOD in a WAP-based cloud solution
    to ensure providing request network bandwidth to tenants'' virtual machines as
    per their plan and subscription.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Monitor network usage**: Monitor Hyper-V network virtualization continuously
    to plan to get insight of network usage and plan for future scalability.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use SDN (Software Defined Networking)**: This is not a Hyper-V networking
    best practice, but looking at cloud solution using SDN, aka network virtualization,
    can enable automated provisioning, management and flexibilities for cloud networking.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V storage deployment best practices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Best practices for Hyper-V storage deployment are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Ensure redundancy for storage path**: Use multipath IO for storage paths.
    Eliminate any single point of failure at server port, storage port, or SAN switch
    and so on. Configure multipathing policies as per SAN provider guidelines for
    reliability and efficiency.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Using vhdx**: New virtual disk file format that is vhdx was introduced with
    Windows Server 2012\. VHD provides multiple benefits over older format VHD in
    terms of performance and reliability. Use vhdx instead of vhd unless exceptionally
    required.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Size volumes and CSV properly**: Sizing workload VMs is important in terms
    of capacity and IOPS. Oversized volumes may cause performance and outage issues.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Implement storage QoS**: Use Hyper-V storage quality of service feature to
    ensure that no single VM becomes the storage performance constraints for other
    VMs with respect to IOPS. It is a must for a WAP-based cloud solution to ensure
    providing requested storage IOPS to tenants'' virtual machines as per their plan
    and subscription.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Monitor storage usage**: Monitor Hyper-V storage continuously for capacity
    and performance to plan to get insight of network usage and plan for future scalability.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use SDS/SMI-S/SMP integrations**: This is not a Hyper-V storage best practice,
    but from a cloud prospective it is recommended to use SDS (Software Defined Storage),
    SMI-S provider array integration for better provisioning, management and automation
    for cloud storage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V virtual machine deployment best practices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Best practices for Hyper-V virtual machine deployment are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Properly sizing of VM Compute**: A greater number of virtual CPUs doesn''t
    guarantee more performance, assign CPUs to VMs as per actual application requirements.
    The same goes for memory. Ensure not to oversize or undersize virtual machines.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use Generation-2 VM**: Generation 2 VMs provide multiple features over Generation-1
    VMs such as UEFI boot, synthetic hardware, faster installation and booting time
    and more. It is recommended to use Generation-2 VMs unless specifically required.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use dynamic memory**: It is recommended to use dynamic memory to make the
    most out of physical RAM available in your server. Using dynamic memory in a large
    cloud environment can help in increasing host density. It is recommended to plan
    carefully while using dynamic memory to avoid any performance hit on any of the
    virtual machines or hosts.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use non-uniform memory access (NUMA) if supported**: NUMA helps virtual machines
    having multiple virtual CPUs assigned to scale and perform better by facilitating
    it to use local cache and memory bus of the CPU executing its instruction. NUMA
    is dependent upon hardware architecture.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Remove unused virtual hardware**: It''s recommended to use unused virtual
    hardware such as a floppy drive and so on.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use proper integration services**: Integration service are installed inside
    guest operating systems to make those virtualization aware and avail features
    such as graceful shutdown from Hyper-V manager, time sync, data exchange and so
    on. All the latest Windows operating systems by default include integration service,
    for non-Windows OS it may be required to manually install integration services.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Monitor virtual machine usage**: Monitor VM usage continuously for compute
    and take necessary corrective action for oversized and undersized virtual machines.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hyper-V cluster and mobility deployment best practices
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Best practices for Hyper-V cluster and mobility deployment are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Cluster Validation Report**: Microsoft Windows'' failover cluster provides
    features to examine the nodes with respect to Hyper-V configuration, inventory,
    network, storage and system configuration before deploying a cluster. Any error
    or warning produced by validation check should be remediated with the necessary
    corrective actions. Successfully validated cluster is the key to smooth Hyper-V
    HA functionalities.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use SCVMM to deploy and manage highly available virtual machines**: This
    isn''t particularly related to Hyper-V cluster best practice, but for a cloud
    solution it is recommended to deploy and manage Hyper-V cluster and mobility via
    SCVMM.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use separate network for live migration**: It is recommended to use separate
    physical and logical network live migration traffic for reliability and performance.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cluster Aware Updating**: It is recommended to use CAU for patching and upgrading
    cluster nodes. With this organizations and service providers can ensure no outages
    to end customers during the patching of hypervisors. WSUS can be integrated with
    VMM to automate updates to Hyper-V hosts.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up virtual machines for cloud management fabric
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Enough of planning and best practices, it is time to get things in action. Let
    us setup virtual machines to host our cloud infrastructure. These VMs shall host
    cloud management infrastructure and be hosted on the cloud management cluster.
  prefs: []
  type: TYPE_NORMAL
- en: Create a user in Active Directory for joining these servers into the Active
    Directory domain.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Add one redundant VM for each type of VM below, except WAP server (see [Chapter
    1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715 "Chapter 1. Know
    Windows Azure Pack and Its Architecture"), *Know Windows Azure Pack and Its Architecture*,
    for WAP HA), to provide highly available fabric. See product specific guidelines
    for configuring HA for respective components.
  prefs: []
  type: TYPE_NORMAL
- en: '| Sr. Num | VM Name | Compute Configuration | Purpose of VM |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | WAPMGT-SQLDB-01 | 4 CPU, 12 GB RAM | Host SQL databases for entire WAP
    solution database needs |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | WAPMGTSCVMM-01* | 4 CPU, 12 GB RAM | System Center Virtual Machine Manager
    |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | WAPMGT-SCSPF-01 | 2 CPU, 8GB RAM | Service Provider Foundation |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | WAPMGT-SCSMA-01 | 2 CPU, 8 GB RAM | Service Management Automation |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | WAPMGT-ACRDG-01 | 2 CPU, 8 GB RAM | Remote Desktop Gateway Server for
    providing Azure Console Connect |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | WAPMGT-WAPSR-01 | 2 CPU, 8 GB RAM | Windows Azure Pack (Express Installation
    Model) |'
  prefs: []
  type: TYPE_TB
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: These VM configuration used in this book is only for evaluation purpose, follow
    guidelines discussed in [Chapter 1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715
    "Chapter 1. Know Windows Azure Pack and Its Architecture"), *Know Windows Azure
    Pack and Its Architecture* and this chapter along with product specific documentation
    for production deployment.
  prefs: []
  type: TYPE_NORMAL
- en: 'All VMs mentioned above shall be configured with the following common settings:'
  prefs: []
  type: TYPE_NORMAL
- en: 127 GB disk (dynamic expanding disk)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows Server 2012 R2 DC/STD edition operating system
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Single NIC card connected to Hyper-V virtual switch (external)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dynamic memory not being used
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All integration services available
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Highly available in a Hyper-V cluster (recommended, not mandatory)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The post VM deployment steps are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Active Windows operating system
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Assign static IPv4 address
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Assign hostname as per naming convention
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Join the server to domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Turn off Windows firewall or create firewall rules as applicable
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and deploying SQL Server for cloud management DB
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: All components of Windows Azure Pack and system center uses SQL Server database
    to store its configuration, run time data, historical usage data etc. Failure
    of the database is directly proportional to the failure of respective components.
  prefs: []
  type: TYPE_NORMAL
- en: Choosing the database server version and deployment model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In a bare minimum deployment, this SQL Server for management databases shall
    be used by the following components:'
  prefs: []
  type: TYPE_NORMAL
- en: Windows Azure Pack components
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SCVMM
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SPF
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SMA
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While choosing the database version a deployment model, supportability and compatibility
    has to be aligned with respect to each of the components mentioned previously.
  prefs: []
  type: TYPE_NORMAL
- en: 'Windows Azure Pack supports the following MS SQL Server versions for managing
    databases:'
  prefs: []
  type: TYPE_NORMAL
- en: MS SQL Server 2008 Service Pack 3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MS SQL Server 2008 R2 Service Pack 2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MS SQL Server 2012 Service Pack 1
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MS SQL Server 2012 Service Pack 2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MS SQL Server 2014
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: System Center 2012 R2 has different SQL Server version support differentiating
    upon components. Taking the common and latest, MS SQL 2012 SP1 is the supported
    SQL version for Windows Azure Pack and all System Center products, MS SQL 2012
    SP2 and MS SQL 2014 is supported for WAP components and all System Center 2012
    R2 components except app controller. Organizations or cloud providers can choose
    between SQL 2012 SP1, SQL 2012 SP2 and SQL 2014 depending upon the components
    installed.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: SQL Support matrix for System Center 2012 R2 can be accessed at [https://technet.microsoft.com/en-us/library/dn281933.aspx](https://technet.microsoft.com/en-us/library/dn281933.aspx)
  prefs: []
  type: TYPE_NORMAL
- en: 'The deployment model in SQL Server can be deployed in multiple ways with respect
    to placement, failover, and so on. WAP management database deployment is supported
    in following ways:'
  prefs: []
  type: TYPE_NORMAL
- en: Standalone SQL Server deployment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Server failover cluster
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Server AlwaysOn availability groups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Choosing the right deployment model for your cloud management databases depends
    upon deployment strategy. Standalone deployment works fine but becomes a single
    point of failure. Failure in the management database will cause failure of all
    cloud management components functionalities.
  prefs: []
  type: TYPE_NORMAL
- en: SQL Cluster (active/passive) and SQL AlwaysOn availability group can be used
    to add redundancy for management databases eliminating any single point of failure.
  prefs: []
  type: TYPE_NORMAL
- en: While both options provide redundancy for SQL Server, AlwaysOn adds greater
    flexibility and reliability by enabling clusters without any shared storage and
    protection at database level, which is at instance level in case of SQL Cluster.
  prefs: []
  type: TYPE_NORMAL
- en: More on SQL Cluster versus SQL can be found at [https://msdn.microsoft.com/en-us/library/ff929171.aspx](https://msdn.microsoft.com/en-us/library/ff929171.aspx).
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: SQL cluster functionalities is available in MS SQL Standard edition where AlwaysOn
    requires Enterprise edition license.
  prefs: []
  type: TYPE_NORMAL
- en: 'While installing SQL for management databases, the following features are required
    to be installed. Default collation will work when deploying for English language.
    See product specific guidelines for other languages:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Common features:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Database engine
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Management tools
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Product specific features:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Full text search (for SC operations Manager and Service Manager)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Reporting services (for SC operations Manager and Service Manager)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Analysis services (For SC Service Manager)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Additional consideration while deploying SQL Server for WAP and System Center
    2012 R2 include:'
  prefs: []
  type: TYPE_NORMAL
- en: Deploy additional SQL Server/instances in a large production setup to avoid
    any performance issues.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reporting services instances cannot be shared between components.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configure pre-size and automatically grow along with monitoring for efficient
    and undisrupted management databases.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL authentication needs to be enabled on the SQL Server before installing Windows
    Azure Pack components. If Windows authentication is planned for configuration,
    the current user has to be added as an administrator on the SQL Server.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL AlwaysOn availability groups functionality is not supported for a named
    instance for System Center Service Manager Database, it is supported for default
    server instance only.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: SQL Express Edition can be used WAP in Express deployment. For WAP distributed
    deployment and system center components Standard edition is the minimum edition
    supported. Choose SQL edition depending upon the features and HA model discussed
    above.
  prefs: []
  type: TYPE_NORMAL
- en: Installing and configuring SQL Server 2012 SP2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For the purpose of evaluation in this book, we shall be using SQL Server 2012
    SP2 standalone installation as the DB server. This database server shall be used
    by all WAP and system center components.
  prefs: []
  type: TYPE_NORMAL
- en: 'Installation prerequisite:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A set of hardware and software prerequisite has to be met before deploying SQL
    Server
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Software requirements:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Install the following components on SQL Server VM before installing SQL Server:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: .NET 3.5 SP1 Framework
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows PowerShell (installed by default)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Network protocol and libraries (like shared memory, named pipe, TCP IP—available
    by default)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Active Directory accounts requirements:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a user account in AD for SQL Server administration and services login
    account
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '| Account Name | Purpose | Permissions |'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
- en: '| Sqldbadmin | SQL DB administrator user | Member of local administrator group
    on SVMM + DB admin |'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
- en: '| Sqldb-svc | Service account for SQL Server Service | Member of local administrator
    group on SVMM + DB admin |'
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
- en: Add created user accounts in the local administrator's group on SQL Server Windows
    OS.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Installation procedure
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following is the installation procedure to be followed:'
  prefs: []
  type: TYPE_NORMAL
- en: Download MS SQL Server 2012 SP1 installation media and mount on SQL VM.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Execute the setup file from installation media and select **Standalone installation**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SQL setup will start a valid validation check for installing the SQL Server
    setup support file. All tests must report green to green to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the product key (embedded in licensed media) or select evaluation mode
    installation option as applicable.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Accept the license terms and proceed further to install setup files.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the setup support rules result. All results must pass successfully to
    proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **SQL Server Feature Installation** on the **Setup Role** page.![Installation
    procedure](img/00008.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Database Engine Services**, **Client Tools Connectivity** and **Management
    Tools - Basic** on the **Features** page (select features as per product specific
    requirements discussed in the last topic).![Installation procedure](img/00009.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the installation rules status, all rules must pass successfully in order
    to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the instance name to a name of your choice. For the purpose of evaluation
    we are using the **Default instance**.![Installation procedure](img/00010.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the disk space requirement and available space to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Change the default service account for the SQL Server agent and database engine
    to the Active Directory account created earlier.![Installation procedure](img/00011.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Mixed Mode** authentication on the **Database Engine Configuration**
    page. Provide "`sa`" as the password and add the current logged in user (SQLDBADMIN)
    into SQL administrators. Change the data directories location to different drives
    if applicable.![Installation procedure](img/00012.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the error reporting option if you wish to participate in error reporting
    to Microsoft.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the installation configuration rule status. Each rule must pass successfully
    to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the installation option selected summary.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SQL Setup will start installing SQL DB Server as per the inputs provided.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the wizard once installation finishes successfully, review setup logs
    in case of any errors.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Post installation tasks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Configure the following tasks after successfully installing SQL Server 2012
    SP1:'
  prefs: []
  type: TYPE_NORMAL
- en: Login into SQL Server using SQL Management Studio and verify successful installation.
    Also verify whether the system databases such as `master`, `tempdb` are created.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a login for SCVMM, SPF, and WAP admin Active Directory user. Permissions
    can be defined later. Browse through the **Security** | **Logins** menu and right
    click on **Logins** to create the SQL user.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configure the SQL Server network port for remote access using SQL Server Configuration
    Manager. By default it's **1433**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Planning and deploying SCVMM 2012 R2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: System Center virtual machine manager is the heart of the solution and is responsible
    for delivering IaaS services for the Windows Azure Pack based cloud solution.
    SCVMM is responsible for provisioning and managing the life cycle of IaaS resources
    such as virtual machines, virtual networks and so on.
  prefs: []
  type: TYPE_NORMAL
- en: SCVMM manages not only the hypervisor and virtual machines resources but also
    is responsible for provisioning and managing network and storage resources for
    cloud virtual machines. SCVMM provides flexibility to integrate with third party
    network and storage providers for automated provisioning and management. In a
    nutshell, SCVMM is core resource provider for IaaS offerings for WAP cloud solution.
  prefs: []
  type: TYPE_NORMAL
- en: SCVMM comes as a part of system center suite. WAP communicates with SCVMM for
    IaaS services via **SPF** (**Service Provider Foundation**). In this section we
    will cover VMM architecture and deployment models along with installation walkthrough.
  prefs: []
  type: TYPE_NORMAL
- en: The VMM architecture and deployment model
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'VMM server is made up of multiple components which can be deployed together
    on a single server or on a different server in a distributed fashion to achieve
    scalability and availability. VMM requires a SQL Server database to store all
    configurations and run time data. Components of overall VMM working solutions
    are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**VMM Management Server**: This server is responsible for the execution of
    all tasks SCVMM is participating in. It installs System Center Virtual Machine
    management services which communicates with all other system center VMM and non-system
    center components for provisioning and controlling the fabric. This can be protected
    from SPOF by deploying in HA mode on the top of Microsoft Failover Cluster.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VMM Management Console**: Management console is used by administrators for
    connecting to VMM management services and performing administrative tasks. It
    gets installed on VMM management server by default, you can also install it in
    your management endpoints for SCVMM administration. .'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VMM Database**: VMM database is a Microsoft SQL Server provided database
    which stores VMM configuration such as hosts, networks, virtual machine, and so
    on, along with run time data. VMM is highly dependent on this database to function,
    it is highly recommended to protect this database using SQL HA techniques in production
    deployment.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VMM library and library server**: VMM library stores all resources that are
    used to deploy VMs or services. VMM library typically includes VHDs, templates,
    ISO files, network and storage profiles and so on. VMM library is stored in a
    file share hosted on a library server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VMM Agent**: VMM agent is not a server component, it facilitates communication
    between hypervisor and VMM. VMM agent gets installed on hypervisor while adding
    hosts in VMM. It can also be manually installed in case of any isolated environmental
    restrictions.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All components here except VMM database (provided by SQL) are available in SCVMM
    2012 R2 installation media.
  prefs: []
  type: TYPE_NORMAL
- en: VMM deployment models
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'SCVMM works on a distributed architecture which enables it to provide multiple
    flexible deployment options. Organizations can choose to increase components such
    as management server or library server for scalability needs. Majorly, SCVMM can
    be deployed in three ways:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Standalone deployment**: In standalone deployment all server components of
    VMM (VMM management server, VMM console, VMM library server and VMM SQL database)
    are installed on a single server. This deployment model facilitates a minimum
    deployment footprint and is suitable for test and non-production architectures.
    It doesn''t provide any redundancy for any of the components.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Distributed deployment**: In a distributed deployment, organizations can
    choose to install a management server, library server and database server of three
    or more different servers to achieve availability and scalability. VMM database
    can be protected using SQL high availability techniques'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SCVMM in high availability mode**: SCVMM supports deployment in cluster mode
    using Windows Failover Cluster. Virtual machine management server can be protected
    using HA deployment mode, along with protected DB using SQL HA techniques. This
    is recommended for production deployment eliminating any single point of failure.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing System Center Virtual Machine Manager 2012 R2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For the purpose of evaluation in this book, we shall be deploying VMM Management
    Server, VMM Console and VMM Library Server and share on a single machine. Cloud
    Management SQL database server shall be utilized for hosting VMM database.
  prefs: []
  type: TYPE_NORMAL
- en: Installation prerequisites
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Multiple Active Directory accounts with specific permission are required for
    SCVMM to work. Let's have a look at the recommended accounts and permissions for
    SCVMM usage.
  prefs: []
  type: TYPE_NORMAL
- en: 'AD user account and group for SCVMM:'
  prefs: []
  type: TYPE_NORMAL
- en: '| Account Name | Purpose | Permissions |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Scvmmadmin | SCVMM admin user for administrative tasks | Member of local
    administrator group on SVMM + DB Admin |'
  prefs: []
  type: TYPE_TB
- en: '| Scvmmsvc | Service account for SCVMM service | Member of local administrator
    group on SVMM + DB Admin |'
  prefs: []
  type: TYPE_TB
- en: '| Scvmm-runasadmin | Run as account for SCVMM operation | Admin permissions
    on SCVMM and other resources being managed such as Hyper-V hosts. |'
  prefs: []
  type: TYPE_TB
- en: '| Scvmm-admins | Security group for administrators | Admin permissions on SCVMM
    |'
  prefs: []
  type: TYPE_TB
- en: Add SCVMM admin and service account as a part of "scvmm-admin" security group
  prefs: []
  type: TYPE_NORMAL
- en: Software prerequisite
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'VMM takes care of installing most of the software prerequisites except Windows
    Access and development kit (Windows ADK) and SQL database related tools. Install
    the following components as a part of the software prerequisite for deploying
    System Center Virtual Machine Manager 2012 R2:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Features from Windows assessment and development toolkit:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Deployment tools
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows pre-installation environment (Windows PE)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'SQL Server connectivity tools:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Server 2012 command line utilities
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft SQL Server native client
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Apart from installing, VMM has the following software components requirements
    which the setup takes care of during installation:'
  prefs: []
  type: TYPE_NORMAL
- en: Windows Remote Management (WinRM 2.0) Service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft .NET framework 4 or 4.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows PowerShell 2.0
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Windows ADK can be download from [https://www.microsoft.com/en-in/download/details.aspx?id=39982](https://www.microsoft.com/en-in/download/details.aspx?id=39982),
    SQL connectivity tools can be downloaded from [http://www.microsoft.com/en-in/download/details.aspx?id=29065](http://www.microsoft.com/en-in/download/details.aspx?id=29065).
    These are also available in SQL Server 2012 installation media.
  prefs: []
  type: TYPE_NORMAL
- en: Installation procedure
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For evaluation purposes, we shall be deploying VMM Management Server, VMM console
    and library server on a single machine.
  prefs: []
  type: TYPE_NORMAL
- en: Download MS System Center 2012 R2 Virtual Machine Management installation media
    and mount on SCVMM VM.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Execute the setup file from installation media and click **Install**.![Installation
    procedure](img/00013.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **VMM Management Server** feature to install, it will automatically
    select **VMM console** as well.![Installation procedure](img/00014.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the name and organization details along with the product key provided
    by Microsoft for your system center licenses. VMM will be installed in evaluation
    mode if no product key is specified. You can choose to provide the product key
    at a later stage as well, post installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Accept the evaluation/product license terms and proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose **Yes** or **No** to participate in the **Customer Experience Improvement
    Program**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Turn on or off for Microsoft Update, with turning it on you can update VMM using
    automatic updates.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify the SCVMM installation location, by default it is in `C:\Program Files\Microsoft
    System Center 2012 R2\Virtual Machine Manager`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clicking **Next** will start the prerequisite check and will return with an
    error or warning if any of the prerequisites defined in the previous section aren't
    completed. Complete any pending prerequisites if any and proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the database configuration on this page. You can choose to use existing
    DB created in SQL instance for VMM or may choose to create a new database. Change
    the SQL port if changed in SQL post-installation tasks.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify Database configuration and proceed further.![Installation procedure](img/00015.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configure the service account for SCVMM services login. For SCVMM in HA mode,
    this has to be a domain account. Provide the location to store the Distributed
    Encryption key location in AD if deploying in HA mode. More on deployment in HA
    mode is covered in the next section.![Installation procedure](img/00016.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Customize network ports for SCVMM communication if required.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a library share on the library disk and provide name and location. This
    will act as a SCVMM library which can be used to store resources such as VHDs,
    templates and so on. By default VMM setup takes `C:\Program Data\Virtual Machine
    Manager Library Files` as the library share location.![Installation procedure](img/00017.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the installation configuration summary and start installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the Wizard on successful installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: VMM Installation logs are located at `%SystemDrive%\ProgramData\ VMMLogs\`
  prefs: []
  type: TYPE_NORMAL
- en: There is a known issue of installation failing while having—SCVMM in computer
    name of SCVMM server. You can try renaming the server by removing "`-`" from hostname
    or changing it to `scvmm` or any other characters.
  prefs: []
  type: TYPE_NORMAL
- en: Post-installation tasks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Following are the post installation tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: Verify successful VMM installation by logging into VMM server using VMM console.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add SCVMM-admins group to SCVMM administrator in VMM console settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create RunAs accounts for hypervisor and more related operations.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Update SCVMM with the latest updates and patches.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Highly available SCVMM architecture and deployment
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As covered in *VMM* *architecture and deployment models* section, SCVMM can
    be deployed in high availability mode using Windows Server Failover Clustering.
    By deploying SCVMM in high availability mode on the top of Microsoft Windows Failover
    Cluster Services, it can be protected against both hardware and software level
    failures.
  prefs: []
  type: TYPE_NORMAL
- en: 'Deploying SCVMM management server in a cluster has some prerequisite which
    needs to be fulfilled:'
  prefs: []
  type: TYPE_NORMAL
- en: '**VMM Service Account**: The Virtual Machine Management service on the SCVMM
    server must be configured to run with a domain account. You cannot use a local
    system account to run a VMM service in HA mode. This service account has to be
    a member of the local administrator''s group on SCVMM server Windows.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Container in Active Directory for Distributed Key Management**: VMM stores
    all configurations and user account details such as RunAs account credentials
    in a SQL database. Credentials security is of utmost importance in every scenario,
    and SCVMM takes care of security by storing these credentials in encrypted form.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'There are two ways to encrypt these credentials:'
  prefs: []
  type: TYPE_NORMAL
- en: '**DPAPI**: DPAPI uses computer hardware ID (on which SCVMM is installed) to
    encrypt the credentials.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**DKM**: In the case of DKM SCVMM, it stores the encrypted keys in a container
    in Active Directory. These encryption keys aren''t tied to any physical parameter
    of any of SCVMM server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In a clustered deployment, SCVMM Virtual Machine Management service shall be
    running on multiple nodes which make DPAPI encryption technique unusable. For
    cluster deployment DKM is mandatory to be used.
  prefs: []
  type: TYPE_NORMAL
- en: As a prerequisite of deploying SCVMM in a cluster, a container needs to be created
    in Active Directory prior to installing SCVMM. This container will be used to
    store the encrypted keys for various SCVMM credentials.
  prefs: []
  type: TYPE_NORMAL
- en: 'Steps to deploy a highly available VMM Management Server are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Complete the prerequisite for VMM service account and AD container.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Join VMM servers to Windows Server Failover Cluster.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Execute the SCVMM installation setup; the setup automatically detects that setup
    is running on cluster node and gives the option to deploy VMM in highly available
    mode.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Follow the SCVMM installation guidelines given in the last topic.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a cluster name and DKM container location when asked.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add other SCVMM node by executing the setup, the setup will automatically detect
    the cluster and SCVMM configuration deployed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once deployed successfully, Failover Cluster Manager can be used to view cluster
    status and switch services as and when required.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Planning and configuring hypervisor compute layer with SCVMM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section we will learn to plan and configure hypervisor resources such
    as Hyper-V hosts and clusters, VMware and Citrix hypervisors. In a WAP-based cloud
    solution the hypervisor layer has to be in control of SCVMM for IaaS services
    provisioning and lifecycle management.
  prefs: []
  type: TYPE_NORMAL
- en: In this section we will cover various ways of adding and managing a hypervisor
    layer in SCVMM.
  prefs: []
  type: TYPE_NORMAL
- en: Planning and creating SCVMM host groups
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In a large scale cloud deployment comprising hundreds of Hyper-V hosts and thousands
    of virtual machines or more, managing the hosts effectively in terms of resource
    provisioning and controlling becomes challenging. SCVMM host groups can be used
    to avoid such challenges, it provides flexibilities to group multiple hypervisor
    hosts and uses as a single entity for resource provisioning and management.
  prefs: []
  type: TYPE_NORMAL
- en: 'Host group planning would have a different foundation and strategy for organizations
    and service providers. A few common options are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Site or geo location
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Performance and capabilities such as fault tolerance and so on
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Isolated environment of the web zone environment such as DMZ
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dedicated host groups for large tenants in a service provider's cloud
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host groups with or without BC and DR
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cloud management infra and tenant workload infra
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Many more
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We can add Hyper-V hosts or clusters and VMware/Citrix hosts in a host group
    and define various settings at host group level such as:'
  prefs: []
  type: TYPE_NORMAL
- en: General settings.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Placement rules.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host reserve settings (CPU, memory, network and storage bandwidth, and so on.)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dynamic optimization.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Power optimization.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network and storage resources and quota.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PRO configuration.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Custom properties.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host groups can be nested to providers' greater level of hierarchy and management.
    By default child host groups inherit parent host group settings and policies,
    which can be overridden at child host group level. Hypervisor hosts can be moved
    from one host group to another.
  prefs: []
  type: TYPE_NORMAL
- en: You can create SCVMM cloud consisting of multiple host groups. SCVMM cloud will
    be discussed in detail in [Chapter 4](part0040_split_000.html#164MG1-b479cf466c26404ca54119871a9b2715
    "Chapter 4. Building VM Clouds and IaaS Offerings"), *Building VM Clouds and IaaS
    Offerings*.
  prefs: []
  type: TYPE_NORMAL
- en: Creating host groups
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Following are the steps to create host groups:'
  prefs: []
  type: TYPE_NORMAL
- en: Login to SCVMM server using VMM console and open fabric workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand **Servers** in the **Fabric** menu, right click on **All Hosts**.![Creating
    host groups](img/00018.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Create Host Group** and provide the host group friendly name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configure host group properties.![Creating host groups](img/00019.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Adding virtual machine hosts in host groups
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: After creating host groups, we can add virtual machine hosts in their respective
    group to apply host group level policies. We can choose to add already configured
    hypervisor or cluster or perform bare metal provisioning using SCVMM. We can also
    create a Hyper-V cluster of already configured standalone Hyper-V hosts using
    SCVMM.
  prefs: []
  type: TYPE_NORMAL
- en: Adding Hyper-V host in a host group
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Following are the steps to add a Hyper-V host in a host group:'
  prefs: []
  type: TYPE_NORMAL
- en: Login to SCVMM server using VMM console and open fabric workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right click on host group created and select **Add Hyper-V Hosts and Clusters**.![Adding
    Hyper-V host in a host group](img/00020.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the Windows Server location in the given option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide credentials for accessing the host by using RunAs account or manual
    credentials.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Fill in discovery scope details depending upon the server location provided
    earlier.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select target host groups and host setting.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the configuration summary and finish the wizard to add the host.![Adding
    Hyper-V host in a host group](img/00021.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Planning and configuring cloud network fabric with SCVMM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Cloud network is the most crucial and complex piece of any private or service
    provider's cloud. Cloud network has to be efficient and flexible enough to handle
    daily changing networking needs of tenants and businesses. Software defined networking
    is a key pillar of providing automated and flexible networking for tenants with
    complete isolation and extensibilities. In this section we will learn various
    cloud network solution components for both private cloud and service providers'
    cloud in a WAP cloud.
  prefs: []
  type: TYPE_NORMAL
- en: Before getting into tenant workload networking needs, it is crucial to note
    that networking for cloud management infra and tenant workload infrastructure
    should be kept separate. Also known as Control Plane and Data Plane in networking
    languages, management infra networking should be kept separate in terms of provisioning
    and management. Demystifying the recommendation, assume a scenario where cloud
    network is down due to some issue with the physical network, and you are not able
    to make any changes to the cloud network solution to get it up and running because
    network controller VM was also running on the same problematic network. Follow
    the same cloud management and tenant workload infrastructure recommendation while
    designing cloud networking Control and Data plane.
  prefs: []
  type: TYPE_NORMAL
- en: 'Private cloud and service providers'' cloud would have different networking
    requirement, let''s have a look at major cloud networking requirement for both
    and their solution in our WAP cloud:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cloud networking needs for a private cloud:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Secure and reliable virtual networking with easy management
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Isolated network capabilities for **T&D environments**
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Separate zone separated by firewall depending upon network traffic
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Faster and automated network provisioning
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: IP address automated allocation and managed
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Extensibility to support custom needs
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Quality of service control
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Load balancing and physical network integration capabilities
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Hardware independent configurations
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Cloud networking needs for a service provider''s cloud:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Complete isolation between different tenants' networks while using the same
    physical network
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Extensibility to support hybrid networking model with a tenant's on-premises
    deployment
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Automated provisioning and tenant controlled management
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Advanced address translation capabilities with limited resources such as gateways
    and more for public facing services
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: No IP range usage constraints
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Easily manageable and open to dynamic changes
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Quality of service as per the tenant's plans and subscriptions
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: All enterprise class networking features such as load balancing and physical
    network integrated or hardware independent configurations
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: WAP along with system center and Hyper-V provides true cloud networking capabilities
    for requirements of private clouds and service providers' cloud. Networking capabilities
    of SCVMM such as logical networks and switches, network load balancing integration,
    network virtualization (the BIG thing), network virtualization gateways, port
    profiles along with automation and self-service experience of Windows Azure Pack
    provide solutions to all these requirements of organizations and service providers.
  prefs: []
  type: TYPE_NORMAL
- en: Network Virtualization
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Network Virtualization allows us to create multiple independent networks on
    the same physical hardware, traveling and routing on the same physical NIC cards
    and network switches/routes with complete isolation to each other. Network Virtualization
    is the foundation of one of the most modern networking technologies today, that
    is Software Defined Networking. Network Virtualization enables transforming of
    traditional physical network devices such as routers, firewalls, and load balancers
    into software. Software Defined Networking enables all networking features from
    layer 2 to 7 with isolation and multi-tenancy. Network Virtualization is a must
    have technology for cloud service providers in order to facilitate flexible isolated
    networking for tenants without any dependency on each other.
  prefs: []
  type: TYPE_NORMAL
- en: Hyper-V **Network Virtualization using General Routing Encapsulation** (**NVGRE**)
    mechanism is used to facilitate virtualized networks for virtual machines. Windows
    Azure Pack with SCVMM and Hyper-V provides true self service automated virtual
    networks for private and service providers' cloud solutions. Hyper-V and VMM provides
    Network Virtualization gateways to enable virtualized network traffic communication
    with physical networks and the outside world.
  prefs: []
  type: TYPE_NORMAL
- en: Each VM connected to a virtualized network has two IP associated with it, one
    from the virtual network known as **customer address** (**CA**) and the other
    from a cloud **provider's address** (**PA**). Hyper-V Network Virtualization encapsulates
    the CA address network packet using PA, source and destination IP and virtual
    network ID while transmitting the packet so that it can travel on a physical network.
    On the receiver end it decapsulates the packet and transmits the packet with the
    CA address only in the other virtual machine.
  prefs: []
  type: TYPE_NORMAL
- en: Network Virtualization works at Hyper-V virtual switch level on Hyper-V hosts.
    Hyper-V virtual switch on Server 2012 onwards can be extended to provide additional
    functionalities apart from default layer 2 responsibilities. Additional extension
    can be programmed and implemented on a virtual switch for additional features
    for network and security such as network filtering, virtual firewalls, and so
    on. This enables a true Software Defined Network infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: There is no separate dedicated NIC requirements for implementing network virtualization,
    we can use same NIC or virtual switch for both types of traffic including traditional
    networks as well as virtualized networks.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The provider address doesn't need to be the IP of physical NIC or team, in VMM
    it comes from the IP pool configured in the logical network.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring networking fabric in SCVMM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this section we will configure networking fabric in SCVMM for traditional
    and virtualized networks. There are multiple network resources when it comes to
    configuring networking fabric in VMM:'
  prefs: []
  type: TYPE_NORMAL
- en: Logical network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MAC address pools
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Load balancers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VIP templates
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Logical switches
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Port profiles
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Port classifications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VM networks (available in VM and services workspace)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Logical networks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A logical network in SCVMM is the top level hierarchy of SCVMM network fabric.
    It can be used to represent a network site, or a different network domain. Logical
    networks can consist of multiple virtual machine networks. Multiple logical networks
    can be created such as production network, T&D logical network. Logical networks
    can be assigned to hosts and host groups.
  prefs: []
  type: TYPE_NORMAL
- en: In a traditional network, create logical network corresponding to a physical
    network in your environment such as DMZ, backup, internal and so on. One virtual
    machine network per logical network shall be created in this scenario.
  prefs: []
  type: TYPE_NORMAL
- en: Network Virtualization is enabled at logical network level.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a logical network
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The following steps have to be followed to create a logical network:'
  prefs: []
  type: TYPE_NORMAL
- en: Login to VMM server using VMM console and select fabric workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand **Networking** and click on **Logical Networks**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right click on **Logical Networks** and click on **Create Logical Network**.![Creating
    a logical network](img/00022.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type the name of the logical network such as **WAP-CLOUD-PROD**, along with
    the optional description for easy identification in case of large deployments.
    Select **One connected network** or VLAN based network or PVLAN network as per
    your network topology.![Creating a logical network](img/00023.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Next** and add the network site in the logical network. Select a host
    group that can use this logical network along with the **VLAN** ID and **IP subnet**.![Creating
    a logical network](img/00024.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the configurations on the **Summary** page and click **Finish** to create
    the network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating an IP pool for the newly created logical network
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: IP pools are created to provide a usable IP address range to VMM for IP allocation.
    IP pools assigned to a logical network are also used to provide PA (provider address)
    in Network Virtualization.
  prefs: []
  type: TYPE_NORMAL
- en: Open **Fabric** | **Networking** in VMM console.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Expand the logical network and right click on the logical network to select
    **Create IP Pool**.![Creating an IP pool for the newly created logical network](img/00025.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the IP pool name and description and select the logical network we created.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On **Network Sites**, click **Use an existing network site**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next enter a usable IP range.![Creating an IP pool for the newly created logical
    network](img/00026.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a gateway for the given IP range.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configure DNS, DNS Suffix and WINS settings if any.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the settings on the **Summary** page and create the IP pool.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating a Virtualized VM Network and IP Pool on the Logical Network
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: VM networks are used by virtual machine network adaptors to connect with a virtualized
    VM network use a logical network for PA. In a traditional network scenario one
    VM network is created per logical network and used by virtual machines. It is
    also possible to automatically create virtual network corresponding to the logical
    network.
  prefs: []
  type: TYPE_NORMAL
- en: Create a VM network
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The following are the steps to create a VM network:'
  prefs: []
  type: TYPE_NORMAL
- en: Login to the VMM console and select **Logical Network**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right click on **Logical Network** and select **Create VM network**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide name and description for VM network for identification. Select corresponding
    logical network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configure the Isolation setting, click **Isolation using Hyper-V network virtualization**
    for isolated networks.![Create a VM network](img/00027.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the Virtual Network **Name** and **Subnet**.![Create a VM network](img/00028.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select a Hyper-V Network Virtualization gateway if any.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the configuration and finish the wizard for creating the VM network.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create an IP pool for each VM network created by using the Create IP Pool wizard
    for VM network.
  prefs: []
  type: TYPE_NORMAL
- en: The next steps in a private or service provider's cloud networking deployment
    is to create and attach all logical network and VM networks as per cloud network
    design and attach to host groups accordingly.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: VM Network management wizard is available in the "VM and Services" workspace
    in VMM Console, not in fabric workspace.
  prefs: []
  type: TYPE_NORMAL
- en: Apart from logical networks, VM networks and IP pools, VMM provides multiple
    other network resources mentioned above to add greater management control and
    flexibility on your cloud's network fabric.
  prefs: []
  type: TYPE_NORMAL
- en: MAC address pool
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: MAC address pool allows you to provide a custom static MAC address for your
    virtual machine. While the VMM given MAC address pool is created by default, you
    can always create a new one as per requirement.
  prefs: []
  type: TYPE_NORMAL
- en: Load balancers
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: By using load balancing, you can easily distribute traffic between multiple
    servers for a scaled application. SCVMM has inbuilt support of using Microsoft
    NLB as a native load balancing provider, you can also add custom configurations
    for supported third party load balancer integration such as F5, Citrix and more.
    Custom configuration providers need to be installed for third party integration.
  prefs: []
  type: TYPE_NORMAL
- en: VIP template
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: VIP templates are configurations which are utilized by load balancers for virtual
    IP needs. They can be used for configuring VIP configuration for load balancing
    traffic rules such for HTTPS and so on.
  prefs: []
  type: TYPE_NORMAL
- en: Logical switches
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: These enable centralized networking deployment on your Hyper-V hosts. Logical
    switches can be configured to use specific port mapping, classifications and extensions.
  prefs: []
  type: TYPE_NORMAL
- en: Port profiles
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Port profiles enable deploying consistent network settings such as QoS, and
    advanced security features across all Hyper-V hosts.
  prefs: []
  type: TYPE_NORMAL
- en: Port classifications
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Port classifications can be used to classify ports such as 10GB networks, low
    bandwidth networks.
  prefs: []
  type: TYPE_NORMAL
- en: Network service
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In network services, third party network devices can be integrated with SCVMM
    such as TOR switches and so on.
  prefs: []
  type: TYPE_NORMAL
- en: Planning and configuring cloud storage fabric with SCVMM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Microsoft Windows Azure Pack based cloud solution support both block based storage
    and file based storage configured with VMM for storing virtual machines and other
    cloud IaaS resources.
  prefs: []
  type: TYPE_NORMAL
- en: Storage requirements and solutions are likely to be different for private clouds
    and service provider clouds. While it is common to see traditional enterprise
    class SAN storage solutions in private clouds, software defined storage solutions
    on commodity hardware are also in use for both private and service provider cloud
    solution. VMM supports a wide range of storage solution integration for automated
    provisioning and management solving storage challenges for both private clouds
    and service provider clouds.
  prefs: []
  type: TYPE_NORMAL
- en: In the case of block based storage, VMM can take advantage of **Storage Area
    Network** (**SAN**) using Fibre Channel, iSCSI and SAS storage connectivity solutions
    for storing virtual machines and resources.
  prefs: []
  type: TYPE_NORMAL
- en: For file based storages, VMM can be integrated with storage solutions supporting
    SMB 3.0 protocol for file based storage access. Windows server file server provides
    SMB capabilities, enabling shared storage capabilities without purchasing expensive
    storage array solutions.
  prefs: []
  type: TYPE_NORMAL
- en: Cloud storage deployment options in VMM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: There are various options available in VMM to store virtual machines and other
    cloud resources. Every storage appears to Hyper-V hosts as local or remote storage,
    local storage stands for storage devices locally attached or assigned to hosts
    where remote storage defines remotely connected LUNs. Let's have a look at major
    options for providing storage fabric in a VMM environment.
  prefs: []
  type: TYPE_NORMAL
- en: '**Directly attached storage (DAS)**: This is storage disks connected directly
    to hypervisor hosts, commonly in a form of disk drive inside a server chassis
    connected via inbuilt RAID controller or SAS based JBOD connectivity. This is
    dedicated to each host and isn''t shared. This doesn''t provide any high availability
    or host failure tolerance, hence is not recommended for production usage.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Traditional SAN arrays**: Enterprise class storage solutions from leading
    vendors such as EMC, NetApp, Hitachi and so on, comes under this category. These
    solutions can be used to store virtual machines on LUNs using FC/iSCSI and other
    connectivity mechanisms. VMM can be integrated with iSCSI target arrays by supporting
    both static and dynamic discovery.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Storage solutions with SMI-S or SMP providers**: Storage solutions which
    support integration with SCVMM using SMI-S or SMP protocol comes under this category.
    SMI-S enables automated storage provisioning and management using VMM console
    enabling a true automated cloud solution. It is recommended to integrate any supported
    existing traditional storage with VMM in a private cloud for automation at storage
    layer. See vendor specific guidelines for configuring SMI-S for VMM integration.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**File storage (SMB 3.0)**: With Windows Server 2012 R2 Hyper-V supports storing
    virtual machines on file shares accessible via SMB protocol. Windows Server based
    file server clusters can be deployed and integrated with VMM for storing cloud
    virtual machines and resources.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scale out file server**: Scale out file server is a Windows Server feature
    which ensures continuous availability of file share storage across multiple hosts
    simultaneously. SOFS can take advantages of JBOD connected for file server nodes
    to provide always available file shares to Hyper-V hosts. SOFS uses SMB protocol
    for providing storage access. SOFS can be easily provisioned and managed using
    System Center Virtual Machine Manager.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Software Defined Storage (Microsoft Storage Spaces)**: In today''s era of
    Software Defined infrastructure, Microsoft provides Windows storage spaces which
    can be utilized for delivering storage solutions on commodity hardware without
    purchasing expensive storage arrays. This can be utilized by cloud service providers
    for providing shared storage features and capabilities without investing in traditional
    storage solutions. Microsoft storage space groups physical disks together in a
    storage pool which can be used to create space for data storage requirements.
    It can be configured to protect failure at each level by maintain multiple copies
    of data. Storages spaces can be used to provide shared storage capabilities by
    using multiple nodes connected to JBOD trays.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A list of supported storage solutions for VMM integration can be found at [http://social.technet.microsoft.com/wiki/contents/articles/16100.system-center-2012-vmm-supported-storage-arrays.aspx](http://social.technet.microsoft.com/wiki/contents/articles/16100.system-center-2012-vmm-supported-storage-arrays.aspx)
  prefs: []
  type: TYPE_NORMAL
- en: Configuring storage fabric in VMM
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Let's have a look at the various configurable parameters available in VMM for
    storage fabric.
  prefs: []
  type: TYPE_NORMAL
- en: '**Storage classifications**: Storage classification can be used to provide
    a friendly name or container to storage resources available such as gold storage,
    silver storage differentiating upon factors such as capacity, performance, resiliency
    and more. This can ease daily administrative tasks while assigning storage by
    representing complex architecture in a simplified way. You can associate storage
    pools with classification for mapping resources with a friendly name. To create
    a storage classification you need to perform the following steps:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Login to VMM console and open **Fabric** workspace.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Right click on **Storage** | **Classification and Pools** to create classification.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a friendly name and description and click **Add**.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '![Configuring storage fabric in VMM](img/00029.jpeg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: '**Storage provider**: Storage provider provides options to add storage devices
    in VMM for automated LUN provisioning and management. VMM 2012 R2 provides flexibility
    to add the following storage solutions:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows based file server
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: SAN or NAS device discovered and managed by a SMI-S provider
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: SAN device managed by native SMP providers
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Fibre channel fabric discovered and managed by SMI-S providers
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: By integrating storage devices in VMM, we can provision and assign LUNs to Hyper-V
    hosts using VMM console, provisioning and management of storage devices can be
    performed using VMM, which allows the flexibility of having completed automated
    storage deployment and management.
  prefs: []
  type: TYPE_NORMAL
- en: 'Adding a storage device in VMM:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Launch VMM console and connect to VMM server with admin permissions.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Open fabric workspace, right click on **Providers** under the **Storage** section.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Add Storage Devices**, and select the type of device from the given
    option.![Configuring storage fabric in VMM](img/00030.jpeg)
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide discovery scope, credentials and more details depending upon the storage
    provider type.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Select an available storage device and finish the wizard to add.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the array listed in the VMM storage fabric workspace.
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Post storage device integration tasks:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create storage pools and LUNs
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Map the storage pool with classification created earlier
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Assign LUNs and storage pools to the hosts
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Manage and monitor storage resources
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning and Deploying Service Provider Foundation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: System Center Service Provider Foundation 2012 R2 is part of the System Center
    suite, available in System Center 2012 R2 Orchestrator installation media. SPF
    add multi-tenancy capabilities to System Center products such as SCVMM, SMA and
    more. SPF exposes an extensible OData Web Service that interacts with Virtual
    Machine Manager.
  prefs: []
  type: TYPE_NORMAL
- en: Service providers and organization can design and develop their own cloud portals,
    and take advantage of SPF for utilizing IaaS capabilities of SCVMM. Windows Azure
    Pack uses SPF to integrate with SCVMM for provisioning and managing cloud IaaS
    resources such as virtual machines, virtual networks and so on.
  prefs: []
  type: TYPE_NORMAL
- en: SPF architecture and deployment options
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'SPF is a collection of four web services as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**SPF Admin Web Service**: Admin Web Service is responsible for creating and
    managing tenants, roles, stamps (SCVMM) and more. It can be accessed on `https://SPFSERVER:8090/SC2012R2/Admin/Microsoft.Management.Odata.svc`.
    User running SPF Admin Web Service application pool must be a member of local
    administrator and `SPF_Admin` local group on SPF server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SPF VMM Web Service**: VMM Web Service is responsible for getting operations
    performed by Virtual Machine Manager such as creating virtual machines, networks,
    user roles and more. This service is also responsible to maintain and replicating
    change performed at components such as WAP and SCVMM. It can be accessed on'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`https://SPFSERVER:8090/SC2012R2/VMM/Microsoft.Management.Odata.svc`. The user
    running SPF Admin Web Service application pool must be a member of the local administrator,
    `SPF_VMM` local group and VMM administrators on SPF and VMM server respectively.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SPF Usage Service**: Usage Web Service integrates with System Center Operations
    Manager Data warehouse and is used by WAP or third party billing providers for
    gathering resources usage data. A user account running Usage Service must be a
    part of the local administrator and `SPF_Usage` group on the SPF server along
    with access on the SC Operations Manager data warehouse database.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**SPF Provider Service**: Provider Web Service is used by resource providers
    for delivering IaaS services. Provider services provide Microsoft ASP.NET Web
    API and not OData as in the case of other web services. Provider Service also
    uses the VMM and admin service. Users running the SPF Provider Web Service application
    pool must be a member of local administrator and SPF_Provider, SPF_VMM, and SPF_Admin
    local groups on the SPF Server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'System Center Service Provider Foundation can be deployed in two ways:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Standalone Single Server deployment**: In case of standalone deployment,
    only one server will be deployed in a solution with no redundancy. This is not
    recommended for production and is used for test and evaluation purposes only.
    All web services are always installed on the same server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Highly available scaled deployment**: SPF support highly available deployment
    with the use of load balancers. Hardware LBs or Microsoft NLB can be used for
    providing load balancing between multiple SPF servers. Multiple SPF servers can
    be deployed behind a load balancer pointing to a highly available database for
    providing HA capabilities to SPF deployment at each layer. This is the recommended
    deployment model for a production scenario.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing Service Provider Foundation 2012 R2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Like every other system center or Microsoft product, SPF also has a set of prerequisites
    which need to be met before starting installation. SPF installation binaries are
    included in System Center 2012 R2 Orchestrator media.
  prefs: []
  type: TYPE_NORMAL
- en: Installation prerequisites
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The following are the installation prerequisites.
  prefs: []
  type: TYPE_NORMAL
- en: 'Create SPF service accounts as follows (Active Directory Accounts):'
  prefs: []
  type: TYPE_NORMAL
- en: '| Account name | Purpose | Permissions |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Spfsvc | SPF service account for running IIS application pool | Member of
    local administrator + SPF local groups + SCVMM admin + SQLDB sysadmin |'
  prefs: []
  type: TYPE_TB
- en: '| Spflocal | Local account for SPF integration | Member of local administrator
    + SPF local groups + SCVMM admin |'
  prefs: []
  type: TYPE_TB
- en: Separate service accounts can also be created for admin, provider, usage and
    VMM application pool if required.
  prefs: []
  type: TYPE_NORMAL
- en: Software prerequisites
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following software needs to be installed before starting Service Provider
    Foundation installation:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Windows features:'
  prefs: []
  type: TYPE_NORMAL
- en: Management OData Internet Information Services (IIS) extension
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: NET Framework 4.5 features, WCF Services, and HTTP activation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'For Web Server (IIS) server install the following components of IIS:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Basic authentication
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows authentication
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Application deployment ASP.NET 4.5
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Application development ISAPI extensions
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Application deployment ISAPI filters
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: IIS Management scripts and Tools Role Service
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Web Services:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: WCF data services 5.0 for OData V3
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: ASP.NET MVC 4
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Virtual Machine Manager 2012 R2 Console
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Certificates SPF creates self-signed certificate, CA provided SSL certificates
    should be created for production deployments
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The local account is used by Windows Azure Pack for registering SPF.
  prefs: []
  type: TYPE_NORMAL
- en: Installation procedure
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following is the installation procedure:'
  prefs: []
  type: TYPE_NORMAL
- en: Login to SPF server and mount System Center Orchestrator media.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run `SetupOrchestrator.exe` from the mounted media.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Service Provider Foundation** under the **Standalone installation**
    section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This will launch the **SPF Installation wizard**, click **Install** to proceed
    further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Accept the agreement and proceed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Setup will check for prerequisite check, proceed if all checks are completed
    successfully. Review errors in case of any failure.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide database **Server** IP and **Port number** along with **Database name**.![Installation
    procedure](img/00031.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the installation folder for SPF files and a port number. (By default
    `C:\intepub` and `8090`). Select **Generate self signed certificate** or provide
    pre-created SSL for SPF.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: SPF automatically creates local groups on the SPF server for administrative
    permissions, provide SPF Admin service account and admin account, SCVMM-Admins
    group and SPF local account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide service account details for each service that is, admin web, VMM, usage
    and provider.![Installation procedure](img/00032.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the installation configuration and summary and proceed further for installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Close the wizard on successful installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Post-installation tasks
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The following are the post installation tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: Verify successful installation and application pools status in IIS.![Post-installation
    tasks](img/00033.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify local groups created in the SPF server, add `spflocal user` in all groups.![Post-installation
    tasks](img/00034.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable **Basic Authentication** for the SPF website, this is a requirement for
    WAP integration.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter we learned about planning for cloud fabric for private cloud
    needs and service providers. We covered infrastructure planning at each layer
    starting from hardware to hypervisors, network and storage. Hyper-V deployment
    best practices were also covered which will help in deploying a reliable and stable
    hypervisor layer.
  prefs: []
  type: TYPE_NORMAL
- en: We learned about SCVMM and SPF architecture and has installation walkthrough
    for both products. We learned about planning and configuration of compute, network
    and storage for cloud fabric in SCVMM.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter we will be covering installation and configuration of Windows
    Azure Pack portals, API's and authentication sites.
  prefs: []
  type: TYPE_NORMAL
