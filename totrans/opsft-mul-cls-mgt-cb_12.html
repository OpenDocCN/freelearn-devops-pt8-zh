<html><head></head><body>
		<div id="_idContainer307">
			<h1 id="_idParaDest-239" class="chapter-number"><a id="_idTextAnchor251"/>12</h1>
			<h1 id="_idParaDest-240"><a id="_idTextAnchor252"/>OpenShift Multi-Cluster Security</h1>
			<p>In <a href="B18015_08.xhtml#_idTextAnchor153"><em class="italic">Chapter 8</em></a>, <em class="italic">OpenShift Security</em>, we discussed some important aspects you may consider for defining and implementing security policies for your OpenShift cluster. We went through aspects such as authentication and authorization, certifications and encryption, container and network isolation, and others. If you haven't gone through that chapter yet, we encourage you to take a look now before reading this one.</p>
			<p>Implementing security policies on OpenShift is important, but not really complicated in general – most policies’ configuration is straightforward and well documented. Things become more complicated when you scale your infrastructure to several clusters though. How can you be sure that all the containers that run on top of several clusters are using secure and certified base images? Do you know how compliant all your environments are according to industry and regulatory standards such as PCI and HIPAA? To help you to monitor and maximize your OpenShift and Kubernetes clusters’ security, we will introduce in this chapter Red Hat <strong class="bold">Advanced Cluster Security</strong> (<strong class="bold">ACS</strong>).</p>
			<p>Therefore, you will find the following topics covered in this chapter:</p>
			<ul>
				<li>What is Red Hat Advanced Cluster Security?</li>
				<li>Red Hat Advanced Cluster Security installation</li>
				<li>Adding secured clusters</li>
				<li>Policies and violations</li>
				<li>Vulnerability management</li>
				<li>Risk profiling</li>
				<li>Configuration management</li>
				<li>Network segmentation</li>
			</ul>
			<p>Let’s dive into it now!</p>
			<h1 id="_idParaDest-241"><a id="_idTextAnchor253"/>What is Red Hat Advanced Cluster Security?</h1>
			<p>Red Hat Advanced Cluster Security, also<a id="_idIndexMarker856"/> known as StackRox, is a Kubernetes-native security tool that provides the following features:</p>
			<ul>
				<li><strong class="bold">Policies and violations</strong>: Defines<a id="_idIndexMarker857"/> security policies and has a report of all violation events in real time. You can <a id="_idIndexMarker858"/>define your own policies and/or use dozens of policies that come out of the box.</li>
				<li><strong class="bold">Vulnerability management</strong>: Detects<a id="_idIndexMarker859"/> known vulnerabilities in your clusters to give you the weapons you need to remediate and prevent security issues.</li>
				<li><strong class="bold">Risk profiling</strong>: Assesses <a id="_idIndexMarker860"/>the risk of your environment and classifies applications according to their security risk.</li>
				<li><strong class="bold">Compliance</strong>: Reports the compliance<a id="_idIndexMarker861"/> of your clusters according to some industry-standard security profiles.</li>
				<li><strong class="bold">Configuration management</strong>: Helps <a id="_idIndexMarker862"/>you to make sure your deployments follow the security best practices.</li>
				<li><strong class="bold">Network segmentation</strong>: Views<a id="_idIndexMarker863"/> the network traffic between different namespaces and allows you to create Network Policies to restrict and isolate traffic.</li>
			</ul>
			<p>Recent research conducted by <em class="italic">KuppingerCole</em> recognized Red Hat Advanced Cluster Security as the overall leader in the Kubernetes security segment. It is indeed a great product that is included with<a id="_idIndexMarker864"/> the <strong class="bold">Red Hat OpenShift Plus</strong> offering, which we will discuss in more detail in the next chapter. In the <em class="italic">Further reading</em> section of this chapter, you can find a link to <em class="italic">KuppingerCole’s</em> research.</p>
			<p>We encourage you to experiment with ACS if you have an active OpenShift Plus subscription or reach out to Red Hat’s account team that covers your company for more information a<a id="_idTextAnchor254"/>bout it.</p>
			<h1 id="_idParaDest-242"><a id="_idTextAnchor255"/>Red Hat Advanced Cluster Security installation</h1>
			<p>The installation <a id="_idIndexMarker865"/>process of ACS is similar to what you have seen in the last chapter with ACM: through an Operator. However, you can also install it<a id="_idIndexMarker866"/> using <strong class="bold">Helm charts</strong> or the <strong class="bold">roxctl</strong> CLI. In this book, we will use the Operator installation; if you want more <a id="_idIndexMarker867"/>information about the Helm or roxctl installation process, refer to the official documentation. You can find links to the official documentation in the <em class="italic">Further reading</em> section of this chapter.</p>
			<p>To install ACS using the operator, proceed as follows.</p>
			<h2 id="_idParaDest-243"><a id="_idTextAnchor256"/>Prerequisites</h2>
			<ol>
				<li>You will need access to <a id="_idIndexMarker868"/>an OpenShift cluster with cluster-admin permissions.</li>
			</ol>
			<h2 id="_idParaDest-244"><a id="_idTextAnchor257"/>Operator installation</h2>
			<p>Follow the next<a id="_idIndexMarker869"/> steps to get the ACS operator ready for use:.</p>
			<ol>
				<li value="1">Access the OpenShift Web Console using the Administrator’s perspective.</li>
				<li>Navigate to the <strong class="bold">Operators</strong> | <strong class="bold">OperatorHub</strong> menu item.</li>
			</ol>
			<div>
				<div id="_idContainer248" class="IMG---Figure">
					<img src="image/B18015_12_01.jpg" alt="Figure 12.1 – OperatorHub "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.1 – OperatorHub</p>
			<ol>
				<li value="3">Search <a id="_idIndexMarker870"/>for <strong class="source-inline">Advanced Cluster Security for Kubernetes</strong> using the <em class="italic">Filter by keyword...</em> box.</li>
			</ol>
			<div>
				<div id="_idContainer249" class="IMG---Figure">
					<img src="image/B18015_12_02.jpg" alt="Figure 12.2 – Advanced Cluster Security for Kubernetes on OperatorHub "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.2 – Advanced Cluster Security for Kubernetes on OperatorHub</p>
			<ol>
				<li value="4">Click on<a id="_idIndexMarker871"/> the <strong class="bold">Advanced Cluster Security for Kubernetes</strong> tile and on the <strong class="bold">Install</strong> button to see the <strong class="bold">Install Operator</strong> screen.</li>
			</ol>
			<div>
				<div id="_idContainer250" class="IMG---Figure">
					<img src="image/B18015_12_03.jpg" alt="Figure 12.3 – Installing Advanced Cluster Security for Kubernetes "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.3 – Installing Advanced Cluster Security for Kubernetes</p>
			<ol>
				<li value="5">Don’t change the default namespace (<strong class="source-inline">rhacs-operator</strong>).</li>
				<li>Select <strong class="bold">Automatic</strong> or <strong class="bold">Manual</strong> for the upgrades <strong class="bold">Approval Strategy</strong>. If you select <strong class="bold">Automatic</strong>, upgrades will be performed automatically by the <strong class="bold">Operator Lifecycle Manager</strong> (<strong class="bold">OLM</strong>) as <a id="_idIndexMarker872"/>soon as they are released by Red Hat, while in <strong class="bold">Manual</strong>, you need to approve upgrades before being applied.</li>
				<li>Select the proper <strong class="bold">Update channel</strong>. The latest channel is recommended as it contains the latest stable and <em class="italic">supported</em> version of the operator.</li>
				<li>Click<a id="_idIndexMarker873"/> the <strong class="bold">Install</strong> button.</li>
			</ol>
			<div>
				<div id="_idContainer251" class="IMG---Figure">
					<img src="image/B18015_12_04.jpg" alt="Figure 12.4 – Installing the operator "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.4 – Installing the operator</p>
			<ol>
				<li value="9">Wait up to 5 minutes until you see the following <a id="_idIndexMarker874"/>message:</li>
			</ol>
			<div>
				<div id="_idContainer252" class="IMG---Figure">
					<img src="image/B18015_12_05.jpg" alt="Figure 12.5 – Operator installed "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.5 – Operator installed</p>
			<p>Now that we <a id="_idIndexMarker875"/>have the operator installed, the next step is to deploy the ACS Central custom resource. See next how to do it.</p>
			<h2 id="_idParaDest-245"><a id="_idTextAnchor258"/>ACS Central installation</h2>
			<p>We can <a id="_idIndexMarker876"/>now go ahead and deploy a new ACS <em class="italic">Central</em> instance:</p>
			<ol>
				<li value="1">Click on the <strong class="bold">View Operator</strong> button or navigate to the <strong class="bold">Operators</strong> | <strong class="bold">Installed Operators</strong> menu and click on <strong class="bold">Advanced Cluster Security for Kubernetes</strong>.</li>
				<li>Access the <strong class="bold">Central</strong> tab and click on the <strong class="bold">Create Central</strong> button.</li>
			</ol>
			<div>
				<div id="_idContainer253" class="IMG---Figure">
					<img src="image/B18015_12_06.jpg" alt="Figure 12.6 – Creating a new ACS Central instance "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.6 – Creating a new ACS Central instance</p>
			<ol>
				<li value="3">Usually, no<a id="_idIndexMarker877"/> changes are needed, so leave the default values and click on the <strong class="bold">Create</strong> button. Check out the link in the <em class="italic">Further reading</em> section of this chapter for product documentation for more information if you need to configure some advanced settings.</li>
			</ol>
			<div>
				<div id="_idContainer254" class="IMG---Figure">
					<img src="image/B18015_12_07.jpg" alt="Figure 12.7 – Create ACS Central "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.7 – Create ACS Central</p>
			<ol>
				<li value="4">Wait a <a id="_idIndexMarker878"/>few seconds until you see the <strong class="bold">Conditions: Deployed, Initialized</strong> status.</li>
			</ol>
			<div>
				<div id="_idContainer255" class="IMG---Figure">
					<img src="image/B18015_12_08.jpg" alt="Figure 12.8 – ACS Central installed "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.8 – ACS Central installed</p>
			<ol>
				<li value="5">To access the recently created ACS Central portal, you need to first get the admin credentials. To do so, navigate to <strong class="bold">Workloads</strong> | <strong class="bold">Secrets</strong> in the <strong class="source-inline">rhacs-operator</strong> project and click on the <strong class="source-inline">central-htpasswd</strong> secret.</li>
			</ol>
			<div>
				<div id="_idContainer256" class="IMG---Figure">
					<img src="image/B18015_12_09.jpg" alt="Figure 12.9 – Admin credentials secret "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.9 – Admin credentials secret</p>
			<ol>
				<li value="6">Scroll<a id="_idIndexMarker879"/> down and click on <strong class="bold">Reveal values</strong>. Copy the value in the <strong class="bold">password</strong> field.</li>
			</ol>
			<div>
				<div id="_idContainer257" class="IMG---Figure">
					<img src="image/B18015_12_10.jpg" alt="Figure 12.10 – Copy the admin password "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.10 – Copy the admin password</p>
			<ol>
				<li value="7">Now go<a id="_idIndexMarker880"/> to <strong class="bold">Networking</strong> | <strong class="bold">Routes</strong> to get the ACS Central URL:</li>
			</ol>
			<div>
				<div id="_idContainer258" class="IMG---Figure">
					<img src="image/Image91621.jpg" alt="Figure 12.11 – ACS Central URL "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.11 – ACS Central URL</p>
			<ol>
				<li value="8">Use the admin username and the password you copied from the secret.</li>
			</ol>
			<div>
				<div id="_idContainer259" class="IMG---Figure">
					<img src="image/B18015_12_12.jpg" alt="Figure 12.12 – Red Hat ACS login page "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.12 – Red Hat ACS login page</p>
			<p>You now have <a id="_idIndexMarker881"/>Red Hat Advanced Cluster Security installed. You will notice though that we don’t have any clusters under ACS management. We will add a managed cluster (also known as secured cluster) in the next steps.</p>
			<div>
				<div id="_idContainer260" class="IMG---Figure">
					<img src="image/B18015_12_13.jpg" alt="Figure 12.13 – Red Hat ACS initial page "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.13 – Red Hat ACS initial page</p>
			<p>Continue reading to see how to add secured clusters on ACS.</p>
			<h1 id="_idParaDest-246"><a id="_idTextAnchor259"/>Adding secured clusters</h1>
			<p><strong class="bold">Secured cluster</strong> is the <a id="_idIndexMarker882"/>term used to refer to a cluster under ACS management. ACS Central works as a control plane where you will create the policies and visualize violations, compliance, and all the features that we will walk through later in this chapter; while an ACS secured cluster is a set of ACS processes (<strong class="bold">AdmissionControl</strong>, <strong class="bold">Scanner</strong>, <strong class="bold">Sensor</strong>, and <strong class="bold">Collector</strong>) that run on managed clusters to monitor and enforce policies.</p>
			<div>
				<div id="_idContainer261" class="IMG---Figure">
					<img src="image/B18015_12_14.jpg" alt="Figure 12.14 – ACS Central/secured cluster "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.14 – ACS Central/secured cluster</p>
			<p>The <a id="_idIndexMarker883"/>process of adding secured clusters on ACS Central comprises the following steps:</p>
			<ol>
				<li value="1">Generate an <strong class="source-inline">init</strong> bundle on ACS Central.</li>
				<li>Run the <strong class="source-inline">init</strong> bundle.</li>
				<li>Create a <strong class="source-inline">SecuredCluster</strong> custom resource in the ACS operator.</li>
			</ol>
			<p>To perform the previous steps and add a secured cluster, run the following steps in <strong class="bold">ACS Central</strong>:</p>
			<ol>
				<li value="1">Access the <strong class="bold">Platform Configuration</strong> | <strong class="bold">Integrations</strong> menu:</li>
			</ol>
			<div>
				<div id="_idContainer262" class="IMG---Figure">
					<img src="image/B18015_12_15.jpg" alt="Figure 12.15 – Generating an init bundle "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.15 – Generating an init bundle</p>
			<ol>
				<li value="2">Scroll <a id="_idIndexMarker884"/>down and click on <strong class="bold">Authentication Tokens</strong> | <strong class="bold">Cluster Init Bundle</strong>.</li>
			</ol>
			<div>
				<div id="_idContainer263" class="IMG---Figure">
					<img src="image/B18015_12_16.jpg" alt="Figure 12.16 – Generating an init bundle "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.16 – Generating an init bundle</p>
			<ol>
				<li value="3">Click on <strong class="bold">Generate bundle</strong>, give it a name, and click on the <strong class="bold">Download Kubernetes secrets file</strong> button:</li>
			</ol>
			<div>
				<div id="_idContainer264" class="IMG---Figure">
					<img src="image/B18015_12_17.jpg" alt="Figure 12.17 – Generating the init bundle "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.17 – Generating the init bundle</p>
			<p>Now, access <a id="_idIndexMarker885"/>the OpenShift cluster that you want to add as a secured cluster (not ACS Central).</p>
			<ol>
				<li value="4">Using a terminal with the <strong class="source-inline">oc</strong> CLI, run the following command. Note that you need to run this command in the secured cluster and not on ACS Central:<p class="source-code">$ oc create namespace rhacs-operator</p><p class="source-code">$ oc create –f &lt;cluster-init-secrets&gt;.yaml -n rhacs-operator</p><p class="source-code">secret/collector-tls created</p><p class="source-code">secret/sensor-tls created</p><p class="source-code">secret/admission-control-tls created</p></li>
				<li>Install the ACS operator in the secured cluster following the same steps we performed in the <em class="italic">Operator installation</em> section of this chapter. Note that this time, we are installing the operator in the secured cluster.</li>
			</ol>
			<div>
				<div id="_idContainer265" class="IMG---Figure">
					<img src="image/B18015_12_18.jpg" alt="Figure 12.18 – ACS Operator installed in the ACS secured cluster "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.18 – ACS Operator installed in the ACS secured cluster</p>
			<ol>
				<li value="6">Still in<a id="_idIndexMarker886"/>  the OpenShift secured cluster, navigate to <strong class="bold">Operators</strong> | <strong class="bold">Installed Operators</strong> and click on <strong class="bold">Advanced Cluster Security for Kubernetes</strong>. On this page, access the <strong class="bold">Secured Cluster</strong> tab:</li>
			</ol>
			<div>
				<div id="_idContainer266" class="IMG---Figure">
					<img src="image/B18015_12_19.jpg" alt="Figure 12.19 – Creating a new secured cluster "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.19 – Creating a new secured cluster</p>
			<ol>
				<li value="7">Click <a id="_idIndexMarker887"/>on the <strong class="bold">Create SecuredCluster</strong> button. On this page, give the cluster a name, add the ACS Central URL, and click on the <strong class="bold">Create</strong> button:</li>
			</ol>
			<div>
				<div id="_idContainer267" class="IMG---Figure">
					<img src="image/B18015_12_20.jpg" alt="Figure 12.20 – Adding a secured cluster "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.20 – Adding a secured cluster</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">Always add the <strong class="source-inline">port (:443</strong>) in <strong class="bold">Central Endpoint</strong>. The secured cluster sensor and scanner may fail if you don’t specify the port.</p>
			<ol>
				<li value="8">Wait up <a id="_idIndexMarker888"/>to 10 minutes for <strong class="bold">ACS Collector</strong>, <strong class="bold">Sensor</strong>, and <strong class="bold">AdmissionControl</strong> to spin up in the managed cluster. To check the status of the ACS managed cluster, access ACS Central and navigate to <strong class="bold">Platform Configuration</strong> | <strong class="bold">Clusters</strong>. The cluster should be marked in green as <strong class="bold">Healthy</strong>:</li>
			</ol>
			<div>
				<div id="_idContainer268" class="IMG---Figure">
					<img src="image/B18015_12_21.jpg" alt="Figure 12.21 – Secured cluster health "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.21 – Secured cluster health</p>
			<p class="callout-heading">Note</p>
			<p class="callout">It is normal to see <strong class="bold">Cluster Status</strong> as <strong class="bold">Degraded</strong> during the secured cluster deployment. Wait up to 10 minutes for it to be <strong class="bold">Healthy</strong>. Refresh your browser to check the latest status.</p>
			<p>We now <a id="_idIndexMarker889"/>have what we need to start using ACS: <strong class="bold">ACS Central </strong>monitoring one secured cluster. Continue to the next section to find out more about the ACS policies and violation features.</p>
			<h1 id="_idParaDest-247"><a id="_idTextAnchor260"/>Policies and violations</h1>
			<p>ACS comes<a id="_idIndexMarker890"/> with dozens of security policies defined out of the box that you can just start using and also allows you to define custom<a id="_idIndexMarker891"/> security policies for your Kubernetes clusters. You can also easily check what policies are violated using the <strong class="bold">Violations</strong> feature.</p>
			<p>In this section, we will see how to view and create policies and also walk through the Violations feature.</p>
			<h2 id="_idParaDest-248"><a id="_idTextAnchor261"/>Security policies</h2>
			<p>To access the <a id="_idIndexMarker892"/>security policies, navigate to <strong class="bold">Platform Configuration</strong> | <strong class="bold">Policies</strong>. All out-of-the-box policies will be listed in this view:</p>
			<div>
				<div id="_idContainer269" class="IMG---Figure">
					<img src="image/B18015_12_22.jpg" alt="Figure 12.22 – Security policies "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.22 – Security policies</p>
			<p>Let’s use a<a id="_idIndexMarker893"/> simple policy to learn how a security policy works on ACS. In the <strong class="bold">Filter policies</strong> box, type <strong class="source-inline">Policy</strong> and hit <em class="italic">Enter</em>; then type <strong class="source-inline">admin secret</strong> and hit <em class="italic">Enter</em> again to find the <strong class="source-inline">OpenShift: Advanced Cluster Security Central Admin Secret Accessed</strong> policy:</p>
			<div>
				<div id="_idContainer270" class="IMG---Figure">
					<img src="image/B18015_12_23.jpg" alt="Figure 12.23 – Latest tag policy "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.23 – Latest tag policy</p>
			<p>Now click on the link to see the <strong class="bold">Policy details</strong> page:</p>
			<div>
				<div id="_idContainer271" class="IMG---Figure">
					<img src="image/B18015_12_24.jpg" alt="Figure 12.24 – Policy details "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.24 – Policy details</p>
			<p>On this<a id="_idIndexMarker894"/> page, you will find policy details, such as <strong class="bold">Description</strong>, <strong class="bold">Type</strong>, and so on. Let’s go ahead and click on <strong class="bold">Actions</strong> | <strong class="bold">Edit policy</strong> to take a look at what we can set up as part of a policy.</p>
			<div>
				<div id="_idContainer272" class="IMG---Figure">
					<img src="image/B18015_12_25.jpg" alt="Figure 12.25 – Editing policy details "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.25 – Editing p<a id="_idTextAnchor262"/>olicy details</p>
			<p>The first<a id="_idIndexMarker895"/> screen we see is <strong class="bold">Policy details</strong>. On this page, you can change general policy information, such as <strong class="bold">Name</strong>, the <strong class="bold">Severity</strong> level, <strong class="bold">Categories</strong>, and <strong class="bold">Description<a id="_idTextAnchor263"/></strong>.</p>
			<p class="callout-heading">MITRE ATT&amp;CK</p>
			<p class="callout">MITRE ATT&amp;CK® is a<a id="_idIndexMarker896"/> knowledge base of tactics and techniques that are used often in cyberattacks on Kubernetes. First published by Microsoft in April 2020, it is a great source of security best practices for Kubernetes. ACS allows you to classify security policies according to the MITRE ATT&amp;CK® matrix. If you want to learn more about this framework, check the links in the <em class="italic">Further reading</em> section at the end of this chapter.</p>
			<p>The next screen is <strong class="bold">Policy behavior</strong>, which defines how the policy should be applied:</p>
			<div>
				<div id="_idContainer273" class="IMG---Figure">
					<img src="image/B18015_12_26.jpg" alt="Figure 12.26 – Policy behavior "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.26 – Policy behavior</p>
			<p>The<a id="_idIndexMarker897"/> life cycle stages define to which stage the policy applies:</p>
			<ol>
				<li value="1"><strong class="bold">Build</strong>: Policy applied during the build of a container image. Used in general as part of a CI pipeline for static analysis of YAML Kubernetes manifests or Dockerfile instructions.</li>
				<li><strong class="bold">Deploy</strong>: Policies in this stage will be fired during the application deployment and will inform or even block the deployment if it violates the policy, depending on what you configured in <strong class="bold">Response method</strong>.</li>
				<li><strong class="bold">Runtime</strong>: Policy applied during runtime. For runtime policies, you can define whether <strong class="bold">Event source</strong> will be from <strong class="bold">Deployment</strong> or <strong class="bold">Audit logs</strong>. With the <strong class="bold">Deployment</strong> event source, you can inform and block application deployments that violate the policy, while <strong class="bold">Audit logs</strong> is used to monitor Kubernetes API calls against <strong class="bold">Secrets</strong> and <strong class="bold">ConfigMaps</strong>, to search for suspicious activities, such as sensitive passwords being read – this is exactly what is done by the policy we are using in this example.</li>
			</ol>
			<p>You also can <a id="_idIndexMarker898"/>set up <strong class="bold">Response method</strong> for one of the following:</p>
			<ol>
				<li value="1"><strong class="bold">Inform</strong>: Only inform the violation by adding it as an item in the <strong class="bold">Violations</strong> feature.</li>
				<li><strong class="bold">Inform and enforce</strong>: Besides adding it to the violation list, it also enforces the following behavior, depending on the stage selected under Lifecycle stages:<ul><li><strong class="bold">Fails CI builds</strong> if the <strong class="bold">Build</strong> stage is selected.</li>
<li><strong class="bold">Blocks an application deployment</strong> that violates the policy if the <strong class="bold">Deploy</strong> phase is selected.</li>
<li><strong class="bold">Kills pods</strong> that violate the policy if the <strong class="bold">Runtime</strong> stage is selected.</li>
</ul></li>
			</ol>
			<p>The next step describes the policy criteria that will define the policy:</p>
			<div>
				<div id="_idContainer274" class="IMG---Figure">
					<img src="image/B18015_12_27.jpg" alt="Figure 12.27 – Editing policy criteria "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.27 – Editing <a id="_idTextAnchor264"/>policy criteria</p>
			<p><strong class="bold">Policy criteria</strong> differ according to <strong class="bold">the event source</strong>. When the event source is <strong class="bold">Deployment</strong>, then you can create Boolean logic based on a large set of entities related to the image, container configuration, metadata, storage, network, container runtime processes, and Kubernetes events. We encourage you to access different policies to check the different types of policy criteria available from existing policies.</p>
			<p>When the <a id="_idIndexMarker899"/>event source is <strong class="bold">Audit logs</strong>, the criteria are defined in terms of Kubernetes API events. Let’s check the policy that we are using as an example to learn how audit logs-based policy criteria work. In our example, the following criteria are used:</p>
			<ul>
				<li><strong class="screen-inline">Kubernetes resource</strong>: <strong class="bold">Secrets</strong></li>
				<li><strong class="screen-inline">Kubernetes API verb</strong>: <strong class="bold">GET</strong>, <strong class="bold">PATCH</strong>, or <strong class="bold">UPDATE</strong></li>
				<li><strong class="screen-inline">Kubernetes resource name</strong>: <strong class="source-inline">central-htpasswd</strong></li>
				<li><strong class="screen-inline">Kubernetes user name is NOT</strong>: <strong class="source-inline">system:serviceaccount:openshift-authentication-operator:rhacs-operator-controller-manager</strong></li>
			</ul>
			<p>This means that a violation will be raised when the <strong class="source-inline">central-htpasswd</strong> secret is either <strong class="bold">read</strong> (<strong class="source-inline">GET</strong>) or <strong class="bold">changed</strong> (<strong class="source-inline">PATCH</strong> or <strong class="source-inline">UPDATE</strong>) by <em class="italic">any user other than the </em><strong class="source-inline">rhacs-operator-controller-manager service account</strong>.</p>
			<p>You can also set the policy scope if you want:</p>
			<ol>
				<li value="1">Restrict the policy to only specific clusters, namespaces, or labels.</li>
				<li>Alternatively, exclude entities from the policy.</li>
				<li>Exclude images to be checked during the <strong class="bold">Build</strong> stage:</li>
			</ol>
			<div>
				<div id="_idContainer275" class="IMG---Figure">
					<img src="image/B18015_12_28.jpg" alt="Figure 12.28 – Exclude or restrict entities and images from policy "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.28 – Exclude or restrict entities and images from policy</p>
			<p>This concludes <a id="_idIndexMarker900"/>the configurations you will find in a policy. It is not that difficult, right? We encourage you to create some custom policies to practice and learn from them.</p>
			<h2 id="_idParaDest-249"><a id="_idTextAnchor265"/>Violations</h2>
			<p>The <strong class="bold">Violations</strong> feature<a id="_idIndexMarker901"/> lists all security policies that have been violated in the clusters monitored by ACS:</p>
			<div>
				<div id="_idContainer276" class="IMG---Figure">
					<img src="image/B18015_12_29.jpg" alt="Figure 12.29 – Violations list "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.29 – Violations list</p>
			<p>Remember <a id="_idIndexMarker902"/>that we read <strong class="source-inline">central-htpasswd</strong> in <em class="italic">step 15</em> of the <em class="italic">ACS Central installation</em> section to get the ACS Central admin password. That raised a violation due to the policy we used as an example previously (<strong class="source-inline">GET</strong><em class="italic"> API of </em><strong class="source-inline">central-htpasswd</strong><em class="italic"> secret</em>). Click on some of the violations you see on this page to explore the feature and learn about the events and data that are captured and shown by the ACS <strong class="bold">Violations</strong> feature:</p>
			<div>
				<div id="_idContainer277" class="IMG---Figure">
					<img src="image/B18015_12_30.jpg" alt="Figure 12.30 – Example of a violation "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.30 – Example of a violation</p>
			<p>In this section, we <a id="_idIndexMarker903"/>have learned how a security policy is defined on ACM and how to easily see a list of the violations that occur in your clusters. Continue reading to learn more about the <strong class="bold">Vulnerability Management</strong> feature of ACS and how you can use it to identify, prioritize and remediate vulnerabilities.</p>
			<h1 id="_idParaDest-250"><a id="_idTextAnchor266"/>Vulnerability management</h1>
			<p>There is a general <a id="_idIndexMarker904"/>consensus that any system has vulnerabilities; some of them are known and some are not identified yet. Vulnerability management is the process of identifying and managing known vulnerabilities, which means having plans in place to remediate or mitigate the impact of the vulnerabilities. Navigate to <strong class="bold">Vulnerability Management</strong> | <strong class="bold">Dashboard</strong> to see what this feature looks like:</p>
			<div>
				<div id="_idContainer278" class="IMG---Figure">
					<img src="image/Image91803.jpg" alt="Figure 12.31 – Vulnerability management "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.31 – Vulnerability management</p>
			<p>Through this<a id="_idIndexMarker905"/> feature, you can walk through all the vulnerabilities detected by ACS and decide what actions to take:</p>
			<ul>
				<li>Remediate the vulnerability either by removing the vulnerable software package from the application or updating it with a more recent version in which the vulnerability is already fixed.</li>
				<li>Accept the risk.</li>
				<li>Mark it as a false positive.</li>
			</ul>
			<p>Vulnerabilities are detected and grouped in terms of the following:</p>
			<ul>
				<li><strong class="bold">Components</strong>: Software packages used by containers. This group helps you to detect the software packages that contain more vulnerabilities and where they are used, so you can upgrade the applications accordingly to remediate them.</li>
				<li><strong class="bold">Image</strong>: Group the vulnerabilities by images. Similarly, you can view what images are more vulnerable, check whether there is a fix for the security issues, and plan accordingly.</li>
				<li><strong class="bold">Nodes</strong>: Group the vulnerabilities by nodes.</li>
				<li><strong class="bold">Deployment</strong>: See the vulnerabilities by deployment. Easier to check vulnerabilities for specific applications.</li>
				<li><strong class="bold">Namespace</strong>: Vulnerabilities by namespace.</li>
				<li><strong class="bold">Cluster</strong>: All vulnerabilities by clusters.</li>
			</ul>
			<p>These groups are accessed<a id="_idIndexMarker906"/> from the buttons at the top of the <strong class="bold">Vulnerability Management</strong> dashboard; click on them to explore the different ways you can see and filter the vulnerabilities:</p>
			<div>
				<div id="_idContainer279" class="IMG---Figure">
					<img src="image/B18015_12_32.jpg" alt="Figure 12.32 – Group by entities "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.32 – Group by entities</p>
			<p>We are going to deploy a sample application now to check the <strong class="bold">Vulnerability Management</strong> feature in action. To do so, run the following commands in the OpenShift secured cluster:</p>
			<pre class="source-code">$ oc new-project acs-test
$ oc run samba --labels=app=rce \
  --image=vulnerables/cve-2017-7494 -n acs-test
$ oc run shell --labels=app=shellshock,team=test-team \
  --image=vulnerables/cve-2014-6271 -n acs-test</pre>
			<p>Now, access again the <strong class="bold">Vulnerability Management</strong> dashboard. You may notice some interesting things in the dashboard now:</p>
			<div>
				<div id="_idContainer280" class="IMG---Figure">
					<img src="image/B18015_12_33.jpg" alt="Figure 12.33 – Top riskiest images and deployments "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.33 – Top riskiest images and deployments</p>
			<p>In the previous<a id="_idIndexMarker907"/> screenshot, you can see the following:</p>
			<ul>
				<li>The container image from the application we just deployed is listed as the top riskiest image.</li>
				<li>In the graph, the application deployment is shown as the most critical in terms of CVE count and CVSS score.</li>
			</ul>
			<p>Click on <strong class="bold">APPLICATION &amp; INFRASTRUCTURE</strong> | <strong class="bold">Namespaces</strong> to view the vulnerabilities grouped by namespaces:</p>
			<div>
				<div id="_idContainer281" class="IMG---Figure">
					<img src="image/B18015_12_34.jpg" alt="Figure 12.34 – APPLICATION &amp; INFRASTRUCTURE menu "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.34 – APPLICATION &amp; INFRASTRUCTURE menu</p>
			<p>You will<a id="_idIndexMarker908"/> notice now our <strong class="source-inline">acs-test</strong> namespace is listed with more than 400 CVEs, with more than 150 fixable:</p>
			<div>
				<div id="_idContainer282" class="IMG---Figure">
					<img src="image/B18015_12_35.jpg" alt="Figure 12.35 – Vulnerabilities by namespace "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.35 – Vulnerabilities by namespace</p>
			<p>Click on the <strong class="source-inline">acs-test</strong> namespace to drill down and see the details.</p>
			<div>
				<div id="_idContainer283" class="IMG---Figure">
					<img src="image/B18015_12_36.jpg" alt="Figure 12.36 – Namespace Summary view "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.36 – Namespace Summary view</p>
			<p>Explore the <strong class="bold">Related entities</strong> menu on the right side of the screen to check that you can easily find the CVEs for the <strong class="source-inline">samba</strong> deployment, policies that pass or fail for the namespace, a list of images and their vulnerabilities, and all components (software packages) that have CVEs, and, finally, a list of all CVEs detected in that namespace. You can learn by exploring the <a id="_idIndexMarker909"/>namespace that it contains two applications (deployments), in which one of them has 498 known CVEs, of which 169 are fixable:</p>
			<div>
				<div id="_idContainer284" class="IMG---Figure">
					<img src="image/B18015_12_37.jpg" alt="Figure 12.37 – CVEs detected "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.37 – CVEs detected</p>
			<p>By drilling down into the deployment and components, you can check which package version is in use and in which version the CVE was fixed:</p>
			<div>
				<div id="_idContainer285" class="IMG---Figure">
					<img src="image/B18015_12_38.jpg" alt="Figure 12.38 – Components and CVEs "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.38 – Components and CVEs</p>
			<p>That gives a lot of <a id="_idIndexMarker910"/>helpful information for you to identify vulnerable packages and images and remediate them. You can alternatively also decide to accept the risk (defer) or mark it as a false positive; to do so, access the image, scroll down and select the CVEs you want to defer, and click on <strong class="bold">Defer CVE</strong> or <strong class="bold">Mark false positive</strong>:</p>
			<div>
				<div id="_idContainer286" class="IMG---Figure">
					<img src="image/B18015_12_39.jpg" alt="Figure 12.39 – Accepting the risk of a CVE "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.39 – Accepting the risk of a CVE</p>
			<p>You can review and approve the<a id="_idIndexMarker911"/> CVEs in the <strong class="bold">Vulnerability Management</strong> | <strong class="bold">Risk Acceptance</strong> feature and also list the approved deferrals and false positives:</p>
			<div>
				<div id="_idContainer287" class="IMG---Figure">
					<img src="image/Image91889.jpg" alt="Figure 12.40 – Risk Acceptance "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.40 – Risk Acceptance</p>
			<p>The <strong class="bold">Vulnerability Management</strong> feature<a id="_idIndexMarker912"/> also includes a report feature, in which you can set up a security report and send it weekly or monthly to a distribution list. It is helpful to report vulnerabilities across the organization frequently. We will not cover this feature in this book, but you can find a link in the <em class="italic">Further reading</em> section of this chapter that will help you to configure it.</p>
			<h1 id="_idParaDest-251"><a id="_idTextAnchor267"/>Risk profiling</h1>
			<p>The <strong class="bold">Risk</strong> view<a id="_idIndexMarker913"/> is a feature that classifies all running deployments in terms of security risks. Navigate to the <strong class="bold">Risk</strong> menu to access the feature and learn from it:</p>
			<div>
				<div id="_idContainer288" class="IMG---Figure">
					<img src="image/Image91898.jpg" alt="Figure 12.41 – Risk feature "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.41 – Risk feature</p>
			<p>Click on the <strong class="source-inline">samba</strong> deployment <a id="_idIndexMarker914"/>and explore <strong class="bold">RISK INDICATORS</strong>, <strong class="bold">DEPLOYMENT DETAILS</strong>, and <strong class="bold">PROCESS DISCOVERY</strong>:</p>
			<div>
				<div id="_idContainer289" class="IMG---Figure">
					<img src="image/B18015_12_42.jpg" alt="Figure 12.42 – Risk details "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.42 – Risk details</p>
			<p>We will not walk<a id="_idIndexMarker915"/> through each option there but will highlight the <strong class="bold">PROCESS DISCOVERY</strong> tab, which provides some interesting insights, as you can see next:</p>
			<div>
				<div id="_idContainer290" class="IMG---Figure">
					<img src="image/B18015_12_43.jpg" alt="Figure 12.43 – Process Discovery "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.43 – Process Discovery</p>
			<p>In this tab, you can<a id="_idIndexMarker916"/> see all the processes that are running in the container including details and also a graph that shows the process activities over time. Click on the <strong class="bold">VIEW GRAPH</strong> link to see it:</p>
			<div>
				<div id="_idContainer291" class="IMG---Figure">
					<img src="image/B18015_12_44.jpg" alt="Figure 12.44 – Process graph "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.44 – Process graph</p>
			<p>This <strong class="bold">Risk</strong> feature<a id="_idIndexMarker917"/> can be helpful for you to sort your deployments in terms of security risks and then take action according to the prioritized list.</p>
			<h1 id="_idParaDest-252"><a id="_idTextAnchor268"/>Compliance</h1>
			<p>The <strong class="bold">Compliance</strong> feature <a id="_idIndexMarker918"/>scans your clusters and reports them according to some out-of-the-box compliance industry standards, such as CIS Benchmarks for Docker and <a id="_idIndexMarker919"/>Kubernetes, <strong class="bold">Health Insurance Portability and Accountability Act</strong> (<strong class="bold">HIPAA</strong>), <strong class="bold">National Institute of Standards and Technology</strong> (<strong class="bold">NIST</strong>) Special Publication<a id="_idIndexMarker920"/>s 800-190 and<a id="_idIndexMarker921"/> 800-53, and <strong class="bold">Payment Card Industry Data Security Standard</strong> (<strong class="bold">PCI DSS</strong>).</p>
			<p>To run the <a id="_idIndexMarker922"/>compliance scan, navigate to the <strong class="bold">Compliance</strong> feature and click on the <strong class="bold">SCAN ENVIRONMENT</strong> button:</p>
			<div>
				<div id="_idContainer292" class="IMG---Figure">
					<img src="image/Image91941.jpg" alt="Figure 12.45 – Compliance feature "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.45 – Compliance feature</p>
			<p>After some seconds, you will see the compliance report, as follows:</p>
			<div>
				<div id="_idContainer293" class="IMG---Figure">
					<img src="image/B18015_12_46.jpg" alt="Figure 12.46 – Compliance report "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.46 – Compliance report</p>
			<p>We will not<a id="_idIndexMarker923"/> dive into each of these industry standards, as they are very specific to different industries. We encourage you to explore the feature, click on each graph, drill down, and check which controls are compliant and not compliant and why. Read the reference we left in the <em class="italic">Further reading</em> if you want to see more about this compliance feature.</p>
			<h1 id="_idParaDest-253"><a id="_idTextAnchor269"/>Configuration Management</h1>
			<p>The <strong class="bold">Configuration Management</strong> feature<a id="_idIndexMarker924"/> is a different way to look at policies that are violated, correlating with the various objects that make up the configuration and use of the clusters. Using this feature, you can list all failing policies for all clusters and drill down to inspect all namespaces, deployments, and so on. You may be thinking that the same information can also be found in <strong class="bold">Violations</strong> and <strong class="bold">Vulnerability Management</strong>, and that is true! The same information is also there; however, here, you will find it grouped by clusters’ entities and also displaying summary data of each entity, which will help you to correlate the different entities and learn about the connections among them.</p>
			<p>To access this feature, navigate to the <strong class="bold">Configuration Management</strong> menu:</p>
			<div>
				<div id="_idContainer294" class="IMG---Figure">
					<img src="image/Image91958.jpg" alt="Figure 12.47 – Configuration Management feature "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.47 – Configuration Management feature</p>
			<p>You will first see a <a id="_idIndexMarker925"/>dashboard that summarizes the following information:</p>
			<ul>
				<li><strong class="bold">POLICY VIOLATIONS BY SEVERITY</strong>: Group the policy violations by severity (critical, high, medium, and low) and display them in a pie chart. You can drill down and inspect the policies by clicking on the link on the right side of the pie chart:</li>
			</ul>
			<div>
				<div id="_idContainer295" class="IMG---Figure">
					<img src="image/B18015_12_48.jpg" alt="Figure 12.48 – POLICY VIOLATIONS BY SEVERITY pie chart "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.48 – POLICY VIOLATIONS BY SEVERITY pie chart</p>
			<ul>
				<li><strong class="bold">CIS DOCKER/Kubernetes</strong>: Another <a id="_idIndexMarker926"/>pie chart grouping entities by CIS Docker or CIS Kubernetes controls:</li>
			</ul>
			<div>
				<div id="_idContainer296" class="IMG---Figure">
					<img src="image/B18015_12_49.jpg" alt="Figure 12.49 – CIS DOCKER/KUBERNETES pie chart "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.49 – CIS DOCKER/KUBERNETES pie chart</p>
			<p>See next the description of this pie chart:</p>
			<ol>
				<li>Pie chart that summarizes the controls compliance considering the CIS Docker or Kubernetes standard.</li>
				<li>Click here to switch between CIS Docker and CIS Kubernetes.</li>
				<li>Click on the <strong class="bold">SCAN</strong> button to perform a new scan in the environment.</li>
				<li>Click on <strong class="bold">VIEW STANDARD</strong> to get a list of all CIS controls and the status (<strong class="bold">Passing, Failing</strong>, or <strong class="bold">N/A</strong>).</li>
				<li>Drill down to the passed, failed, or N/A control list.</li>
			</ol>
			<ul>
				<li><strong class="bold">USERS WITH MOST CLUSTER ADMIN ROLES</strong>: This is self-explanatory. You can use this list<a id="_idIndexMarker927"/> to review users’ permissions and make sure they have the proper permissions:</li>
			</ul>
			<div>
				<div id="_idContainer297" class="IMG---Figure">
					<img src="image/B18015_12_50.jpg" alt="Figure 12.50 – Users with most cluster admin roles "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.50 – Users with most cluster admin roles</p>
			<ul>
				<li><strong class="bold">SECRETS MOST USED ACROSS DEPLOYMENTS</strong>: Also self-explanatory. Use this list to find sensitive data and how it is accessed through the environment, and look<a id="_idIndexMarker928"/> for suspicious activities:</li>
			</ul>
			<div>
				<div id="_idContainer298" class="IMG---Figure">
					<img src="image/B18015_12_51.jpg" alt="Figure 12.51 – Secrets most used across deployments "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.51 – Secrets most used across deployments</p>
			<p>You can also use<a id="_idIndexMarker929"/> the bar at the top of this page to inspect the policies and controls by clusters, namespaces, nodes, deployments, images, secrets, users and groups, service accounts, and roles:</p>
			<div>
				<div id="_idContainer299" class="IMG---Figure">
					<img src="image/B18015_12_52.jpg" alt="Figure 12.52 – View policies and controls by entities "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.52 – View policies and controls by entities</p>
			<p>Click on the menu options and explore the different lists you get with each of them. Notice also that you can drill down from clusters to deployments, images, and so on to navigate back and <a id="_idIndexMarker930"/>forth to analyze the entities:</p>
			<div>
				<div id="_idContainer300" class="IMG---Figure">
					<img src="image/B18015_12_53.jpg" alt="Figure 12.53 – Drill down from cluster to namespace "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.53 – Drill down from cluster to namespace</p>
			<p>This concludes an <a id="_idIndexMarker931"/>overview of the <strong class="bold">Configuration Management</strong> feature. Continue reading to see a great feature ACS brings to help you to inspect your clusters’ network communication.</p>
			<h1 id="_idParaDest-254"><a id="_idTextAnchor270"/>Network segmentation</h1>
			<p>An important security <a id="_idIndexMarker932"/>aspect in any Kubernetes cluster is how Pods communicate between each other and also ingress and egress communication. Currently, there isn’t any graphical view on Kubernetes to check how the network communications are performed in real time, and neither allowed nor blocked flows. To help with that, ACS brings the <strong class="bold">Network Graph</strong> feature, which allows you to view the active communications in real time and also define and apply NPs to allow or block network traffic. Click on the <strong class="bold">Network Graph</strong> menu to access<a id="_idIndexMarker933"/> the feature:</p>
			<div>
				<div id="_idContainer301" class="IMG---Figure">
					<img src="image/B18015_12_54.jpg" alt="Figure 12.54 – Network Graph feature "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.54 – Network Graph feature</p>
			<p>Select the <strong class="source-inline">rhacs-operator</strong> namespace to view what the network graph looks like:</p>
			<div>
				<div id="_idContainer302" class="IMG---Figure">
					<img src="image/B18015_12_55.jpg" alt="Figure 12.55 – Network graph for the rhacs-operator namespace "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.55 – Network graph for the rhacs-operator namespace</p>
			<p>You can change the<a id="_idIndexMarker934"/> view to see only active connections, allowed connections, or all types of connection flows.</p>
			<h2 id="_idParaDest-255"><a id="_idTextAnchor271"/>Network flows</h2>
			<p><a id="_idIndexMarker935"/> Red Hat Advanced Cluster Security can learn the network flows used by the applications and apply a baseline of all network flows. Any network flows detected that are different from the baseline are marked as anomalous for your review. When viewing the network flows and baseline, access any deployment, and you will see the anomalous flows marked in red:</p>
			<div>
				<div id="_idContainer303" class="IMG---Figure">
					<img src="image/B18015_12_56.jpg" alt="Figure 12.56 – Network flows – anomalous and baseline "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.56 – Network flows – anomalous and baseline</p>
			<p>Click<a id="_idIndexMarker936"/> on the <strong class="bold">BASELINE SETTINGS</strong> tab to check the current baseline:</p>
			<div>
				<div id="_idContainer304" class="IMG---Figure">
					<img src="image/B18015_12_57.jpg" alt="Figure 12.57 – Configure baseline "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.57 – Configure baseline</p>
			<p>Through <a id="_idIndexMarker937"/>the <strong class="bold">BASELINE SETTINGS</strong> tab, you can do the following:</p>
			<ol>
				<li value="1">View the baseline of network flows.</li>
				<li>Configure sending an alert when ACS detects anomalous flows.</li>
				<li>Simulate the impact in the environment of having the baseline as NPs.</li>
			</ol>
			<p>See next how to also use the <strong class="bold">Network Graph</strong> feature to generate a list of <strong class="bold">NP</strong>s (Network Policies) to allow only the communications that are required by the applications.</p>
			<h2 id="_idParaDest-256"><a id="_idTextAnchor272"/>Network Policy Simulator</h2>
			<p>Do you know whether the<a id="_idIndexMarker938"/> NP configurations of your clusters allow only required communications and nothing more? Clusters with a permissive set of NPs are very common and the ACS Network Policy Simulator<a id="_idIndexMarker939"/> can help to avoid that. ACS monitors the network traffic between all Pods and namespaces in the clusters to create a matrix of firewall rules. You can use ACS to generate a set of NPs based on what it learned from the environment that will allow only the communications needed. To use this feature, click on the <strong class="bold">Network Policy Simulator</strong> button then click on <strong class="bold">Generate and simulate network policies</strong>:</p>
			<div>
				<div id="_idContainer305" class="IMG---Figure">
					<img src="image/B18015_12_58.jpg" alt="Figure 12.58 – Generate and simulate network policies "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.58 – Generate and simulate network policies</p>
			<p>You will see an extensive list of NPs that will allow only the communications that ACS learned from the environment that is in use. You can apply the NPs in the environment or share them by email. We highly recommend you review and test the NPs in a development or test environment before applying them in production.</p>
			<div>
				<div id="_idContainer306" class="IMG---Figure">
					<img src="image/B18015_12_59.jpg" alt="Figure 12.59 – Apply or share NPs "/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.59 – Apply or share NPs</p>
			<p>Helpful, right? Now <a id="_idIndexMarker940"/>explore the <strong class="bold">Network Graph</strong> feature a bit more and envision how this feature can help you and your organization to have more visibility into the network traffic and also allow only the communications that are really required by your applications.</p>
			<h1 id="_idParaDest-257"><a id="_idTextAnchor273"/>Summary</h1>
			<p>We covered a lot of content in this chapter about Red Hat Advanced Cluster Security. In this chapter, we have seen an overview of ACS capabilities to help you to learn how ACS can help to make sure your clusters are secure and vulnerabilities are known, and put an action plan in place.</p>
			<p>We learned how to use and define security policies and list all policy violations using the <strong class="bold">Violations</strong> feature. We also saw that the <strong class="bold">Vulnerability Management</strong> feature is very helpful to list all known vulnerabilities, review them, and take proper action: remediate (fix vulnerable packages), accept the risk, or mark them as false positives.</p>
			<p>We also learned that the <strong class="bold">Risk</strong> profiling feature helps you to assess the risk of application deployments and prioritize the remediation and actions that need to be taken to enhance the security. <strong class="bold">Compliance</strong> reports the clusters, namespaces, and deployments in terms of industry standards, such as CIS Docker, HIPAA, NIST, PCI, and so on.</p>
			<p>Finally, we saw the list of policies and controls aggregated by a cluster’s entities in the <strong class="bold">Configuration Management</strong> feature, helping to correlate the different entities into the clusters. <strong class="bold">Network Graph</strong>, in turn, gave us a nice view of the network flows in real time with some useful added features to help generate and simulate NPs and make sure only needed communications are allowed and nothing more.</p>
			<p>We hope this chapter helped you to understand Red Hat Advanced Cluster Security. We encourage you to move on to the next chapter to see how ACM, ACS, and other pieces will build together a complete and comprehensive platform for multi-cloud or hybrid cloud: <strong class="bold">OpenShift Platform Plus</strong>.</p>
			<h1 id="_idParaDest-258"><a id="_idTextAnchor274"/>Further reading</h1>
			<p>Looking for more information? Check the following references to get more information about Red Hat Advanced Cluster Security:</p>
			<ul>
				<li><em class="italic">KuppingerCole Report Leadership Compass: Container security</em>: <a href="https://www.redhat.com/en/resources/kuppingercole-container-security-report-analyst-material">https://www.redhat.com/en/resources/kuppingercole-container-security-report-analyst-material</a></li>
				<li><em class="italic">ACM installation using the Operator</em>: <a href="https://docs.openshift.com/acs/3.70/installing/install-ocp-operator.html">https://docs.openshift.com/acs/3.70/installing/install-ocp-operator.html</a></li>
				<li><em class="italic">ACM installation using Helm</em>: <a href="https://docs.openshift.com/acs/3.70/installing/installing_helm/install-helm-quick.html">https://docs.openshift.com/acs/3.70/installing/installing_helm/install-helm-quick.html</a></li>
				<li><em class="italic">ACM installation using the roxctl CLI</em>: <a href="https://docs.openshift.com/acs/3.70/installing/install-quick-roxctl.html">https://docs.openshift.com/acs/3.70/installing/install-quick-roxctl.html</a></li>
				<li><em class="italic">Threat matrix for Kubernetes</em> – Microsoft article about MITRE ATT&amp;CK®: <a href="https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/">https://www.microsoft.com/security/blog/2020/04/02/attack-matrix-kubernetes/</a></li>
				<li><em class="italic">Protecting Kubernetes Against MITRE ATT&amp;CK: Initial Access</em> – First of a series of articles about the MITRE ATT&amp;CK® framework:<a href="https://cloud.redhat.com/blog/protecting-kubernetes-against-mitre-attck-initial-access"> https://cloud.redhat.com/blog/protecting-kubernetes-against-mitre-attck-initial-access</a></li>
				<li><em class="italic">MITRE ATT&amp;CK® knowledge base: </em><a href="https://attack.mitre.org/">https://attack.mitre.org/</a></li>
				<li><em class="italic">Configuring the vulnerability reports</em>: <a href="https://docs.openshift.com/acs/3.70/operating/manage-vulnerabilities.html#vulnerability-management-reporting_acs-operating-manage-vulnerabilities">https://docs.openshift.com/acs/3.70/operating/manage-vulnerabilities.html#vulnerability-management-reporting_acs-operating-manage-vulnerabilities</a></li>
				<li><em class="italic">Managing compliance</em>: <a href="https://docs.openshift.com/acs/3.70/operating/manage-compliance.html">https://docs.openshift.com/acs/3.70/operating/manage-compliance.html</a></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer308">
			</div>
		</div>
</body></html>