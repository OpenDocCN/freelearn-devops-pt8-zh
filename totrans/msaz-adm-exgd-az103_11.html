<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Managing Azure VMs and VM Backups</h1>
                </header>
            
            <article>
                
<p>In the previous chapter, we covered <strong>Virtual Machines</strong> (<strong>VMs</strong>) in Azure and how to create and configure them from the Azure portal and PowerShell. We also looked at how to automate these steps using ARM templates.</p>
<p>This chapter continues with the second part of <em>Deploying and Managing Virtual Machines</em> objective<em><strong>.</strong></em><span> </span>In this chapter, we are going to focus on the different ways you can manage your VMs after creation. You will learn how to resize and deploy your VMs using the Azure portal, PowerShell, and CLI. You will also learn how to add additional data disks and network interfaces to your VMs. We are going to cover how you can automate the configuration management of your virtual machines, and you will learn how to configure backup and restore operations for your VMs.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>Managing VM sizes</li>
<li>Redeploying VMs</li>
<li>Moving VMs</li>
<li>Adding data disks and network interfaces</li>
<li>Automating configuration management</li>
<li>Configuring VM backup and restore operations</li>
</ul>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>This chapter uses Azure PowerShell (<a href="https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0">https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0</a>) for examples.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Managing VM sizes</h1>
                </header>
            
            <article>
                
<p>In the first part of this chapter, we are going to look at some management capabilities for virtual machines. After creation, you can manage and change (vertical scale) the sizes of Windows and Linux VMs from the Azure portal, PowerShell, and CLI. <strong>Vertical scaling</strong>, also known as <strong>scale up</strong> and <strong>scale down</strong>, means increasing or decreasing VM sizes in response to different workloads. </p>
<p>In the upcoming demonstrations, we are going to resize VMs using the Azure portal and CLI.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Resizing a VM in the Azure portal</h1>
                </header>
            
            <article>
                
<p>To manage and change the sizes <span>of the VMs </span>to scale up and down from the Azure portal, you have to take the following steps:</p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Go to the overview blade of one of the VMs that we created earlier or create a new one.</li>
<li>Under <strong>Settings</strong>, select <strong>Size</strong>.</li>
<li>In the <strong>Size</strong> overview blade, you can easily select another VM size. In the top menu, there are different filters. You can filter on the different sizes, the VM generation type, the different VM types, the disk type, and you can add your own filter to it as well. Once you have selected the VM size, click the <strong>Resize</strong> <span><span>button to actually resize it:</span></span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d404e9f1-932f-45c3-b3e8-d37d8580e80d.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Resizing the VM</div>
<ol start="5">
<li>If the VM is currently running, then the changing its size will be implemented when the VM is restarted.</li>
</ol>
<p>In the next section, we are going to resize the same VM using the CLI.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Resizing a VM using the CLI</h1>
                </header>
            
            <article>
                
<p>You can also resize your VM using the CLI. You can run CLI scripts from the Azure Cloud Shell or from your local file system. You can use the Azure Cloud Shell for PowerShell scripts and commands as well. We are going to resize the VM from Azure Cloud Shell using the CLI in this demonstration.</p>
<p>To resize a VM using the CLI, you have to perform the following steps:</p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Open Azure Cloud Shell by clicking the following menu item in the top-right menu in the Azure portal:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/c95930b1-816d-4f97-b093-708e9eda879c.png" style="width:32.42em;height:2.67em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Opening Azure Cloud Shell</div>
<ol start="3">
<li>Make sure that the Bash shell is selected.</li>
<li class="mce-root">Add the following <span>line of code to list the different available machine sizes for your region:</span></li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>az vm list-vm-resize-options --resource-group PacktVMResourceGroup --name myVM1 --output table</strong></pre>
<ol start="5">
<li>To resize your VM to a different size, add the following line of code. If the size is not available, you can replace the required VM size with one that is available <span>for </span>your subscription or region:</li>
</ol>
<pre style="padding-left: 60px"><strong>az vm resize --resource-group PacktVMResourceGroup --name myVM1 --size Standard_DS3_v2</strong></pre>
<p>We have now resized our VM using the Azure portal and CLI. In the next section, we are going to move VMs across different <span>regions</span> and redeploy them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Redeploying VMs</h1>
                </header>
            
            <article>
                
<p class="mce-root">You can also redeploy the VMs after their creation. This can be helpful when you are <span>facing difficulties troubleshooting <strong>Remote Desktop Protocol</strong> (<strong>RDP</strong>) connections or application access to Windows and Linux VMs. When you redeploy a VM, Azure will shut down the VM, move the VM to a new node within the Azure infrastructure, and then power it back on. All your configuration options and associated resources will remain during redeployment. After you redeploy a VM, the temporary disk is lost and any dynamic IP addresses associated with the virtual network interface are updated.</span></p>
<p class="mce-root">Redeploying Windows VMs can easily be done from the Azure portal, using PowerShell and the CLI as well. In the next demonstration, we are going to redeploy a VM from the Azure portal and PowerShell.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Redeploying a VM from the Azure portal</h1>
                </header>
            
            <article>
                
<p>To redeploy a VM from the Azure portal, you have to take the following steps:</p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Again, go to the overview blade<span> </span>of<span> </span>one of the VMs that we created earlier or create a new one.</li>
</ol>
<ol start="3">
<li>Under <strong>Support + troubleshooting</strong>, s<span>elect </span><strong>Redeploy</strong>. <span>This will open the <strong>Redeploy</strong> blade, where you can select the </span><strong>Redeploy </strong><span>button to redeploy the VM:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/243d2082-2811-4865-bb2d-7c2d46e34bd4.png" style="width:31.50em;height:45.83em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Redeploying the VM</div>
<ol start="4">
<li>The VM will be unavailable during redeployment.</li>
</ol>
<p>In the next demonstration, we are going to redeploy the same VM using PowerShell.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Redeploying a VM from PowerShell </h1>
                </header>
            
            <article>
                
<p><span>To redeploy a VM from PowerShell, you have to take the following steps:</span></p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li class="CDPAlignLeft CDPAlign">Open the Azure Cloud Shell again by clicking the following menu item in the top-right menu<span> </span>in<span> </span>the Azure portal.</li>
<li>Make sure that this time <strong>PowerShell</strong> is selected.</li>
<li class="mce-root"><span>Add the following line of code to redeploy the VM:</span></li>
</ol>
<pre style="color: black;padding-left: 60px"><strong>Set-AzVM -Redeploy -ResourceGroupName "PacktVMResourceGroup" -Name "myVM1"</strong></pre>
<p>We have now covered most of the different ways to redeploy your VMs. In the next section, we are going to add extra data disks and network interfaces to a VM.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Moving VMs</h1>
                </header>
            
            <article>
                
<p>You can also move VMs and other resources across different subscriptions and resource groups. You can move resources using the Azure portal, Azure PowerShell, Azure CLI, or the REST API to move resources.</p>
<p>When you move a VM to another resource group, both the source and the target are locked during the operation. Also, write and delete operations are blocked on the resource group until it has completely finished moving the VM. By locking these two operations, you can't add, update, or delete any resource in the resource group. However, applications that use these resources, for instance when you move an Azure SQL database to another resource group, will not experience any downtime. </p>
<p>Moving a resource only moves it to a new resource group. The actual location will remain the same, and this cannot be changed. Even when the new resource group is deployed in another location, the moved resource will still remain in the original location.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<div class="packt_tip">There are limitations for moving resources across different subscriptions and resource groups. This can be part of the exam questions. For more information, you can refer to the documentation at: <a href="https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-move-resources">https://docs.microsoft.com/en-us/azure/azure-resource-manager/resource-group-move-resources</a>.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding data disks and network interfaces</h1>
                </header>
            
            <article>
                
<p><span>You can add a new managed data disk and extra network interfaces to a Windows VM by using the Azure portal, PowerShell, and CLI. The size of the VM determines how many data disks you can attach to one single VM.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a data disk</h1>
                </header>
            
            <article>
                
<p><span> To add a data disk from the Azure portal, you have to perform the following steps:</span></p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Go to the overview blade of one of the VMs that we created earlier.</li>
<li>Under <strong>Settings</strong><span>, select</span> <strong>Disks</strong>. Click <span>the </span><strong>Add data disk </strong><span>button:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/1ce4d6d3-ded4-46cf-ab61-c583e3d75d2a.png" style="width:41.58em;height:23.50em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Adding a data disk</div>
<ol start="4">
<li class="CDPAlignLeft CDPAlign">You can now add an existing disk or create a new disk. We don't have an extra disk in place, so select <strong>Create disk</strong>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/7d669316-aa4f-4faa-988b-a5a87d91764c.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Creating a new disk<strong><br/>
<br/></strong></div>
<ol start="5">
<li>In the <span class="packt_screen">Create managed disk</span> blade, add the following values:
<ul>
<li><strong>Disk name</strong>: <kbd>PacktDisk2</kbd>.</li>
<li><strong>Resource group</strong>: Keep the default selected group here.</li>
<li><strong>Account type</strong>: Here, you can select three different options: <span class="packt_screen">Standard HHD</span>, <span><span class="packt_screen">Standard SSD</span>, and <span class="packt_screen">Premium SSD</span>. Select any one.</span></li>
<li><strong>Size</strong>: Keep the default size here.</li>
<li><strong>Source type</strong>:<span> </span><span>Here, you can select three different options as well: <span class="packt_screen">None</span>, <span class="packt_screen">Snapshot</span>, <span class="packt_screen">Storage Blob</span>. Select <strong>None</strong></span>:</li>
</ul>
</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/6c3c8259-cc3d-4e45-9530-c420d9b47caf.png" style="width:36.83em;height:38.17em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span>Disk settings</span></div>
<ol start="6">
<li>Click <strong>Create</strong> to create the disk.</li>
</ol>
<p>The disk is now added to the VM. To initialize the new data disk, you can log into your server and create a new volume inside<span> </span><strong>Disk management</strong>. After this, you can format the disk to complete the initialization of it.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Adding a network interface</h1>
                </header>
            
            <article>
                
<p>To add an extra network interface to the VM from the Azure portal, you have to perform the following steps:</p>
<ol>
<li>From the <span class="packt_screen">Overview</span> blade of the virtual machine, under <strong>Settings</strong>, select <strong>Networking</strong>. In there, click <strong>Attach network interface</strong>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/ad0df9e8-2623-4663-a0b9-eeeb34069a87.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Adding a network interface</div>
<ol start="2">
<li>A popup will be displayed where you have to click the <strong>Create network interface</strong> to create a new network interface. You can also add existing network interfaces here:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/a286fa64-b419-4957-bc41-b388c9323e2e.png" style="width:31.17em;height:16.00em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Creating a new network interface</div>
<ol start="3">
<li>In the <span class="packt_screen">Create network interface</span> blade, add the following values:
<ul>
<li><strong>Name</strong>: <kbd>PacktNIC</kbd>.</li>
<li><strong>Subnet</strong>: Select the default subnet here.</li>
<li><strong>Private IP address assignment</strong>: Choose either <strong>Dynamic </strong>or <strong>Static</strong>.</li>
<li><strong>Resource group</strong><span>: Keep the default selected here: </span></li>
</ul>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/280ca362-f669-415c-86a1-19941d51616a.png" style="width:20.50em;height:47.17em;"/></p>
<div class="CDPAlignCenter CDPAlign packt_figref">Network interface settings</div>
<ol start="4">
<li>Click <strong>Create</strong>.</li>
</ol>
<p>The network interface is now added to the VM and can be configured by logging into the VM and by configuring the network adapter. </p>
<p>In the preceding sections, we managed our VMs using manual actions or single scripts. In the next part of this chapter, we are going to look at automating configuration management for our VMs.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Automating configuration management</h1>
                </header>
            
            <article>
                
<p>There are various ways in Azure to automate the creation and the configuration of your infrastructure. You can use ARM templates to deploy your infrastructure as a code, or use Azure Automation, PowerShell scripts and more. </p>
<p>When the different Azure resources are deployed, there are some tools that you can use to manage the configuration of the resources. For example, when you want to automate the configuration of your VMs, Azure provides the following tools:</p>
<ul>
<li><strong>Chef</strong>: Chef is a third-party solution that offers a DevOps automation platform for Linux, Windows, and macOS devices. It can be used for virtual and physical server configurations. It requires an agent to be installed on the virtual machines or servers, which connects to the Chef server to check whether there are available updates and other configurations for the machines. You can use the <strong>Chef Automate</strong> platform to package and deploy applications as well.</li>
<li><strong>Puppet</strong>: Puppet is a third-party solution as well, and it has similar capabilities to Chef. You can enable support for Puppet when you create a virtual machine from the Azure portal automatically. You can add it as an extension when you create a new virtual machine. It will install the Puppet agent, which connects to the Puppet master server.</li>
<li><strong>Desired State Configuration</strong> (<strong>DSC</strong>):<strong> </strong><span><span>DSC is the process of forcing a configuration on a system. It uses configuration files that consist of PowerShell scripts. These scripts are responsible for making the required configurations to the system and for ensuring that these systems stay in sync. So, for example, when you have created a DSC file to configure IIS on a Windows Server and this is removed by an administrator, the DSC file will reinstall and configure IIS again.</span></span></li>
<li><strong>Custom Script Extensions</strong>: You can configure <span>software installation tasks and various post deployment, configuration,</span> and management tasks using <span>Custom Script Extensions</span><span>. Scripts can be downloaded from Azure storage or GitHub, or provided to the Azure portal at extension runtime, and are executed on the VMs. You can integrate Custom Script Extensions with ARM templates, and you can run them using PowerShell, CLI, the VM REST API, and the Azure portal. </span></li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring VM backup and restore operations</h1>
                </header>
            
            <article>
                
<p>In this demonstration, we will be performing a backup and restore operation for a VM. We are going to backup the VM that we used throughout this chapter and restore it from a <span class="packt_screen">Recovery Services vault</span>.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating a Recovery Services vault</h1>
                </header>
            
            <article>
                
<p>The first step is to create a Recovery Services vault<span>, which can be used to store backups.</span></p>
<p>We are going to create the Recovery Services vault in Azure. You can create this using the Azure portal, PowerShell, and CLI. We are going to create the vault from the Azure portal. To create this, perform the following steps:</p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Create a new resource. Then, select <strong>Management tools</strong><span> and then </span><strong>Backup and Site Recovery</strong><span>.</span></li>
<li>Add the following values to create a new vault:
<ul>
<li><strong>Name</strong>: <kbd>PacktVMVault</kbd>.</li>
<li><strong>Subscription</strong>:<strong> </strong>Select a subscription here.</li>
<li><strong>Resource group</strong>: Create a new one and call it <kbd><span>PacktVMVault</span></kbd><span><span>.</span></span></li>
<li class="CDPAlignLeft CDPAlign"><strong>Location</strong>: Pick a location:</li>
</ul>
</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/6e0315fd-8d40-47b2-83ed-6b5db9be19e0.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Creating a new Recovery Services vault</div>
<ol start="4">
<li>Click the <strong>Create</strong><span> </span>button.</li>
</ol>
<p class="mce-root">We have now created a <span class="packt_screen">Recovery Services vault</span>, which we can use to restore backups. We will create and configure a backup policy in the next section.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating and configuring a backup policy</h1>
                </header>
            
            <article>
                
<p>From the <span class="packt_screen">Recovery Services vault</span> overview blade, you can configure a backup policy. In this demonstration, we are going to configure one. Therefore, perform the following steps:</p>
<ol>
<li><span>Navigate to the Azure portal by opening </span><a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
<li>Open the R<span>ecovery Services vault that we created in the previous step.</span></li>
</ol>
<ol start="3">
<li class="CDPAlignLeft CDPAlign">In the top menu, click <strong>+ Backup</strong>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/b5c4794d-7000-4e2a-8d55-fade1a0d4263.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref"><span>Creating a new backup</span></div>
<ol start="4">
<li>In<span> </span>the next<span> </span>screen, select<span> </span>the following and click<span> </span><strong>Backup</strong>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5c4e8034-a26b-46d3-9afa-4e969c745633.png" style="width:25.17em;height:17.92em;"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Setting a backup goal</div>
<ol start="5">
<li>Now we need to select a backup policy. We can use the default policy that is created for us by Azure, and which makes a daily backup, or we can create a custom policy in here. Under <span class="packt_screen">Choose backup policy</span>, select <span class="packt_screen">Create New</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/0d674f3e-9533-42f6-a06d-dfff83863f9a.png" style="width:47.00em;height:23.75em;"/></div>
<div class="mce-root CDPAlignCenter CDPAlign packt_figref"><span>Creating a new backup policy</span></div>
<ol start="6">
<li>For the new policy, fill in the following values:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/18f5629d-2896-4fac-bb46-013229fad0c6.png" style="width:43.17em;height:48.83em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Creating a backup policy</div>
<ol start="7">
<li>Once you have filled in all the values, click <strong>OK</strong>.</li>
<li>Then we have to select the VMs that we want to backup. Select them and click <strong>OK</strong>:</li>
</ol>
<p class="mce-root CDPAlignCenter CDPAlign"><strong><img src="assets/c733f9ea-c64f-4557-83f3-4af46493bdfe.png"/><br/></strong><sub><span>Selecting the VM to backup</span></sub></p>
<ol start="9">
<li>Click <strong>Enable backup</strong>.</li>
<li>The VM will now be backed up every day at the same time.</li>
</ol>
<ol start="11">
<li>If you open the VM overview blade, under <strong>Operations</strong>, <span>select </span><strong>Backup</strong><span>. You will see that there is a backup policy applied and that the <span class="packt_screen">Recovery Services vault</span> is displayed as well. Click </span><strong>Backup now</strong> <span>in the top menu to perform a manual backup:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/79c46260-4eb8-4924-90ef-ba8c8750bc8f.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Backing up the VM</div>
<ol start="12">
<li>Keep the default retaining date and click <strong>OK</strong>.</li>
</ol>
<ol start="13">
<li>Select<span> </span><strong>View all Jobs</strong><span> </span><span>to see the progress of the backup:<br/></span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/b00f5b5a-b560-4b01-8b2e-c6571841a6ca.png"/></p>
<div style="color: black" class="packt_figref CDPAlignCenter CDPAlign">Backup jobs</div>
<ol start="14">
<li>All the jobs are displayed in the list:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/efe8afa1-1c2d-4905-b5e6-c48ff73278e7.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">List of backups</div>
<p>When the backup is created, we can restore it. In the next and last section of this demonstration, we are going to restore the backup of the VM.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Restoring a backup</h1>
                </header>
            
            <article>
                
<p>In this last demonstration, we are going to restore the backup of the VM that we created. Therefore, take the following steps:</p>
<ol>
<li>In the <span class="packt_screen">Overview</span> blade of the <span class="packt_screen">Backup</span> section of the VM, select <strong>Restore VM</strong><span> </span>in the top menu:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/d55e1aa1-d38c-44d9-8a83-80012e955e97.png"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Restoring the backup</div>
<ol start="2">
<li>Select the restore point from the list and click<span> </span><strong>OK</strong>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="assets/20a58e6e-881c-4fa1-b03f-0c01f433bb56.png"/></div>
<div class="CDPAlignCenter CDPAlign packt_figref">Selecting a restore point</div>
<ol start="3">
<li>In the next blade, you can set the restore configuration. You can choose between creating a new VM or replacing a VM. Select <strong>Replace existing</strong><span> </span>and select the following values:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="assets/e6c0133c-cd05-4e87-8b68-f5d0fb516104.png" style="width:37.17em;height:27.17em;"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Setting the restore configuration</div>
<ol start="4">
<li>Make sure that the VM is turned off.</li>
<li>Click <strong>OK </strong>and <strong>Restore</strong>.</li>
</ol>
<p>The backup will now be restored and the existing VM will be replaced by the backup.</p>
<div class="packt_infobox">Azure Site Recovery is already covered in <a href="6bb56fd5-3785-42d2-b32c-4ba14333dca4.xhtml">Chapter 6</a>, <em>Configuring Azure Files and Implementing Azure Backup</em>. For more information about what features and capabilities it has to offer, you can refer to that chapter.</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p><span>In this chapter, we covered how to manage your VMs and how to implement VM backups. We also covered how to manage your VMs from the Azure portal, and how to move and redeploy them using PowerShell and CLI. We looked into the automation of configuration management and we took a deep dive into Azure backup and restore operations for your VMs.</span></p>
<p>In the next chapter, we will begin with the first part of the <em>Deploying and Managing Virtual Networks</em> objective by covering how to implement and manage virtual networking.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<p>Answer the following questions to test your knowledge of the information in this chapter. You can find the answers in the <em>Assessments</em><span> section at the end of this book:</span></p>
<ol start="1">
<li><span>Can you use both PowerShell and the CLI to move, redeploy, and resize your Windows and Linux VMs?</span>
<ul>
<li>Yes</li>
<li>No</li>
</ul>
</li>
<li>Can you only add extra data disks and network interfaces from the Azure portal?
<ul>
<li>Yes</li>
<li>No</li>
</ul>
</li>
<li>Can you use Custom Script Extensions to configure macOS machines after deployment?
<ul>
<li>Yes</li>
<li>No</li>
</ul>
</li>
</ol>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<p><span>You can check out the following links for more information about the topics that were covered in this chapter:</span></p>
<ul>
<li><em>Resize a Windows VM</em>: <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/resize-vm">https://docs.microsoft.com/en-us/azure/virtual-machines/windows/resize-vm</a>.<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/resize-vm"/></li>
<li><em>Resize a Linux virtual machine using Azure CLI</em>: <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/change-vm-size">https://docs.microsoft.com/en-us/azure/virtual-machines/linux/change-vm-size</a>.<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/change-vm-size"> </a></li>
<li><em>Redeploy Windows virtual machine to new Azure node</em>: <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/redeploy-to-new-node-windows">https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/redeploy-to-new-node-windows</a>.</li>
<li><em>Redeploy Linux virtual machine to new Azure node</em>: <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/redeploy-to-new-node-linux">https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/redeploy-to-new-node-linux</a>.<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/troubleshooting/redeploy-to-new-node-linux"/></li>
<li><em>Attach a data disk to a Windows VM with PowerShell</em>:<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/attach-disk-ps"> </a><a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/attach-disk-ps">https://docs.microsoft.com/en-us/azure/virtual-machines/windows/attach-disk-ps</a>.<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/windows/attach-disk-ps"/></li>
<li><em>Move Azure VMs to another region</em>: <a href="https://docs.microsoft.com/en-us/azure/site-recovery/azure-to-azure-tutorial-migrate?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json">https://docs.microsoft.com/en-us/azure/site-recovery/azure-to-azure-tutorial-migrate?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json</a>.<a href="https://docs.microsoft.com/en-us/azure/site-recovery/azure-to-azure-tutorial-migrate?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json"/></li>
<li><em>Custom Script Extension for Windows</em>: <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-windows">https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-windows</a>.<a href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/custom-script-windows"/></li>
<li><em>Windows PowerShell Desired State Configuration Overview</em>: <a href="https://docs.microsoft.com/en-us/powershell/dsc/overview/overview">https://docs.microsoft.com/en-us/powershell/dsc/overview/overview</a>.<a href="https://docs.microsoft.com/en-us/powershell/dsc/overview/overview"/></li>
<li><em>What is Azure Backup?</em>: <a href="https://docs.microsoft.com/en-us/azure/backup/backup-overview">https://docs.microsoft.com/en-us/azure/backup/backup-overview</a>.<a href="https://docs.microsoft.com/en-us/azure/backup/backup-overview"/></li>
<li><em>About Site Recovery</em>: <a href="https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview">https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview</a>.<a href="https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview"/></li>
</ul>


            </article>

            
        </section>
    </body></html>