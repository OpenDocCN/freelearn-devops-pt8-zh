- en: Using the Azure AD App Proxy and the Web Application Proxy
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Azure AD 应用代理和 Web 应用代理
- en: As the successor to [Chapter 7](468509fa-856c-411d-abdb-e9a39c266750.xhtml), *Deploying
    Solutions on Azure AD and ADFS**,* we dig further into the different features
    of Azure AD and ADFS. We already published the Kerberos on-premises application
    to external users. We'll do this with another application in this chapter. Furthermore,
    we will dive into the functionality of the Azure AD app proxy. Additionally, the
    first usage examples and the basic functionality of conditional access will be
    shown in this chapter. We do some more claims operation and task customization
    in [Chapter 10](6b29475f-7917-49bf-91d4-3024835d0278.xhtml), *Exploring Azure
    AD Identity Service**s*, and provide examples in the code package for the book.
    With this chapter, you will get all the information for managing the application
    integration into Azure AD and ADFS. You will also learn to publish applications
    with the Azure AD or the Web Application Proxy. Additionally, you will be enabled
    to use conditional access for securing your application access.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 作为[第7章](468509fa-856c-411d-abdb-e9a39c266750.xhtml)的继任者，*在 Azure AD 和 ADFS 上部署解决方案*，我们深入探讨了
    Azure AD 和 ADFS 的不同功能。我们已经将 Kerberos 本地应用发布给外部用户。本章我们将使用另一个应用程序来做这个。此外，我们将深入了解
    Azure AD 应用代理的功能。本章还将展示条件访问的初步使用示例及其基本功能。我们将在[第10章](6b29475f-7917-49bf-91d4-3024835d0278.xhtml)，*探索
    Azure AD 身份服务*，进行更多声明操作和任务自定义，并提供代码包中的示例。通过本章，您将获得所有有关将应用程序集成到 Azure AD 和 ADFS
    中的信息。您还将学会使用 Azure AD 或 Web 应用代理发布应用程序。此外，您将能够使用条件访问来保护应用程序访问。
- en: 'This chapter is divided into the following sections:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章分为以下几个部分：
- en: Configuring additional applications for Azure AD and ADFS
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 Azure AD 和 ADFS 的附加应用
- en: Publishing with Windows server and Azure AD Web Application Proxy
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Windows 服务器和 Azure AD Web 应用代理进行发布
- en: Using conditional access
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用条件访问
- en: Ready to go? We'll start with the configuration of additional applications for
    Azure AD and ADFS.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 准备好了吗？我们将从配置 Azure AD 和 ADFS 的附加应用程序开始。
- en: Configuring additional applications for Azure AD and ADFS
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 Azure AD 和 ADFS 的附加应用程序
- en: 'We will continue the deployment and configuration of more business apps to
    allow you to test the different authentication mechanisms. For our support, we
    configure ServiceNow with SAML and active user provisioning from Azure AD to ServiceNow:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续部署和配置更多的业务应用程序，以便您测试不同的身份验证机制。为了支持我们，我们将配置 ServiceNow 与 SAML 并启用 Azure
    AD 到 ServiceNow 的活动用户预配：
- en: 'Navigate to Azure Active Directory | Enterprise Applications and add a New
    Application:'
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到 Azure Active Directory | 企业应用并添加新应用：
- en: '![](img/81e01e5d-3247-4e91-bdd3-8cf1c0a76aa1.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](img/81e01e5d-3247-4e91-bdd3-8cf1c0a76aa1.png)'
- en: Adding a new Enterprise application
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 添加新的企业应用
- en: 'Choose ServiceNow and add the app from the gallery:'
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 ServiceNow 并从图库中添加该应用：
- en: '![](img/a965e1f0-698d-4563-90da-194f3854e0aa.png)'
  id: totrans-13
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a965e1f0-698d-4563-90da-194f3854e0aa.png)'
- en: Adding ServiceNow
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 添加 ServiceNow
- en: 'After adding the application, we will configure SAML to authenticate our users:'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加应用后，我们将配置 SAML 以验证我们的用户：
- en: '![](img/7e30bb59-d3c5-4b40-8211-0a817b85d366.png)'
  id: totrans-16
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7e30bb59-d3c5-4b40-8211-0a817b85d366.png)'
- en: Using SAML as an authentication method
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SAML 作为身份验证方法
- en: 'In the Basic SAML Configuration, we add our ServiceNow instance information,
    as shown in the following screenshot:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在基本 SAML 配置中，我们添加了我们的 ServiceNow 实例信息，如下图所示：
- en: '![](img/362deb77-a38c-4200-bbf8-3acd73ef0b31.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/362deb77-a38c-4200-bbf8-3acd73ef0b31.png)'
- en: Configuring the SAML options
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 SAML 选项
- en: 'The following URIs need to be used:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 需要使用以下 URI：
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We will use the automatic configuration method for this chapter.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将使用自动配置方法。
- en: 'For the manual configuration tasks, you can download the certificate by using
    the Base64 option:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对于手动配置任务，您可以使用 Base64 选项下载证书：
- en: '![](img/19266103-cec9-4d71-8585-0a84a6cce6b1.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/19266103-cec9-4d71-8585-0a84a6cce6b1.png)'
- en: Download the signing certificate
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 下载签名证书
- en: 'Also, for manual configuration tasks, you can copy the following links into
    a Notepad:'
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，对于手动配置任务，您可以将以下链接复制到记事本中：
- en: '![](img/0f0fd45b-c1f9-4420-bf23-29f00a5ba6dc.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0f0fd45b-c1f9-4420-bf23-29f00a5ba6dc.png)'
- en: Azure AD endpoints overview
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 端点概述
- en: 'Next, we will assign our Service Management Application Access group to the
    application:'
  id: totrans-30
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将把我们的服务管理应用访问组分配给该应用：
- en: '![](img/4c37e157-ba48-4b58-928d-d66216177ab4.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4c37e157-ba48-4b58-928d-d66216177ab4.png)'
- en: Assigning users to the application
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 将用户分配到应用
- en: Now, we can start to configure the ServiceNow instance for Single Sign-On.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以开始为 ServiceNow 实例配置单点登录。
- en: 'First, we need to activate the Multi-Provider Single Sign-On Installer plugin:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要激活 Multi-Provider Single Sign-On 安装程序插件：
- en: '![](img/23e8dda3-6fd9-4436-8e79-1a2caa9d34c3.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/23e8dda3-6fd9-4436-8e79-1a2caa9d34c3.png)'
- en: Multi-Provider SSO feature in ServiceNow
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ServiceNow 中的 Multi-Provider SSO 功能
- en: You will find this option in the navigation pane on the left-hand side: System
    Definition | Plugins.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将在左侧导航窗格中找到此选项：系统定义 | 插件。
- en: 'Activate the following plugin:'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 激活以下插件：
- en: '![](img/8c18543b-1119-4bb2-b4d7-81079f448bbe.png)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8c18543b-1119-4bb2-b4d7-81079f448bbe.png)'
- en: Activating the Multi-Provider SSO feature in ServiceNow
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在 ServiceNow 中激活 Multi-Provider SSO 功能
- en: 'Click the Activate button in the dialog:'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击对话框中的激活按钮：
- en: '![](img/61d63f97-ae6b-4ddc-825c-6ff4565152ec.png)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
  zh: '![](img/61d63f97-ae6b-4ddc-825c-6ff4565152ec.png)'
- en: Activation dialog
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 激活对话框
- en: 'Next, we will configure the plugin under Multi-Provider SSO | Administration
    | Properties:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将在 Multi-Provider SSO | 管理 | 属性下配置插件：
- en: '![](img/aa9def3a-7279-4bf2-8fdc-0a99565dd7dc.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/aa9def3a-7279-4bf2-8fdc-0a99565dd7dc.png)'
- en: Configuring the newly installed plugin
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 配置新安装的插件
- en: 'The following features need to be activated:'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 需要激活以下功能：
- en: '![](img/7b3c3c16-ce52-4f3e-a0b5-6a02f70f7dfb.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7b3c3c16-ce52-4f3e-a0b5-6a02f70f7dfb.png)'
- en: Activating the custom properties for the provider
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 激活提供程序的自定义属性
- en: If you want to use the manual configuration method, you need to use the information
    in your Notepad.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您想使用手动配置方法，您需要使用记事本中的信息。
- en: We use the automatic option for the configuration; it's a little bit of a hidden
    option!
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们使用自动配置选项；这是一个稍微隐藏的选项！
- en: 'You will find it under View step-by-step instructions as shown in the following
    screenshot, in the SAML configuration section:'
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将在以下截图中找到它，位于 SAML 配置部分下的“查看逐步说明”：
- en: '![](img/db783d30-f6fa-4b86-a916-b10cd2fa217f.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/db783d30-f6fa-4b86-a916-b10cd2fa217f.png)'
- en: Automatic configuration option for the ServiceNow SSO Provider
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: ServiceNow SSO 提供程序的自动配置选项
- en: 'Click the option and the following dialog appears; enter your ServiceNow administrative
    credentials:'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击该选项，出现以下对话框；输入您的 ServiceNow 管理员凭据：
- en: '![](img/fa6d90ec-b8e7-416c-8b3f-7d40b8cfdecc.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fa6d90ec-b8e7-416c-8b3f-7d40b8cfdecc.png)'
- en: Configuring the SAML connection
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 SAML 连接
- en: Click **Configure Now**.
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **立即配置**。
- en: Next, we can do additional configuration tasks on the ServiceNow part.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们可以在 ServiceNow 部分进行其他配置任务。
- en: 'Navigate to Multi-Provider SSO | Identity Providers:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 Multi-Provider SSO | 身份提供者：
- en: '![](img/d5b371d2-8572-4c20-90fc-8dc40c36b050.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d5b371d2-8572-4c20-90fc-8dc40c36b050.png)'
- en: Identity Provider configuration
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 身份提供者配置
- en: 'You will find the automatically generated Identity Provider:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将找到自动生成的身份提供者：
- en: '![](img/3b9824b0-a37d-4488-ba46-ef39fee9a7cc.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3b9824b0-a37d-4488-ba46-ef39fee9a7cc.png)'
- en: Start configuring the newly created Azure AD connection in ServiceNow
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 开始配置在 ServiceNow 中新创建的 Azure AD 连接
- en: We need to remove the populated Identity Provider's `SingleLogoutRequest` URL.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们需要移除填充的身份提供者的 `SingleLogoutRequest` URL。
- en: 'All the other fields can be left as their defaults:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 所有其他字段可以保留其默认设置：
- en: '![](img/ee2b6edf-1bac-4799-9e59-3d3fe32385c1.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ee2b6edf-1bac-4799-9e59-3d3fe32385c1.png)'
- en: Configuring the IdP including the Auto Redirect option
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 IdP，包括自动重定向选项
- en: 'Very important! Set the Auto Redirect IdP option, with the expected result:'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 非常重要！设置自动重定向 IdP 选项，预期结果如下：
- en: '![](img/dc13d236-ef45-47b3-ba80-9cfdd75b358b.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dc13d236-ef45-47b3-ba80-9cfdd75b358b.png)'
- en: Auto Redirect IdP option
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 自动重定向 IdP 选项
- en: 'Next, we need to choose the correct certificate for our configuration by navigating
    to the X.509 section:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要通过导航到 X.509 部分选择正确的证书：
- en: '![](img/82ab6d4f-a54b-4bc7-8a3c-7d682e000bff.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/82ab6d4f-a54b-4bc7-8a3c-7d682e000bff.png)'
- en: Configuring the correct certificate
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 配置正确的证书
- en: Save the configuration.
  id: totrans-76
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 保存配置。
- en: 'Now, we have finished the SAML configuration of SeviceNow and we will follow
    up with the user provisioning:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们已经完成了 ServiceNow 的 SAML 配置，接下来将进行用户配置：
- en: Navigate to the Provisioning section of the ServiceNow application and change
    the Provisioning Mode to Automatic.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 ServiceNow 应用程序的配置部分，并将配置模式更改为自动。
- en: 'Insert the following values:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入以下值：
- en: Instance Name
  id: totrans-80
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实例名称
- en: Admin Username
  id: totrans-81
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理员用户名
- en: Admin Password
  id: totrans-82
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理员密码
- en: 'Notification Email (and check Send an email notification when a failure occurs):'
  id: totrans-83
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通知电子邮件（并勾选“发生故障时发送电子邮件通知”）：
- en: '![](img/4e252785-e34f-4654-840d-beed4ca77ab9.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4e252785-e34f-4654-840d-beed4ca77ab9.png)'
- en: Configuring the SCIM provisioning feature
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 SCIM 预配功能
- en: 'Click Test Connection and you should receive a notification like the following
    example. The test of the connection is required to save:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“测试连接”，您应该会收到如下示例的通知。测试连接是保存之前的必需步骤：
- en: '![](img/319235ba-d076-41fe-8631-7e49cd81df82.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/319235ba-d076-41fe-8631-7e49cd81df82.png)'
- en: Connection Test
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 连接测试
- en: Next, we will take a look into the **synchronization configuration** for users
    and groups.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将查看用户和组的**同步配置**。
- en: 'Click the Synchronize Azure Active Directory Users to ServiceNow rule:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“同步 Azure Active Directory 用户到 ServiceNow”规则：
- en: '![](img/c4514e27-814f-475a-ad45-546eebb71cf8.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c4514e27-814f-475a-ad45-546eebb71cf8.png)'
- en: Configuring the Synchronization Rules
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 配置同步规则
- en: 'You will find the active Attribute Mapping. If you need to handle special considerations,
    such as if you connect to a filled ServiceNow instance, you can modify the mappings
    to fit your needs:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您将找到活动的属性映射。如果您需要处理特殊考虑事项，例如连接到已填充的 ServiceNow 实例，您可以修改映射以满足您的需求：
- en: '![](img/ed4b2db4-9d59-42cf-a892-5ab425457c02.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ed4b2db4-9d59-42cf-a892-5ab425457c02.png)'
- en: Synchronization Rule Settings
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 同步规则设置
- en: 'You will also get an actual overview of the **Synchronization Details**:'
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您还将获得**同步详细信息**的实际概览：
- en: '![](img/d69db8e4-39c2-46d8-b6a4-bef3ab47477a.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d69db8e4-39c2-46d8-b6a4-bef3ab47477a.png)'
- en: Synchronization details for monitoring and auditing
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 用于监控和审计的同步详细信息
- en: 'By clicking on View the "Account Provisioning" category in the audit logs for
    full details you will get the following screenshot:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击查看“帐户预配”类别，您可以在审计日志中看到完整详细信息，并获得如下截图：
- en: '![](img/9486384c-fe1d-430c-bdef-a36e2340d3e8.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9486384c-fe1d-430c-bdef-a36e2340d3e8.png)'
- en: Actual state for the test user
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 测试用户的实际状态
- en: Next, we will change to the Organization | User section in your ServiceNow instance.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将切换到您的 ServiceNow 实例中的“组织 | 用户”部分。
- en: 'Search for your test user, in my case `Don.Hall@inovitdemos.ch`, and you will
    see the result of the automatic provisioning:'
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 搜索您的测试用户，例如`Don.Hall@inovitdemos.ch`，您将看到自动预配的结果：
- en: '![](img/679a13e4-f5a2-49fe-a091-17ff4d247048.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/679a13e4-f5a2-49fe-a091-17ff4d247048.png)'
- en: Verifying the synchronized test user in ServiceNow
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 验证在 ServiceNow 中同步的测试用户
- en: The initial synchronization takes longer to perform than subsequent synchronizations,
    which occur approximately every **40 minutes** as long as the service is running.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 初始同步所需的时间较长，而后续同步大约每**40分钟**进行一次，只要服务在运行。
- en: The next scenario we want to accomplish is the use of **OpenID Connect** and
    your on-premises ADFS infrastructure. To follow the authentication flow, use [Chapter
    6](1f239a9c-c62a-4e40-ab58-ce78cd87e8be.xhtml), *Managing Authentication Protocols*.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的场景是使用**OpenID Connect**和您的本地ADFS基础设施。要跟随认证流程，请参考[第六章](1f239a9c-c62a-4e40-ab58-ce78cd87e8be.xhtml)，*管理认证协议*。
- en: To configure this scenario on your **YD1APP01** server, we need to copy the `active-directory-dotnet-webapp-openidconnect`
    folder from the code package to your desktop.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 要在您的**YD1APP01**服务器上配置此场景，我们需要将`active-directory-dotnet-webapp-openidconnect`文件夹从代码包复制到桌面。
- en: 'We configure your ADFS server (**YD1ADS01**) on your domain controller to get
    the following expected result at the end, a full working OpenID authenticated
    application:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在您的域控制器上配置 ADFS 服务器（**YD1ADS01**），最终将得到以下预期结果——一个完整的 OpenID 认证应用程序：
- en: '![](img/65d23739-b669-4930-8b88-afe0be215f7c.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/65d23739-b669-4930-8b88-afe0be215f7c.png)'
- en: Result of the following configuration steps
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 以下配置步骤的结果
- en: 'In the next steps, we will configure the scenario:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的步骤中，我们将配置该场景：
- en: 'We start with the creation of a new application group including a Server application
    (standalone application):'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们从创建一个新的应用程序组开始，其中包括一个服务器应用程序（独立应用程序）：
- en: '![](img/9844338e-7a3e-46c5-abec-92482ff30efe.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9844338e-7a3e-46c5-abec-92482ff30efe.png)'
- en: Configuring the new application group
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 配置新的应用程序组
- en: Next, a Client Id is generated; copy the ID to a notepad.
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，生成一个客户端 ID；将该 ID 复制到记事本中。
- en: 'Enter the redirect URI, `https://localhost:44320/`, under which the application
    will run:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入应用程序将运行的重定向 URI，`https://localhost:44320/`：
- en: '![](img/f18e296c-c8b0-446d-a6d6-56f7d39178ef.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f18e296c-c8b0-446d-a6d6-56f7d39178ef.png)'
- en: Providing the application properties
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 提供应用程序属性
- en: 'Click Next and check **Generate a shared secret box**; copy the key to the
    notepad:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“下一步”，并勾选**生成共享密钥框**；将密钥复制到记事本中：
- en: '![](img/33487fa4-dddf-4bcd-8e28-7f31f33813d5.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/33487fa4-dddf-4bcd-8e28-7f31f33813d5.png)'
- en: Generating the shared key
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 生成共享密钥
- en: Complete the wizard.
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成向导。
- en: Next, we will create the Web API configuration by double-clicking on your new
    application group.
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们通过双击新应用程序组来创建 Web API 配置。
- en: 'Choose Add application:'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择添加应用程序：
- en: '![](img/869ca15a-8bd8-4e98-a64b-2835bfe6a42b.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/869ca15a-8bd8-4e98-a64b-2835bfe6a42b.png)'
- en: Web API configuration
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: Web API 配置
- en: 'Use the Web API option:'
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Web API 选项：
- en: '![](img/35830923-eab0-42c1-a46d-06659f881c8a.png)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](img/35830923-eab0-42c1-a46d-06659f881c8a.png)'
- en: Choosing the Web API option
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 Web API 选项
- en: 'Next, add the Identifier for the API: `https://inovitdemos.ch/OpenIDDemo`[.](https://inovitdemos.ch/OpenIDDemo)'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，为 API 添加标识符：`https://inovitdemos.ch/OpenIDDemo`[.](https://inovitdemos.ch/OpenIDDemo)
- en: Click Next in the Access Control Policy section and all the other sections to
    finish the wizard.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在访问控制策略部分点击下一步，然后完成向导的其他部分。
- en: For now, we change to the **YD1APP01** server and open our Visual Studio.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们切换到 **YD1APP01** 服务器并打开 Visual Studio。
- en: Open the Solution file of the demo code: `WebApp-OpenIDConnect-DotNet.sln`.
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开示例代码的解决方案文件：`WebApp-OpenIDConnect-DotNet.sln`。
- en: Navigate in Solution Explorer to the `web.config` file: `WebApp-OpenIDConnect-DotNet.sln`.
  id: totrans-135
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在解决方案资源管理器中导航到 `web.config` 文件：`WebApp-OpenIDConnect-DotNet.sln`。
- en: 'Modify the code so that it looks like the following example:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 修改代码，使其看起来像下面的示例：
- en: Copy your Client Id from your notepad.
  id: totrans-137
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从记事本中复制您的客户端 ID。
- en: Configure the `ida:ADFSDiscoveryDoc` value so that it contains your ADFS FQDN: `https://login.inovitdemos.ch`.
  id: totrans-138
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 `ida:ADFSDiscoveryDoc` 的值，使其包含您的 ADFS FQDN：`https://login.inovitdemos.ch`。
- en: 'Verify that the `ida:PostLogoutRedirectUri` value contains `https://localhost:44320/`:'
  id: totrans-139
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证 `ida:PostLogoutRedirectUri` 的值是否包含 `https://localhost:44320/`：
- en: '[PRE1]'
  id: totrans-140
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Next, navigate to the *App_Start* section and the `Startup.Auth.cs` file.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，导航到 *App_Start* 部分和 `Startup.Auth.cs` 文件。
- en: 'Directly under the public partial class `Startup`, the code needs to look like
    the following to tweak the OpenID Connect middleware initialization logic:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 `public partial class Startup` 下面，代码需要像下面这样调整 OpenID Connect 中间件初始化逻辑：
- en: '[PRE2]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: We don't need the Azure AD configuration, so we comment this part out!
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不需要 Azure AD 配置，所以我们将这一部分注释掉！
- en: 'Next, we need to modify the OpenID Connect middleware options:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要修改 OpenID Connect 中间件选项：
- en: '[PRE3]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: ADFS does enforce the `redirect_uri` in the request. Azure AD doesn't do that.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: ADFS 会强制执行请求中的 `redirect_uri`，而 Azure AD 不会这样做。
- en: 'Now, we can verify the app; press *F5* in Visual Studio. To analyze the traffic,
    you can use Fiddler. Note that you will be stuck with Fiddler on the authentication
    part:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以验证应用程序；在 Visual Studio 中按下 *F5*。要分析流量，您可以使用 Fiddler。请注意，您会在身份验证部分遇到 Fiddler
    的问题：
- en: '![](img/7462f82e-15cc-4200-b32c-beffceb41a7d.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7462f82e-15cc-4200-b32c-beffceb41a7d.png)'
- en: Fiddler result of the authentication
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: Fiddler 认证结果
- en: Well done, you have configured an application that uses OpenID Connect!
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 做得好，您已经配置了一个使用 OpenID Connect 的应用程序！
- en: Publishing with Windows server and Azure AD Web Application Proxy
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用 Windows 服务器和 Azure AD Web 应用程序代理发布
- en: The Azure AD Application Proxy is similar to the on-premises Web Application
    Proxy role, starting in Windows Server 2012 R2\. With this service, you can enable
    external access for on-premises applications. Azure AD Application Proxy requires
    an Azure AD Basic or an Azure AD Premium subscription. The connection is made
    directly with Azure and done through a proxy into the private network, with an
    application proxy agent installed on the on-premises web application server.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 应用程序代理类似于 Windows Server 2012 R2 开始的本地 Web 应用程序代理角色。通过此服务，您可以启用本地应用程序的外部访问。Azure
    AD 应用程序代理需要 Azure AD Basic 或 Azure AD Premium 订阅。连接直接与 Azure 建立，并通过代理进入私有网络，在本地
    Web 应用程序服务器上安装应用程序代理代理。
- en: 'Let''s run a very common use case to include a Kerberos on-premises application
    into our Azure AD Access UI, [https://myapps.microsoft.com](https://myapps.microsoft.com).
    We use our existing application to configure the scenario:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们运行一个非常常见的用例，将 Kerberos 本地应用程序添加到我们的 Azure AD 访问 UI，[https://myapps.microsoft.com](https://myapps.microsoft.com)。我们使用现有应用程序来配置这个场景：
- en: Log in to [https://portal.azure.com](https://portal.azure.com) and choose the
    Azure Active Directory blade.
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 [https://portal.azure.com](https://portal.azure.com) 并选择 Azure Active Directory
    面板。
- en: Under Application proxy, we first need to download and install the application
    proxy agent on our **YD1APP01** server.
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在应用程序代理下，我们首先需要在 **YD1APP01** 服务器上下载并安装应用程序代理代理。
- en: You don't need to install the agent directly on the application server. It's
    also possible to use any other server, or also additional agents for redundancy
    requirements. The agent needs to be installed on a server in the same or a correctly
    trusted domain/forest to support Kerberos constrained delegation, and the SPN
    of the application needs to be done on every agent instance. The domain function
    level needs to be Windows Server 2012 at a minimum. Also, the correct ports need
    to be accessible from the other server.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 您无需直接在应用程序服务器上安装代理。也可以使用任何其他服务器，或者出于冗余要求使用额外的代理。代理需要安装在与应用程序在同一域/森林中或正确信任的域/森林中的服务器上，以支持Kerberos受限委派，应用程序的SPN需要在每个代理实例上完成。域功能级别至少需要为Windows
    Server 2012。同时，其他服务器必须能够访问正确的端口。
- en: 'Download the agent onto the server and start the installation:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将代理下载到服务器并启动安装：
- en: '![](img/7337b579-2580-4701-9258-4c626c7f9add.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7337b579-2580-4701-9258-4c626c7f9add.png)'
- en: Configure the Azure AD Application Proxy
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 配置Azure AD应用程序代理
- en: Agree to the license terms and conditions and click Next.
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同意许可条款并点击下一步。
- en: Next, you need to provide global administrator credentials to register the agent
    to Azure AD.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，您需要提供全局管理员凭证以将代理注册到Azure AD。
- en: 'Recognize the notification for outbound proxy usage:'
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 识别用于外部代理的通知：
- en: '![](img/bfbe4775-1b67-4179-8c26-dd2b051277ca.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bfbe4775-1b67-4179-8c26-dd2b051277ca.png)'
- en: Installation of the Application Proxy Connector
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 安装应用程序代理连接器
- en: 'The expected result is an Active agent:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 预期结果是激活的代理：
- en: '![](img/5151fa0f-ae04-4793-872f-2ef592bbf510.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5151fa0f-ae04-4793-872f-2ef592bbf510.png)'
- en: Active agents overview
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 激活代理概览
- en: Now, we can start to configure our Kerberos-based on-premises application.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以开始配置基于Kerberos的本地应用程序。
- en: 'First, we create a group that can be assigned to grant access to the portal:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们创建一个可以分配以授权访问门户的组：
- en: '![](img/51f587ac-d3f3-4a23-a1e6-35f0b04cf3c7.png)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![](img/51f587ac-d3f3-4a23-a1e6-35f0b04cf3c7.png)'
- en: Assigning the needed test group
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 分配所需的测试组
- en: Assign one test user to your group.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将一个测试用户分配给您的组。
- en: In this example, we use the option that we don't publish the application with
    an official public FQDN. In that case, we don't need to open any firewall ports
    and the traffic to the app is working through the connector.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，我们使用的是不通过官方公共FQDN发布应用程序的选项。在这种情况下，我们不需要打开任何防火墙端口，应用程序的流量通过连接器工作。
- en: 'Next, we will configure the app proxy configuration:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将配置应用程序代理配置：
- en: '![](img/eacc1379-9a4e-4bda-92c5-9b5975560074.png)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eacc1379-9a4e-4bda-92c5-9b5975560074.png)'
- en: Configuring the on-premises application properties
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 配置本地应用程序属性
- en: As you can see, you are able to provide several additional settings to address
    your needs.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如您所见，您可以提供多个附加设置以满足您的需求。
- en: You can find more information about the different options at the following reference: [https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-add-on-premises-application](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-add-on-premises-application).
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在以下参考文献中找到关于不同选项的更多信息：[https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-add-on-premises-application](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-add-on-premises-application)。
- en: In the next step, we will configure the Single-Sign-On options for our application.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一步中，我们将配置应用程序的单点登录选项。
- en: 'Choose the Windows Integrated Authentication option:'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择Windows集成认证选项：
- en: '![](img/1dadced9-8df8-485b-ae55-fef1a5e6c2d5.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1dadced9-8df8-485b-ae55-fef1a5e6c2d5.png)'
- en: Choosing the Windows Integrated Authentication option
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 选择Windows集成认证选项
- en: If you need to use Header-based authentication, the integration with PingAccess
    will be your friend. You can find more information about this integration at the
    following source: [https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-configure-single-sign-on-with-ping-access](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-configure-single-sign-on-with-ping-access).
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您需要使用基于头部的认证，与PingAccess的集成将是您的好伙伴。您可以在以下来源找到有关此集成的更多信息：[https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-configure-single-sign-on-with-ping-access](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/application-proxy-configure-single-sign-on-with-ping-access)。
- en: Enter your Internal Application SPN to configure the Kerberos part.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入您的内部应用程序SPN以配置Kerberos部分。
- en: 'Keep in mind that only Kerberos Constrained Delegation will work:'
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请记住，只有Kerberos受限委派才有效：
- en: '![](img/270472f1-d7d0-4c7e-bd80-5de075b76dc3.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](img/270472f1-d7d0-4c7e-bd80-5de075b76dc3.png)'
- en: Configure the SPN for the App
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 配置应用的SPN
- en: 'After this configuration, we can test the application with the assigned user
    in your access group, and you should get a similar result to this:'
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成此配置后，我们可以使用已分配的用户来测试应用，并且你应该得到类似于此的结果：
- en: '![](img/6219a02c-09fc-4262-b592-b743fffff0d7.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6219a02c-09fc-4262-b592-b743fffff0d7.png)'
- en: Result of a successful Kerberos authentication on the example app
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 示例应用上成功的Kerberos身份验证结果
- en: This publishing method also allows us to use a public FQDN. This option can
    be useful if your application sends notification mails with links inside. To realize
    this use case, you need to change the external URL and provide a public SSL certificate.
    You can use your wildcard certificate or issue a separate SSL certificate with
    Let's encrypt.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这种发布方式还允许我们使用公共FQDN。如果你的应用程序发送带有链接的通知邮件，这个选项会很有用。要实现这种使用场景，你需要更改外部URL并提供公共SSL证书。你可以使用通配符证书，或使用Let's
    Encrypt颁发一个独立的SSL证书。
- en: 'You will find the settings under Basic Settings:'
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将在基本设置下找到该设置：
- en: '![](img/77bc56e9-f1c5-4701-bd30-7d0125ff0596.png)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
  zh: '![](img/77bc56e9-f1c5-4701-bd30-7d0125ff0596.png)'
- en: Defining the basic app settings
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 定义基本应用程序设置
- en: 'For the certificate, you need to use the following section. Don''t forget to
    create the CNAME inside your public DNS:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 对于证书，你需要使用以下部分。别忘了在你的公共DNS中创建CNAME：
- en: '![](img/170e7ded-8d6f-448e-8404-19357d8c3635.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![](img/170e7ded-8d6f-448e-8404-19357d8c3635.png)'
- en: View the DNS configuration options
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 查看DNS配置选项
- en: The next authentication method we can use for cloud or on-premises applications
    (through Azure AD Web Application Proxy) is the password-based option. We use
    it for form-based authentication activated applications that use their own identity
    provider.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以为云或本地应用（通过Azure AD Web应用代理）使用的下一个身份验证方法是基于密码的选项。我们将其用于启用了表单身份验证的应用，这些应用使用自己的身份提供者。
- en: Your credentials will be securely stored under the user or group object.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 你的凭证将被安全地存储在用户或组对象下。
- en: 'In the next steps, we will add a password-based application access:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的步骤中，我们将添加一个基于密码的应用访问：
- en: Add a new application and use the Non-gallery application option.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加一个新应用并选择非画廊应用选项。
- en: 'Choose the Password-based option under the Single sign-on method:'
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在单点登录方法下选择基于密码的选项：
- en: '![](img/5f4f587c-5610-441b-8daf-bfc634589e31.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5f4f587c-5610-441b-8daf-bfc634589e31.png)'
- en: Choosing a non-gallery application
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 选择非画廊应用
- en: 'Provide a name for your application and navigate to the Single-Sign-On configuration:'
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为你的应用提供名称，并导航到单点登录配置：
- en: '![](img/60a77d91-9f74-41d1-90ab-42f6485a93a6.png)'
  id: totrans-207
  prefs: []
  type: TYPE_IMG
  zh: '![](img/60a77d91-9f74-41d1-90ab-42f6485a93a6.png)'
- en: Using the password-based authentication method
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 使用基于密码的身份验证方法
- en: Provide the Sign-On URL and detect the sign-in fields of your application.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供单点登录URL并检测你的应用的登录字段。
- en: 'There are three options to do this configuration:'
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 有三种方式可以进行此配置：
- en: Automatically
  id: totrans-211
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动
- en: Manually
  id: totrans-212
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 手动
- en: 'With custom configuration in the Advanced View:'
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在高级视图中的自定义配置：
- en: '![](img/55b1b925-8994-4cf8-bd9c-e779700b6eb5.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![](img/55b1b925-8994-4cf8-bd9c-e779700b6eb5.png)'
- en: Detecting the login fields of the application
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 检测应用程序的登录字段
- en: In this example, we used our public DNS provider's login page.
  id: totrans-216
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个例子中，我们使用了我们公共DNS提供商的登录页面。
- en: 'You can view the field labels with any browser and the developer tools to provide
    the values if the Azure AD mechanism doesn''t get the correct values:'
  id: totrans-217
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果Azure AD机制未能获取正确的值，你可以使用任何浏览器和开发者工具查看字段标签，并提供值：
- en: '![](img/a114233c-6925-457d-afa2-f3fbf760691e.png)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a114233c-6925-457d-afa2-f3fbf760691e.png)'
- en: Analyzing the code to find the login fields/labels
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 分析代码以查找登录字段/标签
- en: 'Next, you need to assign the user or group to the application:'
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，你需要将用户或组分配给应用：
- en: '![](img/164990f5-a2bd-4b35-b2a8-19430d5a5714.png)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![](img/164990f5-a2bd-4b35-b2a8-19430d5a5714.png)'
- en: Updating the credentials on the user/group
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 更新用户/组上的凭证
- en: You have the option to provide the credentials hidden to the user or group,
    and the option that the credentials will be saved with the first access.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以选择将凭证隐藏给用户或组，或选择凭证在首次访问时保存。
- en: 'For now, provide the credentials with the Update Credentials button:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，通过更新凭证按钮提供凭证：
- en: '![](img/27d7c21d-3a4b-4a89-b690-a065555768b4.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](img/27d7c21d-3a4b-4a89-b690-a065555768b4.png)'
- en: Update credentials dialog
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 更新凭证对话框
- en: Now, you are ready to test the application with your test user.
  id: totrans-227
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你可以使用你的测试用户来测试这个应用。
- en: Keep in mind that the user needs to have the Access Panel UI extension installed
    or he will get asked to install it. You can also deploy this extension to all
    your computers using a group policy or any other software deployment tool. Find
    out more information about this at [https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/access-panel-extension-problem-installing](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/access-panel-extension-problem-installing)
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 请记住，用户需要安装访问面板 UI 扩展，否则他将被要求安装。你还可以使用组策略或任何其他软件部署工具将此扩展部署到所有计算机。有关此的更多信息，请访问
    [https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/access-panel-extension-problem-installing](https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/access-panel-extension-problem-installing)
- en: To test the same capabilities with your on-premises infrastructure, we provide
    you with a small challenge. If you don't get it running, send an email to `support@inovit.ch`
    and we will be happy to provide you with the answer.
  id: totrans-229
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了在本地基础设施中测试相同的功能，我们为你提供了一个小挑战。如果你未能成功运行，请发送电子邮件到 `support@inovit.ch`，我们将很高兴为你提供答案。
- en: You need to deploy the test application with the following steps on the **YD1APP01 server**.
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你需要在 **YD1APP01 服务器** 上按照以下步骤部署测试应用程序。
- en: 'Create a DNS entry for the app on your domain controller (**YD1ADS01**), `forms.inovitdemos.ch`:'
  id: totrans-231
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在你的域控制器（**YD1ADS01**）上为应用程序创建 DNS 条目 `forms.inovitdemos.ch`：
- en: '[PRE4]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Create the service account under which the application runs on your app server:'
  id: totrans-233
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在应用服务器上创建应用程序运行所需的服务账户：
- en: '[PRE5]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Connect to your SQL Server over in the SQL Management Studio on your **YD1APP01:**
  id: totrans-235
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 SQL 管理工作室中连接到你的 SQL Server，位于 **YD1APP01**：
- en: '![](img/74343ba0-4df5-43fa-99e8-72a944860c8b.png)'
  id: totrans-236
  prefs: []
  type: TYPE_IMG
  zh: '![](img/74343ba0-4df5-43fa-99e8-72a944860c8b.png)'
- en: SQL Connection with the SQL Management Studio
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 SQL 管理工作室进行 SQL 连接
- en: 'Create a login for your service account under Security | **Logins**:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在安全性 | **登录** 下为你的服务账户创建一个登录：
- en: '![](img/e50054ff-19a1-41cd-9e77-526ab7678708.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e50054ff-19a1-41cd-9e77-526ab7678708.png)'
- en: Configuring the login for the app service account
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 配置应用程序服务账户的登录
- en: 'Assign the dbcreator server role to the user:'
  id: totrans-241
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为用户分配 dbcreator 服务器角色：
- en: '![](img/414f5dc7-5813-441f-b0af-143d93ef3bfe.png)'
  id: totrans-242
  prefs: []
  type: TYPE_IMG
  zh: '![](img/414f5dc7-5813-441f-b0af-143d93ef3bfe.png)'
- en: Assigning the dbcreator role to the service account
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 为服务账户分配 dbcreator 角色
- en: 'Next, we need to create the website on the server:'
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们需要在服务器上创建网站：
- en: '[PRE6]'
  id: totrans-245
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'As with the other on-premises demo applications, we will create a HTTPS binding
    and assign our SSL certificate:'
  id: totrans-246
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 与其他本地演示应用程序一样，我们将创建 HTTPS 绑定并分配我们的 SSL 证书：
- en: '![](img/93701cfd-fcba-48aa-affe-c270d09b22b9.png)'
  id: totrans-247
  prefs: []
  type: TYPE_IMG
  zh: '![](img/93701cfd-fcba-48aa-affe-c270d09b22b9.png)'
- en: Configuring the IIS Bindings for the application
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 配置应用程序的 IIS 绑定
- en: 'We also need to create a new app pool for the website and use the service account
    to run the app:'
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们还需要为网站创建一个新的应用程序池，并使用服务账户来运行应用程序：
- en: '![](img/f89b3530-2e5e-4761-afb2-bc8d36cc6dac.png)'
  id: totrans-250
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f89b3530-2e5e-4761-afb2-bc8d36cc6dac.png)'
- en: Creation of the Application Pool
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 创建应用程序池
- en: 'Next, we will assign the newly created application pool to our website under Advanced
    settings:'
  id: totrans-252
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将在高级设置中将新创建的应用程序池分配给我们的网站：
- en: '![](img/99cab251-a56e-44e5-a746-0e0d742e1ddf.png)'
  id: totrans-253
  prefs: []
  type: TYPE_IMG
  zh: '![](img/99cab251-a56e-44e5-a746-0e0d742e1ddf.png)'
- en: Assigning the newly created app pool
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 分配新创建的应用程序池
- en: 'The authentication for the page should be configured as shown in the following
    screenshot:'
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 页面身份验证应该按照以下截图进行配置：
- en: '![](img/4150cc65-48db-485a-88de-9ca7b068b149.png)'
  id: totrans-256
  prefs: []
  type: TYPE_IMG
  zh: '![](img/4150cc65-48db-485a-88de-9ca7b068b149.png)'
- en: IIS Authentication configuration
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: IIS 身份验证配置
- en: 'The next step is that we need to copy the content of the `formsapp` folder
    from the code package to `C:\inetpub\formsroot`:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是将代码包中的 `formsapp` 文件夹内容复制到 `C:\inetpub\formsroot`：
- en: '![](img/abb475a9-a764-4570-9822-14060e63f778.png)'
  id: totrans-259
  prefs: []
  type: TYPE_IMG
  zh: '![](img/abb475a9-a764-4570-9822-14060e63f778.png)'
- en: Application Code
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序代码
- en: 'Before you can run the app, you need to configure the `web.config` file to
    address the SQL Server instance:'
  id: totrans-261
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在运行应用程序之前，你需要配置 `web.config` 文件，以便连接到 SQL Server 实例：
- en: '[PRE7]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Now, you can test your application by registering a user and a successful login:'
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你可以通过注册一个用户并成功登录来测试你的应用程序：
- en: '![](img/06942a3a-5eb7-45a8-96ff-68e205148324.png)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![](img/06942a3a-5eb7-45a8-96ff-68e205148324.png)'
- en: Successful test of the app
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序测试成功
- en: Start with your publishing scenario and log in to this website—good luck!
  id: totrans-266
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从你的发布场景开始并登录此网站——祝你好运！
- en: 'In the next example, we will use the **Windows Server Web Application Proxy**
    to publish a Basic authentication-based application to external users:'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一个示例中，我们将使用 **Windows Server Web 应用程序代理** 将基于基本身份验证的应用程序发布到外部用户：
- en: First, you need to log in to your **YD1ADS01** to configure the relying party
    for the Basic demo application.
  id: totrans-268
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，你需要登录到**YD1ADS01**来配置基础演示应用程序的依赖方。
- en: Navigate to Relying Party Trusts and Add Relying Party Trust.
  id: totrans-269
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到依赖方信任并添加依赖方信任。
- en: Choose the non-claims-aware option.
  id: totrans-270
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择非声明感知选项。
- en: Fill in the following Display Name: `Basic Demo Web Site`.
  id: totrans-271
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写以下显示名称：`Basic Demo Web Site`。
- en: Use `https://basic.inovitdemos.ch` (replace it with your domain) as Relying
    Party Trust Identifier and click add.
  id: totrans-272
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`https://basic.inovitdemos.ch`（替换为你的域名）作为依赖方信任标识符，然后点击添加。
- en: Don't forget to configure the FQDN in your public DNS.
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: 别忘了在你的公共 DNS 中配置 FQDN。
- en: Click Next until the wizard is finished.
  id: totrans-274
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一直点击下一步直到向导完成。
- en: Log in to your **YD1URA01** server and open the Remote Access Management console.
  id: totrans-275
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到你的**YD1URA01**服务器并打开远程访问管理控制台。
- en: 'Click on Publish in the right-hand Tasks pane:'
  id: totrans-276
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在右侧任务窗格中点击发布：
- en: '![](img/ddf7bd84-a212-487e-8489-624a3d2d3235.png)'
  id: totrans-277
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ddf7bd84-a212-487e-8489-624a3d2d3235.png)'
- en: Publishing wizard on the web application proxy
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: Web 应用程序代理中的发布向导
- en: 'Specify the ADFS preauthentication method:'
  id: totrans-279
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定 ADFS 预身份验证方法：
- en: '![](img/6993f66b-3517-407c-bc63-82bb4f440104.png)'
  id: totrans-280
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6993f66b-3517-407c-bc63-82bb4f440104.png)'
- en: Using the ADFS preauthentication method
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 ADFS 预身份验证方法
- en: 'Choose HTTP Basic as the type of preauthentication:'
  id: totrans-282
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择 HTTP Basic 作为预身份验证类型：
- en: '![](img/dadf671f-54b0-4082-af90-b23535bb4d7e.png)'
  id: totrans-283
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dadf671f-54b0-4082-af90-b23535bb4d7e.png)'
- en: Using HTTP Basic
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 HTTP Basic
- en: Choose Basic Demo Web Site relying party.
  id: totrans-285
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择基础演示网站作为依赖方。
- en: 'Fill in the following publishing values:'
  id: totrans-286
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 填写以下发布值：
- en: '![](img/79aeb31a-c0d8-4b6d-b0b5-92c02b408faf.png)'
  id: totrans-287
  prefs: []
  type: TYPE_IMG
  zh: '![](img/79aeb31a-c0d8-4b6d-b0b5-92c02b408faf.png)'
- en: Setting the application properties
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 设置应用程序属性
- en: 'Click Next, Publish, and Close:'
  id: totrans-289
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击下一步，发布，然后关闭：
- en: '![](img/96eb4c63-34b9-4543-8000-3c5ef134367c.png)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![](img/96eb4c63-34b9-4543-8000-3c5ef134367c.png)'
- en: Final publishing settings
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 最终发布设置
- en: Now, you can test your freshly published Basic authentication app.
  id: totrans-292
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你可以测试你刚刚发布的基本身份验证应用程序。
- en: You will find more practical scenarios for several services, such as the Exchange
    and Remote Desktop services, at the following sources: [https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication](https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication) and [https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication](https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication).
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在以下来源找到更多针对多个服务的实际场景，例如 Exchange 和远程桌面服务：[https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication](https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication)
    和 [https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication](https://docs.microsoft.com/en-us/windows-server/remote/remote-access/web-application-proxy/publishing-applications-using-ad-fs-preauthentication)。
- en: In the next section, we will include the first conditional access options.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分中，我们将包括第一个条件访问选项。
- en: Using conditional access
  id: totrans-295
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用条件访问
- en: 'In our first conditional access scenario, we will use the Azure AD functionality
    to secure Salesforce access with Azure MFA:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的第一个条件访问场景中，我们将使用 Azure AD 功能，通过 Azure MFA 来保护 Salesforce 的访问：
- en: Navigate to [https://portal.azure.com](https://portal.azure.com) and the Azure
    AD pane | Conditional Access.
  id: totrans-297
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到 [https://portal.azure.com](https://portal.azure.com) 和 Azure AD 窗格 | 条件访问。
- en: 'Click New policy:'
  id: totrans-298
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击新建策略：
- en: '![](img/25391b21-4ca5-4722-b1d4-4332045ba36e.png)'
  id: totrans-299
  prefs: []
  type: TYPE_IMG
  zh: '![](img/25391b21-4ca5-4722-b1d4-4332045ba36e.png)'
- en: Creating a Conditional Access policy
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: 创建条件访问策略
- en: Call the new policy `Salesforce Protection`.
  id: totrans-301
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新策略命名为 `Salesforce Protection`。
- en: 'Under assignments, go to Include | All users:'
  id: totrans-302
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在分配下，进入包含 | 所有用户：
- en: '![](img/b97d6fa1-3880-404d-82a8-f984e6f2dffe.png)'
  id: totrans-303
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b97d6fa1-3880-404d-82a8-f984e6f2dffe.png)'
- en: User assignment options
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 用户分配选项
- en: 'Under Cloud apps | Select apps, choose Salesforce:'
  id: totrans-305
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在云应用 | 选择应用中，选择 Salesforce：
- en: '![](img/85fbf159-1b6d-48d1-96b7-47233ba29421.png)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![](img/85fbf159-1b6d-48d1-96b7-47233ba29421.png)'
- en: Selecting the Salesforce app
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 Salesforce 应用
- en: 'Under Conditions | choose Locations | Yes and Any location:'
  id: totrans-308
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在条件 | 选择位置 | 是和任何位置：
- en: '![](img/6a294d6c-17d5-489b-9526-5a9fe0d70f7b.png)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6a294d6c-17d5-489b-9526-5a9fe0d70f7b.png)'
- en: Choosing the location attributes
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 选择位置属性
- en: As you can see, you have many conditions that can be set when you want to fulfill
    security requirements in the case of additional authentication or access control
    mechanisms. You can find more information at the following source: [https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/).
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，当您需要满足附加身份验证或访问控制机制的安全要求时，您可以设置许多条件。您可以在以下来源找到更多信息：[https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/)。
- en: Under Access controls, go to Grant.
  id: totrans-312
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在访问控制下，转到授予。
- en: 'Choose Grant access | Require multi-factor authentication:'
  id: totrans-313
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择授予访问权限 | 需要多因素认证（MFA）：
- en: '![](img/10020e08-a352-4eff-9972-20e0ee00b153.png)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
  zh: '![](img/10020e08-a352-4eff-9972-20e0ee00b153.png)'
- en: Using MFA for granting the access
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 使用MFA来授予访问权限
- en: 'Enable the policy and click Create:'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用策略并点击创建：
- en: '![](img/c172525c-79ce-471d-93b7-0eb7c8fbe44a.png)'
  id: totrans-317
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c172525c-79ce-471d-93b7-0eb7c8fbe44a.png)'
- en: Enabling the policy
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 启用策略
- en: Now, you can test it with a Salesforce assigned user and Azure MFA will be required.
  id: totrans-319
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您可以使用Salesforce分配的用户进行测试，并且Azure MFA将是必需的。
- en: 'In the second example, we will follow the same scenario with our on-premises
    ADFS infrastructure:'
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
  zh: 在第二个示例中，我们将沿用相同的场景，使用我们的本地ADFS基础设施：
- en: Log in to your ADFS server (**YD1ADS01**) and open the ADFS management console.
  id: totrans-321
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到您的ADFS服务器（**YD1ADS01**），并打开ADFS管理控制台。
- en: We will enable **Azure MFA** for our **Kerberos Demo Web Site.**
  id: totrans-322
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将为我们的**Kerberos演示网站**启用**Azure MFA**。
- en: 'Right-click on the app and choose Edit Access Control Policy:'
  id: totrans-323
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键单击应用程序并选择编辑访问控制策略：
- en: '![](img/3b0164aa-5fa2-47de-be4a-5e492982ed76.png)'
  id: totrans-324
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3b0164aa-5fa2-47de-be4a-5e492982ed76.png)'
- en: Configuring Access Control Policies for the app
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 为应用程序配置访问控制策略
- en: 'Next, choose Permit everyone and require MFA:'
  id: totrans-326
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，选择允许所有人并要求MFA：
- en: '![](img/eec65966-fc58-4fce-87e8-bcaad5025186.png)'
  id: totrans-327
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eec65966-fc58-4fce-87e8-bcaad5025186.png)'
- en: Enabling the MFA option
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: 启用MFA选项
- en: Apply the settings and navigate to Authentication Methods.
  id: totrans-329
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用设置并转到身份验证方法。
- en: Choose Edit Multi-Factor Authentication Methods.
  id: totrans-330
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择编辑多因素认证方法。
- en: 'Go to Additional and choose Azure MFA:'
  id: totrans-331
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到“附加”并选择Azure MFA：
- en: '![](img/0e85a490-2816-45fc-a8b8-efeb3ef83b9d.png)'
  id: totrans-332
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0e85a490-2816-45fc-a8b8-efeb3ef83b9d.png)'
- en: Choosing the Azure MFA method
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 选择Azure MFA方法
- en: Apply the setting and you are now ready to test the application.
  id: totrans-334
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用设置后，您现在可以开始测试应用程序。
- en: You need to use a registered Azure MFA user to access the application. In the
    code package for the chapter, you will find additional use cases, including the
    customization required to modify the login web page to interact with the user.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要使用已注册的Azure MFA用户来访问应用程序。在本章的代码包中，您将找到其他用例，包括修改登录网页与用户交互所需的自定义内容。
- en: 'We will include more conditional access use cases and more information about
    the Azure MFA service in the following chapters:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将在接下来的章节中涵盖更多的条件访问用例以及有关Azure MFA服务的更多信息：
- en: Exploring Azure AD identity services
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 探索Azure AD身份服务
- en: Developing single-and multi-tenant applications
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开发单租户和多租户应用程序
- en: Configuring Azure information protection solutions
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置Azure信息保护解决方案
- en: This is to show its relevance to specific requirements.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 这是为了显示它与特定需求的相关性。
- en: Summary
  id: totrans-341
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, you have learned to configure different authentication scenarios
    using Azure AD and ADFS capabilities. There are many possible combinations, and
    we can't provide all of them in one chapter. We gave you an introduction and some
    of our practical tips to get started and guide you in your upcoming journey through
    this technology. Don't worry; we jump more and more into some different scenarios
    in the next chapters of this book to give you as much help as possible. Also,
    look at the code package for the book; you will find additional practical examples
    from our projects.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您已经学会了如何使用Azure AD和ADFS功能配置不同的身份验证场景。有许多可能的组合，我们无法在一章中提供所有的组合。我们为您提供了一个入门介绍，并分享了一些实用的小贴士，帮助您开始并指引您在未来的技术旅程中前进。别担心；在本书的下一章节中，我们将深入探讨更多不同的场景，为您提供尽可能多的帮助。同时，查看本书的代码包，您将找到来自我们项目的额外实践示例。
- en: In the next chapter, we will explore more Azure AD identity services, such as
    Azure AD B2B and B2C.
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章节中，我们将探讨更多的Azure AD身份服务，例如Azure AD B2B和B2C。
