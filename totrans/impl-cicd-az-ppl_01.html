<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer038">
<h1 class="chapter-number" id="_idParaDest-15"><a id="_idTextAnchor014"/>1</h1>
<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/>Understanding Azure Pipelines</h1>
<p>This <a id="_idIndexMarker000"/>book will be one of your favorite books in the Microsoft DevOps world as it provides a comprehensive guide to learning all about <strong class="bold">Azure Pipelines</strong> and will allow you to become an experienced Azure DevOps engineer. An Azure DevOps engineer<a id="_idIndexMarker001"/> is an individual who is responsible for designing and implementing <strong class="bold">continuous integration and continuous deployment</strong> (<strong class="bold">CI/CD</strong>) pipelines<a id="_idIndexMarker002"/> using the Azure Pipelines service, which is a component of <strong class="bold">Azure DevOps</strong>. Azure DevOps<a id="_idIndexMarker003"/> is a group of Microsoft services that help a project team achieve the <span class="No-Break">project’s goal.</span></p>
<p>In this chapter, you will be introduced to the CI/CD and Azure DevOps concepts in greater detail and will learn about the advantages of using Azure Pipelines to create CI/CD pipelines for the application deployment process. More specifically, in this chapter, you will learn about the <span class="No-Break">following topics:</span></p>
<ul>
<li>What <span class="No-Break">is CI/CD?</span></li>
<li>Introducing <span class="No-Break">Azure DevOps</span></li>
<li>Introducing Azure Pipelines and <span class="No-Break">its components</span></li>
<li>Comparing Azure Pipelines with other <span class="No-Break">CI/CD tools</span></li>
<li>Setting up <span class="No-Break">agent pools</span></li>
<li>Creating a <strong class="bold">personal access </strong><span class="No-Break"><strong class="bold">token</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">PAT</strong></span><span class="No-Break">)</span></li>
<li>Setting up and updating <span class="No-Break">self-host agents</span></li>
<li>Setting up <span class="No-Break">deployment groups</span></li>
</ul>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Technical requirements</h1>
<p>You can find the code for this chapter <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch01"><span class="No-Break">https://github.com/PacktPublishing/Implementing-CI-CD-Using-Azure-Pipelines/tree/main/ch01</span></a><span class="No-Break">.</span></p>
<h1 id="_idParaDest-18"><a id="_idTextAnchor017"/>What is CI/CD?</h1>
<p>CI/CD is the<a id="_idIndexMarker004"/> workflow process for automation development and deployment that developers should know about to improve <span class="No-Break">their skills.</span></p>
<p>CI is the workflow<a id="_idIndexMarker005"/> process for automating the process of building and testing code whenever a team member commits changes to Git, which is a form of version control that’s run on a source control repository platform such as Azure Repos, GitHub, GitLab, and others. CI creates a modern culture for all developers to share their code, including unit tests, by merging all changes into a shared version control repository after finishing a small task. CI runs based on committing code triggers to grab the latest code from the shared version control repository to build, test, and validate any branch that they commit. Using CI allows you to rapidly discover error code issues and correct them to ensure all developer code is of <span class="No-Break">good quality.</span></p>
<p>CD <a id="_idIndexMarker006"/>involves automating the process of building, testing, configuring, and deploying from the CI workflow process to specific environments, such as QA, staging, <span class="No-Break">and production.</span></p>
<p>This workflow is illustrated in the <span class="No-Break">following figure:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer009">
<img alt="Figure 1.1 – CI/CD diagram" height="161" src="image/B18875_01_01.jpg" width="588"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.1 – CI/CD diagram</p>
<p>CI/CD reduces human error and the routine operation of the manual build, test, and deploy stages for any developer. It helps the developer focus only on <span class="No-Break">application development.</span></p>
<p>This book will focus on the CI/CD<a id="_idIndexMarker007"/> tool <strong class="bold">Azure Pipelines</strong>, which is a comprehensive <a id="_idIndexMarker008"/>service for DevOps and a part of the ecosystem of services in <strong class="bold">Azure DevOps</strong>. Before we look at this further, let’s introduce <span class="No-Break">Azure DevOps.</span></p>
<h1 id="_idParaDest-19"><a id="_idTextAnchor018"/>Introducing Azure DevOps</h1>
<p>Many CI/CD tools <a id="_idIndexMarker009"/>are used to support modern software development, such as Azure Pipelines, GitLab CI/CD, GitHub Actions, and Bitbucket Pipelines. One of the most widely used is Azure Pipelines; this is a part of <strong class="bold">Azure DevOps</strong>, which consists of the following <span class="No-Break">five services:</span></p>
<ul>
<li><strong class="bold">Azure Boards</strong> is an <a id="_idIndexMarker010"/>Azure DevOps sub-service that’s used to track all tasks related to a project conveniently in one place. It is suitable for teamwork. It helps with collaboration because it supports Kanban boards, backlogs, team dashboards, and custom reporting, which can create a connection between the tasks and source version repositories such as GitHub or <span class="No-Break">Azure Repos.</span></li>
<li><strong class="bold">Azure Pipelines</strong> is an <a id="_idIndexMarker011"/>Azure DevOps sub-service that’s used to build, test, integrate, and deploy CI/CD processes. It helps reduce delivery errors and allows teams to focus solely on developing clean and readable code in software development; this service can be accessed through the Azure DevOps web portal (<strong class="source-inline">https://dev.azure.com/{your-organization}</strong>). This book will focus on this service due to <span class="No-Break">this benefit.</span></li>
<li><strong class="bold">Azure Repos</strong> is an <a id="_idIndexMarker012"/>Azure DevOps sub-service for controlling the version of the source code. It is easy to manage code in one place. Easy maintenance can also help you define rules so that you can deploy code safely to desired environments, such as merge checks or static code analysis after the team creates the pull request. The examples in this book will use <span class="No-Break">Azure Repos.</span></li>
<li><strong class="bold">Azure Test Plans</strong> is an <a id="_idIndexMarker013"/>Azure DevOps sub-service that helps test or quality assurance teams write use case scenarios to easily deliver the test<a id="_idIndexMarker014"/> results to the customer. The tester or quality assurance team creates <strong class="bold">system integration testing</strong> (<strong class="bold">SIT</strong>) and <strong class="bold">user acceptance testing</strong> (<strong class="bold">UAT</strong>) on <a id="_idIndexMarker015"/>Azure Test Plans. It can display test results as dashboard reports and include comments or feedback. Azure Test Plans also helps the team understand the test process of the project on the <span class="No-Break">same page.</span></li>
<li><strong class="bold">Azure Artifacts</strong> is<a id="_idIndexMarker016"/> an Azure DevOps sub-service that enables developers to share and manage all their packages that result from building code in one place. Developers can publish packages to their feeds and share them within the same team, organization, and even publicly. Developers can also load the <a id="_idIndexMarker017"/>packages<a id="_idIndexMarker018"/> from different public repositories such as <a href="https://www.nuget.org/">https://www.nuget.org/</a> or <a href="https://www.npmjs.com/">https://www.npmjs.com/</a>. Azure Artifacts also supports multiple package types, such as NuGet, npm, Python, Maven, and <span class="No-Break">Universal Packages.</span></li>
</ul>
<p>All these services fall under the umbrella of Azure DevOps, which covers the necessary development process for a project. You don’t need to use additional services <span class="No-Break">for development.</span></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor019"/>Introducing Azure Pipelines and its components</h1>
<p>Azure Pipelines is <a id="_idIndexMarker019"/>a CI/CD platform for building, testing, and deploying your code to a live application. First, let’s take a look at its <span class="No-Break">key components.</span></p>
<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/>Exploring the key components</h2>
<p>There are some key <a id="_idIndexMarker020"/>concepts that you need to understand when creating an <span class="No-Break">Azure pipeline:</span></p>
<ul>
<li>An <strong class="bold">agent</strong> is the <a id="_idIndexMarker021"/>software that runs a job within a server. It can be a Microsoft-hosted agent or a <span class="No-Break">self-hosted agent.</span></li>
<li>A <strong class="bold">pipeline</strong> is a<a id="_idIndexMarker022"/> workflow process for CI/CD for your application development. It can define your idea of how to build, test, integrate, and deploy <span class="No-Break">your project.</span></li>
<li>A <strong class="bold">trigger</strong> is<a id="_idIndexMarker023"/> an action that calls a pipeline <span class="No-Break">to run.</span></li>
<li>A <strong class="bold">stage</strong> is a<a id="_idIndexMarker024"/> flow of defined jobs in a pipeline, and each stage can have one or more jobs. The benefit of using a stage is that you can rerun job(s) under it. This means you do not need to rerun the whole pipeline. For example, let’s say the developer creates a pipeline<a id="_idIndexMarker025"/> containing two stages: the <strong class="bold">build stage</strong> and the <strong class="bold">deployment stage</strong>. If the<a id="_idIndexMarker026"/> deployment stage fails, then they can only rerun the failed job under the <span class="No-Break">deployment stage.</span></li>
<li>A <strong class="bold">job</strong> is a<a id="_idIndexMarker027"/> group of one or more steps set in a stage. It is useful when you need to run a set of steps in a different operating <span class="No-Break">system environment.</span></li>
<li>A <strong class="bold">step</strong> can <a id="_idIndexMarker028"/>be a task or script and is the smallest piece of <span class="No-Break">a pipeline:</span><ul><li>A <strong class="bold">task</strong> is a<a id="_idIndexMarker029"/> pre-defined script that your idea <span class="No-Break">can define.</span></li><li>A <strong class="bold">script</strong> is an<a id="_idIndexMarker030"/> action that uses the <strong class="bold">command-line interface</strong> (<strong class="bold">CLI</strong>), PowerShell, or <a id="_idIndexMarker031"/>Bash. It depends on the operating system agent that you choose for a job. For example, if you use a command line to run on a Linux agent, it will use a bash script. PowerShell runs on a macOS agent and will use a PowerShell core for <span class="No-Break">cross-platform scripts.</span></li></ul></li>
<li>A <strong class="bold">target</strong> is <a id="_idIndexMarker032"/>a destination <a id="_idIndexMarker033"/>of the pipeline. It can be Azure Artifacts, an Azure resource service (such as Azure App Services, Azure Functions, Azure Container Apps, Azure Kubernetes Services, and so on), or invoke a REST API such as webhooks on <span class="No-Break">Microsoft Teams.</span></li>
</ul>
<p>Now, let’s look at how these components interact with <span class="No-Break">each other:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer010">
<img alt="Figure 1.2 – Key components" height="364" src="image/B18875_01_02.jpg" width="809"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.2 – Key components</p>
<p>This section described the meaning of and relationship between key objects. Before we take a more in-depth look at the different aspects of this platform, let’s learn how we can start <span class="No-Break">using it.</span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/>Signing up for Azure Pipelines</h2>
<p>Two methods can be <a id="_idIndexMarker034"/>used for <span class="No-Break">signing up:</span></p>
<ul>
<li><strong class="bold">Sign up with a Microsoft account</strong>: To do this, complete the <span class="No-Break">following steps:</span><ol><li class="upper-roman">Go <span class="No-Break">to </span><a href="https://azure.microsoft.com/en-us/services/devops/pipelines"><span class="No-Break">https://azure.microsoft.com/en-us/services/devops/pipelines</span></a><span class="No-Break">.</span></li><li class="upper-roman">Click on <span class="No-Break"><strong class="bold">Start free</strong></span><span class="No-Break">.</span></li><li class="upper-roman">Log in with your <span class="No-Break">Microsoft account.</span></li><li class="upper-roman">Enter a name for <span class="No-Break">your organization.</span></li><li class="upper-roman">You must always log in to your organization <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">https://dev.azure.com/{your-organization}</strong></span><span class="No-Break">.</span></li></ol></li>
<li><strong class="bold">Sign up with a GitHub account</strong>: To do this, complete the <span class="No-Break">following steps:</span><ol><li class="upper-roman" value="1">Go <span class="No-Break">to </span><a href="https://azure.microsoft.com/en-us/services/devops/pipelines."><span class="No-Break">https://azure.microsoft.com/en-us/services/devops/pipelines.</span></a></li><li class="upper-roman">Click on <strong class="bold">Start free </strong><span class="No-Break"><strong class="bold">with GitHub</strong></span><span class="No-Break">.</span></li><li class="upper-roman">Log in with your <span class="No-Break">GitHub account.</span></li><li class="upper-roman">Enter a name for <span class="No-Break">your organization.</span></li><li class="upper-roman">You must always log<a id="_idIndexMarker035"/> in to your organization <span class="No-Break">using </span><a href="https://dev.azure.com/"><span class="No-Break">https://dev.azure.com/</span></a><span class="No-Break"><strong class="source-inline">{your-organization}</strong></span><span class="No-Break">.</span></li></ol></li>
</ul>
<p>Once you’ve <a id="_idIndexMarker036"/>signed up for an Azure Pipelines account, you are ready to create a new project for building your code and release the built code to the <span class="No-Break">live application.</span></p>
<h3>Creating a new project</h3>
<p>Creating a new<a id="_idIndexMarker037"/> project is the first step after you sign up, before creating any CI/CD pipeline. Upon creating a project, you can set <span class="No-Break">project visibility:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer011">
<img alt="Figure 1.3 – Creating a new project" height="443" src="image/B18875_01_03.jpg" width="576"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.3 – Creating a new project</p>
<p>You can enter <a id="_idIndexMarker038"/>a project name and select <strong class="bold">Visibility</strong>, then click <span class="No-Break"><strong class="bold">Create project</strong></span><span class="No-Break">.</span></p>
<h3>Inviting team members</h3>
<p>When you need to work with a team, you <a id="_idIndexMarker039"/>must add a new member by inviting one or more team members. Follow these steps to invite a <span class="No-Break">team member:</span></p>
<ol>
<li>Click on your project’s name in the web portal and click <span class="No-Break"><strong class="bold">Project settings</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer012">
<img alt="Figure 1.4 – Project settings" height="602" src="image/B18875_01_04.jpg" width="1065"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.4 – Project settings</p>
<ol>
<li value="2">Select <strong class="bold">Teams</strong> | <span class="No-Break"><strong class="bold">Add</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer013">
<img alt="Figure 1.5 – Adding a new team member" height="500" src="image/B18875_01_05.jpg" width="1162"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.5 – Adding a new team member</p>
<ol>
<li value="3">Enter the <a id="_idIndexMarker040"/>email addresses of your team members and <span class="No-Break">click </span><span class="No-Break"><strong class="bold">Save</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer014">
<img alt="Figure 1.6 – Inviting team members" height="438" src="image/B18875_01_06.jpg" width="449"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.6 – Inviting team members</p>
<p>Now that you’ve invited your collaborators to join your project, let’s delve into how we can start using <span class="No-Break">this<a id="_idTextAnchor022"/> service.</span></p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor023"/>Creating Azure pipelines</h2>
<p>There are two ways to<a id="_idIndexMarker041"/> create <span class="No-Break">Azure pipelines:</span></p>
<ul>
<li>Using the <strong class="bold">Classic interface</strong> (create Azure pipelines from the web Azure DevOps portal) while following these <span class="No-Break">basic steps:</span><ol><li class="upper-roman">Configure Azure Pipelines to use your Azure Repos <span class="No-Break">Git repository.</span></li><li class="upper-roman">Use Azure Pipelines to create and configure your build and release pipeline using drag and drop from the Azure <span class="No-Break">DevOps portal.</span></li><li class="upper-roman">Push your code to your version control repository. The pipeline will be automatically initiated by the default trigger and the defined tasks will <span class="No-Break">be executed.</span></li></ol></li>
<li>Using <strong class="bold">YAML syntax</strong> (create YAML files and commit them to the code repository) while following these <span class="No-Break">basic steps:</span><ol><li class="upper-roman" value="1">Configure Azure Pipelines to use your Azure Repos <span class="No-Break">Git repository.</span></li><li class="upper-roman">Edit your <strong class="source-inline">azure-pipelines.yml</strong> file by defining your <span class="No-Break">custom build.</span></li><li class="upper-roman">Push your code to your version control repository. This action runs the <span class="No-Break">default trigger.</span></li></ol></li>
</ul>
<p>Let’s illustrate the <a id="_idIndexMarker042"/>Azure Pipelines YAML method for ease <span class="No-Break">of understanding:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer015">
<img alt="Figure 1.7 – Azure Pipelines YAML steps" height="51" src="image/B18875_01_07.jpg" width="771"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.7 – Azure Pipelines YAML steps</p>
<p>There are different pipeline features available for both these methods, with some available for both and others only featuring in one. We’ll look at these in detail in the <span class="No-Break">next section.</span></p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor024"/>Feature availability</h2>
<p>Some pipeline<a id="_idIndexMarker043"/> features are only available when using the classic interface or YAML. The following table displays which features are available for which of <span class="No-Break">these methods:</span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-1">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Feature</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">YAML</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Classic</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Description</strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Agents</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the resource where the pipeline <span class="No-Break">can run.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Approvals</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the validation steps for additional checking before completing a <span class="No-Break">deployment stage.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Artifacts</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the library packages for publishing or consuming different <span class="No-Break">package types.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Caching</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define an additional task to reduce the build time by allowing outputs or downloaded dependencies to store them on the agents and reuse <span class="No-Break">them again.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Conditions</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the specific conditions before running <span class="No-Break">a job.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Container jobs</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p>To define the specific jobs to run in <span class="No-Break">a container.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Demands</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the specific pipeline to ensure requirements are met before a pipeline stage <span class="No-Break">is run.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Dependencies</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define specific requirements for validation before running the next job <span class="No-Break">or stage.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Deployment groups</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a logical group for the code that will be deployed to the <span class="No-Break">target machines.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Deployment <span class="No-Break">group jobs</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a job to release to a <span class="No-Break">deployment group.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Deployment jobs</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p>To define the <span class="No-Break">deployment steps.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Environment</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p>To define a collection of resources targeted <span class="No-Break">for deployment.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Gates</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To support automatic collection and evaluation of external health signals before completing a release stage. Available with classic <span class="No-Break">release only.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Jobs</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the execution sequence of a set <span class="No-Break">of steps.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Service connections</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a connection to a remote service required to execute tasks in <span class="No-Break">a job.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Service containers</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p>To define a service that you can use to manage the life cycle of a <span class="No-Break">containerized service.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Stages</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define flow jobs within <span class="No-Break">a pipeline.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Task groups</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a set of sequence tasks as a single <span class="No-Break">reusable task.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Tasks</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the building blocks that construct <span class="No-Break">a pipeline.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Templates</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p>To define reusable content, logic, <span class="No-Break">and parameters.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Triggers</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a specific event that causes a pipeline <span class="No-Break">to run.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Variables</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define a value for data replacement and pass it to <span class="No-Break">the pipeline.</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Variable groups</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p>To define the storage of values that you want to control and make available across <span class="No-Break">multiple pipelines.</span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 1.1 – Pipeline features</p>
<p>Apart from<a id="_idIndexMarker044"/> these features, there are source version control repositories that Azure Pipelines can connect to. We’ll look at these in detail in the <span class="No-Break">next section.</span></p>
<h2 id="_idParaDest-25"><a id="_idTextAnchor025"/>Availability of source version control repositories</h2>
<p>YAML pipelines only<a id="_idIndexMarker045"/> support some version control repositories. The following table displays which version control repositories can support <span class="No-Break">which method:</span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table002">
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Repository</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">YAML</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Classic Interface</strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Azure Repos</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">GitHub</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>GitHub <span class="No-Break">Enterprise Server</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Bitbucket Cloud</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Bitbucket Server</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Subversion</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">No</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Yes</span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 1.2 – Comparing repositories</p>
<p>In this section, we discussed all the available features of Azure Pipelines. In the next section, we will convert the key components of Azure Pipelines into a YAML structure to manage <span class="No-Break">it better.</span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor026"/>Understanding the YAML structure of Azure Pipelines</h2>
<p>Usually, creating <a id="_idIndexMarker046"/>a file called <strong class="source-inline">azure-pipelines.yml</strong> will help you remember <a id="_idIndexMarker047"/>which YAML file is used for <strong class="source-inline">azure-pipelines</strong> in the source code repository. The basic Azure Pipelines YAML structure is <span class="No-Break">as follows:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer016">
<img alt="Figure 1.8 – azure-pipelines.yml file" height="1106" src="image/B18875_01_08.jpg" width="974"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.8 – azure-pipelines.yml file</p>
<p>The <strong class="source-inline">azure-pipelines.yml</strong> file in<a id="_idIndexMarker048"/> this example contains a <span class="No-Break">typical </span><span class="No-Break"><a id="_idIndexMarker049"/></span><span class="No-Break">structure:</span></p>
<ul>
<li>There are two stages, <strong class="source-inline">stage1</strong> and <strong class="source-inline">stage2</strong>, and each stage contains a <span class="No-Break"><strong class="source-inline">job</strong></span><span class="No-Break"> step.</span></li>
<li><em class="italic">Lines 1-2</em> show the pipeline runs when the developer pushes changes on the main (<span class="No-Break"><strong class="source-inline">master</strong></span><span class="No-Break">) branch.</span></li>
<li><em class="italic">Lines 8-9</em> and <em class="italic">21-22</em> show the pipeline uses a Microsoft-hosted agent with the <strong class="source-inline">windows-latest</strong> operating <span class="No-Break">system image.</span></li>
<li><em class="italic">Line 11</em> is a pre-created script for using the NuGet library. You can access this script in the <strong class="source-inline">ch1</strong> folder in this book’s <span class="No-Break">GitHub repository.</span></li>
<li><em class="italic">Line 12</em> is a pre-created script for using the NuGet <span class="No-Break">command line.</span></li>
<li><em class="italic">Line 15</em> is a command line to run the <span class="No-Break"><strong class="source-inline">echo</strong></span><span class="No-Break"> command.</span></li>
<li><em class="italic">Line 24</em> is a <a id="_idIndexMarker050"/>PowerShell Core script that <span class="No-Break">is </span><span class="No-Break"><a id="_idIndexMarker051"/></span><span class="No-Break">cross-platform.</span></li>
</ul>
<p>As you can see, the basic YAML structure is rather simple to understand. Once you’ve prepared the YAML file, you can see the status for running it. We will discuss this in the <span class="No-Break">next section.</span></p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/>Viewing the Azure pipelines' status</h2>
<p>The Azure pipelines' <a id="_idIndexMarker052"/>status is displayed on the Azure DevOps web portal under the <span class="No-Break">running pipeline:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer017">
<img alt="Figure 1.9 – The Azure pipelines' status" height="714" src="image/B18875_01_09.jpg" width="1036"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.9 – The Azure pipelines' status</p>
<p>Clicking on the current<a id="_idIndexMarker053"/> pipeline status row will take you to the historical status of the pipeline. Two colors are used to indicate the status: green and red. These indicate successful and failed <span class="No-Break">pipelines, respectively.</span></p>
<p>This section described all the components and their relationships. In the next section, you will understand the key differences between Azure Pipelines and other commonly used <span class="No-Break">CI/CD tools.</span></p>
<h1 id="_idParaDest-28"><a id="_idTextAnchor028"/>Comparing Azure Pipelines with other CI/CD tools</h1>
<p>Azure Pipelines has <a id="_idIndexMarker054"/>different features compared to other CI/CD services currently on the market. Let’s take a <span class="No-Break">closer look:</span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table003">
<colgroup>
<col/>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<thead>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Features</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Azure Pipelines</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">GitHub Actions</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">GitLab CI</strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold">Bitbucket Pipelines</strong></span></p>
</td>
</tr>
</thead>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="source-inline">if</strong></span><span class="No-Break"> expression</span></p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>-</p>
</td>
<td class="No-Table-Style">
<p>-</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Loop statement</span></p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>-</p>
</td>
<td class="No-Table-Style">
<p>-</p>
</td>
<td class="No-Table-Style">
<p>-</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Online service – CI/CD minutes free usage <span class="No-Break">per month</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">1,800</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">2,000</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">400</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">50</span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Online service – free package <span class="No-Break">storage (GB)</span></p>
</td>
<td class="No-Table-Style">
<p>2</p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">0.5</span></p>
</td>
<td class="No-Table-Style">
<p>5</p>
</td>
<td class="No-Table-Style">
<p>1</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Self-hosted agents</span></p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
<td class="No-Table-Style">
<p>X</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break">Free users</span></p>
</td>
<td class="No-Table-Style">
<p>5</p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Unlimited</span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break">Unlimited</span></p>
</td>
<td class="No-Table-Style">
<p>5</p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 1.3 – CI/CD tools comparison</p>
<p>This will help you <a id="_idIndexMarker055"/>understand the important factors to consider when you’re trying to decide on the right tool for your <span class="No-Break">CI/CD platform.</span></p>
<p>Before you start to build a pipeline for application deployment, we must prepare the necessary agent pools, as demonstrated in the <span class="No-Break">next section.</span></p>
<h1 id="_idParaDest-29"><a id="_idTextAnchor029"/>Setting up agent pools</h1>
<p>Before using <a id="_idIndexMarker056"/>Azure <a id="_idIndexMarker057"/>Pipelines to build code and deploy code, you need at least one <strong class="bold">build agent</strong>. There are two build agent types: <strong class="bold">Microsoft-hosted build agent</strong>, which<a id="_idIndexMarker058"/> is included by default, and <strong class="bold">self-hosted build agent</strong>. Each <a id="_idIndexMarker059"/>agent type will be located under <a id="_idIndexMarker060"/>an <strong class="bold">agent pool</strong>, which is a collection of build and <span class="No-Break">release agents.</span></p>
<p>A Microsoft-hosted build agent will be located under an agent pool called <strong class="bold">Azure Pipelines</strong>. You can create a new agent pool for self-hosted build agents and assign them <span class="No-Break">under it.</span></p>
<p>To create pools, follow <span class="No-Break">these steps:</span></p>
<ol>
<li>Click on <a id="_idIndexMarker061"/>your project name in the web portal and click <strong class="bold">Project settings</strong> | <strong class="bold">Agent pools</strong> | <span class="No-Break"><strong class="bold">Add pool</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer018">
<img alt="Figure 1.10 – Adding a pool" height="722" src="image/B18875_01_10.jpg" width="1596"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.10 – Adding a pool</p>
<ol>
<li value="2">Enter the information shown in the following screenshot and then <span class="No-Break">click </span><span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer019">
<img alt="Figure 1.11 – Creating an agent pool" height="708" src="image/B18875_01_11.jpg" width="461"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.11 – Creating an agent pool</p>
<ol>
<li value="3">Finally, you<a id="_idIndexMarker062"/> will see the new <span class="No-Break">agent pool:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer020">
<img alt="Figure 1.12 – Displaying the new agent pool" height="277" src="image/B18875_01_12.jpg" width="767"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.12 – Displaying the new agent pool</p>
<p>Once you’ve finished creating the new agent pool, you can start creating and setting up the self-hosted agent under a new agent pool. The following section will show you how to create a <strong class="bold">personal access </strong><span class="No-Break"><strong class="bold">token</strong></span><span class="No-Break"> (</span><span class="No-Break"><strong class="bold">PAT</strong></span><span class="No-Break">).</span></p>
<h1 id="_idParaDest-30"><a id="_idTextAnchor030"/>Creating a PAT</h1>
<p>Before you can <a id="_idIndexMarker063"/>create self-hosted agents on your server or machine, you must create a PAT. To do this, follow <span class="No-Break">these instructions:</span></p>
<ol>
<li>Go to the <strong class="bold">Settings</strong> menu under your personal icon and click on <strong class="bold">Personal </strong><span class="No-Break"><strong class="bold">access tokens</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer021">
<img alt="Figure 1.13 – Creating PATs" height="721" src="image/B18875_01_13.jpg" width="1263"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.13 – Creating PATs</p>
<ol>
<li value="2">Click on <span class="No-Break"><strong class="bold">New Token</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer022">
<img alt="Figure 1.14 – New Token" height="512" src="image/B18875_01_14.jpg" width="1264"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.14 – New Token</p>
<ol>
<li value="3">Enter the <a id="_idIndexMarker064"/><span class="No-Break">required information:</span><ul><li><strong class="bold">Name</strong>: Enter the name <span class="No-Break">you need</span></li><li><strong class="bold">Organization</strong>: Select an organization you will <span class="No-Break">link to</span></li><li><strong class="bold">Expiration (UTC)</strong>: There are four choices – 30 days, 60 days, 90 days, and custom-defined but under <span class="No-Break">2 years</span></li><li><strong class="bold">Scopes</strong>: Select <strong class="bold">Custom defined</strong> | <strong class="bold">Agents Pools</strong> with <strong class="bold">Read &amp; manage</strong> | <strong class="bold">Auditing</strong> with <strong class="bold">Read </strong><span class="No-Break"><strong class="bold">Audit Log</strong></span><span class="No-Break">:</span></li></ul></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer023">
<img alt="Figure 1.15 – Entering the required information" height="1474" src="image/B18875_01_15.jpg" width="926"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.15 – Entering the required information</p>
<ol>
<li value="4">Copy the <a id="_idIndexMarker065"/>PAT before clicking on the <strong class="bold">Close</strong> button as you won’t be able to see <span class="No-Break">it again:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer024">
<img alt="Figure 1.16 – Copying the PAT" height="849" src="image/B18875_01_16.jpg" width="970"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.16 – Copying the PAT</p>
<p>Now, you are ready to set up a <span class="No-Break">self-hosted agent.</span></p>
<h1 id="_idParaDest-31"><a id="_idTextAnchor031"/>Setting up self-hosted agents</h1>
<p>After you’ve created a <a id="_idIndexMarker066"/>PAT, you can create a new self-hosted agent under a new agent pool. To do this, follow <span class="No-Break">these steps:</span></p>
<ol>
<li>Click on <strong class="bold">PacktAzureDevOps</strong> | <strong class="bold">Agent pools</strong> | <span class="No-Break"><strong class="bold">General</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer025">
<img alt="Figure 1.17 – Entering a new agent pool" height="591" src="image/B18875_01_17.jpg" width="960"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.17 – Entering a new agent pool</p>
<ol>
<li value="2">Click <a id="_idIndexMarker067"/>on <span class="No-Break"><strong class="bold">New agent</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer026">
<img alt="Figure 1.18 – Entering a new agent" height="760" src="image/B18875_01_18.jpg" width="1246"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.18 – Entering a new agent</p>
<ol>
<li value="3">You can <a id="_idIndexMarker068"/>download a self-hosted agent based on your operating system. Three operating system options will show you how to download and set <span class="No-Break">them up:</span><ul><li><strong class="bold">Windows users</strong> can download build agent software from the <strong class="bold">Windows</strong> tab. There are two options, as shown in the following screenshot: Windows 64-bit (<strong class="bold">x64</strong>) and Windows <span class="No-Break">32-bit (</span><span class="No-Break"><strong class="bold">x86</strong></span><span class="No-Break">):</span></li></ul></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer027">
<img alt="Figure 1.19 – The Windows agent for setting up a file" height="1007" src="image/B18875_01_19.jpg" width="1033"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.19 – The Windows agent for setting up a file</p>
<ul>
<li>To set up a <a id="_idIndexMarker069"/>Windows agent, you need to run on PowerShell as <span class="No-Break">an administrator.</span></li>
<li><strong class="bold">Mac users</strong> can download build agent software from the <span class="No-Break"><strong class="bold">macOS</strong></span><span class="No-Break"> tab:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer028">
<img alt="Figure 1.20 – macOS agent" height="1041" src="image/B18875_01_20.jpg" width="1063"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.20 – macOS agent</p>
<ul>
<li>You don’t need to use the <strong class="source-inline">bash</strong> command in the administrator role to set up the <span class="No-Break">macOS agent.</span></li>
<li><strong class="bold">Linux users</strong> can <a id="_idIndexMarker070"/>download build agent software from the <strong class="bold">Linux</strong> tab. There are four options for computer architecture – <strong class="bold">x64</strong>, <strong class="bold">ARM</strong>, <strong class="bold">ARM64</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="bold">RHEL6</strong></span><span class="No-Break">:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer029">
<img alt="Figure 1.21 – Linux agent" height="933" src="image/B18875_01_21.jpg" width="1053"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.21 – Linux agent</p>
<ul>
<li>You don’t need to use a <strong class="source-inline">root</strong> user for installation to set up a <span class="No-Break">Linux agent.</span></li>
</ul>
<ol>
<li value="4">After configuring the agent in each operating system, you must enter the <span class="No-Break">following information:</span><pre class="source-code">
<strong class="bold">Enter (Y/N) Accept the Team Explorer Everywhere license agreement now? (press enter for N) &gt; Y</strong>
<strong class="bold">Enter server URL &gt; https://dev.azure.com/yourOrganization</strong>
<strong class="bold">Enter authentication type (press enter for PAT) &gt; [ENTER]</strong>
<strong class="bold">Enter personal access token &gt; [Personal Access Token]</strong>
<strong class="bold">Enter agent pool (press enter for default) &gt; General</strong>
<strong class="bold">Enter agent name (press enter for [computer name]) &gt; agent01</strong>
<strong class="bold">Enter work folder (press enter for _work) &gt; [ENTER]</strong></pre></li> <li>Once you <a id="_idIndexMarker071"/>start the service, you will see that <strong class="source-inline">agent01</strong> <span class="No-Break">is active:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer030">
<img alt="Figure 1.22 – The agent status dashboard" height="224" src="image/B18875_01_22.jpg" width="1013"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.22 – The agent status dashboard</p>
<ol>
<li value="6">You can see the <strong class="bold">Online</strong> status of the build agent that has already <span class="No-Break">been created:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer031">
<img alt="Figure 1.23 – The action menu of the agent" height="301" src="image/B18875_01_23.jpg" width="1117"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.23 – The action menu of the agent</p>
<ol>
<li value="7">You can delete the <a id="_idIndexMarker072"/>agent and <strong class="bold">u</strong>pdate to a new version of the agent by clicking on the button with the ellipses or <span class="No-Break">three dots.</span></li>
</ol>
<p>You are now ready to create the build and deployment on the <strong class="source-inline">agent01</strong> build agent. However, you need to set up the deployment group so that you can deploy your application on a local web server <a id="_idIndexMarker073"/>such as Microsoft <strong class="bold">Internet and Information Services</strong> (<strong class="bold">IIS</strong>). We’ll do this in the <span class="No-Break">next section.</span></p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor032"/>Setting up deployment groups</h1>
<p><strong class="bold">Deployment groups</strong> are<a id="_idIndexMarker074"/> logical agent groupings for application deployment on target machines based on environments – they are typically named based on your project needs and promotion levels before they go to production. Agents are installed in each environment. Each agent under the deployment groups supports only Windows <span class="No-Break">and Linux.</span></p>
<p>These deployment<a id="_idIndexMarker075"/> groups can be divided based on environments, such as development (<em class="italic">Dev</em>), quality assurance (<em class="italic">QA</em>), user acceptance testing (<em class="italic">UAT</em>), and production (<em class="italic">Prod</em>), as shown in the <span class="No-Break">following figure:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<img alt="Figure 1.24 – Deployment groups concept" height="627" src="image/B18875_01_24.jpg" width="635"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.24 – Deployment groups concept</p>
<p>To create a <a id="_idIndexMarker076"/>deployment group, follow <span class="No-Break">these instructions:</span></p>
<ol>
<li>Navigate to <strong class="bold">Pipelines</strong> | <strong class="bold">Deployment groups</strong> | <strong class="bold">Groups</strong> | <strong class="bold">Add a </strong><span class="No-Break"><strong class="bold">deployment group</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer033">
<img alt="Figure 1.25 – Adding a deployment group" height="522" src="image/B18875_01_25.jpg" width="1183"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.25 – Adding a deployment group</p>
<ol>
<li value="2">Enter the <a id="_idIndexMarker077"/>required information and <span class="No-Break">click </span><span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer034">
<img alt="Figure 1.26 – Entering deployment group information" height="607" src="image/B18875_01_26.jpg" width="884"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.26 – Entering deployment group information</p>
<ol>
<li value="3">After creating<a id="_idIndexMarker078"/> the deployment group, you must set up the deployment agent under your deployment group. There are two operating systems the deployment <span class="No-Break">agents support:</span><ul><li><strong class="bold">Windows users</strong> can install an agent of the deployment group by copying the PowerShell script and running it with an administrator <span class="No-Break">command prompt:</span></li></ul></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer035">
<img alt="  Figure 1.27 – Script to deploy an agent on Windows" height="675" src="image/B18875_01_27.jpg" width="1264"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">  Figure 1.27 – Script to deploy an agent on Windows</p>
<ul>
<li><strong class="bold">Linux users</strong> can install an agent of the deployment group by copying the bash shell script and running it with an administrator <span class="No-Break">command prompt:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer036">
<img alt="  Figure 1.28 – Script to deploy an agent on Linux" height="537" src="image/B18875_01_28.jpg" width="1264"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">  Figure 1.28 – Script to deploy an agent on Linux</p>
<ol>
<li value="4">After setting up <a id="_idIndexMarker079"/>the agent for deployment groups, you will see that the build agent of the deployment group <span class="No-Break">is online:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer037">
<img alt="Figure 1.29 – The deployment agent is online" height="531" src="image/B18875_01_29.jpg" width="1163"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.29 – The deployment agent is online</p>
<p>After setting up the build and deployment agent on a self-hosted computer, you are ready to create your first <span class="No-Break">Azure pipeline.</span></p>
<h1 id="_idParaDest-33"><a id="_idTextAnchor033"/>Summary</h1>
<p>In this chapter, you learned about the key concepts involved in CI/CD, which is a part of the Azure DevOps service from Microsoft. You learned about the basic structure of Azure Pipelines YAML and the difference between Azure Pipelines and other services currently on the market. You also learned about the fundamentals of Azure Pipelines, which will help you prepare your CI/CD pipelines for all real-world scenarios discussed later in this book. Finally, you learned how to set up agent pools, deployment groups, and self-hosted agents to prepare for the hands-on projects in the <span class="No-Break">following chapters.</span></p>
<p>In the next chapter, you will apply the knowledge you’ve gained from this chapter to basic concepts and features and learn how to create <span class="No-Break">a pipeline.</span></p>
</div>
</div></body></html>