<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure WebJobs</h1>
                </header>
            
            <article>
                
<p>Azure WebJobs are one of the underlying features of Azure App Service. They allow for the easy running of so-called "jobs" using different intervals, or even running them infinitely. They are very flexible and provide a special SDK, so users can work with them efficiently and quickly.</p>
<p>The following topics will be covered in this chapter:</p>
<ul>
<li>How to create Azure WebJobs</li>
<li>Working with different trigger types (continuous and triggered)</li>
<li>Using different file types for WebJobs</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>To perform exercises from this chapter, you will need the following:</p>
<ul>
<li>Access to an Azure subscription</li>
<li>Visual Studio 2017 with Azure development workload installed</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating WebJobs</h1>
                </header>
            
            <article>
                
<p>Working with WebJobs is much simpler than working with App Services, as this is a much easier service to configure and use. In fact, there are two ways of working with them:</p>
<ul>
<li>Using Azure Portal and deploying a job manually</li>
<li>Using Visual Studio to develop and deploy it manually</li>
</ul>
<p>What is more, you can leverage the WebJobs SDK to prepare an application triggered by an external service. This will be covered at the end of this chapter, and will be an excellent introduction to Azure Functions, described later in this book.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating and deploying WebJobs in Azure Portal</h1>
                </header>
            
            <article>
                
<p>The easiest and quickest way to start working with WebJobs is to create a custom console application, perform an action, and then deploy it using Azure Portal. Thanks to this exercise, you will understand the main concepts of jobs hosted within App Services. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating an application in Visual Studio</h1>
                </header>
            
            <article>
                
<p>When you open Visual Studio, go to <span class="packt_screen">File</span> | <span class="packt_screen">New Project</span>. In the <span class="packt_screen">New Project</span><strong> </strong>window, select <span class="packt_screen">Windows Classic Desktop</span><strong> </strong>and then <span class="packt_screen">Console App (.NET Framework)</span>. Give your application a name and click on <span class="packt_screen">OK</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/b8e18e6f-3acd-4a91-8a92-e12e90f67f56.png" width="935" height="648"/></div>
<p>After a moment, you will see an empty project, which we can modify. We will try to trigger our job in intervals (let's say one minute), so we need to add code, which will finish within the given time.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>For the very beginning, let's just display the current date. In the <kbd>Main()</kbd><strong> </strong>method of your application, add the following code:</p>
<pre>using System;<br/><br/>namespace MyFirstWebJob<br/>{<br/>    class Program<br/>    {<br/>        static void Main()<br/>        {<br/>            Console.WriteLine($"Current date and time is: {DateTime.Now:yyyy-MM-d dddd HH:mm:ss}");<br/>        }<br/>    }<br/>}</pre>
<p>Now save and build your project—we will need the compiled version soon.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Deploying a WebJob in the Azure Portal</h1>
                </header>
            
            <article>
                
<p>Now, when we have a code of our WebJob, we can try to put in the cloud. To do so we need App Service, which will host our code and execute it. You can either use one of your current Web Apps or create a new one:</p>
<ol>
<li>Go to your App Service and find the <span class="packt_screen">WebJobs </span>blade. (If you do not see it, scroll down a little bit—it can be found on the left in the <span class="packt_screen">Settings </span>section.):</li>
</ol>
<div class="mce-root CDPAlignCenter CDPAlign"><img src="Images/697e65a2-7f5c-417e-a086-17ff9bf6ec81.png" style="width:41.50em;height:19.67em;" width="734" height="348"/></div>
<div class="packt_figref packt_infobox"><span>If you do not know how to create App Service or configure it, please take a look at <a href="81d59e59-02b1-4973-95a0-9bf6a998e752.xhtml" target="_blank">Chapter 1</a>, <em>Azure App Service</em></span><span>, where I describe the process of working with this Azure service in detail.</span></div>
<ol start="2">
<li>Since you <span>currently </span>do not have any jobs, click on the <span class="packt_screen">+ Add</span><strong> </strong>button. You will see a new screen, which allows you to configure a new WebJob:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/230a58a3-2009-4291-8c70-06e3286018f8.png" style="width:31.25em;height:34.08em;" width="425" height="462"/></div>
<p style="padding-left: 60px">Available fields differ a bit depending on the selected <span class="packt_screen">Type </span>field value. If you have selected <span class="packt_screen">Triggered </span>job, you will see the following fields:</p>
<ul>
<li><span class="packt_screen">Triggers</span><strong>:</strong> If you select <span class="packt_screen">Scheduled</span>, one additional field (<span class="packt_screen">CRON Expression</span>) will appear. The other option is <span class="packt_screen">Manual</span>, which ensures that a WebJob can be triggered only manually.</li>
<li><span class="packt_screen">CRON Expression</span><span>: A CRON valid expression, which defines an interval at which a job runs. </span></li>
</ul>
<div class="packt_tip">CRON expressions are a quite complicated topic themselves, and we will not focus on them in this book. If you have not heard about them yet, those two links should be useful for you to get started: <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer">https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-timer</a>.</div>
<p style="padding-left: 60px">Another option is to set the <span class="packt_screen">Triggered </span>field to <span class="packt_screen">Continuous</span>. In that scenario, only one extra field is displayed: <span class="packt_screen">Scale.</span> Decide whether you want to always have a <span class="packt_screen">Single Instance</span><strong> </strong>of job or scale it across all instances of your App Service. This is helpful if you want, for instance, to implement a singleton pattern and never scale out a job. Note that you cannot change this option if you are using the <span class="packt_screen">Free </span>or <span class="packt_screen">Shared </span>tier as they do not support scaling.</p>
<ol start="3">
<li>For now, we will create a <span class="packt_screen">Triggered </span>job to see how App Service executes it. Give it a name and attach an executable file of the console application you created in the previous section. Here, you can find my configuration:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/958d131b-1e92-41c5-8777-68c6144eb8f9.png" style="width:25.58em;height:27.25em;" width="428" height="456"/></div>
<ol start="4">
<li>I have decided to use the <kbd>0 */1 * * * *</kbd><strong> </strong><span class="packt_screen">CRON Expression</span> to run my job each minute. Once you are satisfied with your configuration, click <span class="packt_screen">OK</span>. After a moment, you should see a new WebJob added to App Service and deployed:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ca369b70-1270-4373-befb-64738d893c12.png" style="width:57.58em;height:20.83em;" width="972" height="351"/></div>
<div class="packt_tip">You do not have to deploy a single file as your WebJob. If your application has more files (such as additional dependencies or static files), you can archive them in a ZIP package and publish. After deployment, they will be unzipped and fully functional.</div>
<p>Now when you click on a job, new options will be available in the menu above. We would like to see the output—for that, please click on <span class="packt_screen">Logs</span>. On the new screen, you will see the list of jobs available in this particular App Service. Click on the one you have just added—a list of recent runs should be displayed, which you can analyze. You can click on any of the positions available—you will be able to see a full log of the running job:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/62f6cbca-dc5d-432a-97c2-984298cc2f51.png" style="width:52.33em;height:26.58em;" width="839" height="427"/></div>
<p>As you can see, a job was run and it displayed exactly what we have been expecting—the current date and time. Congratulations—you have just created and deployed your first WebJob!</p>
<div class="packt_infobox">Remember that running continuous or triggered jobs require at least the <span class="packt_screen">Basic </span>App Service Plan. If you use the <span class="packt_screen">Free </span>or <span class="packt_screen">Shared </span>tier, after some time, a WebJob will be cancelled and you will need to start it manually.</div>
<p>In the next section, you will learn how to deploy a WebJob directly from Visual Studio.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Deploying WebJobs from Visual Studio</h1>
                </header>
            
            <article>
                
<p>In the previous part of this chapter, you saw how to create a simple WebJob and publish it from Azure Portal. Sometimes you would prefer not to leave your IDE and use it for deployments too. Fortunately, Visual Studio is integrated with Azure and makes such actions a piece of cake. Before, we started to create a brand new <span class="packt_screen">Console Application</span><strong> </strong>as we did in the beginning—this will be our starting point. You can add any code you would like to—I will use the one from the previous exercises, which will display the current date and time. Once you are satisfied with the provided functionality, right-click on your project icon.</p>
<p>From the context menu, click on <span class="packt_screen">Publish as Azure WebJob...</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/e8e9a6a4-52b2-4bea-a7b6-577d8e7f1bb0.png" style="width:25.42em;height:17.92em;" width="458" height="324"/></div>
<p>You will see a new screen, where you can select a name for a new WebJob and its <span class="packt_screen">Run mode</span>. This time, I also decided on a continuous job, so I selected <span class="packt_screen">Run continuously</span>. When you click <span class="packt_screen">OK</span>, this wizard will install missing packages for your project and display the <span class="packt_screen">Publish </span>screen:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/c8d11873-eab5-4a89-81eb-e378da898c9e.png" style="width:33.42em;height:26.25em;" width="692" height="544"/></div>
<p>Here, you can create or import <span class="packt_screen">Publish profile</span>, which is needed to deploy WebJob. We would like to publish our job to a specific location, and that is why we select <span class="packt_screen">Microsoft Azure App Service</span>. On the next screen, you can select the appropriate App Service by filtering it using subscription and resource group fields. Select the one you are interested in and then click <span class="packt_screen">OK</span>. Now you will be able to change different properties if you want and deploy configuration. I recommend leaving the default values for now and clicking on <span class="packt_screen">Publish</span>. After several seconds, you should see a success message in the output window:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/1b66dbd5-9b3e-40f9-9723-69f0ddf34923.png" width="892" height="300"/><br/>
 </div>
<p>We can now check whether our job is available in Azure. Go to the <span class="packt_screen">WebJobs </span>blade in your App Service. You should be able to see your job among others (I used the same Web App as in the previous section, that is why I have two WebJobs available):</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/364a3df1-956f-499e-b1d3-599f8c0eb2cf.png" width="965" height="367"/></div>
<p>It seems that everything is all right. I am sure you see one flaw of such an approach—we can define the <span class="packt_screen">Run mode</span><strong> </strong>of our job only as <span class="packt_screen">Run on demand</span><strong> </strong>or <span class="packt_screen">Run continuously</span>. What we are missing here is running it on a schedule. In the next section, I will address this issue as we will start using the WebJobs SDK to have better control over our application.</p>
<div class="packt_tip">In fact, it is possible to modify a continuous job to work in intervals. If you take a look at your project, you will see that now it contains a file called <kbd>webjob-publish-settings.json</kbd>. Its schema and description can be found here—<a href="http://schemastore.org/schemas/json/webjob-publish-settings.json">http://schemastore.org/schemas/json/webjob-publish-settings.json</a>.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Working with the WebJobs SDK</h1>
                </header>
            
            <article>
                
<p>To simplify working with WebJobs in Azure and easily access their advanced features, you can use a framework called the WebJobs SDK. It is available out of the box in Visual Studio when an Azure workload is installed. To start, you can create a clean console application, or use the one used for the previous exercises—at this moment, it is up to you. You will need one more thing—the <kbd>Microsoft.Azure.WebJobs</kbd><span> package, which can be installed either using the command line or the NuGet package manager:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/93558c19-5ef8-4ca3-9b00-d8f693c5a5d9.png" width="1204" height="282"/></div>
<div class="packt_infobox">Please note that it is possible to develop .NET Core WebJob using the packages version 3.X. However, since they are still in the beta state, I will not cover them in this book.</div>
<p>When everything is set and ready, we can proceed and try to actually create a new application. Writing jobs using the WebJobs SDK is a bit different than creating them like we did in the previous exercises, but it gives you some interesting benefits:</p>
<ul>
<li>You have an available set of triggers integrated with other Azure services such as queues</li>
<li>You have an integrated logging framework, which eases the process of monitoring a job</li>
<li>It is a great start to developing Azure Functions, which will be covered later in this book</li>
</ul>
<p>To get started you have to start a <kbd>JobHost</kbd> instance. It is a container for all of the jobs you will run within your application. (We can also call them <kbd>functions</kbd>, as described in the documentation.) The boilerplate code looks like this:</p>
<pre>using Microsoft.Azure.WebJobs;<br/><br/>namespace MyFirstWebJobWebJobsSDK<br/>{<br/>    class Program<br/>    {<br/>        static void Main()<br/>        {<br/>            var config = new JobHostConfiguration();<br/>            var host = new JobHost(config);<br/>            host.RunAndBlock();<br/>        }<br/>    }<br/>}</pre>
<p>Those three lines are the actual host of your job application, which will handle its functionalities.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Try to compile and run—unfortunately, there is something missing, as you will see an exception thrown as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/2575f617-8143-4409-9510-563998e082f2.png" width="790" height="517"/></div>
<p>It tells us that we have a missing Azure Storage account connection string. Because we have not covered this topic yet, you will have to perform one more exercise before continuing. Go to <a href="6feb3822-0662-46c8-b889-c038672a1ad1.xhtml" target="_blank">Chapter 11</a>, <em>Using Azure Storage - Tables, Queues, Files, and Blobs</em>,<strong> </strong>and go through the very first section. It will guide you through the process of creating an Azure Storage account and tell where you can find the connection string to it. Once you have, we can proceed—add it to <kbd>App.config</kbd> as follows:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;configuration&gt;<br/>    &lt;startup&gt; <br/>        &lt;supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.7" /&gt;<br/>    &lt;/startup&gt;<br/>  &lt;connectionStrings&gt;<br/>    &lt;add name="AzureWebJobsDashboard" connectionString="DefaultEndpointsProtocol=https;AccountName={NAME};AccountKey={KEY}" /&gt;<br/>    &lt;add name="AzureWebJobsStorage" connectionString="DefaultEndpointsProtocol=https;AccountName={NAME};AccountKey={KEY}" /&gt;<br/>  &lt;/connectionStrings&gt;<br/>&lt;/configuration&gt;</pre>
<p>As you can see, I <span>already </span>added two required connection strings—<kbd>AzureWebJobsDashboard </kbd>and <kbd>AzureWebJobsStorage</kbd>. Now, when you start the host, you should be able to see something similar to the following:</p>
<div class="CDPAlignCenter CDPAlign"><img style="font-size: 1em;" src="Images/b896b350-1e5f-4d82-ac19-c8b9d23bf918.png" width="975" height="131"/></div>
<p>Since we have no jobs added yet, none is found and enabled. Let's try to add one and see how it works. </p>
<div class="packt_tip">If you want, you can configure connection strings directly in your code by setting the <kbd>StorageConnectionString </kbd><span>and</span><strong><span> </span></strong><kbd><span>DashboardConnectionString</span></kbd> <span>properties of the </span><kbd>JobHostConfiguration </kbd><span>object manually.</span></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Calling a job manually</h1>
                </header>
            
            <article>
                
<p>If you would like to trigger a job manually, you can use the <kbd>[NoAutomaticTrigger]</kbd><span> attribute to tell a host that this particular function is not triggered automatically. Here, you have an example of the one I created and named </span><kbd>Manual.cs</kbd><span>:</span></p>
<pre>using System.IO;<br/>using Microsoft.Azure.WebJobs;<br/><br/>namespace MyFirstWebJobWebJobsSDK<br/>{<br/>    public class Manual<br/>    {<br/>        [NoAutomaticTrigger]<br/>        public static void ManualFunction(<br/>            TextWriter logger,<br/>            string value)<br/>        {<br/>            logger.WriteLine($"Received message: {value}");<br/>        }<br/>    }<br/>}</pre>
<p>Now let's see what happens if you call it from the main point of your program:</p>
<pre>using Microsoft.Azure.WebJobs;<br/><br/>namespace MyFirstWebJobWebJobsSDK<br/>{<br/>    class Program<br/>    {<br/>        static void Main()<br/>        {<br/>            var config = new JobHostConfiguration();<br/>            var host = new JobHost(config);<br/><br/>            host.Call(typeof(Manual).GetMethod("ManualFunction"), new { value = "Hello world!" });<br/><br/>            host.RunAndBlock();<br/>        }<br/>    }<br/>}</pre>
<p>You should be able to see the following result:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/fccb9942-d36e-4f1f-9373-c216599e2647.png" width="991" height="174"/></div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Automatic triggers in WebJobs</h1>
                </header>
            
            <article>
                
<p>By default, the WebJobs SDK provides a limited set of triggers. Currently, it supports only the following ones:</p>
<ul>
<li>Blob storage</li>
<li>Queue storage</li>
<li>Table storage</li>
</ul>
<p class="mce-root"/>
<p>All of these are connected to Azure Storage and will be covered in the chapter describing Azure Functions. Fortunately, we can install additional NuGet packages to extend the functionality of our host. For now, add the <kbd>Microsoft.Azure.WebJobs.Extensions</kbd><span> package so that we will be able to use </span><kbd>TimerTrigger</kbd><span>. When you have it, call the </span><kbd>UseTimers()</kbd><strong> </strong><span>method on the </span><kbd>JobHostConfiguration </kbd><span>object:</span></p>
<pre>using Microsoft.Azure.WebJobs;<br/><br/>namespace MyFirstWebJobWebJobsSDK<br/>{<br/>    class Program<br/>    {<br/>        static void Main()<br/>        {<br/>            var config = new JobHostConfiguration();<br/>            <strong>config.UseTimers();</strong><br/><br/>            var host = new JobHost(config);<br/><br/>            host.Call(typeof(Manual).GetMethod("ManualFunction"), new { value = "Hello world!" });<br/><br/>            host.RunAndBlock();<br/>        }<br/>    }<br/>}</pre>
<p>Now we can create a new <kbd>Timer.cs</kbd><strong> </strong>function, which will be triggered on schedule:</p>
<pre>using System;<br/>using System.IO;<br/>using Microsoft.Azure.WebJobs;<br/><br/>namespace MyFirstWebJobWebJobsSDK<br/>{<br/>    public class Timer<br/>    {<br/>        public static void TimerFunction(<br/>            [TimerTrigger("* */1 * * * *")] TimerInfo timer,<br/>            TextWriter logger)<br/>        {<br/>            logger.WriteLine($"Message triggered at {DateTime.Now:yyyy-MM-dd HH:mm:ss}");<br/>        }<br/>    }<br/>}</pre>
<p>When you start your project, <kbd>TimerFunction</kbd> should be discovered and called:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/de72d02c-2333-441c-b850-83bf863362d6.png" width="975" height="421"/></div>
<div class="packt_tip">You can install additional packages to leverage other bindings, such as <kbd>Http</kbd>, <kbd>Notification Hub</kbd>, or <kbd>SendGrid</kbd>. Search for packages with the <kbd><span>Microsoft.Azure.WebJobs.Extensions</span></kbd> <strong> </strong><span>prefix.</span> </div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Publish a job </h1>
                </header>
            
            <article>
                
<p>Publishing a job, which is written using the WebJobs SDK, is the same as in the previous exercises. Right-click on your project and click on <span class="packt_screen">Publish as Azure WebJob</span>. You will be once more guided through the process of publishing a job package. At the end of it, you should be able to see a job available in your App Service:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/a4332933-8c9e-4f54-a42e-010e632551bb.png" width="968" height="388"/></div>
<div class="packt_tip">If you find that your job has problems running, make sure the required connection strings are available in App Service. To do so, go to the <span class="packt_screen">Application settings</span><strong> </strong>blade and verify the contents of the <span class="packt_screen">Connection strings</span><strong> </strong>section. If something is missing, add it manually by adding a name and its value and set its type as <span class="packt_screen">Custom</span>.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure WebJobs limitations</h1>
                </header>
            
            <article>
                
<p>As Azure WebJobs are based on Azure App Services and, what is more, there is no way to host them individually (you can use an extra App Service Plan to power them, but this often means that you pay the double price for your service), you may find some of their limitations quite serious in your projects. When using this particular service, remember the following things:</p>
<ul>
<li>When co-hosting Web App and WebJobs, one may interfere with the performance of other. In other words, if your WebJob starts to utilize too much CPU/memory, it may affect your web application powered by the same App Service Plan.</li>
<li>Azure WebJobs have a limited catalog of bindings that are offered—they are currently less popular than Azure Functions and are not so dynamically developed.</li>
<li>There is no way to utilize the consumption model with Azure WebJobs; hence, you have to pay the full price, even if they do nothing 90% of the time.</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using different file types for WebJobs</h1>
                </header>
            
            <article>
                
<p>When you are working with WebJobs, you are not limited to using EXE files. Currently, this service supports the following applications:</p>
<ul>
<li>Windows executables (<kbd>.exe</kbd>, <kbd>.bat</kbd>, and <kbd>.cmd</kbd>)</li>
<li>Powershell (<kbd>.ps1</kbd>)</li>
<li>Bash (<kbd>.sh</kbd>)</li>
<li>Python (<kbd>.py</kbd>)</li>
<li>PHP (<kbd>.php</kbd>)</li>
<li>Node.js (<kbd>.js</kbd>)</li>
<li>Java (<kbd>.jar</kbd>)</li>
</ul>
<p>As you can see, the preceding list is quite similar to the supported languages in App Services. This should be understandable now, as you have learned that WebJobs are in fact an integral part of Web Apps in Azure. Let's try something practical—we will deploy a simple Node.js application, which will publish to Azure as a WebJob.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating and deploying a Node.js application as a WebJob</h1>
                </header>
            
            <article>
                
<p>JavaScript is one of the most popular programming languages around the world. The strength of Azure lies in the fact that it does not block you from using other, non-native to Microsoft technologies. Before we start, you have to remember one important piece of information.</p>
<div class="packt_infobox">The way in which the runtime executes WebJobs requires you to follow a specific convention. When searching for a job, the runtime will search for a file named <kbd>run.{job_type}</kbd>, where <kbd>job_type</kbd> is an extension representing a particular programming language (such as <kbd>.js</kbd> and <kbd>.py</kbd>). If that fails, it will try to find any file with a specific extension. If that also fails, a job will be skipped.</div>
<p>Here is a really simple code of my first WebJob written in JavaScript:</p>
<pre>var myFirstWebJob = function() {<br/> console.log("Hello, this is my first WebJob in Node.js!");<br/>};<br/><br/>myFirstWebJob();</pre>
<p>To create it, you can use any kind of application supporting JavaScript (it can be, for instance, notepad or Visual Studio Code). Name your file <kbd>run.js</kbd><strong> </strong>and publish it in Azure Portal as described previously. Here you can find the result:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/0ec0ccac-c3c8-4dbc-b865-ba21548ca1e8.png" style="width:39.00em;height:24.67em;" width="638" height="404"/></div>
<p>As you can see, it was discovered automatically—no additional configuration was required to run it using Node.js runtime. I strongly encourage you to take your time and test this feature a little bit using other file types. </p>
<div class="packt_tip">Remember that if your application needs additional files (such as extra packages for a Node.js job), you will have to archive them as a ZIP package and then deploy. </div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Deploying a Node.js Azure WebJob from Visual Studio Code</h1>
                </header>
            
            <article>
                
<p>Unfortunately, it is not<span> currently</span> possible to deploy an Azure WebJob directly from Visual Studio Code. However, if you have the <strong>Azure App Service </strong>extension installed, you can quickly navigate from within the IDE to the portal and upload the code manually.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>To do so, you have to right-click on <span>the </span><span class="packt_screen">WebJobs</span> section of your Azure App Service and select <span class="packt_screen">Open in Portal</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/b6957682-b8ca-45f5-88d0-21d7adfeda4a.png" width="729" height="327"/></p>
<p>Doing so will route you directly to the instance of Azure App Service, where you can add a new WebJob by clicking on the <span class="packt_screen">+ Add</span><strong> </strong>button:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/6485b618-3220-45fb-9ee0-940c9f57a662.png" style="width:36.50em;height:22.50em;" width="633" height="390"/></p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>As you have seen, Azure WebJobs are a really helpful and useful feature of App Services that let you quickly develop jobs running either continuously or triggered on schedule. They start to shine when you have a working web app, which could be used to host them and execute many different actions asynchronously (such as generating a report or reading a queue, which will feed your application's database later). Thanks to the support of different programming languages, you do not have to limit yourself to only one particular platform. Last but not least, they are a great introduction to Azure Functions, which are one of the most popular services in Azure and extend the current possibilities of WebJobs even further. In <a href="51d6dd91-dc4f-4c18-af05-e6ddc1b552fc.xhtml" target="_blank">Chapter 3</a>, <span><em>Deploying Web Applications as Containers</em>, </span>you will learn about deploying Web Apps as containers, what extends even more the capabilities of App Service when it comes to hosting web applications.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Questions</h1>
                </header>
            
            <article>
                
<ol>
<li>Can you run WebJobs using the <span class="packt_screen">Free </span>or <span class="packt_screen">Shared </span>tier?</li>
<li>What run modes does WebJobs currently supprt?</li>
<li>Can you run a Java application using WebJobs?</li>
<li>How can you ensure that runtime will find your job starting file?</li>
<li>Can you publish a WebJob containing more than only one file? If so, how can you do that?</li>
<li>How can you ensure that a WebJob will not be scaled out to multiple instances?</li>
<li>Can a WebJob access the application settings of the App Service that hosts it?</li>
</ol>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Further reading</h1>
                </header>
            
            <article>
                
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/app-service/webjobs-sdk-how-to">https://docs.microsoft.com/en-us/azure/app-service/webjobs-sdk-how-to</a></li>
</ul>


            </article>

            
        </section>
    </div>



  </body></html>