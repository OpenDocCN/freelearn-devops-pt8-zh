<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer287">
<h1 class="chapter-number" id="_idParaDest-179"><a id="_idTextAnchor181"/>12</h1>
<h1 id="_idParaDest-180"><a id="_idTextAnchor182"/>Navigating Common Pitfalls and Future Trends in Azure Pipelines</h1>
<p>In the previous chapter, we learned how to create a pipeline for mobile applications. This chapter will teach you about the common mistakes you should avoid and, more importantly, how to effectively address and circumvent them at a <span class="No-Break">high level.</span></p>
<p>We will also discuss best practices, offering insights into optimizing your workflow for maximum efficiency and reliability. This will help ensure that your pipeline operates at its <span class="No-Break">full potential.</span></p>
<p>Finally, we will explore what lies ahead in the future of Azure Pipelines. By the end of this chapter, you will know how to avoid the common pitfalls of using Azure Pipelines, optimize your workflow with best practices, and adapt to the ever-evolving future of this <span class="No-Break">essential tool.</span></p>
<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
<ul>
<li><span class="No-Break">Common pitfalls</span></li>
<li><span class="No-Break">Best practices</span></li>
<li><span class="No-Break">Future trends</span></li>
</ul>
<h1 id="_idParaDest-181"><a id="_idTextAnchor183"/>Common pitfalls</h1>
<p>Understanding<a id="_idIndexMarker600"/> and proactively addressing certain common mistakes and issues in Azure Pipelines is essential. You can save valuable time and resources by learning how to recognize and resolve <span class="No-Break">them promptly.</span></p>
<p>In the context of real-world projects, timely resolution is essential to prevent delays and costly setbacks, allowing you to maintain project momentum and focus your efforts on other <span class="No-Break">critical aspects.</span></p>
<p>Let’s discuss the details of these <span class="No-Break">common errors:</span></p>
<ul>
<li>Sometimes, you<a id="_idIndexMarker601"/> may start the run of a pipeline and see it is queued. This could be because there is no available agent on Microsoft-hosted or self-hosted agents, insufficient concurrency, or unmet demand for agents. You can see the error immediately after you see the status of the job in your pipeline, as shown in the <span class="No-Break">following screenshot:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer275">
<img alt="Figure 12.1 – A job queued due to unavailability of agents" height="230" src="image/B18875_12_1.jpg" width="834"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.1 – A job queued due to unavailability of agents</p>
<p class="list-inset">This might be an indication that additional parallel jobs must be purchased, ensuring these jobs are not queued if you want these pipelines to run as quickly <span class="No-Break">as possible.</span></p>
<ul>
<li>A pipeline may not run because you entered the incorrect branch for filtering in YAML files or disabled triggers. You need to go back to the YAML files and review the values under the <strong class="bold">branch</strong> section to ensure they <span class="No-Break">are correct.</span></li>
<li>The pipelines can’t run due to the access permission for variable groups or secret files. To address this, navigate to <strong class="bold">Library</strong> | <strong class="bold">secrets</strong> | <strong class="bold">Variable group</strong> | <span class="No-Break"><strong class="bold">Pipeline permissions</strong></span><span class="No-Break">:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer276">
<img alt="Figure 12.2 – Go to Pipeline permissions" height="811" src="image/B18875_12_2.jpg" width="915"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.2 – Go to Pipeline permissions</p>
<p class="list-inset">Then, you can do<a id="_idIndexMarker602"/> either of <span class="No-Break">the following:</span></p>
<ul>
<li>Open all access for all pipelines. This option will allow all pipelines access to secrets in the variable group. If all pipelines need to use the same secrets, then you should select <span class="No-Break">this option:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer277">
<img alt="Figure 12.3 – Granting open access to variable group" height="625" src="image/B18875_12_3.jpg" width="1182"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.3 – Granting open access to variable group</p>
<ul>
<li>Limit access to<a id="_idIndexMarker603"/> the selected <span class="No-Break">pipeline (recommended):</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer278">
<img alt="Figure 12.4 – Restricting permission to variable group to selected pipelines" height="631" src="image/B18875_12_4.jpg" width="1022"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.4 – Restricting permission to variable group to selected pipelines</p>
<p class="list-inset">This option will <a id="_idIndexMarker604"/>limit access to only the required pipelines that can access secrets because, otherwise, anyone could access your pipeline and use <span class="No-Break">your secrets.</span></p>
<p>In this section, you learned how to avoid common mistakes, as well as how these errors can be mitigated. In the next section, you will learn more about following <span class="No-Break">best practices.</span></p>
<h1 id="_idParaDest-182"><a id="_idTextAnchor184"/>Best practices</h1>
<p>The importance of<a id="_idIndexMarker605"/> following best practices becomes evident when you encounter issues during a pipeline’s life cycle. They will enable your team to not only maintain pipelines with ease but also swiftly identify and address any problems that <span class="No-Break">may arise.</span></p>
<p>Here are some practices that will help your team find any <span class="No-Break">issues easily:</span></p>
<ul>
<li>Use YAML syntax rather than the classic version. YAML can be version-controlled in repositories such as Azure Repos, GitHub, and Bitbucket, which can help you track changes in the YAML file and introduce changes gradually when combined with a branching strategy. Even better, if you want to enforce this, you can disable the creation of classic build pipelines at the organization or project <span class="No-Break">settings level.</span></li>
<li>Separate common tasks into separate YAML files that can be referenced from your main template when you have many tasks repeated throughout stages. This makes it easier to maintain or change the behavior of a pipeline in large <span class="No-Break">multi-stage configurations.</span></li>
<li>Consider creating more stages if you have <span class="No-Break">long-running jobs.</span></li>
<li>Keep your pipelines small and focused, using templates, stages, jobs, <span class="No-Break">and steps.</span></li>
<li>Build stages for large and complex applications might require more resources to compile and package faster. Microsoft-hosted agents run on general-purpose virtual machines, with only dual-core CPUs, 7 GB of RAM, and a 14 GB SSD for Linux and Windows, or three-core CPUs, 14 GB of RAM, and a 14 GB SSD for macOS. If you need to improve the performance of builds, you should consider self-hosted agents running on virtual machines with <span class="No-Break">more resources.</span></li>
<li>Consider using programming languages that support incremental compilation. Application projects that can take advantage of partial incremental builds can only be hosted in self-hosted agents, ensuring that filesystem resources are not discarded after <span class="No-Break">every build.</span></li>
<li>Use variable groups to reduce duplication when multiple pipelines use the same value. This makes your pipelines <span class="No-Break">more maintainable.</span></li>
<li>Use secret <a id="_idIndexMarker606"/>values for private values or keys. Navigate to <strong class="bold">Library</strong> | <strong class="bold">secrets</strong> | <strong class="bold">Variable group</strong>, and click on the lock icon to limit access to the variables, as shown in the <span class="No-Break">following screenshot:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer279">
<img alt="Figure 12.5 – Creating secret variables" height="583" src="image/B18875_12_5.jpg" width="1157"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.5 – Creating secret variables</p>
<ul>
<li>If you have variables from<a id="_idIndexMarker607"/> Azure <strong class="bold">Key Vault</strong> (<strong class="bold">KV</strong>), Azure’s <strong class="bold">Key Management Service</strong> (<strong class="bold">KMS</strong>) will <a id="_idIndexMarker608"/>encrypt and store the secret key safely. It will make sure all variables are safe. Once this is done, no one can read your secret keys without your permission. It is recommended that you link all variables from KV to the variable group, as <span class="No-Break">shown here:</span><a id="_idTextAnchor185"/></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer280">
<img alt="Figure 12.6 – Linking secrets from Azure KV" height="410" src="image/B18875_12_6.jpg" width="1006"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.6 – Linking secrets from Azure KV</p>
<ul>
<li>Consider using the <strong class="bold">principle of least privilege</strong>, a security concept that dictates that a user should be<a id="_idIndexMarker609"/> granted the minimum levels of access – or permissions – needed to perform their job functions. This principle is applied to restrict users’ access rights to what is only strictly required to do their work, minimizing the risk of malicious activity or accidental damage and reducing the risk of the wrong pipelines <span class="No-Break">being used.</span></li>
<li>To investigate <a id="_idIndexMarker610"/>the problem of failed pipelines, you can download the log directly from the pipelines. This can be done by following <span class="No-Break">these steps:</span><ol><li class="upper-roman">Select the pipeline for which you need to download <span class="No-Break">the log.</span></li><li class="upper-roman">Click on the three dots icon and then <span class="No-Break"><strong class="bold">Download logs</strong></span><span class="No-Break">:</span></li></ol></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer281">
<img alt="Figure 12.7 – Download logs for pipelines" height="429" src="image/B18875_12_7.jpg" width="333"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.7 – Download logs for pipelines</p>
<ul>
<li>If you use <strong class="source-inline">PublishBuildArtifacts@1</strong>, you can download artifacts directly from a pipeline if<a id="_idIndexMarker611"/> you need to inspect them, by following <span class="No-Break">these steps:</span><ol><li class="upper-roman" value="1">Select a pipeline, and click on the value in the <strong class="bold">Related</strong> column, <strong class="bold"># </strong><span class="No-Break"><strong class="bold">published</strong></span><span class="No-Break">:</span></li></ol></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer282">
<img alt="Figure 12.8 – Pipeline artifacts" height="494" src="image/B18875_12_8.jpg" width="985"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.8 – Pipeline artifacts</p>
<ol>
<li class="upper-roman" value="2">Click on the file to <span class="No-Break">download it:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer283">
<img alt="Figure 12.9 – Downloading a file from Artifacts" height="800" src="image/B18875_12_9.jpg" width="510"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.9 – Downloading a file from Artifacts</p>
<ul>
<li>For cost <a id="_idIndexMarker612"/>optimization, you can adjust the retention policy of <strong class="bold">Artifacts</strong> to reduce the <span class="No-Break">storage size:</span><ol><li class="upper-roman" value="1">Go to <strong class="bold">Project Settings</strong> | <span class="No-Break"><strong class="bold">Settings</strong></span><span class="No-Break">.</span></li><li class="upper-roman">Adjust the parameters of the retention policy, depending on your business objectives. For example, if your business plan requires you to retain Azure pipeline results for only five days due to the need for cost optimization in storage, then it’s essential to adhere to this timeframe. Keeping data for longer periods would result in additional <span class="No-Break">storage costs:</span></li></ol></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer284">
<img alt="Figure 12.10 – Retention policy" height="815" src="image/B18875_12_10.jpg" width="1198"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.10 – Retention policy</p>
<ul>
<li>Consider <a id="_idIndexMarker613"/>validating the number of parallel jobs you have. It will help you to understand better how many processes you can run on the pipelines in <span class="No-Break">parallel mode:</span><ol><li class="upper-roman" value="1">Navigate to <strong class="bold">Project Settings</strong> | <span class="No-Break"><strong class="bold">Parallel jobs</strong></span><span class="No-Break">.</span></li><li class="upper-roman">You can see an overview of all the agents <span class="No-Break">you have:</span></li></ol></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer285">
<img alt="Figure 12.11 – Parallel jobs" height="815" src="image/B18875_12_11.jpg" width="1265"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.11 – Parallel jobs</p>
<p>In this section, you learned how to make a better Azure pipeline based on best practices. In the last section of this chapter, you will learn more about the future of <span class="No-Break">Azure Pipelines.</span></p>
<h1 id="_idParaDest-183"><a id="_idTextAnchor186"/>Future trends</h1>
<p>Azure DevOps is an ever-evolving <a id="_idIndexMarker614"/>product, and as such, new features and capabilities are introduced often, typically because of the Microsoft product team looking to improve the product, or because of requests <span class="No-Break">from users.</span></p>
<p>Let’s look at some of the most recent features related to <span class="No-Break">Azure Pipelines:</span></p>
<ul>
<li>Improvements in the authoring experience for Azure Pipelines tasks to support newer versions of Node.js and ease the transition to newer versions of it, allowing you and any other contributors in the community to create your <span class="No-Break">own extensions.</span></li>
<li>GitHub Advanced Security for Azure DevOps is a new security suite of tools aimed at<a id="_idIndexMarker615"/> increasing <strong class="bold">DevSecOps</strong> practices. Among its features, it includes the ability to scan your code to prevent common vulnerability scenarios, using specialized tasks that detect scenarios such as cross-site scripting, SQL or XML injection attacks, and many more common issues that developers can often overlook. This is available for many programming languages <a id="_idIndexMarker616"/>and keeps evolving to offer more support in <span class="No-Break">the future.</span></li>
</ul>
<p class="callout-heading">What is DevSecOps?</p>
<p class="callout">DevSecOps<a id="_idIndexMarker617"/> is a comprehensive integration of DevOps and security practices in the software development life cycle, which promotes that teams collaborate closely to include security in all aspects of the development process. This reduces and eliminates the risks associated with vulnerabilities in their code and third-party dependencies as early <span class="No-Break">as possible.</span></p>
<ul>
<li>Reduce the gaps in features between YAML pipelines and classic release management deployment pipelines for CD scenarios. Several capabilities to improve the checks will be released in the <span class="No-Break">coming year.</span></li>
</ul>
<p>Looking into the future, there are other features that will also become important as you expand your usage of <span class="No-Break">Azure Pipelines:</span></p>
<ul>
<li>In-product recommendations to highlight the best practices when configuring your pipelines <span class="No-Break">around security</span></li>
<li>Deprecation and removal of unsupported versions of Node.js for the agent software included with both the Microsoft-hosted and <span class="No-Break">self-hosted versions</span></li>
</ul>
<p>The Azure DevOps features roadmap<a id="_idIndexMarker618"/> is available at <a href="https://learn.microsoft.com/en-us/azure/devops/release-notes/features-timeline">https://learn.microsoft.com/en-us/azure/devops/release-notes/features-timeline</a>, where you can see all the product capabilities that are in progress or planned to be released by Microsoft in the near and long term. If a feature is in progress and slated to be released, you will see the approximate year and quarter when the feature will be available, as well as its availability in the cloud service or the server edition of the product. You can influence the future of the<a id="_idIndexMarker619"/> product by making suggestions through the portal, as shown in the <span class="No-Break">following screenshot:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer286">
<img alt="Figure 12.12 – Make a suggestion to improve Azure DevOps" height="251" src="image/B18875_12_12.jpg" width="415"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 12.12 – Make a suggestion to improve Azure DevOps</p>
<p>Now that we’ve looked at some future trends of Azure Pipelines, let’s wrap <span class="No-Break">things up.</span></p>
<h1 id="_idParaDest-184"><a id="_idTextAnchor187"/>Summary</h1>
<p>This chapter has been a crucial stepping stone in your journey, empowering you to use Azure Pipelines with confidence and expertise. You’re now better equipped to recognize and address the common pitfalls and challenges, thereby saving valuable resources and maintaining a <span class="No-Break">seamless workflow.</span></p>
<p>Following the best practices will help optimize the functionality of your pipelines and enhance collaboration within your team, ensuring the efficiency and reliability of your pipeline operations. We also offered a glimpse into the future of Azure Pipelines, which will enable you to adapt and stay ahead in this <span class="No-Break">dynamic field.</span></p>
<p>Armed with the knowledge you have acquired throughout this book, you can now navigate the Azure Pipelines landscape, deploying your applications across diverse scenarios and requirements with efficiency <span class="No-Break">and precision.</span></p>
<p>Good luck on <span class="No-Break">your journey!</span></p>
</div>
</div></body></html>