<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure Information Protection Development</h1>
                </header>
            
            <article>
                
<p class="mce-root">This chapter is a good starting point for anyone who wants to dive deeper into the Azure Information Protection technology to get more information for troubleshooting or supporting a solution. This chapter will also help you write an application to help your customers to fulfill your organization's needs. Using the development resources of Azure Information Protection will give you more in-depth knowledge about this technology.</p>
<p class="mce-root">In this chapter, we'll provide you with an overview of the different development resources to help you start your journey into the different Azure Information Protection development options. We'll offer you the starters to prepare your development environment and give you some examples so you can start analyzing this excellent service. You'll get information about the Microsoft Information Protection SDK, the use of PowerShell, and the other SDKs that are available to help you begin your journey.</p>
<p>This chapter is organized into the following sections:</p>
<ul>
<li><span>Microsoft Information Protection</span> solutions</li>
<li>Understanding the Microsoft Information Protection SDK</li>
<li>Preparing your Azure AD environment for tests</li>
<li>Using MIP binaries to explore functionality</li>
<li>Using PowerShell with Azure Information Protection</li>
<li>Overview of the RMS 2.1 and 4.2 SDKs</li>
</ul>
<p>Lets look at the technical requirements you need to start developing on our lab environment.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, you can use the <strong>YD1APP01</strong> server, on which Visual Studio 2017 is already installed in <a href="468509fa-856c-411d-abdb-e9a39c266750.xhtml">Chapter 7</a>, <em>Deploying Solutions on Azure AD and ADFS</em>. Additionally, you need to install the Information Protection SDK 2.1 from <a href="https://bit.ly/298QzMn">https://bit.ly/298QzMn</a> to run any development. Also, download the examples from <a href="https://bit.ly/2RHCjjO">https://bit.ly/2CBVvoE</a>, <a href="https://bit.ly/2RHCjjO">https://bit.ly/2RHCjjO,</a>and <a href="https://bit.ly/2HtYKEj">https://bit.ly/2HtYKEj</a> to the server in your Visual Studio project directory, such as <kbd>C:\Users\cloudadmin.INOVITDEMOS\Documents\Visual Studio 2017\Projects&gt;</kbd>, which you can use to experiment with the framework.</p>
<p class="mce-root">In the next section, we'll dive into the Microsoft Information Protection solutions to get the knowledge about all the related technologies.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Microsoft Information Protection solutions</h1>
                </header>
            
            <article>
                
<p>Azure Information Protection itself is built to classify, label, and protect files in Office 365 and many other applications. The following list shows the different solution components and their relation to Azure Information Protection:</p>
<ul>
<li><strong>Microsoft Cloud App Security</strong>: For protecting cloud applications with direct integration of Azure Information Protection.</li>
<li><strong>Conditional Access</strong>: To control access to sensitive information where no direct integration into Azure Information Protection is required.</li>
<li><strong>SharePoint</strong><span>: To deliver </span>RMS-protected libraries and groups to provide access control.</li>
<li><strong>Office 365 Message encryption</strong>: To send encrypted emails inside or outside your organization with a direct integration into Azure Information Protection.</li>
<li><strong>Office 365 Data Loss Prevention</strong><span>: Is b</span>uilt to prevent data loss over Exchange and SharePoint Online, including OneDrive for Business with a direct integration <span>into Azure Information Protection.</span></li>
<li><strong>Office 365 Advanced Data Governance</strong><span>: Provides the r</span>etention and deletion policies for sensitive information with a direct integration <span><span>into Azure Information Protection.</span></span></li>
<li><strong>Azure Security Center Information Protection</strong>: Assigns classification of structured data, such as Azure SQL or SQL servers, including other Azure repositories with no direct integration into Azure Information Protection.</li>
<li><strong>Windows Information Protection</strong><span>: Is b</span>uilt to separate the private and business context on a mobile phone or PC.</li>
<li><strong>Office Apps</strong>: Used to protect sensitive information in Excel, PowerPoint, Word, and Outlook with an indirect integration into Azure Information Protection.</li>
<li><strong>Adobe PDFs</strong>: Azure Information Protection delivers the native support to label and protect Adobe PDF's.</li>
</ul>
<p>Overall, Microsoft provides Microsoft SDKs to help developers to work on solutions for traditional on-premises infrastructure, cloud platforms, and modern applications on mobile devices. Lets understand more about it. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Understanding the Microsoft Information Protection SDK</h1>
                </header>
            
            <article>
                
<p>The Microsoft Information Protection SDK extends labeling and protection functionality so you can provide a consistent experience in cross-platform scenarios, and it provides a comprehensive set of capabilities. With the SDK, you can extend the classification, labeling, and protection to any other app and service. In general, Microsoft Information Protection solutions are compatible with traditional Active Directory RMS infrastructures. You experienced this with the <strong>Hold Your Own Key</strong> (<strong>HYOK</strong>) functionality.</p>
<p>The Microsoft Information Protection SDK is available on the following:</p>
<ul>
<li>macOS, Linux, and Windows</li>
<li>A preview for Android, IOS, and other platforms</li>
</ul>
<p>The SDK supports u<span>ser and service applications, including support for multi-tenancy. </span>User applications include common authoring tools, such as Office and Adobe. Labeling structured data is also supported. Service applications mostly run in the background, such as DLP, <strong>cloud access security brokers</strong> (<strong>CASBs</strong>), and eDiscovery features. These applications authenticate using OAuth. </p>
<p>In detail, the APIs provide the following capabilities:</p>
<table style="border-collapse: collapse;width: 100%" border="1">
<tbody>
<tr>
<td>
<p><strong>API</strong></p>
</td>
<td>
<p><strong>Functionality</strong></p>
</td>
<td>
<p><strong>Use cases</strong></p>
</td>
</tr>
<tr>
<td>
<p><strong>Protection</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Accepts plaintext content and returns a publishing license</li>
<li>Allows ciphertext and publishing licenses</li>
<li>Returns plaintext</li>
<li>Rights enforcement if needed</li>
</ul>
</td>
<td>
<ul>
<li class="mce-root">Encryption of any data</li>
<li>No key exchange management required</li>
<li>For example, security software that needs to inspect data in transit</li>
</ul>
</td>
</tr>
<tr>
<td>
<p><strong>Policy</strong></p>
</td>
<td>
<ul>
<li class="mce-root">Computes actions that policy should take</li>
<li>Submission enablement for events in the audit pipeline</li>
<li>Application of label metadata if needed</li>
</ul>
</td>
<td>
<ul>
<li class="mce-root">CAD and CAM applications for classifying parts or components</li>
<li>DLP platforms for reading labels and monitoring your services or networks</li>
</ul>
</td>
</tr>
<tr>
<td><strong>File</strong></td>
<td>
<ul>
<li class="mce-root">Support for well-known file types</li>
<li>Allows read, write, or delete labels</li>
<li>Enables protection removal</li>
<li>Applies metadata provided by the API</li>
</ul>
</td>
<td>
<ul>
<li class="mce-root">Word, Excel, PowerPoint, or others</li>
<li>Scanners that need to label files</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p> </p>
<p>In the next section, we'll provide a sample app, <kbd>MipSdk-FileApi-Cpp-Sample-Basic</kbd>, from Microsoft and help you to start using the SDK and explore the different functionalities.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Preparing your Azure AD environment for tests</h1>
                </header>
            
            <article>
                
<p>In this section, we'll adjust our Azure AD environment to run code from the Microsoft Information Protection SDK against our Azure Information Protection infrastructure. As usual, it starts with the creation of an Azure AD app:</p>
<ol>
<li>Log in with global administrator credentials to the Azure portal at <a href="https://portal.azure.com">https://portal.azure.com</a>.<a href="https://portal.azure.com"/></li>
<li>Navigate to the Azure AD blade.</li>
<li>Click <span class="packt_screen">App registrations</span> to create a new application.</li>
<li>Click <span class="packt_screen">New Applications registration</span>.</li>
</ol>
<ol start="5">
<li>Use the following settings:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/f51dc959-9c84-4f10-9897-e18a15153d4c.png" style="width:21.08em;height:16.75em;" width="302" height="240"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Example app properties</div>
<ol start="6">
<li>Click the <span class="packt_screen">Settings</span> button on the registered application:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/702a42b2-68ef-4aae-b8d0-a57df94fff22.png" style="width:45.75em;height:18.17em;" width="574" height="228"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">App Settings option</div>
<ol start="7">
<li>Click the <span class="packt_screen">Required permissions</span> section for API access.</li>
</ol>
<ol start="8">
<li class="mce-root">Click <span class="packt_screen">Add</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/bd12866c-c9f6-46a6-ab98-4f7c4f9d6cfd.png" width="1468" height="445"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Required permissions configuration</div>
<ol start="9">
<li class="mce-root">Click <span class="packt_screen">Select an API</span>. If needed, use the search field to find <span class="packt_screen">Microsoft Rights Management Services</span>.</li>
<li class="mce-root">Select the <span class="packt_screen">Microsoft Rights Management Services</span> API:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/575c4cf6-ea03-4c9f-90a9-76b8546c5c14.png" style="width:32.50em;height:28.42em;" width="575" height="503"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Choosing the Microsoft RMS API</div>
<ol start="11">
<li class="mce-root">Under the <span class="packt_screen">Select permissions</span> section, use the <span class="packt_screen">Create and access protected content for users</span> permission under the <span class="packt_screen">DELEGATED PERMISSIONS</span> options.</li>
<li class="mce-root">Click <span class="packt_screen">Select</span> and <span class="packt_screen">Done</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/51bfae5b-3f26-4a56-9d48-852db417fc99.png" width="863" height="213"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Permission scoping</div>
<ol start="13">
<li class="mce-root">Click the <span class="packt_screen">Add</span> button.</li>
<li class="mce-root">Click the <span class="packt_screen">Select an API</span> option to choose the correct API.</li>
<li class="mce-root">Search the <span class="packt_screen">Microsoft Information Protection Sync Service</span> and select the service:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/9d316de6-707e-441a-b834-648d31d9f8b2.png" style="width:41.17em;height:15.00em;" width="627" height="229"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Select the Microsoft Information Protection Sync Service API</div>
<ol start="16">
<li class="mce-root">Under the <span class="packt_screen">Select permissions</span> option, select <span class="packt_screen">Read all unified policies a user has access to.</span> under <span class="packt_screen">DELEGATED PERMISSIONS</span>.</li>
</ol>
<ol start="17">
<li class="mce-root">Click <span class="packt_screen">Select</span> and then press <span class="packt_screen">Done</span>:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/a2817c4f-78c8-4236-9a1e-d71694c09e76.png" width="866" height="158"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Delegated permission configuration</div>
<ol start="18">
<li>In the <span class="packt_screen">Required permissions</span> blade, click the <span class="packt_screen">Grant permissions</span> button and confirm the dialog:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/b9458139-9edb-478b-8837-67c1699032e5.png" style="width:40.67em;height:17.17em;" width="575" height="242"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Permission granting procedure</div>
<ol start="19">
<li>Copy the application ID in line <kbd>57</kbd> of the <kbd>main.cpp</kbd> file, and your test user into line <kbd>64</kbd>, to configure the application:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/8cffd10a-a0d7-49ec-873f-072500b294d2.png" width="1000" height="217"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Modification of the example app</div>
<p class="mce-root"/>
<p>Now that we have prepared our Azure AD environment, you can start exploring the code samples.</p>
<p>Open the <kbd>MipSdk-FileApi-Cpp-Sample-Basic.vcxproj</kbd> file with Visual Studio and start with the following steps:</p>
<ol>
<li>Copy the label ID to the clipboard or Notepad.</li>
<li>Paste the label into the input prompt.</li>
<li>The application asks for the path to a file. Enter the path to your specific Office document.</li>
<li>The application will display the name of the currently applied label.</li>
<li>Open the file in a viewer that supports the labeling or protection feature.</li>
</ol>
<p>Next, we will explore the functionality of the Microsoft Information Protection (MIP) binaries to see the broad functionality that you can include in the development of your solution. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using MIP binaries to explore functionality</h1>
                </header>
            
            <article>
                
<p>With the Microsoft Information protection binary from the SDK, we can explore the new functionalities of <span>Microsoft's</span><span> unified Information Protection solution. The binaries deliver all the examples <span>needed </span>to start using the different functions like gathering the actual status of a file, classifying and protecting a file, and bulk decrypting files. In the following section, we will focus on the file_example.exe binary which delivers all this basic functionality. This example will give you ideas for developing own applications that use the SDK and the Information protection functions.</span></p>
<p>We downloaded the MIP binaries to explore features. You can use the following steps to get more insight into features:</p>
<ol>
<li>Open PowerShell and navigate to the sample files.</li>
<li>Execute the <kbd>.\file_sample.exe</kbd> binary to view the functionality you can test:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/31602700-832a-47f2-b1a6-57666e82bd41.png" style="width:62.17em;height:45.00em;" width="888" height="643"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Application command-line options</div>
<p>With this binary, you can start with the following commands:</p>
<ul>
<li>Get a list of labels:</li>
</ul>
<pre style="padding-left: 90px"><strong>./file_sample --username jenny.green@leano.ch --password "YOURPASSWORD " --file "PATH" --listlabels</strong></pre>
<ul>
<li>Set a label:</li>
</ul>
<pre style="padding-left: 90px"><strong>./file_sample --username jenny.green@leano.ch --password "YOURPASSWORD" --file "PATH" --setlabel &lt;GUID&gt;</strong></pre>
<ul>
<li class="mce-root">Read a label:</li>
</ul>
<pre style="padding-left: 90px"><strong>./file_sample --username jenny.green@leano.ch --password "YOURPASSWORD" --file "PATH" --getfilestatus</strong></pre>
<p>After working with the MIP file_sample.exe example, we will introduce you the several capabilities of PowerShell to administer and develop your own solution. The functionality is similar to the binaries, but maybe easier to understand for an administrator or PowerShell experienced person. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using PowerShell with Azure Information Protection</h1>
                </header>
            
            <article>
                
<p>PowerShell provides you managing capabilities for Azure Information Protection. In special, to handle custom classification and protection solutions you need to be able to use PowerShell to solve your challenges like, labeling and protecting files on a file share or single computer. With the following cmdlets you have the basic toolset to do the most administrative tasks with PowerShell. We used the cmdlets for example for providing a monitoring solution of a single folder and labeling and encrypting the files in the folder based on keywords. With the following commands, you can start to explore more about Azure Information Protection's capabilities and technology:</p>
<ul>
<li><kbd>Import-Module AzureInformationProtection</kbd></li>
<li class="mce-root"><kbd>Get-AIPFileStatus</kbd>: Used to identify all files with a specific label</li>
<li class="mce-root"><kbd>Set-AIPFileClassification:</kbd> Used to inspect file contents and automatically label unlabeled files</li>
<li class="mce-root"><kbd>Set-AIPFileLabel</kbd>: Used to apply a specified label</li>
<li class="mce-root"><kbd>Set-AIPAuthentication</kbd>: Used to label files non-interactively (scripting/scheduler)</li>
</ul>
<p>Next, we will see some useful PowerShell cmdlets to administrator Azure RMS.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Useful Azure RMS cmdlets</h1>
                </header>
            
            <article>
                
<p>In the following section, we will provide a service principal that is needed for using the scripts to administrate Azure RMS. The following commands are needed to create a new service principal: </p>
<pre><strong>$ServicePrincipalName="RMSPowerShell"</strong><br/><strong>Connect-AadrmService</strong><br/><strong>$bposTenantID=(Get-AadrmConfiguration).BPOSId</strong><br/><strong>Disconnect-AadrmService</strong><br/><strong>Connect-MsolService</strong><br/><strong>New-MsolServicePrincipal -DisplayName $ServicePrincipalName</strong></pre>
<p>The following output is expected:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/bc7736cf-0233-4e64-9b7b-c8231eda3995.png" width="1203" height="573"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Creation result of the new service principal</div>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Copy the generated symmetric key value:</p>
<pre class="mce-root"><strong>$symmetricKey="&lt;value from the display of the New-MsolServicePrincipal command&gt;"</strong><br/><strong> $appPrincipalID=(Get-MsolServicePrincipal | Where { $_.DisplayName -eq $ServicePrincipalName }).AppPrincipalId</strong><br/><strong> Set-RMSServerAuthentication -Key $symmetricKey -AppPrincipalId $appPrincipalID -BposTenantId $bposTenantID</strong></pre>
<p>The following output is expected:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/c586f0b1-9442-4a42-af35-d9144310afdf.png" width="1243" height="88"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Key information</div>
<p>Now, you can start doing the following commands using the service principal account:</p>
<ul>
<li>Enumerate all <kbd>RMSTemplate</kbd>:</li>
</ul>
<pre style="padding-left: 90px">Get-RMSTemplate</pre>
<ul>
<li>Protect a file:</li>
</ul>
<pre style="padding-left: 90px">Protect-RMSFile -File C:\Test.docx -InPlace -TemplateId &lt;yourtemplateid&gt;</pre>
<ul>
<li>Get the status of a file:</li>
</ul>
<pre style="padding-left: 90px">Get-RMSFileStatus -File C:\Test1.docx</pre>
<ul>
<li>Unprotect a file:</li>
</ul>
<pre style="padding-left: 90px">Unprotect-RMSFile C:\test.docx -InPlace</pre>
<p>Now that we've started using PowerShell to work with Azure Information Protection and Azure Rights Management Service, we'll give you some useful information about the other SDKs that are available to develop against the services and increase your knowledge.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Overview of the RMS 2.1 and 4.2 SDKs</h1>
                </header>
            
            <article>
                
<p>Two active generations of RMS SDKs are available to developers and used for the following developments:</p>
<ul>
<li>Microsoft Rights Management SDK 4.2 for Android, iOS/macOS, Windows devices, and Linux</li>
<li>Microsoft Rights Management SDK 2.1 for Windows Desktop Client</li>
<li>AD RMS SDK is superseded</li>
</ul>
<p>The following improvements were included with the 4.2 version:</p>
<ul>
<li>Hybrid support AD RMS and Azure RMS (AD RMS' mobile device extension is needed to make AD RMS available on mobile devices and provides the required authentication methods)</li>
<li>Access protected content offline</li>
<li>Bring your authentication library</li>
<li>Bring your user interface</li>
<li>Redesigned API</li>
</ul>
<p>You can use the following example design to develop your application:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/7e3b572f-f336-4253-b0de-49ed0a151535.png" style="width:33.50em;height:24.33em;" width="844" height="613"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Example of design for an application with the feature specification</div>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="x_MsoNormal">The example above demonstrates how a user can encrypt a document. For this task, he needs to select an Azure RMS template or use an Azure RMS AdHoc-Protection. In order to get the template information from Azure Information Protection, the user needs to be authenticated. Post successful authentication, the user can request templates and services, and return them. If all the previous steps are successful, the required template can be applied and the document will be encrypted. Furthermore, a functionality to unencrypt the document must be included in your design and development to store sensitive information which is not encrypted. Both encryption and unencryption are important to have full solution.</p>
<p>If we take a look at the Azure IP Test application you downloaded at the beginning of the chapter, in the <em>Technical requirements </em>section, you can start to build such an application with the help of this sample, because it provides many main functions of the SDK.</p>
<p>Otherwise, Microsoft provides other examples that help you start to gather more knowledge. A perfect way to start is through simple interaction with text files, which you can do with the <kbd>IpcNoteapp</kbd> application. This app shows you how you can protect a simple text file. My favorite way is to start directly with a specific use case, such as the protection of data in Azure Blob storage. If you think like me, start with <kbd>IpcAzureApp</kbd>, because this automatically introduces you to <kbd>IpcManagedAPI</kbd>, which provides you with many helper classes. Otherwise, if you want to explore more about the DLP functionality, you can use <kbd>IpcDlpApp</kbd>, which interacts with the File API to protect or unprotect data. You can monitor directories on your filesystem and apply protection policies with <kbd>RMSFileWatcher</kbd>. If you also want to see such functionality in a simple PowerShell script, you can use the following example:</p>
<ol>
<li>Set the folder that you want monitor, including the subfolders:</li>
</ol>
<pre style="padding-left: 90px"><strong>$watcher = New-Object System.IO.FileSystemWatcher</strong><br/><strong> $w.Path = "C:\Users\jochen.nickel\Desktop\Monitored"</strong><br/><strong> $w.Filter = "*.*"</strong><br/><strong> $w.IncludeSubdirectories = $true</strong><br/><strong> $w.EnableRaisingEvents = $true</strong></pre>
<ol start="2">
<li>Define the actions for when an event is detected:</li>
</ol>
<pre style="padding-left: 90px" class="mce-root"><strong>$action = { </strong><br/><strong> $fname = $Event.SourceEventArgs.Name</strong><br/><strong> if ($fname -like "*.tmp" -or $fname -like "*~$*"){}</strong><br/><strong> else {</strong><br/><strong> $path = $Event.SourceEventArgs.FullPath</strong><br/> <br/><strong> $changeType = $Event.SourceEventArgs.ChangeType</strong><br/><strong> $logline = "$(Get-Date), $changeType, $path"</strong><br/><strong> #write-host $logline</strong><br/><strong> Add-content "C:\Users\jochen.nickel\Desktop\log.txt" -value $logline</strong><br/><strong> }</strong><br/><strong> }</strong><br/><strong>$action1 = { </strong><br/><strong> $fname = $Event.SourceEventArgs.Name</strong><br/><strong> if ($fname -like "*.tmp" -or $fname -like "*~$*" -or $fname -like "*.TMP" ){}</strong><br/><strong> else {</strong><br/><strong> $path = $Event.SourceEventArgs.FullPath</strong><br/> <br/><strong> $changeType = $Event.SourceEventArgs.ChangeType</strong><br/><strong> $logline = "$(Get-Date), $changeType, $path"</strong><br/><strong> write-host $logline</strong><br/><strong> Add-content "C:\Users\jochen.nickel\Desktop\log.txt" -value $logline</strong><br/><strong> Set-AIPFileLabel $path -LabelId '6523069d-6f4a-4486-8dc3-71de23457c71'</strong><br/><strong> $logline = "$(Get-Date), APPLIED: Set-AIPFileLabel $path -LabelId '6523069d-6f4a-4486-8dc3-71de23457c71'"</strong><br/><strong> write-host $logline</strong><br/><strong> Add-content "C:\Users\jochen.nickel\Desktop\log.txt" -value $logline</strong><br/><strong> }</strong><br/><strong> }</strong> </pre>
<ol start="3">
<li class="mce-root">Decide which events should be monitored:</li>
</ol>
<pre style="padding-left: 90px"><strong>$created = Register-ObjectEvent $w "Created" -Action $action</strong><br/><strong> $changed = Register-ObjectEvent $w "Changed" -Action $action</strong><br/><strong> $deleted = Register-ObjectEvent $w "Deleted" -Action $action</strong><br/><strong> $renamed = Register-ObjectEvent $w "Renamed" -Action $action</strong><br/><strong> while ($true) {sleep 2}</strong></pre>
<p>To extend your knowledge, with the inclusion of the Azure <strong>Active Directory Authentication Library</strong> (<strong>ADAL</strong>), you can encrypt files with the <kbd>FormFileEncrypt</kbd> application. If you need to support HYOK scenarios, I recommend you work through <kbd>DualSererTestApp</kbd>. With your lab infrastructure, you're able to run every scenario.</p>
<p>For more information, check out the Microsoft developer reference (Azure Information Protection Developer's Guide): <a href="https://bit.ly/2HIDjQ2">https://bit.ly/2HIDjQ2</a>.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this final chapter, we first introduced you to the several PowerShell scripts and the related code of the SDK to gather more information about the whole Microsoft Information Protection solution framework, or to start developing your extensions or applications. <span>It was never the intention to turn you into a developer</span> in one chapter, but using these resources is a good source of knowledge for troubleshooting or administering such a solution. You should now be able to describe which SDKs are available and what they can be used for. Furthermore, you have enough code samples to start working. We wanted to provide you with a functional and ready work environment to help you get started easily.</p>
<p>Hopefully, the information in this book will help you with your current organization or project. I want to thank you very much sticking around till the end of this book. If you have any questions, don't hesitate to ask me under my blog jochennickel.ch or info@inovit.ch.</p>


            </article>

            
        </section>
    </div>



  </body></html>