- en: Chapter 9. Automation and Authentication – Service Management Automation and
    ADFS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will be focusing on automating our Windows Azure Pack-based
    cloud solution. You will learn the installation and configuration of **SMA** (**Service
    Management Automation**). You will also learn to create, author, and manage runbooks
    and assets.
  prefs: []
  type: TYPE_NORMAL
- en: 'Along with automation, you will also learn about the authentication, which
    is using ADFS to authenticate for both management and tenant portal. The following
    topics are covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: SMA – overview and architecture
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning the SMA infrastructure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing and configuring SMA
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dealing with SMA assets
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dealing with SMA runbooks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enabling ADFS authentication for WAP portals
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SMA – overview and architecture
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: SMA, a part of the system center product family, adds automation capabilities
    to the Windows Azure Pack cloud. SMA enables a cloud provider to automate provisioning,
    monitoring, and managing all resources in a WAP cloud.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s take an example. In a large-scale cloud provider scenario, tenants create
    and delete virtual machines in real time on a large scale, that is, hundreds of
    operations everyday. This cloud provider provides multiple capabilities and features
    on VMs hosted on the cloud as a value added to it; such capabilities include the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: Backup and disaster recovery
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Real-time monitoring
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Antivirus and anti-malware protection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automatic point in time state snapshots
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each VM provisioned by tenants needs to be configured in respective tools to
    enable the previous capabilities. And after each deletion of VMs by tenants, their
    respective configuration needs to be removed from backup, monitoring, and so on.
    Assume achieving this in a cloud having hundreds or more VM provisioning operations
    daily using traditional methods.
  prefs: []
  type: TYPE_NORMAL
- en: SMA can drastically simplify and automate these operations. Service providers
    can create SMA runbooks for the provisioning and removal of configurations. Runbooks
    can then be linked with VM create and delete operations which will automatically
    initiate execution of respective runbooks with specific VM parameters.
  prefs: []
  type: TYPE_NORMAL
- en: An overview of SMA
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: SMA was introduced with the System Center 2012 R2 product family and is included
    in the System Center Orchestrator installation media. It can be used as a standalone
    product as well as along with Windows Azure Pack.
  prefs: []
  type: TYPE_NORMAL
- en: SMA provides the automation engine for Microsoft's on-premises cloud infrastructure.
    It relies on Windows PowerShell workflows; that is, almost any tasks that can
    be performed via Windows PowerShell can be automated using SMA.
  prefs: []
  type: TYPE_NORMAL
- en: 'PowerShell workflows were introduced with the release of Windows PowerShell
    3.0, and they contain traditional PowerShell cmdlets to execute tasks. Runbooks
    in SMA are authored in PowerShell workflows adding the following capabilities
    of PowerShell workflows:'
  prefs: []
  type: TYPE_NORMAL
- en: Checkpoint or suspend a workflow that is a runbook
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The parallel execution of PowerShell tasks on multiple systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Natively, SMA does not provide any GUI to create, manage, or execute runbooks.
    Unlike System Center Orchestrator, all runbooks in SMA must be written in PowerShell
    workflows manually.
  prefs: []
  type: TYPE_NORMAL
- en: The Windows Azure Pack administrator portal integrates well with SMA and provides
    GUI for scheduling, executing, and performing other management operations on runbooks.
  prefs: []
  type: TYPE_NORMAL
- en: It must be noted that SMA functionality isn't available for tenants to create
    and manage their own runbooks.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Microsoft Azure automation works on the same architecture as SMA and provides
    similar automation capabilities for customers using Microsoft Azure for hosting
    their IT resources.
  prefs: []
  type: TYPE_NORMAL
- en: The architecture of SMA
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Similar to all other WAP cloud components, SMA is distributed across multiple
    components and provides the flexible architecture to achieve performance and eliminate
    a single point of failure. SMA involves the following components to function:'
  prefs: []
  type: TYPE_NORMAL
- en: The SMA web service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The SMA runbook worker
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The database server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The SMA PowerShell module (optional)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The SMA web service**: The web service is the interface to SMA for all other
    administrative mediums. Windows Azure Pack uses the SMA web service to communicate
    with SMA and for other SMA tasks, such as executing a runbook or getting the status
    of a runbook.'
  prefs: []
  type: TYPE_NORMAL
- en: It exposes a REST endpoint and OData API, which can be leveraged by WAP or any
    other custom developed portal for integration with SMA.
  prefs: []
  type: TYPE_NORMAL
- en: It is also responsible for authorization and distribution of runbook execution
    tasks to worker roles.
  prefs: []
  type: TYPE_NORMAL
- en: '**The SMA runbook worker**: SMA runbooks'' jobs are executed or processed by
    worker servers. A runbook worker server executes multiple runbooks in isolated
    environments, which are also known as sandboxes. This ensures that activities
    performed by one runbook don''t affect the other runbook that is being executed
    by the same worker server.'
  prefs: []
  type: TYPE_NORMAL
- en: '**The SMA database**: SMA leverages the Microsoft SQL server database to store
    its configuration and runtime data. SMA database stores SMA runbooks, jobs, and
    other SMA-related objects'' configurations and runtime data.'
  prefs: []
  type: TYPE_NORMAL
- en: '**The SMA PowerShell module**: This can be used to automate the automation;
    that is, it provides 40+ PowerShell cmdlet, which can be used by admins to automate
    the process of executing and managing runbooks. The PowerShell module also interacts
    with the SMA web service to perform SMA operations. This can be installed on the
    administrator''s endpoint and can be used as an alternative to the WAP portal
    for SMA operations.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following diagram illustrates the role and flow of SMA components with
    Windows Azure Pack:'
  prefs: []
  type: TYPE_NORMAL
- en: '![The architecture of SMA](img/00246.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Planning the SMA infrastructure
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'SMA works on the distributed architecture to allow an easy and non-disruptive
    scale in and out of the operations. The following aspects must be taken into consideration
    while planning the infrastructure for SMA deployment:'
  prefs: []
  type: TYPE_NORMAL
- en: Planning for availability
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning for performance/capacity
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning for availability
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'All the components of the SMA solution can be protected against a single point
    of failure by adding redundant servers. The following guidelines include the recommended
    configuration with respect to the availability of each role:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The SMA web service role**: This is recommended to deploy multiple web service
    roles (the minimum recommendation is two for high availability) and configure
    with a load balancer. Any administrative endpoint such as the WAP portal must
    point to the load balancer to communicate with the SMA web service.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The SMA worker role**: It is recommended to deploy multiple SMA worker roles
    (the minimum recommendation is two for high availability) to avoid any single
    point of failure. The SMA web service automatically distributes job tasks to different
    workers ensuring load balancing.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The SMA database**: It is recommended to protect SMA SQL database against
    any single point of failure using SQL availability techniques. SMA database is
    supported to run on the following:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Standalone SQL server
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL server cluster
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Always on
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Virtual machines for SMA servers**: Using virtual machines or hosting SMA
    servers adds another layer of protection against any hardware failure.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning for performance and capacity
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following factors should be taken into consideration while planning the
    SMA infrastructure sizing:'
  prefs: []
  type: TYPE_NORMAL
- en: The number of runbooks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The size of runbooks (activities, variables, connections, and so on)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The average run time of runbooks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Remote calls being executed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'There is no direct formula to calculate the sizing based on the previous factors.
    The following guidelines can be helpful in sizing SMA servers:'
  prefs: []
  type: TYPE_NORMAL
- en: '**The SMA web service**: SMA web service is stateless; that is, it can be scaled
    in and out easily with increased compute and additional servers along with a load
    balancer. Web services are responsible for communicating with administrative consoles,
    such as WAP, and worker roles to assign runbook jobs. High resource utilization
    and requirements are unlikely for the SMA web service unless a large number of
    users start initiating the SMA execution process simultaneously. Two CPU cores
    and 4 GB of RAM (minimum), 8 GB (recommended) are good compute configurations
    to start with.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The SMA worker**: SMA worker hosts a sandbox to execute runbook jobs that
    aren''t stateless as web services. Each sandbox can handle 30 concurrent jobs,
    and a worker can host a maximum of four sandboxes by default. This comes as 120
    concurrent jobs per worker server. The standard SMA server''s hardware recommends
    two CPU cores and 4 GB of RAM (minimum), but 8 GB is recommended. This can likely
    handle these efficiently. Worker roles can then be scaled out as per usage and
    requirement.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The SMA database**: There can only be one database as per the SMA deployment;
    hence, it is recommended to use a dedicated instance for the SMA database in the
    production environment, ensuring that it gets the required compute resources.
    Microsoft recommends using SQL servers for SMA databases with a minimum 8 GB of
    RAM and 8 cores in terms of compute. For storage as per Microsoft guidelines,
    1 month of data with 12 jobs per minute requires 20 GB of disk space. Along with
    this, it is recommended to follow standard Microsoft SQL Server performance and
    capacity guidelines. See [https://technet.microsoft.com/en-us/sqlserver/bb671430.aspx](https://technet.microsoft.com/en-us/sqlserver/bb671430.aspx)
    to learn about SQL server best practices.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing and configuring SMA
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: SMA installation binaries are located inside System Center Orchestrator Media
    and follows similar installation instructions as per other system center products.
  prefs: []
  type: TYPE_NORMAL
- en: SMA installation prerequisites
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The SMA installation prerequisites can be divided in three categories:'
  prefs: []
  type: TYPE_NORMAL
- en: Software components prerequisites
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: AD accounts prerequisites
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SSL certificate prerequisites
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows Server 2012 R2 is the minimum OS version supported for SMA installation.
    Apart from this, the following software components must be installed before starting
    the SMA installation as SMA installer doesn't automatically install prerequisite
    components.
  prefs: []
  type: TYPE_NORMAL
- en: 'Software prerequisite for installing the SMA web service are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Internet Information Services** (**IIS**) 7.5 or higher'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IIS basic authentication
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IIS Windows authentication
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IIS URL authorization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ASP.NET 4.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: .NET Framework 3.5 (for the setup program)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: .NET Framework 4.5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: WCF HTTP activation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Server 2012 DB connectivity
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To install .NET 3.5 on Windows Server 2012/R2 using Server Manager's **Add Feature**
    wizard, alternate source locations must be specified during the installation,
    and it needs to be pointed to the `sxs` folder under sources in the Windows installation
    media.
  prefs: []
  type: TYPE_NORMAL
- en: 'Software prerequisites to install the SMA worker role—Windows PowerShell 4.0
    (this is included by default with Windows Server 2012 R2):'
  prefs: []
  type: TYPE_NORMAL
- en: '**Active Directory Accounts**: It is recommended to create separate dedicated
    accounts and groups for running following services in SMA deployment. The following
    table lists the accounts required for deploying SMA components:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '| Sample account/group name | Account usage | Remarks |'
  prefs:
  - PREF_IND
  type: TYPE_TB
- en: '| --- | --- | --- |'
  prefs:
  - PREF_IND
  type: TYPE_TB
- en: '| SMA pool | SMA Application Pool Admin Group | A member of Local Administrators
    |'
  prefs:
  - PREF_IND
  type: TYPE_TB
- en: '| SMA poolsvc | SMA Pool Web Service Account | A member of Local Administrators
    |'
  prefs:
  - PREF_IND
  type: TYPE_TB
- en: '| SMA workersvc | SMA Worker Service Account | A member of Local Administrators
    |'
  prefs:
  - PREF_IND
  type: TYPE_TB
- en: '**SSL certificate**: It is recommended to use an internal CA issued SSL certificate
    for the SMA web service instead of the automatically generated self-signed certificate.
    This certificate must be trusted by the SPF server.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing the SMA web service, runbook worker, and PowerShell module
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For the purpose of evaluation in this book, we will be installing all three
    components on a single server. The following steps are required to install the
    SMA web service:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the server designated for installing the SMA web service.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start `SetupOrchestrator.exe` from System Center Orchestrator Media.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Web Service** on the **Install** page under **Service Management**.![Installing
    the SMA web service, runbook worker, and PowerShell module](img/00247.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Install** to proceed.![Installing the SMA web service, runbook worker,
    and PowerShell module](img/00248.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the **Name** and **Organization** names along with the registration key
    if any. The setup will get installed in the evaluation mode if no registration
    key is provided at this stage:![Installing the SMA web service, runbook worker,
    and PowerShell module](img/00249.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Agree to the terms and condition to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The setup will start its prerequisite check and will display any error or warning
    as applicable. Proceed further if all the prerequisites are met:![Installing the
    SMA web service, runbook worker, and PowerShell module](img/00250.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the database server connection information including the server name,
    port, database name, and credentials. Both Windows and SQL authentication can
    be used:![Installing the SMA web service, runbook worker, and PowerShell module](img/00251.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify security groups or users and credentials to run the web service application
    pool:![Installing the SMA web service, runbook worker, and PowerShell module](img/00252.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify the web service port and SSL certificate to use. The setup can also
    generate a self-signed certificate to use in test environments:![Installing the
    SMA web service, runbook worker, and PowerShell module](img/00253.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify a location to store web service files.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify choices for **CEIP** (**Customer Experience Improvement Program**) and
    Microsoft update.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the settings and click on **Install** to start the installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Close** on the successful completion; the SMA web service is now installed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Installing web worker roles
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following steps are required to install the SMA worker role:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the server designated to install the SMA worker.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start `SetupOrchestrator.Exe` from System Center Orchestrator Media.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Runbook Worker** on the **Install** page under Service Management.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the **Name** and **Organization** name along with the registration key
    if any. The setup will get installed in the evaluation mode if no registration
    key is provided at this stage.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Agree to the terms and condition to proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The setup will start its prerequisite checks and will display any error or warning
    as applicable. Proceed further if all the prerequisites are met.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the database server connection information including the server name,
    port, the database name, and credentials. Both Windows and SQL authentication
    can be used.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify the service account for running the SMA worker service:![Installing
    web worker roles](img/00254.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify a location to store worker files.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify choices for CEIP.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Review the setting and click on **Install** to start the installation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **close** upon successful completion. The SMA runbook worker is now
    installed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The SMA PowerShell module can be installed in a similar manner on administrative
    endpoints.
  prefs: []
  type: TYPE_NORMAL
- en: Post installation tasks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Ensure to complete the following tasks to have a working SMA deployment for
    the WAP integration:'
  prefs: []
  type: TYPE_NORMAL
- en: Replace the self-signed certificate for SMA web services with trusted SSL in
    production environments.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Verify the **SPF** (**Service Provider Foundation**) server trust the SSL certificate
    presented by SMA web service.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Integrating SMA with Windows Azure Pack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following steps are required to integrate SMA with Windows Azure Pack by
    registering SMA endpoints:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the WAP management portal for administrators.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Browse through the **automation** workspace:![Integrating SMA with Windows Azure
    Pack](img/00255.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Register the Service Management Automation Endpoint**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the SMA endpoint details along with some credentials:![Integrating SMA
    with Windows Azure Pack](img/00256.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The SMA endpoint will be visible in the WAP portal upon a successful registration.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The **automation** workspace under the WAP portal can now be used for all operations
    related to SMA. The **DASHBOARD** page displays statuses and statistics about
    runbooks and jobs throughout the cloud. Similar dashboards can also be accessed
    per runbook:![Integrating SMA with Windows Azure Pack](img/00257.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Dealing with SMA assets
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Assets in a SMA-based automation solution for WAP provide global configurations
    and parameters that can be leveraged by runbooks. For example, it is very likely
    that any runbook being executed for VM cloud's operations may require VMM server
    connection info and credentials. In large environments having hundreds of runbooks,
    instead of defining VMM server connection information and credentials per runbook,
    these can be declared as assets and can be leveraged by all runbooks.
  prefs: []
  type: TYPE_NORMAL
- en: Declaring such variables at global level in asset also helps in handling changes
    at a later stage in a very smooth manner.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assets in Windows Azure Pack automation include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Connections
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Credentials
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Variables
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Schedules
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modules
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Asset types and functionalities
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following are the types of assets and their functionalities:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Connections**: Connections include connectivity details and authorized credentials
    for common services used by runbooks. Examples include services such as SCVMM,
    Azure, or any other available services.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Credentials**: Credentials in WAP automation assets can be compared to Run
    As accounts in SCVMM. Credentials contain a username and password for accounts
    leveraged by runbooks for accessing, modifying, and managing resources across
    the cloud. WAP automation assets can store two types of credentials:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows PowerShell credentials
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: SSL certificates credentials
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Service providers can add multiple credentials depending upon the permission
    and usage required by runbooks.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Variables**: As implied by its name, variables can be used to store key values
    used by runbooks. Variables can be defined in the following format:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: String
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Integer
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Boolean
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Date time
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Variables having confidential values such as password can be encrypted for security.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '**Schedules**: This can be used to create a regular schedule for any runbook
    to execute; for example, a schedule can be created, which will initiate a runbook
    everyday at some specific time to collect statics data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Modules**: This contains PowerShell modules, which can be used by runbooks
    to execute specific PowerShell cmdlets. Modules can be compared with integration
    packs in System Center Orchestrator.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modules help in managing all PowerShell modules in a central point without requiring
    installation at each worker role.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: Adding and managing assets
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **ASSETS** tab under the automation workspace in the WAP management portal
    provides options to add or remove assets.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following steps are required to add, delete, and modify assets:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the WAP management portal for administrators.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Browse the **automation** workspace and the **ASSETS** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: By default, all the standard PowerShell modules are included in the WAP portal.
    Any additional module can be imported. Any existing module can be deleted by buttons
    available in the bottom pane:![Adding and managing assets](img/00258.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **ADD SETTING** to add a new asset:![Adding and managing assets](img/00259.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the type of asset to be added and proceed further.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To create a connection asset, select a connection and provide connection details
    including connection type, name, hostname and credentials. By default, WAP supports
    the following connection types:![Adding and managing assets](img/00260.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add any credentials by selecting add credential on the add service page. Provide
    the credentials type and credentials friendly name and a username, password, or
    the SSL certificate as applicable:![Adding and managing assets](img/00261.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add any variable by selecting add variable on the add service page provide the
    variable type, variable name, and value with an optional encryption:![Adding and
    managing assets](img/00262.jpeg)![Adding and managing assets](img/00263.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add any schedule by selecting add schedule on the add service page. Provide
    a schedule name and schedule values including a type (one time or daily) and start
    time:![Adding and managing assets](img/00264.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The created assets will now be visible in the **ASSETS** tab. They are ready
    for usage by the runbooks.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clicking on any asset will display its configurations; for example, clicking
    on a module will display the module information along with PowerShell cmdlets.
    It will show the following screenshot:![Adding and managing assets](img/00265.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Additional assets can be created in a similar manner.
  prefs: []
  type: TYPE_NORMAL
- en: Dealing with SMA runbooks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: SMA runbooks consist of PowerShell workflows, which include PowerShell cmdlets
    to perform specified tasks in an automated manner.
  prefs: []
  type: TYPE_NORMAL
- en: The Runbooks can be managed from the **RUNBOOKS** tab under the **automation**
    workspace WAP portal. Service providers can write PowerShell workflows and runbooks
    anywhere, and then import them in the WAP SMA.
  prefs: []
  type: TYPE_NORMAL
- en: 'The **RUNBOOKS** tab in the **automation** workspace provides functionality
    to perform the following basic operations on runbooks:'
  prefs: []
  type: TYPE_NORMAL
- en: Start the execution of any runbook
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Import a runbook to WAP (PS1 file)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Export any existing runbook to the PS1 file on a local system
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Delete any existing runbook from WAP
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note that there is no GUI (drag and drop item) available for authoring runbooks
    such as System Center Orchestrator (SCO); it must be written manually in PowerShell
    workflows.
  prefs: []
  type: TYPE_NORMAL
- en: Sample runbooks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Windows Azure Pack along with SMA by default provides a few samples of runbooks
    that can be used and leveraged as a reference to author new runbooks.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following steps outline the process to view and manage sample runbooks:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the WAP management portal for administrators.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Browse the **automation** workspace and the **RUNBOOKS** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sample runbooks will be displayed. Click on any sample runbook to see its workflows
    and other configurations.![Sample runbooks](img/00266.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Any runbook can be started, imported, exported, and deleted using the buttons
    available in the bottom pane.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Creating a runbook
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following steps are required to create a runbook:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the WAP management portal for administrators.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Browse the **automation** workspace and the **RUNBOOKS** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **NEW** button, select **RUNBOOK** and **QUICK CREATE**:![Creating
    a runbook](img/00267.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The newly created runbook will now be listed under the **RUNBOOKS** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **RUNBOOK NAME** to perform additional operations on the runbook including
    authoring and scheduling.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Authoring a runbook
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Authoring a runbook involves writing PowerShell workflows for the runbook and
    managing runbook versions and modifications throughout the lifecycle.
  prefs: []
  type: TYPE_NORMAL
- en: 'Multiple tools can be leveraged by service providers to author a runbook:'
  prefs: []
  type: TYPE_NORMAL
- en: Windows PowerShell ISE
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Visual Studio IDE
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows Azure Pack management portal
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Any other source control or programming tool
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While authoring runbooks in the Windows Azure Pack administrator portal, it
    can either be in the draft or published version. A published version is used by
    worker servers to execute the workload while initiating a runbook.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following outlines the steps required to author a runbook in the Windows
    Azure Pack portal:'
  prefs: []
  type: TYPE_NORMAL
- en: First, create runbook by following instructions given in the previous topic.
  prefs: []
  type: TYPE_NORMAL
- en: Select the newly created runbook and browse the **AUTHOR** workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **DRAFT**, and then the workflow writer will be available:![Authoring
    a runbook](img/00268.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Follow the standard Microsoft PowerShell workflow writing guidelines to write
    the workflow for the runbook. See Microsoft documentation at [https://azure.microsoft.com/en-in/documentation/articles/automation-powershell-workflow/](https://azure.microsoft.com/en-in/documentation/articles/automation-powershell-workflow/)
    to learn more about writing PowerShell workflows.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The bottom pane buttons can be leveraged to add additional functionality into
    the runbook, such as adding another runbook (nesting) or adding any activity or
    assets.![Authoring a runbook](img/00269.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Clicking on **SAVE** will save the current version of the draft. Publishing
    will make this draft available for execution by SMA workers.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using assets in runbook PowerShell workflows
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'SMA assets declared at global level can be used inside workflows by the following
    syntax:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Connection**: The following shows an example where connection declared in
    assets is being accessed in the PowerShell workflow:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '**Credentials**: The following PowerShell shows an example where credentials
    declared in assets are being accessed in the PowerShell workflow:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '**Variable**: The following PowerShell shows an example where a variable declared
    in assets is being accessed in the PowerShell workflow:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Scheduling a runbook
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Scheduling a runbook will automatically start executing the runbook as per the
    configured date, time, and frequency value. Schedules configured in assets can
    be attached with runbooks; custom schedules can also be created.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following steps are required to author a runbook:'
  prefs: []
  type: TYPE_NORMAL
- en: Select the runbook to be scheduled in the WAP portal and browse the **SCHEDULE**
    tab:![Scheduling a runbook](img/00270.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on an existing schedule to the leverage schedule created in global assets.
    Click on **ADD A NEW SCHEDULE** to add a new schedule for this runbook.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a schedule name and type (one time/daily) along with date and time to
    configure a new schedule.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Finish** to save the schedule configured for the runbook.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Dealing with jobs
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Whenever a runbook execution is started, a corresponding job is created and
    assigned to a worker role for execution. The worker role stores jobs during runtime
    in a sandbox.
  prefs: []
  type: TYPE_NORMAL
- en: Using the Windows Azure pack portal **automation** workspace, we can see the
    status of jobs in real time and for historical data. Jobs can also be stopped,
    suspended, and resumed.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following outlines the steps for viewing and dealing with runbooks:'
  prefs: []
  type: TYPE_NORMAL
- en: The **RUNBOOKS** tab under the **automation** workspace displays the status
    for all runbooks in the WAP cloud:![Dealing with jobs](img/00271.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A job status per runbook can be accessed under the **JOBS** tab for each runbook
    page. Select the job status and timelines to see jobs status as per selected parameters.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Configuring the runbook logging
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Windows Azure Pack provides multiple choices to cloud administrators for configuring
    logging levels and types for a runbook. Administrators can choose to enable or
    disable the following level of logging per runbook:'
  prefs: []
  type: TYPE_NORMAL
- en: Log Debug Records
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Log Verbose Records
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Log Progress Records
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following steps are required to configure logging options for a runbook:'
  prefs: []
  type: TYPE_NORMAL
- en: Select the runbook and browse the configure tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Scroll down to the logging space and configure settings as per requirement;
    click on **SAVE** to save the changed configurations:![Configuring the runbook
    logging](img/00272.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Linking runbooks with VM cloud actions
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Linking runbooks with VM cloud operations enable executing a specified runbook
    only when a specific event or action occurs. Linking a runbook with actions helps
    in getting the required operations performed on objects as soon the objects gets
    created instead of waiting until the next runbook schedule.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following steps are required to link the runbook with an action in VM clouds:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the WAP portal for administrators and browse the **vm clouds** workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **AUTOMATION** tab:![Linking runbooks with VM cloud actions](img/00273.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **LINK AN ACTION WITH A RUNBOOK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'WAP automation supports the following objects of VM clouds to link a runbook
    on the specific action:'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '![Linking runbooks with VM cloud actions](img/00274.jpeg)'
  prefs:
  - PREF_IND
  type: TYPE_IMG
- en: Select **OBJECT**, **ACTION** and **RUNBOOK** to configure:![Linking runbooks
    with VM cloud actions](img/00275.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Click** on **finish** to link the runbook with the selected action.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enabling ADFS authentication for WAP portals
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Windows Azure Pack standard installation includes authentication sites for both
    admin and tenant portals to leverage their default authentication mechanisms.
    Active directory provides authentication services worldwide. We can leverage AD
    features and capabilities by enabling our WAP portals to use ADFS for authentication.
  prefs: []
  type: TYPE_NORMAL
- en: This can enable service providers to authenticate tenant users against the tenant's
    own active directory hosted inside their on-premises infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: ADFS authentication architecture and overview – admin and tenant portals
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, Windows Azure Pack portals are configured to use the following authentication
    mechanisms.
  prefs: []
  type: TYPE_NORMAL
- en: 'The WAP management portal for administrators: Windows authentication'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The WAP management portal for tenants—ASP.NET provider
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Active Directory Federations Services are used to simplify login and enable
    true SSO (single sign on) capabilities across the applications and services hosted
    anywhere (on-premises/public clouds). Using ADFS for authentication in Windows
    Azure Pack, cloud providers can secure and simplify authentication mechanisms
    for admins portals. For tenant portals, it will help in enabling single sign on
    for tenant users, leveraging a tenant''s own active directory for authentication.
    The following diagram explains the authentication architecture for Windows Azure
    Pack with ADFS:'
  prefs: []
  type: TYPE_NORMAL
- en: '![ADFS authentication architecture and overview – admin and tenant portals](img/00276.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Implementing ADFS for the Windows Azure Pack cloud involves the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Setting up ADFS farms (both cloud provides and tenants)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding the tenant's ADFS as a claim provider to the cloud provider's ADFS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding cloud provider's ADFS as a relying party to tenant's ADFS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding the WAP portal (tenant/admin) as a relying party to the cloud provider's
    ADFS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Adding the cloud provider's ADFS as a claim provider to the WAP tenant portal
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Testing and verifying the configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up ADFS farms and configuring relationship between a provider's and
    tenant's ADFS service isn't covered in this book. See Microsoft ADFS documentation
    at [https://technet.microsoft.com/en-in/windowsserver/dd448613.aspx](https://technet.microsoft.com/en-in/windowsserver/dd448613.aspx)
    to know more about ADFS.
  prefs: []
  type: TYPE_NORMAL
- en: Adding the WAP portal as a relying party
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following steps are required to add WAP portals as a relying party to the
    cloud provider''s ADFS service. See [Chapter 3](part0033_split_000.html#VF2I1-b479cf466c26404ca54119871a9b2715
    "Chapter 3. Installing and Configuring Windows Azure Pack"), *Installing and Configuring
    Windows Azure Pack*, to learn more about the Windows Azure Pack architecture and
    role of these components:'
  prefs: []
  type: TYPE_NORMAL
- en: Log into the ADFS server and open the ADFS console from the server manager.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Add** relaying party trust.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the federation metadata URL of the WAP server in the given format, that
    is, `https://manage.wapcloud.com/federationmetadata/2007-06/federationmetadata.xml`:![Adding
    the WAP portal as a relying party](img/00277.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Specify **Display Name** and optional note.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enable or disable the multi-factor authentication as per the service provider's
    decision.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Permit** to allow all users to access this relying party.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On the **Finish** page, select the checkbox for **Edit claims rules**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add the rule with the setting called **Send LDAP Attributes as Claims**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a claim rule name and select **Active Directory** as **Attribute store**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Map the User-Principal-Name LDAP attribute to the UPN called **Outgoing claim
    type**.![Adding the WAP portal as a relying party](img/00278.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add one more rule with the same configuration except changing the binding by
    mapping MapToken-Groups—Qualified by the domain name LDAP attribute to the group
    Outgoing claim type.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add another rule with Passthrough or Filter an Incoming Claim rule template.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide a claim rule name and select **UPN** in the incoming claim type.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Add another rule to Passthrough or Filter an Incoming Claim template with Provide
    claim rule name. Select **Group** in the incoming claim type.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Verify the created rules and proceed to finish the configuration wizard.![Adding
    the WAP portal as a relying party](img/00279.jpeg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Post this run to finish ADFS configurations along with the WAP website identifier:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'To get the identifier, run the following PowerShell. Provide the WAP portal
    party name in cmdlet:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Configuring WAP websites to use ADFS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following steps are required to configure WAP websites to use ADFS as the
    authentication site. See [Chapter 3](part0033_split_000.html#VF2I1-b479cf466c26404ca54119871a9b2715
    "Chapter 3. Installing and Configuring Windows Azure Pack"), *Installing and Configuring
    Windows Azure Pack*, to learn more about configuring WAP portals:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Execute the following PowerShell on the Windows Azure Pack server to configure
    tenant websites to use ADFS. Tenants can be replaced with an admin to configure
    an admin portal:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Execute the following PowerShell on the Windows Azure Pack server to configure
    the Identity Provider to use ADFS:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Execute the following PowerShell on the Windows Azure Pack server to configure
    the selected user as the administrator of WAP:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Post successful configuration, ADFS authentication can be verified by opening
    the WAP portal. The portal will automatically redirect the authentication to the
    ADFS page.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At the end of this chapter, we have completed building essential services for
    our WAP cloud solution. You learned about building a SMA solution for automating
    the WAP cloud resource provisioning, monitoring, and management. You learned about
    planning, installing, and configuring SMA. You learned about SMA assets and runbooks
    including authoring and managing runbooks.
  prefs: []
  type: TYPE_NORMAL
- en: We also covered using authentication capabilities of ADFS with Windows Azure
    Pack for admin and tenant portal authentication.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will look at the extensible architecture of the Windows
    Azure Pack cloud by learning about partner and third-party developed products
    for extending WAP capabilities and features.
  prefs: []
  type: TYPE_NORMAL
