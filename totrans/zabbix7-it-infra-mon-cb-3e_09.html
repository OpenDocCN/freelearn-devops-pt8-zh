<html><head></head><body>
<div id="_idContainer589" class="calibre2">
<h1 class="chapter-number" id="_idParaDest-297"><a id="_idTextAnchor1664" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1.1">9</span></h1>
<h1 id="_idParaDest-298" class="calibre5"><a id="_idTextAnchor1665" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.2.1">Integrating Zabbix with External Services</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.3.1">In this chapter, we are going to set up some of the useful external service integrations that Zabbix has to offer. </span><span class="kobospan" id="kobo.3.2">We can use these external services to notify our Zabbix users of </span><span><span class="kobospan" id="kobo.4.1">ongoing problems.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.5.1">We will start by learning how to set up in-company chat applications such as Slack and Microsoft Teams. </span><span class="kobospan" id="kobo.5.2">Then, we will learn how to use a personal chat application such as Telegram before learning how to integrate Atlassian Opsgenie for even more </span><span><span class="kobospan" id="kobo.6.1">extensive alerting.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.7.1">Once you’ve completed these recipes, you will be able to effectively integrate certain services with Zabbix. </span><span class="kobospan" id="kobo.7.2">This is a good starting point for working with external services in general and the easiest way to set up Slack, Teams, Opsgenie, </span><span><span class="kobospan" id="kobo.8.1">and Telegram.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.9.1">In this chapter, we will cover the </span><span><span class="kobospan" id="kobo.10.1">following recipes:</span></span></p>
<ul class="calibre14">
<li class="calibre15"><span class="kobospan" id="kobo.11.1">Setting up Slack alerting </span><span><span class="kobospan" id="kobo.12.1">with Zabbix</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.13.1">Setting up Microsoft Teams alerting </span><span><span class="kobospan" id="kobo.14.1">with Zabbix</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.15.1">Using Telegram bots </span><span><span class="kobospan" id="kobo.16.1">with Zabbix</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.17.1">Integrating Atlassian Opsgenie </span><span><span class="kobospan" id="kobo.18.1">with Zabbix</span></span></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.19.1">Let’s </span><span><span class="kobospan" id="kobo.20.1">get started!</span></span></p>
<h1 id="_idParaDest-299" class="calibre5"><a id="_idTextAnchor1666" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1667" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.21.1">Technical requirements</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.22.1">For this chapter, we are going to need our Zabbix server, preferably how we set it up throughout this book, though any Zabbix 7 server with some alerts on it </span><span><span class="kobospan" id="kobo.23.1">will do.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.24.1">We will also need access to a few external services, </span><span><span class="kobospan" id="kobo.25.1">as follows:</span></span></p>
<ul class="calibre14">
<li class="calibre15"><span class="kobospan" id="kobo.26.1">Slack (free, to </span><span><span class="kobospan" id="kobo.27.1">an extent):</span></span><p class="calibre3"><a href="https://slack.com/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.28.1">https://slack.com/</span></span></a></p></li>
<li class="calibre15"><span class="kobospan" id="kobo.29.1">Microsoft Teams (free, to </span><span><span class="kobospan" id="kobo.30.1">an extent):</span></span><p class="calibre3"><a href="https://www.microsoft.com/microsoft-teams" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.31.1">https://www.microsoft.com/microsoft-teams</span></span></a></p></li>
<li class="calibre15"><span class="kobospan" id="kobo.32.1">Opsgenie (free, to </span><span><span class="kobospan" id="kobo.33.1">an extent):</span></span><p class="calibre3"><a href="https://www.atlassian.com/software/opsgenie/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.34.1">https://www.atlassian.com/software/opsgenie/</span></span></a></p></li>
<li class="calibre15"><span><span class="kobospan" id="kobo.35.1">Telegram (free):</span></span><p class="calibre3"><a href="https://telegram.org/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.36.1">https://telegram.org/</span></span></a></p></li>
</ul>
<p class="calibre3"><span class="kobospan" id="kobo.37.1">We will not cover how to set up the services themselves, only how to integrate them with Zabbix. </span><span class="kobospan" id="kobo.37.2">Make sure you have set up the required service by following a guide and that you have some knowledge of the services </span><span><span class="kobospan" id="kobo.38.1">in general.</span></span></p>
<h1 id="_idParaDest-300" class="calibre5"><a id="_idTextAnchor1668" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1669" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.39.1">Setting up Slack alerting with Zabbix</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.40.1">Slack is a </span><a id="_idTextAnchor1670" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.41.1">widely </span><a id="_idIndexMarker685" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.42.1">used tool for easy text messaging, voice/video </span><a id="_idIndexMarker686" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.43.1">chat, and collaboration. </span><span class="kobospan" id="kobo.43.2">In this recipe, we will learn how to use Zabbix Slack integration to send our Zabbi</span><a id="_idTextAnchor1671" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.44.1">x problem information to Slack so that we can gain a good overview </span><span><span class="kobospan" id="kobo.45.1">of issues</span><a id="_idTextAnchor1672" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1673" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.46.1">.</span></span></p>
<h2 id="_idParaDest-301" class="calibre7"><a id="_idTextAnchor1674" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.47.1">Getting ready</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.48.1">Make sure y</span><a id="_idTextAnchor1675" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.49.1">ou have Slack set up. </span><span class="kobospan" id="kobo.49.2">You can go to </span><a href="https://slack.com/intl/en-in/" class="pcalibre calibre6 pcalibre1"><span class="kobospan" id="kobo.50.1">https://slack.com/intl/en-in/</span></a><span class="kobospan" id="kobo.51.1"> a</span><a id="_idTextAnchor1676" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.52.1">nd set it up for free there. </span><span class="kobospan" id="kobo.52.2">We will also need a Zabbix server with some </span><span><span class="kobospan" id="kobo.53.1">active problems</span><a id="_idTextAnchor1677" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1678" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.54.1">.</span></span></p>
<h2 id="_idParaDest-302" class="calibre7"><a id="_idTextAnchor1679" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.55.1">How to do it…</span></h2>
<ol class="calibre16">
<li class="calibre15"><span class="kobospan" id="kobo.56.1">Once you have set up and opened Slack, you should see the </span><span><span class="kobospan" id="kobo.57.1">following page:</span></span><a id="_idTextAnchor1680" class="pcalibre calibre6 pcalibre1"/></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer511">
<span class="kobospan" id="kobo.58.1"><img alt="Figure 9.1 – Slack default page" src="image/B19803_09_01.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.59.1">Figure 9.1 – Slack default page</span></p>
<ol class="calibre16">
<li value="2" class="calibre15"><span class="kobospan" id="kobo.60.1">Let’s</span><a id="_idTextAnchor1681" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.61.1"> create a </span><a id="_idIndexMarker687" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.62.1">new </span><a id="_idIndexMarker688" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.63.1">channel for our Zabb</span><a id="_idTextAnchor1682" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.64.1">ix notifications by clicking the </span><strong class="bold"><span class="kobospan" id="kobo.65.1">+ Add channels</span></strong><span class="kobospan" id="kobo.66.1"> button. </span><span class="kobospan" id="kobo.66.2">Then, from the dropdown that appears, click </span><strong class="bold"><span class="kobospan" id="kobo.67.1">Create a </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.68.1">new channel</span><a id="_idTextAnchor1683" class="pcalibre calibre6 pcalibre1"/></strong></span><span><span class="kobospan" id="kobo.69.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer512">
<span class="kobospan" id="kobo.70.1"><img alt="Figure 9.2 – Slack, Create a channel window" src="image/B19803_09_02.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.71.1">Figure 9.2 – Slack, Create a channel window</span></p>
<ol class="calibre16">
<li value="3" class="calibre15"><span class="kobospan" id="kobo.72.1">Click the </span><strong class="bold"><span class="kobospan" id="kobo.73.1">Next</span></strong><span class="kobospan" id="kobo.74.1"> button. </span><span class="kobospan" id="kobo.74.2">Then, on the next window, click the </span><strong class="bold"><span class="kobospan" id="kobo.75.1">Create</span></strong><span class="kobospan" id="kobo.76.1"> button t</span><a id="_idTextAnchor1684" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.77.1">o make this a public (or </span><span><span class="kobospan" id="kobo.78.1">private) channel:</span></span><a id="_idTextAnchor1685" class="pcalibre calibre6 pcalibre1"/></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer513">
<span class="kobospan" id="kobo.79.1"><img alt="Figure 9.3 – Slack, setting the new channel visibility" src="image/B19803_09_03.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.80.1">Figure 9.3 – Slack, setting the new channel visibility</span></p>
<ol class="calibre16">
<li value="4" class="calibre15"><span class="kobospan" id="kobo.81.1">You’ll be </span><a id="_idIndexMarker689" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.82.1">presented </span><a id="_idIndexMarker690" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.83.1">with one more step to add either specific or all people within your Slack to the new channel. </span><span class="kobospan" id="kobo.83.2">In my test, I’ll add everyone, so I’ll just click </span><span><span class="kobospan" id="kobo.84.1">on </span></span><span><strong class="bold"><span class="kobospan" id="kobo.85.1">Done</span></strong></span><span><span class="kobospan" id="kobo.86.1">.</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer514">
<span class="kobospan" id="kobo.87.1"><img alt="Figure 9.4 – Slack, Add people window" src="image/B19803_09_04.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.88.1">Figure 9.4 – Slack, Add people window</span></p>
<ol class="calibre16">
<li value="5" class="calibre15"><span class="kobospan" id="kobo.89.1">Now, navigat</span><a id="_idTextAnchor1686" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.90.1">e to the following link to create a Slack bot for working with </span><span><span class="kobospan" id="kobo.91.1">Zabbix: </span></span><a href="https://api.slack.com/apps" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.92.1">https://api.slack.com/apps</span></span></a><span><span class="kobospan" id="kobo.93.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.94.1">You will see the </span><strong class="bold"><span class="kobospan" id="kobo.95.1">Create New App</span></strong><span class="kobospan" id="kobo.96.1"> option on this page. </span><span class="kobospan" id="kobo.96.2">Click on it, which brings </span><span><span class="kobospan" id="kobo.97.1">us here:</span></span><a id="_idTextAnchor1687" class="pcalibre calibre6 pcalibre1"/></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer515">
<span class="kobospan" id="kobo.98.1"><img alt="Figure 9.5 – Slack, API Create an app page" src="image/B19803_09_05.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.99.1">Figure 9.5 – Slack, API Create an app page</span></p>
<ol class="calibre16">
<li value="7" class="calibre15"><span class="kobospan" id="kobo.100.1">After</span><a id="_idTextAnchor1688" class="pcalibre calibre6 pcalibre1"/> <a id="_idIndexMarker691" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.101.1">clicking </span><a id="_idIndexMarker692" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.102.1">the </span><strong class="bold"><span class="kobospan" id="kobo.103.1">Create New App</span></strong><span class="kobospan" id="kobo.104.1"> button, </span><a id="_idTextAnchor1689" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.105.1">we have to click on </span><span><strong class="bold"><span class="kobospan" id="kobo.106.1">From scratch</span></strong></span><span><span class="kobospan" id="kobo.107.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.108.1">Then, we’ll see a pop-up window where we can set up our new </span><span><span class="kobospan" id="kobo.109.1">Slack bot</span><a id="_idTextAnchor1690" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.110.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer516">
<span class="kobospan" id="kobo.111.1"><img alt="Figure 9.6 – Slack, API Name app &amp; choose workspace window" src="image/B19803_09_06.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.112.1">Figure 9.6 – Slack, API Name app &amp; choose workspace window</span></p>
<ol class="calibre16">
<li value="9" class="calibre15"><span class="kobospan" id="kobo.113.1">Clic</span><a id="_idTextAnchor1691" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.114.1">k</span><a id="_idIndexMarker693" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.115.1"> on </span><strong class="bold"><span class="kobospan" id="kobo.116.1">Create App</span></strong><span class="kobospan" id="kobo.117.1">. </span><span class="kobospan" id="kobo.117.2">This will take you to </span><a id="_idIndexMarker694" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.118.1">the </span><strong class="bold"><span class="kobospan" id="kobo.119.1">Basic Information</span></strong><span class="kobospan" id="kobo.120.1"> page. </span><span class="kobospan" id="kobo.120.2">On this page, click on </span><strong class="bold"><span class="kobospan" id="kobo.121.1">Bots</span></strong><span class="kobospan" id="kobo.122.1">,</span><a id="_idTextAnchor1692" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.123.1"> as highlighted in the </span><span><span class="kobospan" id="kobo.124.1">following screensho</span><a id="_idTextAnchor1693" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.125.1">t:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer517">
<span class="kobospan" id="kobo.126.1"><img alt="Figure 9.7 – Slack, API Add features and functionality page" src="image/B19803_09_07.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.127.1">Figure 9.7 – Slack, API Add features and functionality page</span></p>
<ol class="calibre16">
<li value="10" class="calibre15"><span class="kobospan" id="kobo.128.1">T</span><a id="_idTextAnchor1694" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.129.1">his will</span><a id="_idIndexMarker695" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.130.1"> take </span><a id="_idIndexMarker696" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.131.1">you to the new app’s </span><strong class="bold"><span class="kobospan" id="kobo.132.1">App Home</span></strong><span class="kobospan" id="kobo.133.1"> page. </span><span class="kobospan" id="kobo.133.2">On the left-hand side of the page, click the </span><strong class="bold"><span class="kobospan" id="kobo.134.1">OAuth &amp; </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.135.1">Permissions</span></strong></span><span><span class="kobospan" id="kobo.136.1"> option.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.137.1">Sc</span><a id="_idTextAnchor1695" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.138.1">roll down to </span><strong class="bold"><span class="kobospan" id="kobo.139.1">Scopes</span></strong><span class="kobospan" id="kobo.140.1"> and click on </span><strong class="bold"><span class="kobospan" id="kobo.141.1">Add an </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.142.1">OAuth Sco</span><a id="_idTextAnchor1696" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.143.1">pe</span></strong></span><span><span class="kobospan" id="kobo.144.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer518">
<span class="kobospan" id="kobo.145.1"><img alt="Figure 9.8 – Slack, API scopes" src="image/B19803_09_08.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.146.1">Figure 9.8 – Slack, API scopes</span></p>
<ol class="calibre16">
<li value="12" class="calibre15"><span class="kobospan" id="kobo.147.1">From the </span><a id="_idIndexMarker697" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.148.1">drop-down</span><a id="_idIndexMarker698" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.149.1"> menu, click on </span><strong class="bold"><span class="kobospan" id="kobo.150.1">chat:write</span></strong><span class="kobospan" id="kobo.151.1"> to allow our bot to write to </span><span><span class="kobospan" id="kobo.152.1">a chan</span><a id="_idTextAnchor1697" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.153.1">nel:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer519">
<span class="kobospan" id="kobo.154.1"><img alt="Figure 9.9 – Slack, API Add an OAuth Scope dropdow﻿n" src="image/B19803_09_09.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.155.1">Figure 9.9 – Slack, API Add an OAuth Scope dropdow</span><a id="_idTextAnchor1698" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.156.1">n</span></p>
<ol class="calibre16">
<li value="13" class="calibre15"><span class="kobospan" id="kobo.157.1">Do the same for </span><strong class="bold"><span class="kobospan" id="kobo.158.1">im:write</span></strong> <span><span class="kobospan" id="kobo.159.1">and </span></span><span><strong class="bold"><span class="kobospan" id="kobo.160.1">groups:write</span></strong></span><span><span class="kobospan" id="kobo.161.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.162.1">Sc</span><a id="_idTextAnchor1699" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.163.1">roll back up and click on the </span><strong class="bold"><span class="kobospan" id="kobo.164.1">Install to Workspace</span></strong><span class="kobospan" id="kobo.165.1"> button to finish setting up </span><span><span class="kobospan" id="kobo.166.1">this a</span><a id="_idTextAnchor1700" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.167.1">pp:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer520">
<span class="kobospan" id="kobo.168.1"><img alt="Figure 9.10 – Slack, API Install to Workspace button" src="image/B19803_09_10.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.169.1">Figure 9.10 – Slack, API Install to Workspace button</span></p>
<ol class="calibre16">
<li value="15" class="calibre15"><span class="kobospan" id="kobo.170.1">Next, you will</span><a id="_idIndexMarker699" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.171.1"> see </span><a id="_idIndexMarker700" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.172.1">a pop-up message. </span><span class="kobospan" id="kobo.172.2">Click the green </span><strong class="bold"><span class="kobospan" id="kobo.173.1">Allow</span></strong><span class="kobospan" id="kobo.174.1"> button </span><span><span class="kobospan" id="kobo.175.1">that appears.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.176.1">After clicking </span><strong class="bold"><span class="kobospan" id="kobo.177.1">Allow</span></strong><span class="kobospan" id="kobo.178.1">, you will see your new token. </span><span class="kobospan" id="kobo.178.2">Copy the token by clicking the </span><span><strong class="bold"><span class="kobospan" id="kobo.179.1">Copy</span></strong></span><span><span class="kobospan" id="kobo.180.1"> but</span><a id="_idTextAnchor1701" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.181.1">ton:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer521">
<span class="kobospan" id="kobo.182.1"><img alt="Figure 9.11 – Slack, API Our new Bot User OAuth Token" src="image/B19803_09_11.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.183.1">Figure 9.11 – Slack, API Our new Bot User OAuth Token</span></p>
<ol class="calibre16">
<li value="17" class="calibre15"><span class="kobospan" id="kobo.184.1">Lastly,</span><a id="_idTextAnchor1702" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.185.1"> add your bot to the </span><strong class="bold"><span class="kobospan" id="kobo.186.1"># zabbix-notifications</span></strong><span class="kobospan" id="kobo.187.1"> cha</span><a id="_idTextAnchor1703" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.188.1">nnel by going back to your Slack channel, clicking on the members in the top-right corner, and </span><span><span class="kobospan" id="kobo.189.1">selecting </span></span><span><strong class="bold"><span class="kobospan" id="kobo.190.1">Integratio</span><a id="_idTextAnchor1704" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.191.1">ns</span></strong></span><span><span class="kobospan" id="kobo.192.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer522">
<span class="kobospan" id="kobo.193.1"><img alt="Figure 9.12 – Slack, connect an app to a channel" src="image/B19803_09_12.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.194.1">Figure 9.12 – Slack, connect an app to a channel</span></p>
<ol class="calibre16">
<li value="18" class="calibre15"><span class="kobospan" id="kobo.195.1">Cl</span><a id="_idTextAnchor1705" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.196.1">ick</span><a id="_idIndexMarker701" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.197.1"> on </span><strong class="bold"><span class="kobospan" id="kobo.198.1">Add </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.199.1">an App</span></strong></span><span><span class="kobospan" id="kobo.200.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.201.1">S</span><a id="_idTextAnchor1706" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.202.1">imply </span><a id="_idIndexMarker702" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.203.1">add </span><strong class="bold"><span class="kobospan" id="kobo.204.1">Zabbix-Alert-Bot</span></strong><span class="kobospan" id="kobo.205.1"> by clicking the white </span><span><strong class="bold"><span class="kobospan" id="kobo.206.1">Add</span></strong></span><span><span class="kobospan" id="kobo.207.1"> but</span><a id="_idTextAnchor1707" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.208.1">ton:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer523">
<span class="kobospan" id="kobo.209.1"><img alt="Figure 9.13 – Slack, connect an app with a bot" src="image/B19803_09_13.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.210.1">Figure 9.13 – Slack, connect an app with a bot</span></p>
<ol class="calibre16">
<li value="20" class="calibre15"><span class="kobospan" id="kobo.211.1">Now, navigate to your Zabbix frontend and go to </span><strong class="bold"><span class="kobospan" id="kobo.212.1">Alerts</span></strong><span class="kobospan" id="kobo.213.1"> | </span><span><strong class="bold"><span class="kobospan" id="kobo.214.1">Media types</span></strong></span><span><span class="kobospan" id="kobo.215.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.216.1">Click on </span><strong class="bold"><span class="kobospan" id="kobo.217.1">Slack</span></strong><span class="kobospan" id="kobo.218.1"> to edit the Slack media type. </span><span class="kobospan" id="kobo.218.2">You will see a whole list of preconfig</span><a id="_idTextAnchor1708" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.219.1">ured parameters. </span><span class="kobospan" id="kobo.219.2">We need to p</span><a id="_idTextAnchor1709" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.220.1">aste our OAuth token into the </span><strong class="source-inline1"><span class="kobospan" id="kobo.221.1">bot_token</span></strong><span class="kobospan" id="kobo.222.1"> parameter, </span><span><span class="kobospan" id="kobo.223.1">like th</span><a id="_idTextAnchor1710" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.224.1">is:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer524">
<span class="kobospan" id="kobo.225.1"><img alt="Figure 9.14 – Zabbix, Slack media type Edit page" src="image/B19803_09_14.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.226.1">Figure 9.14 – Zabbix, Slack media type Edit page</span></p>
<ol class="calibre16">
<li value="22" class="calibre15"><span class="kobospan" id="kobo.227.1">Also, make</span><a id="_idIndexMarker703" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.228.1"> sure </span><strong class="bold"><span class="kobospan" id="kobo.229.1">Media type</span></strong><span class="kobospan" id="kobo.230.1"> is enabled by </span><a id="_idIndexMarker704" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.231.1">scrolling all the way to </span><span><span class="kobospan" id="kobo.232.1">the bottom.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.233.1">On the </span><strong class="bold"><span class="kobospan" id="kobo.234.1">Message templates</span></strong><span class="kobospan" id="kobo.235.1"> tab, we already have five message types configured. </span><span class="kobospan" id="kobo.235.2">We can edit these to our liking if we would like to </span><span><span class="kobospan" id="kobo.236.1">do</span><a id="_idTextAnchor1711" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.237.1"> so.</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer525">
<span class="kobospan" id="kobo.238.1"><img alt="Figure 9.15 – Zabbix, media type Slack Edit page for message types" src="image/B19803_09_15.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.239.1">Figure 9.15 – Zabbix, media type Slack Edit page for message types</span></p>
<ol class="calibre16">
<li value="24" class="calibre15"><span class="kobospan" id="kobo.240.1">You can now click on </span><strong class="bold"><span class="kobospan" id="kobo.241.1">Update</span></strong><span class="kobospan" id="kobo.242.1"> to save </span><span><span class="kobospan" id="kobo.243.1">the changes.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.244.1">Now, let’s create a new user group for our media types by navigating to </span><strong class="bold"><span class="kobospan" id="kobo.245.1">Users</span></strong><span class="kobospan" id="kobo.246.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.247.1">User groups</span></strong><span class="kobospan" id="kobo.248.1"> and clicking the </span><strong class="bold"><span class="kobospan" id="kobo.249.1">Create user group</span></strong><span class="kobospan" id="kobo.250.1"> button in the top-right corner. </span><span class="kobospan" id="kobo.250.2">Add the following </span><span><span class="kobospan" id="kobo.251.1">user gro</span><a id="_idTextAnchor1712" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.252.1">up:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer526">
<span class="kobospan" id="kobo.253.1"><img alt="Figure 9.16 – Zabbix, Create user group page for the External services group" src="image/B19803_09_16.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.254.1">Figure 9.16 – Zabbix, Create user group page for the External services group</span></p>
<ol class="calibre16">
<li value="26" class="calibre15"><span class="kobospan" id="kobo.255.1">C</span><a id="_idTextAnchor1713" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.256.1">lick on the </span><strong class="bold"><span class="kobospan" id="kobo.257.1">Host permissions</span></strong><span class="kobospan" id="kobo.258.1"> tab and then click on </span><strong class="bold"><span class="kobospan" id="kobo.259.1">Select</span></strong><span class="kobospan" id="kobo.260.1">. </span><span class="kobospan" id="kobo.260.2">Make sure that you select all </span><a id="_idIndexMarker705" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.261.1">the</span><a id="_idIndexMarker706" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.262.1"> groups and subgroups wi</span><a id="_idTextAnchor1714" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.263.1">th at least </span><strong class="bold"><span class="kobospan" id="kobo.264.1">Read</span></strong><span class="kobospan" id="kobo.265.1"> permissions, </span><span><span class="kobospan" id="kobo.266.1">like</span><a id="_idTextAnchor1715" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.267.1"> so:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer527">
<span class="kobospan" id="kobo.268.1"><img alt="Figure 9.17 – Zabbix, Create user group Host permissions for the External services group" src="image/B19803_09_17.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.269.1">Figure 9.17 – Zabbix, Create user group Host permissions for the External services group</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.270.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.271.1">When applying permissions to the user group, make sure that you only add the host groups you want to receive notifications from. </span><span class="kobospan" id="kobo.271.2">In my lab and even production environments, I add all groups, but sometimes, we want to filter the notifications down. </span><span class="kobospan" id="kobo.271.3">One way to do this is to use different user groups and users so that you only receive notifications from host groups in certain channels, although Actions are also a great way to do this. </span><span class="kobospan" id="kobo.271.4">For a more in-depth look into Zabbix user permissions and triggers, check out </span><a href="B19803_02.xhtml#_idTextAnchor171" class="pcalibre calibre6 pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.272.1">Chapter 2</span></em></span></a><span class="kobospan" id="kobo.273.1">, </span><em class="italic"><span class="kobospan" id="kobo.274.1">Getting Things Ready with Zabbix User Management</span></em><span class="kobospan" id="kobo.275.1">, and </span><a href="B19803_04.xhtml#_idTextAnchor601" class="pcalibre calibre6 pcalibre1"><span><em class="italic"><span class="kobospan" id="kobo.276.1">Chapter 4</span></em></span></a><span class="kobospan" id="kobo.277.1">, </span><em class="italic"><span class="kobospan" id="kobo.278.1">Working with Triggers and </span></em><span><em class="italic"><span class="kobospan" id="kobo.279.1">Alerts</span></em></span><span><span class="kobospan" id="kobo.280.1">, respectively.</span></span></p>
<ol class="calibre16">
<li value="27" class="calibre15"><span class="kobospan" id="kobo.281.1">Now, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.282.1">Add</span></strong><span class="kobospan" id="kobo.283.1"> button and finish creating this </span><span><span class="kobospan" id="kobo.284.1">user group.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.285.1">Next, navigate to </span><strong class="bold"><span class="kobospan" id="kobo.286.1">Users</span></strong><span class="kobospan" id="kobo.287.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.288.1">User</span></strong><span class="kobospan" id="kobo.289.1"> to create a Slack user. </span><span class="kobospan" id="kobo.289.2">Click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.290.1">Create user</span></strong><span class="kobospan" id="kobo.291.1"> button in the </span><span><span class="kobospan" id="kobo.292.1">top-right corner.</span></span><a id="_idTextAnchor1716" class="pcalibre calibre6 pcalibre1"/></li>
<li class="calibre15"><span class="kobospan" id="kobo.293.1">Add</span><a id="_idTextAnchor1717" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.294.1"> the</span><a id="_idIndexMarker707" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.295.1"> following </span><a id="_idIndexMarker708" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.296.1">user to your Zabbix server and make sure to give it a </span><span><span class="kobospan" id="kobo.297.1">secure pas</span><a id="_idTextAnchor1718" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.298.1">sword:</span></span></li>
</ol>
<p class="calibre3"> </p>
<div class="calibre2">
<div class="img---figure" id="_idContainer528">
<span class="kobospan" id="kobo.299.1"><img alt="Figure 9.18 – Zabbix Create user page for the Slack user" src="image/B19803_09_18.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.300.1">Figure 9.18 – Zabbix Create user page for the Slack user</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.301.1">Tip</span></p>
<p class="callout"><span class="kobospan" id="kobo.302.1">When creating users for things such as alerting or just API access, it is best practice to also add the user to a user group that disables the frontend access. </span><span class="kobospan" id="kobo.302.2">This is why we added the </span><strong class="bold"><span class="kobospan" id="kobo.303.1">No access to the frontend</span></strong> <span><span class="kobospan" id="kobo.304.1">group here.</span></span></p>
<ol class="calibre16">
<li value="30" class="calibre15"><span class="kobospan" id="kobo.305.1">Now, click on the </span><strong class="bold"><span class="kobospan" id="kobo.306.1">Media</span></strong><span class="kobospan" id="kobo.307.1"> tab and click on the underlined </span><strong class="bold"><span class="kobospan" id="kobo.308.1">Add</span></strong><span class="kobospan" id="kobo.309.1"> text. </span><span class="kobospan" id="kobo.309.2">We will add the following media to </span><span><span class="kobospan" id="kobo.310.1">this u</span><a id="_idTextAnchor1719" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.311.1">ser:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer529">
<span class="kobospan" id="kobo.312.1"><img alt="Figure 9.19 – Zabbix Create user media page for the Slack user﻿" src="image/B19803_09_19.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.313.1">Figure 9.19 – Zabbix Create user media page for the Slack user</span><a id="_idTextAnchor1720" class="pcalibre calibre6 pcalibre1"/></p>
<ol class="calibre16">
<li value="31" class="calibre15"><span class="kobospan" id="kobo.314.1">All users will </span><a id="_idIndexMarker709" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.315.1">also </span><a id="_idIndexMarker710" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.316.1">need a user role. </span><span class="kobospan" id="kobo.316.2">To add</span><a id="_idTextAnchor1721" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.317.1"> it, go to </span><strong class="bold"><span class="kobospan" id="kobo.318.1">Permissions</span></strong><span class="kobospan" id="kobo.319.1"> and add </span><span><span class="kobospan" id="kobo.320.1">the follo</span><a id="_idTextAnchor1722" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.321.1">wing:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer530">
<span class="kobospan" id="kobo.322.1"><img alt="Figure 9.20 – Zabbix Create user media page for the Slack user, Permissions" src="image/B19803_09_20.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.323.1">Figure 9.20 – Zabbix Create user media page for the Slack user, Permissions</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.324.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.325.1">For convenience, we are adding the user in the </span><strong class="bold"><span class="kobospan" id="kobo.326.1">Super admin</span></strong><span class="kobospan" id="kobo.327.1"> user role in the example. </span><span class="kobospan" id="kobo.327.2">This overrides the read-only permissions we assigned to the </span><strong class="bold"><span class="kobospan" id="kobo.328.1">External Services</span></strong><span class="kobospan" id="kobo.329.1"> user group. </span><span class="kobospan" id="kobo.329.2">For security reasons, you might want to limit the permissions by choosing a </span><strong class="bold"><span class="kobospan" id="kobo.330.1">User</span></strong><span class="kobospan" id="kobo.331.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.332.1">Admin</span></strong><span class="kobospan" id="kobo.333.1"> role for your user, which will adhere to the host group permissions we </span><span><span class="kobospan" id="kobo.334.1">assigned earlier.</span></span></p>
<ol class="calibre16">
<li value="32" class="calibre15"><span class="kobospan" id="kobo.335.1">Click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.336.1">Add</span></strong><span class="kobospan" id="kobo.337.1"> button at the bottom of the window and then on the blue </span><strong class="bold"><span class="kobospan" id="kobo.338.1">Add</span></strong><span class="kobospan" id="kobo.339.1"> button at the bottom of </span><span><span class="kobospan" id="kobo.340.1">the page.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.341.1">We will also need to add a macro to </span><strong class="bold"><span class="kobospan" id="kobo.342.1">Administration</span></strong><span class="kobospan" id="kobo.343.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.344.1">Macros</span></strong><span class="kobospan" id="kobo.345.1">. </span><span class="kobospan" id="kobo.345.2">Let’s add the following macro, which contains your </span><span><span class="kobospan" id="kobo.346.1">Zabbix </span><a id="_idTextAnchor1723" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.347.1">URL:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer531">
<span class="kobospan" id="kobo.348.1"><img alt="Figure 9.21 – Zabbix Administration | Macros page with Zabbix URL" src="image/B19803_09_21.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.349.1">Figure 9.21 – Zabbix Administration | Macros page with Zabbix URL</span></p>
<ol class="calibre16">
<li value="34" class="calibre15"><span class="kobospan" id="kobo.350.1">Click on the blue </span><span><strong class="bold"><span class="kobospan" id="kobo.351.1">Update</span></strong></span><span><span class="kobospan" id="kobo.352.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.353.1">Las</span><a id="_idTextAnchor1724" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.354.1">t but </span><a id="_idIndexMarker711" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.355.1">not</span><a id="_idIndexMarker712" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.356.1"> least, go to </span><strong class="bold"><span class="kobospan" id="kobo.357.1">Alerts</span></strong><span class="kobospan" id="kobo.358.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.359.1">Actions</span></strong><span class="kobospan" id="kobo.360.1">, and on the </span><strong class="bold"><span class="kobospan" id="kobo.361.1">Trigger Actions</span></strong><span class="kobospan" id="kobo.362.1"> page, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.363.1">Create </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.364.1">action</span></strong></span><span><span class="kobospan" id="kobo.365.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.366.1">Use </span><strong class="source-inline1"><span class="kobospan" id="kobo.367.1">Notify external services</span></strong><span class="kobospan" id="kobo.368.1"> for the name of the action. </span><span class="kobospan" id="kobo.368.2">We won’t set up any conditions for this example, but it’s recommended to do so in production environments. </span><span class="kobospan" id="kobo.368.3">If you do not set any conditions, all problems will be matched on </span><span><span class="kobospan" id="kobo.369.1">this action.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.370.1">Go to </span><strong class="bold"><span class="kobospan" id="kobo.371.1">Operations</span></strong><span class="kobospan" id="kobo.372.1"> and add the </span><span><span class="kobospan" id="kobo.373.1">following operat</span><a id="_idTextAnchor1725" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.374.1">ions:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer532">
<span class="kobospan" id="kobo.375.1"><img alt="Figure 9.22 – Zabbix, Create action operations page for Notify external services" src="image/B19803_09_22.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.376.1">Figure 9.22 – Zabbix, Create action operations page for Notify external services</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.377.1">Tip</span></p>
<p class="callout"><span class="kobospan" id="kobo.378.1">We could also use </span><strong class="bold"><span class="kobospan" id="kobo.379.1">Notify all involved</span></strong><span class="kobospan" id="kobo.380.1"> here to send a message to all the users involved in the </span><span><strong class="bold"><span class="kobospan" id="kobo.381.1">Operations</span></strong></span><span><span class="kobospan" id="kobo.382.1"> steps.</span></span></p>
<ol class="calibre16">
<li value="38" class="calibre15"><span class="kobospan" id="kobo.383.1">Now, </span><a id="_idTextAnchor1726" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.384.1">click on</span><a id="_idIndexMarker713" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.385.1"> the</span><a id="_idIndexMarker714" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.386.1"> blue </span><strong class="bold"><span class="kobospan" id="kobo.387.1">Add</span></strong><span class="kobospan" id="kobo.388.1"> button. </span><span class="kobospan" id="kobo.388.2">With that, you’re d</span><a id="_idTextAnchor1727" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.389.1">one. </span><span class="kobospan" id="kobo.389.2">You can now view any new problems (once they are generated by Zabbix) in your </span><span><span class="kobospan" id="kobo.390.1">Slack ch</span><a id="_idTextAnchor1728" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.391.1">annel:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer533">
<span class="kobospan" id="kobo.392.1"><img alt="Figure 9.23 – Slack notification sent from our Zabbix ﻿﻿server" src="image/B19803_09_23.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.393.1">Figure 9.23 – Slack notification sent from our Zabbix </span><a id="_idTextAnchor1729" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1730" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.394.1">server</span></p>
<h2 id="_idParaDest-303" class="calibre7"><a id="_idTextAnchor1731" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.395.1">How it works…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.396.1">Working with</span><a id="_idTextAnchor1732" class="pcalibre calibre6 pcalibre1"/><a id="_idIndexMarker715" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.397.1"> media</span><a id="_idIndexMarker716" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.398.1"> types might be something completely new to you, or you might have done it in the past. </span><span class="kobospan" id="kobo.398.2">Regardless, starting from Zabbix 5, the process has changed a bit. </span><span class="kobospan" id="kobo.398.3">In the days of Zabbix before Zabbix 5, we had to find the right media types online or make </span><span><span class="kobospan" id="kobo.399.1">them ourselves.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.400.1">Now, with Zabbix 7, we get a lot of preconfigured media types that are ready to be used. </span><span class="kobospan" id="kobo.400.2">We just need to do the necessary setup and fill in the right information, just like we just did for Slack. </span><span class="kobospan" id="kobo.400.3">We are then ready to send our problem-related information from Zabbix 7 to Slack every time a problem </span><span><span class="kobospan" id="kobo.401.1">is created.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.402.1">In this recipe, we told our Zabbix server to only send problem-related information with a severity of warning or higher to Slack, as shown in the </span><span><span class="kobospan" id="kobo.403.1">following scre</span><a id="_idTextAnchor1733" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.404.1">enshot:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer534">
<span class="kobospan" id="kobo.405.1"><img alt="Figure 9.24 – Zabbix Media page for the Slack user" src="image/9.24.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.406.1">Figure 9.24 – Zabbix Media page for the Slack user</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.407.1">We ca</span><a id="_idTextAnchor1734" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.408.1">n fully customize these severities, but we can also fully customize what severities we send to our </span><span><span class="kobospan" id="kobo.409.1">Slack setup.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.410.1">What we configured in this</span><a id="_idTextAnchor1735" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.411.1"> recipe </span><a id="_idIndexMarker717" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.412.1">is called a </span><strong class="bold"><span class="kobospan" id="kobo.413.1">Zabbix webhook</span></strong><span class="kobospan" id="kobo.414.1">. </span><span class="kobospan" id="kobo.414.2">A problem gets created in Zabbix and this problem matches our configured criteria, such as its severity. </span><span class="kobospan" id="kobo.414.3">Our action matches the problem, and the media type will then be executed by the </span><strong class="bold"><span class="kobospan" id="kobo.415.1">Action</span></strong><span class="kobospan" id="kobo.416.1"> operations and sent to the </span><span><span class="kobospan" id="kobo.417.1">configured</span><a id="_idTextAnchor1736" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.418.1"> links:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer535">
<span class="kobospan" id="kobo.419.1"><img alt="Figure 9.25 – Zabbix Slack integration diagram" src="image/B19803_09_25.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.420.1">Figure 9.25 – Zabbix Slack integration diagram</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.421.1">Zabbix sends the problem to the Slack API, and then the API processes the problem. </span><span class="kobospan" id="kobo.421.2">Then, the app </span><a id="_idIndexMarker718" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.422.1">we </span><a id="_idIndexMarker719" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.423.1">configured in Slack posts the problem to </span><span><span class="kobospan" id="kobo.424.1">our channel.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.425.1">Now that we’ve completed this recipe, we can view problems in Slack and keep an eye on our Zabbix alerts </span><span><span class="kobospan" id="kobo.426.1">fr</span><a id="_idTextAnchor1737" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1738" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.427.1">om there.</span></span></p>
<h2 id="_idParaDest-304" class="calibre7"><a id="_idTextAnchor1739" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.428.1">See also</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.429.1">If you want to do more with this integration, check out the Slack API documentation.</span><a id="_idTextAnchor1740" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.430.1"> There’s a lot we can do with this API, and we can build a number of awesome apps/bots for our</span><a id="_idIndexMarker720" class="pcalibre calibre6 pcalibre1"/> <span><span class="kobospan" id="kobo.431.1">channels: </span></span><a href="https://api.slack.com" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.432.1">https://api.s</span><span id="_idTextAnchor1741"/><span id="_idTextAnchor1742"/><span class="kobospan" id="kobo.433.1">lack.com</span></span></a><span><span class="kobospan" id="kobo.434.1">/</span></span><span><span class="kobospan" id="kobo.435.1">.</span></span></p>
<h1 id="_idParaDest-305" class="calibre5"><a id="_idTextAnchor1743" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.436.1">Setting up Microsoft Teams alerting with Zabbix</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.437.1">The previous</span><a id="_idIndexMarker721" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.438.1"> edition of this book was</span><a id="_idIndexMarker722" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.439.1"> written during the COVID-19 pandemic. </span><span class="kobospan" id="kobo.439.2">At that time, a lot of IT companies had been requested to make their employees work from home. </span><span class="kobospan" id="kobo.439.3">Due to this, we noticed a rise in the use of Microsoft Teams and similar applications. </span><span class="kobospan" id="kobo.439.4">Suddenly, a lot of companies started using Microsoft Teams and others to make working from home and collaboration easier. </span><span class="kobospan" id="kobo.439.5">Even after the pandemic ended, this is still the case, which is why we added </span><span><span class="kobospan" id="kobo.440.1">this recipe.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.441.1">Let’s lear</span><a id="_idTextAnchor1744" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.442.1">n how we can make working with Microsoft Teams even better by integrating our Zabbix alert</span><a id="_idTextAnchor1745" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1746" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.443.1">ing </span><span><span class="kobospan" id="kobo.444.1">into it.</span></span></p>
<h2 id="_idParaDest-306" class="calibre7"><a id="_idTextAnchor1747" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.445.1">Getting ready</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.446.1">We will need our Zabbix server to be able to create some problems for us. </span><span class="kobospan" id="kobo.446.2">For this, you can use </span><strong class="source-inline"><span class="kobospan" id="kobo.447.1">lar-book-rocky</span></strong><span class="kobospan" id="kobo.448.1"> from our previous chapters or any Zabbix server that </span><span><span class="kobospan" id="kobo.449.1">you prefer.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.450.1">We will also </span><a id="_idIndexMarker723" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.451.1">need</span><a id="_idIndexMarker724" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.452.1"> general Microsoft Teams knowledge and, of course, Microsoft Teams itself set up an</span><a id="_idTextAnchor1748" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1749" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.453.1">d ready </span><span><span class="kobospan" id="kobo.454.1">to go.</span></span></p>
<h2 id="_idParaDest-307" class="calibre7"><a id="_idTextAnchor1750" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.455.1">How to do it…</span></h2>
<ol class="calibre16">
<li class="calibre15"><span class="kobospan" id="kobo.456.1">Let’s start by opening our Microsoft Teams application on either Windows, macOS, or Linux and creating a new channel. </span><span class="kobospan" id="kobo.456.2">Go to </span><strong class="bold"><span class="kobospan" id="kobo.457.1">Teams</span></strong><span class="kobospan" id="kobo.458.1"> and click on the three dots (</span><strong class="bold"><span class="kobospan" id="kobo.459.1">…</span></strong><span class="kobospan" id="kobo.460.1">) next to your team name, as shown in the </span><span><span class="kobospan" id="kobo.461.1">followin</span><a id="_idTextAnchor1751" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.462.1">g screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer536">
<span class="kobospan" id="kobo.463.1"><img alt="Figure 9.26 – MS Teams, Add chan﻿nel option" src="image/B19803_09_26.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.464.1">Figure 9.26 – MS Teams, Add chan</span><a id="_idTextAnchor1752" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.465.1">nel option</span></p>
<ol class="calibre16">
<li value="2" class="calibre15"><span class="kobospan" id="kobo.466.1">In the </span><strong class="bold"><span class="kobospan" id="kobo.467.1">Add channel</span><a id="_idTextAnchor1753" class="pcalibre calibre6 pcalibre1"/></strong><span class="kobospan" id="kobo.468.1"> window, fill in the following information to create our </span><a id="_idTextAnchor1754" class="pcalibre calibre6 pcalibre1"/><span><span class="kobospan" id="kobo.469.1">new channel:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer537">
<span class="kobospan" id="kobo.470.1"><img alt="Figure 9.27 – MS Teams, Add channel window" src="image/B19803_09_27.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.471.1">Figure 9.27 – MS Teams, Add channel window</span></p>
<ol class="calibre16">
<li value="3" class="calibre15"><span class="kobospan" id="kobo.472.1">Now, click </span><a id="_idIndexMarker725" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.473.1">the</span><a id="_idIndexMarker726" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.474.1"> purple </span><strong class="bold"><span class="kobospan" id="kobo.475.1">Add</span></strong><span class="kobospan" id="kobo.476.1"> button to add the channel. </span><span class="kobospan" id="kobo.476.2">Upon doing this, we will be able to see our new channel in </span><span><span class="kobospan" id="kobo.477.1">the list.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.478.1">Click on the three dots (</span><strong class="bold"><span class="kobospan" id="kobo.479.1">…</span></strong><span class="kobospan" id="kobo.480.1">) next to your channel, as shown in the </span><span><span class="kobospan" id="kobo.481.1">followin</span><a id="_idTextAnchor1755" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.482.1">g screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer538">
<span class="kobospan" id="kobo.483.1"><img alt="Figure 9.28 – MS Teams, Connect﻿ors option" src="image/B19803_09_28.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.484.1">Figure 9.28 – MS Teams, Connect</span><a id="_idTextAnchor1756" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.485.1">ors option</span></p>
<ol class="calibre16">
<li value="5" class="calibre15"><span class="kobospan" id="kobo.486.1">We want</span><a id="_idIndexMarker727" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.487.1"> to</span><a id="_idIndexMarker728" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.488.1"> select the </span><strong class="bold"><span class="kobospan" id="kobo.489.1">Connectors</span></strong><span class="kobospan" id="kobo.490.1"> option from this drop-down menu. </span><span class="kobospan" id="kobo.490.2">This allows us to add our</span><a id="_idTextAnchor1757" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.491.1"> Microsoft Teams connector to </span><span><span class="kobospan" id="kobo.492.1">this channel.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.493.1">We are using the search field here to find the official </span><strong class="bold"><span class="kobospan" id="kobo.494.1">Zabbix </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.495.1">Webh</span><a id="_idTextAnchor1758" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.496.1">ook</span></strong></span><span><span class="kobospan" id="kobo.497.1"> connector:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer539">
<span class="kobospan" id="kobo.498.1"><img alt="Figure 9.29 – MS Teams, Add connectors window" src="image/B19803_09_29.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.499.1">Figure 9.29 – MS Teams, Add connectors window</span></p>
<ol class="calibre16">
<li value="7" class="calibre15"><span class="kobospan" id="kobo.500.1">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.501.1">Configure</span></strong><span class="kobospan" id="kobo.502.1"> button next to the </span><strong class="bold"><span class="kobospan" id="kobo.503.1">Zabbix Webhook</span></strong><span class="kobospan" id="kobo.504.1"> connector to add this connector to our channel. </span><span class="kobospan" id="kobo.504.2">This will open a pop-up window in which you need to copy the </span><a id="_idTextAnchor1759" class="pcalibre calibre6 pcalibre1"/><span><span class="kobospan" id="kobo.505.1">webhook URL.</span></span><div class="img---figure" id="_idContainer540"><span class="kobospan" id="kobo.506.1"><img alt="Figure 9.30 – MS Teams – Webhook U﻿RL" src="image/B19803_09_30.jpg" class="calibre4"/></span></div></li>
</ol>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.507.1">Figure 9.30 – MS Teams – Webhook U</span><a id="_idTextAnchor1760" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.508.1">RL</span></p>
<ol class="calibre16">
<li value="8" class="calibre15"><span class="kobospan" id="kobo.509.1">Now, click the </span><strong class="bold"><span class="kobospan" id="kobo.510.1">Save</span><a id="_idTextAnchor1761" class="pcalibre calibre6 pcalibre1"/></strong><span class="kobospan" id="kobo.511.1"> button. </span><span class="kobospan" id="kobo.511.2">Upon doing this, you can close the </span><span><span class="kobospan" id="kobo.512.1">pop-up window.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.513.1">Go to the</span><a id="_idIndexMarker729" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.514.1"> Zabbix </span><a id="_idIndexMarker730" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.515.1">frontend and navigate to </span><strong class="bold"><span class="kobospan" id="kobo.516.1">Alerts</span></strong><span class="kobospan" id="kobo.517.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.518.1">Media types</span></strong><span class="kobospan" id="kobo.519.1">. </span><span class="kobospan" id="kobo.519.2">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.520.1">MS Teams</span></strong><span class="kobospan" id="kobo.521.1"> media </span><span><span class="kobospan" id="kobo.522.1">type here.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.523.1">Scroll down until you see </span><strong class="bold"><span class="kobospan" id="kobo.524.1">teams_endpoint</span></strong><span class="kobospan" id="kobo.525.1">. </span><span class="kobospan" id="kobo.525.2">Paste the URL you copied previously here, as shown in the </span><span><span class="kobospan" id="kobo.526.1">followi</span><a id="_idTextAnchor1762" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.527.1">ng screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer541">
<span class="kobospan" id="kobo.528.1"><img alt="Figure 9.31 – Zabbix Alerts | Media types, edit MS Teams page" src="image/9.31.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.529.1">Figure 9.31 – Zabbix Alerts | Media types, edit MS Teams page</span></p>
<ol class="calibre16">
<li value="11" class="calibre15"><span class="kobospan" id="kobo.530.1">Make sure to scroll down and enable the media type </span><span><span class="kobospan" id="kobo.531.1">before saving.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.532.1">Now, click the blue </span><strong class="bold"><span class="kobospan" id="kobo.533.1">Update</span></strong><span class="kobospan" id="kobo.534.1"> button at the bottom of </span><span><span class="kobospan" id="kobo.535.1">the page.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.536.1">If you didn’t follow the previous recipe, then create a new user group for our media types by navigating to </span><strong class="bold"><span class="kobospan" id="kobo.537.1">Users</span></strong><span class="kobospan" id="kobo.538.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.539.1">User groups</span></strong><span class="kobospan" id="kobo.540.1"> and clicking the </span><strong class="bold"><span class="kobospan" id="kobo.541.1">Create user group</span></strong><span class="kobospan" id="kobo.542.1"> button in the top-right corner. </span><span class="kobospan" id="kobo.542.2">Add the followin</span><a id="_idTextAnchor1763" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.543.1">g </span><span><span class="kobospan" id="kobo.544.1">user group:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer542">
<span class="kobospan" id="kobo.545.1"><img alt="Figure 9.32 – Zabbix, Create user group page, the External service﻿s group" src="image/B19803_09_16.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.546.1">Figure 9.32 – Zabbix, Create user group page, the External service</span><a id="_idTextAnchor1764" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.547.1">s group</span></p>
<ol class="calibre16">
<li value="14" class="calibre15"><span class="kobospan" id="kobo.548.1">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.549.1">Host pe</span><a id="_idTextAnchor1765" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.550.1">rmissions</span></strong><span class="kobospan" id="kobo.551.1"> tab and click on </span><strong class="bold"><span class="kobospan" id="kobo.552.1">Select</span></strong><span class="kobospan" id="kobo.553.1">. </span><span class="kobospan" id="kobo.553.2">Make sure that you select all</span><a id="_idIndexMarker731" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.554.1"> the</span><a id="_idIndexMarker732" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.555.1"> groups and subgroups with </span><strong class="bold"><span class="kobospan" id="kobo.556.1">Read</span></strong><span class="kobospan" id="kobo.557.1"> permissions. </span><span class="kobospan" id="kobo.557.2">The </span><strong class="bold"><span class="kobospan" id="kobo.558.1">Permissions</span></strong><span class="kobospan" id="kobo.559.1"> tab will l</span><a id="_idTextAnchor1766" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.560.1">ook </span><span><span class="kobospan" id="kobo.561.1">like this:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer543">
<span class="kobospan" id="kobo.562.1"><img alt="Figure 9.33 – Zabbix, Create user group permissions page, the External services group" src="image/B19803_09_17.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.563.1">Figure 9.33 – Zabbix, Create user group permissions page, the External services group</span></p>
<ol class="calibre16">
<li value="15" class="calibre15"><span class="kobospan" id="kobo.564.1">Now, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.565.1">Add</span></strong><span class="kobospan" id="kobo.566.1"> button and finish creating this </span><span><span class="kobospan" id="kobo.567.1">user group.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.568.1">Navigate to </span><strong class="bold"><span class="kobospan" id="kobo.569.1">Users</span></strong><span class="kobospan" id="kobo.570.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.571.1">Users</span></strong><span class="kobospan" id="kobo.572.1"> and click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.573.1">Create user</span></strong><span class="kobospan" id="kobo.574.1"> button in the top-right corner. </span><span class="kobospan" id="kobo.574.2">Add the </span><span><span class="kobospan" id="kobo.575.1">fo</span><a id="_idTextAnchor1767" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.576.1">llowing user:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer544">
<span class="kobospan" id="kobo.577.1"><img alt="Figure 9.34 – Zabbix Users | Users, Create new user page, MS Teams" src="image/B19803_09_34.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.578.1">Figure 9.34 – Zabbix Users | Users, Create new user page, MS Teams</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.579.1">Tip</span></p>
<p class="callout"><span class="kobospan" id="kobo.580.1">When creating users for things such as alerting or just API access, it is best practice to also add the user to a user group that disables the frontend access. </span><span class="kobospan" id="kobo.580.2">This is why we added the </span><strong class="bold"><span class="kobospan" id="kobo.581.1">No access to the frontend</span></strong> <span><span class="kobospan" id="kobo.582.1">group </span><a id="_idTextAnchor1768" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.583.1">here.</span></span></p>
<ol class="calibre16">
<li value="17" class="calibre15"><span class="kobospan" id="kobo.584.1">Next, go </span><a id="_idIndexMarker733" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.585.1">to</span><a id="_idIndexMarker734" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.586.1"> t</span><a id="_idTextAnchor1769" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.587.1">he </span><strong class="bold"><span class="kobospan" id="kobo.588.1">Media</span></strong><span class="kobospan" id="kobo.589.1"> tab of the </span><strong class="bold"><span class="kobospan" id="kobo.590.1">Create user</span></strong><span class="kobospan" id="kobo.591.1"> page. </span><span class="kobospan" id="kobo.591.2">Click the underlined </span><strong class="bold"><span class="kobospan" id="kobo.592.1">Add</span></strong><span class="kobospan" id="kobo.593.1"> text here to create the </span><span><span class="kobospan" id="kobo.594.1">fo</span><a id="_idTextAnchor1770" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.595.1">llowing media:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer545">
<span class="kobospan" id="kobo.596.1"><img alt="Figure 9.35 – Zabbix Users | Users, Create new user media page, MS Teams" src="image/B19803_09_35.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.597.1">Figure 9.35 – Zabbix Users | Users, Create new user media page, MS Teams</span></p>
<ol class="calibre16">
<li value="18" class="calibre15"><span class="kobospan" id="kobo.598.1">All users </span><a id="_idIndexMarker735" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.599.1">will </span><a id="_idIndexMarker736" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.600.1">also need a </span><strong class="bold"><span class="kobospan" id="kobo.601.1">User</span></strong><span class="kobospan" id="kobo.602.1"> role. </span><span class="kobospan" id="kobo.602.2">To add it, go to </span><strong class="bold"><span class="kobospan" id="kobo.603.1">Permissions</span></strong><span class="kobospan" id="kobo.604.1"> and add</span><a id="_idTextAnchor1771" class="pcalibre calibre6 pcalibre1"/> <span><span class="kobospan" id="kobo.605.1">the following:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer546">
<span class="kobospan" id="kobo.606.1"><img alt="Figure 9.36 – Zabbix – Create user media page, MS Teams user, Permissions" src="image/B19803_09_36.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.607.1">Figure 9.36 – Zabbix – Create user media page, MS Teams user, Permissions</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.608.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.609.1">For convenience, we are adding the user in the </span><strong class="bold"><span class="kobospan" id="kobo.610.1">Super admin</span></strong><span class="kobospan" id="kobo.611.1"> user role in the example. </span><span class="kobospan" id="kobo.611.2">This overrides the read-only permissions we assigned to the </span><strong class="bold"><span class="kobospan" id="kobo.612.1">External services</span></strong><span class="kobospan" id="kobo.613.1"> user group. </span><span class="kobospan" id="kobo.613.2">To limit the permissions, choose a </span><strong class="bold"><span class="kobospan" id="kobo.614.1">User</span></strong><span class="kobospan" id="kobo.615.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.616.1">Admin</span></strong><span class="kobospan" id="kobo.617.1"> role for your user, which will adhere to the host group permissions we </span><span><span class="kobospan" id="kobo.618.1">assigne</span><a id="_idTextAnchor1772" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.619.1">d earlier.</span></span></p>
<ol class="calibre16">
<li value="19" class="calibre15"><span class="kobospan" id="kobo.620.1">Once you’ve</span><a id="_idTextAnchor1773" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.621.1"> filled in this information, click the blue </span><strong class="bold"><span class="kobospan" id="kobo.622.1">Add</span></strong><span class="kobospan" id="kobo.623.1"> button at the bottom of the window and then the blue </span><strong class="bold"><span class="kobospan" id="kobo.624.1">Add</span></strong><span class="kobospan" id="kobo.625.1"> button at the bottom of </span><span><span class="kobospan" id="kobo.626.1">the page.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.627.1">If you didn’t follow the previous recipe, then you will also need to add a macro to </span><strong class="bold"><span class="kobospan" id="kobo.628.1">Administration</span></strong><span class="kobospan" id="kobo.629.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.630.1">Macros</span></strong><span class="kobospan" id="kobo.631.1"> and add the following macro. </span><span class="kobospan" id="kobo.631.2">This macro will contain yo</span><a id="_idTextAnchor1774" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.632.1">ur </span><span><span class="kobospan" id="kobo.633.1">Zabbix URL:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer547">
<span class="kobospan" id="kobo.634.1"><img alt="Figure 9.37 – Zabbix Administration | Macros page, Zabbix URL for use with MS Teams" src="image/9.37.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.635.1">Figure 9.37 – Zabbix Administration | Macros page, Zabbix URL for use with MS Teams</span></p>
<ol class="calibre16">
<li value="21" class="calibre15"><span class="kobospan" id="kobo.636.1">Click on </span><a id="_idIndexMarker737" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.637.1">the </span><a id="_idIndexMarker738" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.638.1">blue </span><strong class="bold"><span class="kobospan" id="kobo.639.1">Update</span></strong><span class="kobospan" id="kobo.640.1"> button. </span><span class="kobospan" id="kobo.640.2">You will also need to go to </span><strong class="bold"><span class="kobospan" id="kobo.641.1">Alerts</span></strong><span class="kobospan" id="kobo.642.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.643.1">Actions</span></strong><span class="kobospan" id="kobo.644.1"> if you didn’t follow the previous recipe and, on the </span><strong class="bold"><span class="kobospan" id="kobo.645.1">Trigger Actions</span></strong><span class="kobospan" id="kobo.646.1"> page, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.647.1">Create </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.648.1">action</span></strong></span><span><span class="kobospan" id="kobo.649.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.650.1">Use </span><strong class="source-inline1"><span class="kobospan" id="kobo.651.1">Notify external services</span></strong><span class="kobospan" id="kobo.652.1"> for the name of the action. </span><span class="kobospan" id="kobo.652.2">We won’t set up any conditions for this example, but it’s recommended to do so in production environments. </span><span class="kobospan" id="kobo.652.3">If you do not set any conditions, all problems will be matched on </span><span><span class="kobospan" id="kobo.653.1">this action.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.654.1">Go to </span><strong class="bold"><span class="kobospan" id="kobo.655.1">Op</span><a id="_idTextAnchor1775" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.656.1">erations</span></strong><span class="kobospan" id="kobo.657.1"> and a</span><a id="_idTextAnchor1776" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.658.1">dd the </span><span><span class="kobospan" id="kobo.659.1">follow</span><a id="_idTextAnchor1777" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.660.1">ing operations:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer548">
<span class="kobospan" id="kobo.661.1"><img alt="Figure 9.38 – Zabbix, Create action Operations page, Notify external services for use with MS Teams" src="image/B19803_09_22.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.662.1">Figure 9.38 – Zabbix, Create action Operations page, Notify external services for use with MS Teams</span></p>
<ol class="calibre16">
<li value="24" class="calibre15"><span class="kobospan" id="kobo.663.1">Now, click on</span><a id="_idIndexMarker739" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.664.1"> the</span><a id="_idIndexMarker740" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.665.1"> blue </span><strong class="bold"><span class="kobospan" id="kobo.666.1">Add</span></strong><span class="kobospan" id="kobo.667.1"> button and you’ll be done. </span><span class="kobospan" id="kobo.667.2">You can now view new problems as they occur in your M</span><a id="_idTextAnchor1778" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.668.1">S </span><span><span class="kobospan" id="kobo.669.1">Teams channel:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer549">
<span class="kobospan" id="kobo.670.1"><img alt="Figure 9.39 – Zabbix problem in an ﻿﻿MS Teams channel" src="image/B19803_09_39.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.671.1">Figure 9.39 – Zabbix problem in an </span><a id="_idTextAnchor1779" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1780" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.672.1">MS Teams channel</span></p>
<h2 id="_idParaDest-308" class="calibre7"><a id="_idTextAnchor1781" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.673.1">How it works…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.674.1">Microsoft</span><a id="_idIndexMarker741" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.675.1"> Teams</span><a id="_idIndexMarker742" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.676.1"> works in about the same way as our Slack setup. </span><span class="kobospan" id="kobo.676.2">A problem is created in</span><a id="_idTextAnchor1782" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.677.1"> the Zabbix server and, if that problem matches our configured conditions in Zabbix, we send that problem to our Microsoft </span><span><span class="kobospan" id="kobo.678.1">Teams connector.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.679.1">For instance, we configured Zabbix so that it only sends problems with a severity of warning or higher to Microsoft Team</span><a id="_idTextAnchor1783" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.680.1">s, as </span><span><span class="kobospan" id="kobo.681.1">shown here:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer550">
<span class="kobospan" id="kobo.682.1"><img alt="Figure 9.40 – Zabbix Media page for MS Teams users" src="image/9.40.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.683.1">Figure 9.40 – Zabbix Media page for MS Teams users</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.684.1">Our Microsoft Teams connector catches our problem and, since this connector is configured directly on our channel, it posts a notification</span><a id="_idTextAnchor1784" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.685.1"> to </span><span><span class="kobospan" id="kobo.686.1">the channel:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer551">
<span class="kobospan" id="kobo.687.1"><img alt="Figure 9.41 – Zabbix Microsoft Teams integration diagram" src="image/B19803_09_41.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.688.1">Figure 9.41 – Zabbix Microsoft Teams integration diagram</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.689.1">Now, we can see our Teams notifications in our channel and keep up to date with all our Zabbix issues </span><a id="_idIndexMarker743" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.690.1">directly </span><a id="_idIndexMarker744" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.691.1">vi</span><a id="_idTextAnchor1785" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1786" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.692.1">a </span><span><span class="kobospan" id="kobo.693.1">Microsoft Teams.</span></span><a id="_idTextAnchor1787" class="pcalibre calibre6 pcalibre1"/></p>
<h2 id="_idParaDest-309" class="calibre7"><a id="_idTextAnchor1788" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.694.1">See also</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.695.1">For more information</span><a id="_idIndexMarker745" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.696.1"> about the Zabbix webhook connector, check out this </span><span><span class="kobospan" id="kobo.697.1">page: </span></span><a href="https://appsource.microsoft.com/en-us/product/office/WA200001837?tab=Overview" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.698.1">https://appsource.microsoft.com/en-us/product/office/WA200001837?tab=Overview</span></span></a><span><span class="kobospan" id="kobo.699.1">.</span></span></p>
<h1 id="_idParaDest-310" class="calibre5"><a id="_idTextAnchor1789" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.700.1">Using Telegram bots with Zabbix</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.701.1">If you love</span><a id="_idTextAnchor1790" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.702.1"> automation </span><a id="_idIndexMarker746" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.703.1">in chat applications, you might have </span><a id="_idIndexMarker747" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.704.1">heard of or used Telegram Messenger. </span><span class="kobospan" id="kobo.704.2">Telegram has an extensive API and amazing </span><span><span class="kobospan" id="kobo.705.1">bot featur</span><a id="_idTextAnchor1791" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.706.1">es.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.707.1">In this recipe, we are going to use a Telegram bot to create a Telegram group for Zabbix alert</span><a id="_idTextAnchor1792" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1793" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.708.1">s. </span><span class="kobospan" id="kobo.708.2">Let’s </span><span><span class="kobospan" id="kobo.709.1">get started.</span></span></p>
<h2 id="_idParaDest-311" class="calibre7"><a id="_idTextAnchor1794" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.710.1">Getting ready</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.711.1">Make sure you have your Zabbix server ready. </span><span class="kobospan" id="kobo.711.2">You can use </span><strong class="source-inline"><span class="kobospan" id="kobo.712.1">lar-book-rocky</span></strong><span class="kobospan" id="kobo.713.1"> or any Zabbix server capable of sending </span><span><span class="kobospan" id="kobo.714.1">so</span><a id="_idTextAnchor1795" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.715.1">me alerts.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.716.1">It would be useful if you have some knowledge of Telegram, but I’ll be describing how to set it up step by step, even for </span><a id="_idTextAnchor1796" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.717.1">those of you who have never used Telegram bots. </span><span class="kobospan" id="kobo.717.2">Just make sure that you have the Telegram app on your computer and that yo</span><a id="_idTextAnchor1797" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1798" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.718.1">ur account is </span><span><span class="kobospan" id="kobo.719.1">set up.</span></span></p>
<h2 id="_idParaDest-312" class="calibre7"><a id="_idTextAnchor1799" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.720.1">How to do it…</span></h2>
<ol class="calibre16">
<li class="calibre15"><span class="kobospan" id="kobo.721.1">First, let’s </span><a id="_idIndexMarker748" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.722.1">create </span><a id="_idIndexMarker749" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.723.1">a new channel in Telegram. </span><span class="kobospan" id="kobo.723.2">Click on the create icon next to the search box</span><a id="_idTextAnchor1800" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.724.1"> and select </span><span><strong class="bold"><span class="kobospan" id="kobo.725.1">New Group</span></strong></span><span><span class="kobospan" id="kobo.726.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer552">
<span class="kobospan" id="kobo.727.1"><img alt="Figure 9.42 – Telegram New Group button" src="image/B19803_09_42.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.728.1">Figure 9.42 – Telegram New Group button</span></p>
<ol class="calibre16">
<li value="2" class="calibre15"><span class="kobospan" id="kobo.729.1">Add another user – someone in your team who needs to get notifications as well. </span><span class="kobospan" id="kobo.729.2">Fill in a group name and add a</span><a id="_idTextAnchor1801" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.730.1"> picture if </span><span><span class="kobospan" id="kobo.731.1">you want:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer553">
<span class="kobospan" id="kobo.732.1"><img alt="Figure 9.43 – Telegram New Group page" src="image/B19803_09_43.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.733.1">Figure 9.43 – Telegram New Group page</span></p>
<ol class="calibre16">
<li value="3" class="calibre15"><span class="kobospan" id="kobo.734.1">Now, click on the </span><strong class="bold"><span class="kobospan" id="kobo.735.1">Create</span></strong><span class="kobospan" id="kobo.736.1"> button in the top-right corner. </span><span class="kobospan" id="kobo.736.2">This will take you to the </span><strong class="bold"><span class="kobospan" id="kobo.737.1">N</span><a id="_idTextAnchor1802" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.738.1">ew </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.739.1">Group</span></strong></span><span><span class="kobospan" id="kobo.740.1"> page.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.741.1">Working with Telegram bots is made easy with the </span><strong class="source-inline1"><span class="kobospan" id="kobo.742.1">@BotFather</span></strong><span class="kobospan" id="kobo.743.1"> user on Telegram. </span><span class="kobospan" id="kobo.743.2">We can start creatin</span><a id="_idTextAnchor1803" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.744.1">g our bot by searching for </span><strong class="source-inline1"><span class="kobospan" id="kobo.745.1">botfather</span></strong><span class="kobospan" id="kobo.746.1"> and clicking</span><a id="_idIndexMarker750" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.747.1"> t</span><a id="_idTextAnchor1804" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.748.1">he</span><a id="_idIndexMarker751" class="pcalibre calibre6 pcalibre1"/> <span><span class="kobospan" id="kobo.749.1">specified contact:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer554">
<span class="kobospan" id="kobo.750.1"><img alt="Figure 9.44 – Telegram, BotFather user" src="image/B19803_09_44.JPG" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.751.1">Figure 9.44 – Telegram, BotFather user</span></p>
<ol class="calibre16">
<li value="5" class="calibre15"><span class="kobospan" id="kobo.752.1">Let’s start by issuing the </span><strong class="source-inline1"><span class="kobospan" id="kobo.753.1">/start</span></strong><span class="kobospan" id="kobo.754.1"> command in the chat. </span><span class="kobospan" id="kobo.754.2">This will provide you with a list of </span><a id="_idTextAnchor1805" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.755.1">commands you </span><span><span class="kobospan" id="kobo.756.1">can use:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer555">
<span class="kobospan" id="kobo.757.1"><img alt="Figure 9.45 – Telegram, BotFather user help list" src="image/B19803_09_45.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.758.1">Figure 9.45 – Telegram, BotFather user help list</span></p>
<ol class="calibre16">
<li value="6" class="calibre15"><span class="kobospan" id="kobo.759.1">Now, let’s </span><a id="_idIndexMarker752" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.760.1">immediately</span><a id="_idIndexMarker753" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.761.1"> create a new bot by typing </span><strong class="source-inline1"><span class="kobospan" id="kobo.762.1">/newbot</span></strong><span class="kobospan" id="kobo.763.1"> into the </span><strong class="bold"><span class="kobospan" id="kobo.764.1">BotFather</span></strong><span class="kobospan" id="kobo.765.1"> chat. </span><span class="kobospan" id="kobo.765.2">Press </span><em class="italic"><span class="kobospan" id="kobo.766.1">Enter</span></em><span class="kobospan" id="kobo.767.1"> to send your message. </span><span class="kobospan" id="kobo.767.2">This wil</span><a id="_idTextAnchor1806" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.768.1">l give us</span><a id="_idTextAnchor1807" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.769.1"> the </span><span><span class="kobospan" id="kobo.770.1">following result:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer556">
<span class="kobospan" id="kobo.771.1"><img alt="Figure 9.46 – Telegram, BotFather /newb﻿ot command" src="image/B19803_09_46.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.772.1">Figure 9.46 – Telegram, BotFather /newb</span><a id="_idTextAnchor1808" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.773.1">ot command</span></p>
<ol class="calibre16">
<li value="7" class="calibre15"><span class="kobospan" id="kobo.774.1">Type in the new name of the bot; we will call it </span><strong class="source-inline1"><span class="kobospan" id="kobo.775.1">zabbix-notfication-bot</span></strong><span class="kobospan" id="kobo.776.1">. </span><span class="kobospan" id="kobo.776.2">Press </span><em class="italic"><span class="kobospan" id="kobo.777.1">Ent</span><a id="_idTextAnchor1809" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.778.1">er</span></em><span class="kobospan" id="kobo.779.1"> to send </span><span><span class="kobospan" id="kobo.780.1">your name:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer557">
<span class="kobospan" id="kobo.781.1"><img alt="Figure 9.47 – Telegram, BotFather bot username" src="image/B19803_09_47.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.782.1">Figure 9.47 – Telegram, BotFather bot username</span></p>
<ol class="calibre16">
<li value="8" class="calibre15"><span class="kobospan" id="kobo.783.1">You will then</span><a id="_idIndexMarker754" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.784.1"> be </span><a id="_idIndexMarker755" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.785.1">asked what username you want to give the bot. </span><span class="kobospan" id="kobo.785.2">I will use </span><span><strong class="source-inline1"><span class="kobospan" id="kobo.786.1">lar</span><a id="_idTextAnchor1810" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.787.1">_ zbx_notfication_bot</span></strong></span><span><span class="kobospan" id="kobo.788.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer558">
<span class="kobospan" id="kobo.789.1"><img alt="Figure 9.48 – Telegram, BotFather bot token" src="image/B19803_09_48.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.790.1">Figure 9.48 – Telegram, BotFather bot token</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.791.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.792.1">Your bot username must be unique, so you can’t use </span><strong class="source-inline1"><span class="kobospan" id="kobo.793.1">lar_zbx_ notification_bot</span></strong><span class="kobospan" id="kobo.794.1"> here. </span><span class="kobospan" id="kobo.794.2">Pick a unique bot name that suits you and then use that name throughout </span><a id="_idTextAnchor1811" class="pcalibre calibre6 pcalibre1"/><span><span class="kobospan" id="kobo.795.1">this recipe.</span></span></p>
<ol class="calibre16">
<li value="9" class="calibre15"><span class="kobospan" id="kobo.796.1">Make sure that you save the </span><strong class="bold"><span class="kobospan" id="kobo.797.1">HTTP API</span></strong><span class="kobospan" id="kobo.798.1"> key </span><span><span class="kobospan" id="kobo.799.1">somewh</span><a id="_idTextAnchor1812" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.800.1">ere safe.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.801.1">Let’s go back to our </span><strong class="bold"><span class="kobospan" id="kobo.802.1">Zabbix notifications</span></strong><span class="kobospan" id="kobo.803.1"> group and add our bot. </span><span class="kobospan" id="kobo.803.2">Click on the group in your list of chats and click on the </span><span><span class="kobospan" id="kobo.804.1">group’s name.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.805.1">Now, click on </span><strong class="bold"><span class="kobospan" id="kobo.806.1">Add</span></strong><span class="kobospan" id="kobo.807.1"> to add</span><a id="_idTextAnchor1813" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.808.1"> the bot, </span><span><span class="kobospan" id="kobo.809.1">as follows:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer559">
<span class="kobospan" id="kobo.810.1"><img alt="Figure 9.49 – Telegram, Add user to group button" src="image/B19803_09_49.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.811.1">Figure 9.49 – Telegram, Add user to group button</span></p>
<ol class="calibre16">
<li value="12" class="calibre15"><span class="kobospan" id="kobo.812.1">Next, you </span><a id="_idIndexMarker756" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.813.1">will </span><a id="_idIndexMarker757" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.814.1">need to search for your bot using its username, as shown in the</span><a id="_idTextAnchor1814" class="pcalibre calibre6 pcalibre1"/> <span><span class="kobospan" id="kobo.815.1">following screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer560">
<span class="kobospan" id="kobo.816.1"><img alt="Figure 9.50 – Telegram, Add user to group page" src="image/B19803_09_50.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.817.1">Figure 9.50 – Telegram, Add user to group page</span></p>
<ol class="calibre16">
<li value="13" class="calibre15"><span class="kobospan" id="kobo.818.1">Click on the bot and click on the </span><strong class="bold"><span class="kobospan" id="kobo.819.1">Add</span></strong><span class="kobospan" id="kobo.820.1"> button. </span><span class="kobospan" id="kobo.820.2">With that, your bot has been added to </span><span><span class="kobospan" id="kobo.821.1">the channel.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.822.1">Let’s navigate to the Zabbix frontend and go to </span><strong class="bold"><span class="kobospan" id="kobo.823.1">Alerts</span></strong><span class="kobospan" id="kobo.824.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.825.1">Media types</span></strong><span class="kobospan" id="kobo.826.1">. </span><span class="kobospan" id="kobo.826.2">Click on the media type </span><span><span class="kobospan" id="kobo.827.1">titled </span></span><span><strong class="bold"><span class="kobospan" id="kobo.828.1">Te</span><a id="_idTextAnchor1815" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.829.1">legram</span></strong></span><span><span class="kobospan" id="kobo.830.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.831.1">Here, you must ad</span><a id="_idTextAnchor1816" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.832.1">d the </span><strong class="bold"><span class="kobospan" id="kobo.833.1">HTTP API</span></strong><span class="kobospan" id="kobo.834.1"> key you generated earlier to the </span><strong class="bold"><span class="kobospan" id="kobo.835.1">Token</span></strong><span class="kobospan" id="kobo.836.1"> fie</span><a id="_idTextAnchor1817" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.837.1">ld of our </span><span><span class="kobospan" id="kobo.838.1">media type:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer561">
<span class="kobospan" id="kobo.839.1"><img alt="Figure 9.51 – Zabbix Alerts | Media types, Edit Telegram Media type page" src="image/B19803_09_51.JPG" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.840.1">Figure 9.51 – Zabbix Alerts | Media types, Edit Telegram Media type page</span></p>
<ol class="calibre16">
<li value="16" class="calibre15"><span class="kobospan" id="kobo.841.1">Also, scroll </span><a id="_idIndexMarker758" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.842.1">down</span><a id="_idIndexMarker759" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.843.1"> and make sure this media type </span><span><span class="kobospan" id="kobo.844.1">is enabled.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.845.1">Click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.846.1">Update</span></strong><span class="kobospan" id="kobo.847.1"> button at the bottom of the page to finish editing the </span><strong class="bold"><span class="kobospan" id="kobo.848.1">Telegram</span></strong> <span><span class="kobospan" id="kobo.849.1">media type.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.850.1">Now, let’s go back to Telegram and add another bot to our group. </span><span class="kobospan" id="kobo.850.2">Go to our new group and click on the group’s name. </span><span class="kobospan" id="kobo.850.3">Click on </span><strong class="bold"><span class="kobospan" id="kobo.851.1">Add</span></strong> <a id="_idTextAnchor1818" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.852.1">to add the </span><span><strong class="bold"><span class="kobospan" id="kobo.853.1">IDBot</span></strong></span><span><span class="kobospan" id="kobo.854.1"> user:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer562">
<span class="kobospan" id="kobo.855.1"><img alt="Figure 9.52 – The Add user page for a Telegram group" src="image/B19803_09_52.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.856.1">Figure 9.52 – The Add user page for a Telegram group</span></p>
<ol class="calibre16">
<li value="19" class="calibre15"><span class="kobospan" id="kobo.857.1">Click on the user and click on </span><strong class="bold"><span class="kobospan" id="kobo.858.1">Add</span></strong><span class="kobospan" id="kobo.859.1">. </span><span class="kobospan" id="kobo.859.2">Then, navigate back to the </span><span><span class="kobospan" id="kobo.860.1">Zabbix frontend.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.861.1">If you haven’t followed any of the preceding recipes, create a new user group for our media types by navigating to </span><strong class="bold"><span class="kobospan" id="kobo.862.1">Users</span></strong><span class="kobospan" id="kobo.863.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.864.1">User groups</span></strong><span class="kobospan" id="kobo.865.1"> and clicking the </span><strong class="bold"><span class="kobospan" id="kobo.866.1">Create user group</span></strong><span class="kobospan" id="kobo.867.1"> button in the top-right cor</span><a id="_idTextAnchor1819" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.868.1">ner. </span><span class="kobospan" id="kobo.868.2">Add the </span><a id="_idTextAnchor1820" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.869.1">following </span><span><span class="kobospan" id="kobo.870.1">user group:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer563">
<span class="kobospan" id="kobo.871.1"><img alt="Figure 9.53 – Zabbix Create user group page and the External services group for use w﻿ith Telegram" src="image/B19803_09_53.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.872.1">Figure 9.53 – Zabbix Create user group page and the External services group for use w</span><a id="_idTextAnchor1821" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.873.1">ith Telegram</span></p>
<ol class="calibre16">
<li value="21" class="calibre15"><span class="kobospan" id="kobo.874.1">Click </span><a id="_idIndexMarker760" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.875.1">on</span><a id="_idIndexMarker761" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.876.1"> the </span><strong class="bold"><span class="kobospan" id="kobo.877.1">Host permissions</span></strong><span class="kobospan" id="kobo.878.1"> tab and click on </span><strong class="bold"><span class="kobospan" id="kobo.879.1">Select</span></strong><span class="kobospan" id="kobo.880.1">. </span><span class="kobospan" id="kobo.880.2">Make sure that you select all the groups and subgroups with </span><strong class="bold"><span class="kobospan" id="kobo.881.1">Read</span></strong><span class="kobospan" id="kobo.882.1"> pe</span><a id="_idTextAnchor1822" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.883.1">rmissions, </span><span><span class="kobospan" id="kobo.884.1">as follows:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer564">
<span class="kobospan" id="kobo.885.1"><img alt="Figure 9.54 – Zabbix Create user group Permissions page, External services for use with Telegram" src="image/B19803_09_54.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.886.1">Figure 9.54 – Zabbix Create user group Permissions page, External services for use with Telegram</span></p>
<ol class="calibre16">
<li value="22" class="calibre15"><span class="kobospan" id="kobo.887.1">Now, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.888.1">Add</span></strong><span class="kobospan" id="kobo.889.1"> button and finish creating this </span><span><span class="kobospan" id="kobo.890.1">user group.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.891.1">At this point, you must create a new user in Zabbix. </span><span class="kobospan" id="kobo.891.2">However, to create this user, you are going to need our new group ID. </span><span class="kobospan" id="kobo.891.3">Go back to Telegram and issue </span><strong class="source-inline1"><span class="kobospan" id="kobo.892.1">/getgroupid@myidbot</span></strong><span class="kobospan" id="kobo.893.1"> in the group chat. </span><span class="kobospan" id="kobo.893.2">You will receive a value that y</span><a id="_idTextAnchor1823" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.894.1">ou will need </span><span><span class="kobospan" id="kobo.895.1">to copy:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer565">
<span class="kobospan" id="kobo.896.1"><img alt="Figure 9.55 – Telegra﻿m user group ID" src="image/B19803_09_55.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.897.1">Figure 9.55 – Telegra</span><a id="_idTextAnchor1824" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.898.1">m user group ID</span></p>
<ol class="calibre16">
<li value="24" class="calibre15"><span class="kobospan" id="kobo.899.1">Let’s</span><a id="_idIndexMarker762" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.900.1"> navigate</span><a id="_idIndexMarker763" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.901.1"> to </span><strong class="bold"><span class="kobospan" id="kobo.902.1">Users</span></strong><span class="kobospan" id="kobo.903.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.904.1">Users</span></strong><span class="kobospan" id="kobo.905.1"> and click the blue</span><a id="_idTextAnchor1825" class="pcalibre calibre6 pcalibre1"/> <strong class="bold"><span class="kobospan" id="kobo.906.1">Create user</span></strong><span class="kobospan" id="kobo.907.1"> button. </span><span class="kobospan" id="kobo.907.2">A</span><a id="_idTextAnchor1826" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.908.1">dd the </span><span><span class="kobospan" id="kobo.909.1">following user:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer566">
<span class="kobospan" id="kobo.910.1"><img alt="Figure 9.56 – Zabbix Create user page, Telegram user" src="image/B19803_09_56.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.911.1">Figure 9.56 – Zabbix Create user page, Telegram user</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.912.1">Tip</span></p>
<p class="callout"><span class="kobospan" id="kobo.913.1">When creating users for things such as alerting or just API access, it is best practice to also add the user to a user group that disables the frontend access. </span><span class="kobospan" id="kobo.913.2">This is why we added the </span><strong class="bold"><span class="kobospan" id="kobo.914.1">No access to the frontend</span></strong> <span><span class="kobospan" id="kobo.915.1">group here.</span></span></p>
<ol class="calibre16">
<li value="25" class="calibre15"><span class="kobospan" id="kobo.916.1">Now, select the </span><strong class="bold"><span class="kobospan" id="kobo.917.1">Media</span></strong><span class="kobospan" id="kobo.918.1"> tab and click on the underlined </span><strong class="bold"><span class="kobospan" id="kobo.919.1">Add</span></strong><span class="kobospan" id="kobo.920.1"> text. </span><span class="kobospan" id="kobo.920.2">Add</span><a id="_idTextAnchor1827" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.921.1"> the </span><span><span class="kobospan" id="kobo.922.1">following media:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer567">
<span class="kobospan" id="kobo.923.1"><img alt="Figure 9.57 – Zabbix Create user media page, Telegram use﻿r" src="image/B19803_09_57.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.924.1">Figure 9.57 – Zabbix Create user media page, Telegram use</span><a id="_idTextAnchor1828" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.925.1">r</span></p>
<ol class="calibre16">
<li value="26" class="calibre15"><span class="kobospan" id="kobo.926.1">All users will </span><a id="_idIndexMarker764" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.927.1">also </span><a id="_idIndexMarker765" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.928.1">need a </span><strong class="bold"><span class="kobospan" id="kobo.929.1">User</span></strong><span class="kobospan" id="kobo.930.1"> role. </span><span class="kobospan" id="kobo.930.2">To add it, go to </span><strong class="bold"><span class="kobospan" id="kobo.931.1">Permissions</span></strong> <a id="_idTextAnchor1829" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.932.1">and add </span><span><span class="kobospan" id="kobo.933.1">the following:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer568">
<span class="kobospan" id="kobo.934.1"><img alt="Figure 9.58 – Zabbix Create user media page, Telegram user, Permissions" src="image/B19803_09_58.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.935.1">Figure 9.58 – Zabbix Create user media page, Telegram user, Permissions</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.936.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.937.1">For convenience, we are adding the user in the </span><strong class="bold"><span class="kobospan" id="kobo.938.1">Super admin</span></strong><span class="kobospan" id="kobo.939.1"> user role in the example. </span><span class="kobospan" id="kobo.939.2">This overrides the read-only permissions we assigned to the </span><strong class="bold"><span class="kobospan" id="kobo.940.1">External services</span></strong><span class="kobospan" id="kobo.941.1"> user group. </span><span class="kobospan" id="kobo.941.2">To limit the permissions, choose a </span><strong class="bold"><span class="kobospan" id="kobo.942.1">User</span></strong><span class="kobospan" id="kobo.943.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.944.1">Admin</span></strong><span class="kobospan" id="kobo.945.1"> role for your user, which will adhere to the host group permissions we </span><a id="_idTextAnchor1830" class="pcalibre calibre6 pcalibre1"/><span><span class="kobospan" id="kobo.946.1">assigned earlier.</span></span></p>
<ol class="calibre16">
<li value="27" class="calibre15"><span class="kobospan" id="kobo.947.1">Make sure that you add the group ID to the </span><strong class="bold"><span class="kobospan" id="kobo.948.1">Send to</span></strong><span class="kobospan" id="kobo.949.1"> field with the </span><strong class="source-inline1"><span class="kobospan" id="kobo.950.1">–</span></strong><span class="kobospan" id="kobo.951.1"> text and click on the blue </span><span><strong class="bold"><span class="kobospan" id="kobo.952.1">Add</span></strong></span><span><span class="kobospan" id="kobo.953.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.954.1">If you haven’t followed the previous recipes, you will also need to go to </span><strong class="bold"><span class="kobospan" id="kobo.955.1">Alerts</span></strong><span class="kobospan" id="kobo.956.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.957.1">Actions</span></strong><span class="kobospan" id="kobo.958.1">. </span><span class="kobospan" id="kobo.958.2">Then, on the </span><strong class="bold"><span class="kobospan" id="kobo.959.1">Trigger Actions</span></strong><span class="kobospan" id="kobo.960.1"> page, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.961.1">Create </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.962.1">action</span></strong></span><span><span class="kobospan" id="kobo.963.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.964.1">Use </span><strong class="source-inline1"><span class="kobospan" id="kobo.965.1">Notify external services</span></strong><span class="kobospan" id="kobo.966.1"> for the name of the action. </span><span class="kobospan" id="kobo.966.2">We won’t set up any </span><a id="_idIndexMarker766" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.967.1">conditions </span><a id="_idIndexMarker767" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.968.1">for this example, but it’s recommended to do so in production environments. </span><span class="kobospan" id="kobo.968.2">If you do not set any conditions, all problems will be matched on </span><span><span class="kobospan" id="kobo.969.1">this action.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.970.1">Go to </span><strong class="bold"><span class="kobospan" id="kobo.971.1">Operations</span></strong><span class="kobospan" id="kobo.972.1"> and add th</span><a id="_idTextAnchor1831" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.973.1">e </span><span><span class="kobospan" id="kobo.974.1">following operations:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer569">
<span class="kobospan" id="kobo.975.1"><img alt="Figure 9.59 – Zabbix – Create action operations page, Notify external services for use w﻿ith Telegram" src="image/B19803_09_22.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.976.1">Figure 9.59 – Zabbix – Create action operations page, Notify external services for use w</span><a id="_idTextAnchor1832" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.977.1">ith Telegram</span></p>
<ol class="calibre16">
<li value="31" class="calibre15"><span class="kobospan" id="kobo.978.1">Now, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.979.1">Add</span></strong><span class="kobospan" id="kobo.980.1"> button. </span><span class="kobospan" id="kobo.980.2">With that, you’re done. </span><span class="kobospan" id="kobo.980.3">You can now view new problems i</span><a id="_idTextAnchor1833" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.981.1">n your </span><span><span class="kobospan" id="kobo.982.1">Telegram group:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer570">
<span class="kobospan" id="kobo.983.1"><img alt="Figure 9.60 – Zabbix notifica﻿﻿tions in Telegram chat" src="image/B19803_09_60.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.984.1">Figure 9.60 – Zabbix notifica</span><a id="_idTextAnchor1834" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1835" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.985.1">tions in Telegram chat</span></p>
<h2 id="_idParaDest-313" class="calibre7"><a id="_idTextAnchor1836" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.986.1">How it works…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.987.1">Slack apps, Microsoft</span><a id="_idIndexMarker768" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.988.1"> connectors, and Telegram bots all work kind</span><a id="_idIndexMarker769" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.989.1"> of the same in the e</span><a id="_idTextAnchor1837" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.990.1">nd. </span><span class="kobospan" id="kobo.990.2">There’s just another backend (API) provided by the respective companies, but the Zabbix </span><span><span class="kobospan" id="kobo.991.1">webhook remains.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.992.1">Now that we’ve added our Zabbix Telegram integration, we are receiving notifications in our Telegram group </span><a id="_idTextAnchor1838" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.993.1">via the </span><span><span class="kobospan" id="kobo.994.1">Zabbix webhook:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer571">
<span class="kobospan" id="kobo.995.1"><img alt="Figure 9.61 – Zabbix Users | Users, Edit user media page" src="image/B19803_09_61.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.996.1">Figure 9.61 – Zabbix Users | Users, Edit user media page</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.997.1">However, we will only receive these notifications if they match our configured settings. </span><span class="kobospan" id="kobo.997.2">For instance, we’ve added our media type so that it only sends problems with a severity of warning or highe</span><a id="_idTextAnchor1839" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.998.1">r to our </span><span><span class="kobospan" id="kobo.999.1">Telegram bot:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer572">
<span class="kobospan" id="kobo.1000.1"><img alt="Figure 9.62 – Zabbix Telegram integration diagram" src="image/B19803_09_62.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1001.1">Figure 9.62 – Zabbix Telegram integration diagram</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1002.1">Our Zabbix server is now sending our problems that match the </span><strong class="bold"><span class="kobospan" id="kobo.1003.1">Action</span></strong><span class="kobospan" id="kobo.1004.1"> conditions to our Telegram bot. </span><span class="kobospan" id="kobo.1004.2">The </span><a id="_idIndexMarker770" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1005.1">bot</span><a id="_idIndexMarker771" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1006.1"> catches these problems successfully. </span><span class="kobospan" id="kobo.1006.2">Because our bot is in our Telegram group, the problems are poste</span><a id="_idTextAnchor1840" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1841" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1007.1">d in our </span><span><span class="kobospan" id="kobo.1008.1">Telegram group.</span></span></p>
<h2 id="_idParaDest-314" class="calibre7"><span class="kobospan" id="kobo.1009.1">There’s m</span><a id="_idTextAnchor1842" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1010.1">ore…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1011.1">There’s a very cool Zabbix community group on Telegram. </span><span class="kobospan" id="kobo.1011.2">Now that you have Telegram, do not forget to join using the following invitation </span><span><span class="kobospan" id="kobo.1012.1">link: </span><a id="_idTextAnchor1843" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1844" class="pcalibre calibre6 pcalibre1"/></span><a href="https://t.me/ZabbixTech" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.1013.1">https://t.me/ZabbixTech</span></span></a><span><span class="kobospan" id="kobo.1014.1">.</span></span></p>
<h2 id="_idParaDest-315" class="calibre7"><a id="_idTextAnchor1845" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1015.1">See also</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1016.1">Make sure that you check out all the awesome features Telegram bots have to</span><a id="_idTextAnchor1846" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1017.1"> offer. </span><span class="kobospan" id="kobo.1017.2">There’s a lot of information available directly from Telegram, and you can build amazing integrations by using </span><span><span class="kobospan" id="kobo.1018.1">them: </span></span><span><span class="kobospan" id="kobo.1019.1">https:/</span><a id="_idTextAnchor1847" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1848" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1020.1">/core.telegram.org/bots</span></span><span><span class="kobospan" id="kobo.1021.1">.</span></span></p>
<h1 id="_idParaDest-316" class="calibre5"><span class="kobospan" id="kobo.1022.1">Integrating Atlassian Opsgenie with Zabb</span><a id="_idTextAnchor1849" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1023.1">ix</span></h1>
<p class="calibre3"><span class="kobospan" id="kobo.1024.1">Atlassian </span><a id="_idIndexMarker772" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1025.1">Opsgenie is so much more than just </span><a id="_idIndexMarker773" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1026.1">another integration service for receiving notifications. </span><span class="kobospan" id="kobo.1026.2">Opsgenie offers us a call system, an SMS system, iOS and Android apps, two-way acknowledgments, and even an </span><span><span class="kobospan" id="kobo.1027.1">on-call schedule.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1028.1">I think O</span><a id="_idTextAnchor1850" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1029.1">psgenie (and PagerDuty) are the best tools for replacing old-school call and SMS systems and fully integrating them with Zabbix. </span><span class="kobospan" id="kobo.1029.2">So, let’s get started with Opsgenie and see how we can get</span><a id="_idTextAnchor1851" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1852" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1030.1"> this amazing tool </span><span><span class="kobospan" id="kobo.1031.1">set up.</span></span><a id="_idTextAnchor1853" class="pcalibre calibre6 pcalibre1"/></p>
<h2 id="_idParaDest-317" class="calibre7"><a id="_idTextAnchor1854" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1032.1">Getting ready</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1033.1">Ensure that your Zabbix server is ready. </span><span class="kobospan" id="kobo.1033.2">I’ll be using the </span><strong class="source-inline"><span class="kobospan" id="kobo.1034.1">lar-book-rocky</span></strong><span class="kobospan" id="kobo.1035.1"> server, but any Zabbix server ready to send problems </span><span><span class="kobospan" id="kobo.1036.1">should work.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1037.1">You are also going to need an Atlassian Opsgenie account with Opsgenie ready to go. </span><span class="kobospan" id="kobo.1037.2">This integration is slightly different from the previous examples, as we’ll also be utilizing </span><span><span class="kobospan" id="kobo.1038.1">some scripts.</span></span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1039.1">I won’t show you how</span><a id="_idIndexMarker774" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1040.1"> to </span><a id="_idIndexMarker775" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1041.1">create accounts, but we’ll start this recip</span><a id="_idTextAnchor1855" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1856" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1042.1">e with Opsgenie ready </span><span><span class="kobospan" id="kobo.1043.1">to go.</span></span></p>
<h2 id="_idParaDest-318" class="calibre7"><a id="_idTextAnchor1857" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1044.1">How to do it…</span></h2>
<ol class="calibre16">
<li class="calibre15"><span class="kobospan" id="kobo.1045.1">Let’s start by logging in to our Atlassian Opsgenie setup and going to </span><strong class="bold"><span class="kobospan" id="kobo.1046.1">Settings</span></strong><span class="kobospan" id="kobo.1047.1"> on the home page. </span><span class="kobospan" id="kobo.1047.2">From the left sidebar, click </span><span><span class="kobospan" id="kobo.1048.1">on </span></span><span><strong class="bold"><span class="kobospan" id="kobo.1049.1">Notifications</span></strong></span><span><span class="kobospan" id="kobo.1050.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1051.1">Make sure that you add your email and phone number here by using the </span><strong class="bold"><span class="kobospan" id="kobo.1052.1">+ Add email</span></strong><span class="kobospan" id="kobo.1053.1"> and </span><strong class="bold"><span class="kobospan" id="kobo.1054.1">+ Add phone number</span></strong><span class="kobospan" id="kobo.1055.1"> buttons. </span><span class="kobospan" id="kobo.1055.2">We need these in orde</span><a id="_idTextAnchor1858" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1056.1">r to </span><span><span class="kobospan" id="kobo.1057.1">receive notifications:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer573">
<span class="kobospan" id="kobo.1058.1"><img alt="Figure 9.63 – Opsgenie profile, Contact methods" src="image/B19803_09_63.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1059.1">Figure 9.63 – Opsgenie profile, Contact methods</span></p>
<ol class="calibre16">
<li value="3" class="calibre15"><span class="kobospan" id="kobo.1060.1">Your settings will </span><a id="_idIndexMarker776" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1061.1">be</span><a id="_idIndexMarker777" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1062.1"> automatically saved once you</span><a id="_idTextAnchor1859" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1063.1">’ve added them, which means we can navigate away from </span><strong class="bold"><span class="kobospan" id="kobo.1064.1">Settings</span></strong><span class="kobospan" id="kobo.1065.1"> to </span><strong class="bold"><span class="kobospan" id="kobo.1066.1">Teams</span></strong><span class="kobospan" id="kobo.1067.1"> using the </span><span><span class="kobospan" id="kobo.1068.1">top bar.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1069.1">From the </span><strong class="bold"><span class="kobospan" id="kobo.1070.1">Teams</span></strong><span class="kobospan" id="kobo.1071.1"> tab, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.1072.1">Add team</span></strong><span class="kobospan" id="kobo.1073.1"> button in th</span><a id="_idTextAnchor1860" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1074.1">e top-right corner. </span><span class="kobospan" id="kobo.1074.2">Then, ad</span><a id="_idTextAnchor1861" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1075.1">d the </span><span><span class="kobospan" id="kobo.1076.1">following information:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer574">
<span class="kobospan" id="kobo.1077.1"><img alt="Figure 9.64 – Opsgenie, Add team window" src="image/B19803_09_64.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1078.1">Figure 9.64 – Opsgenie, Add team window</span></p>
<ol class="calibre16">
<li value="5" class="calibre15"><span class="kobospan" id="kobo.1079.1">I’ve set up our </span><strong class="source-inline1"><span class="kobospan" id="kobo.1080.1">Consultancy</span></strong><span class="kobospan" id="kobo.1081.1"> team with two users that are part of this team. </span><span class="kobospan" id="kobo.1081.2">Click on the</span><a id="_idIndexMarker778" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1082.1"> blue </span><strong class="bold"><span class="kobospan" id="kobo.1083.1">Add</span></strong><span class="kobospan" id="kobo.1084.1"> button</span><a id="_idIndexMarker779" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1085.1"> at the bottom of the window to add the </span><span><span class="kobospan" id="kobo.1086.1">new team.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1087.1">This will take you to the new </span><strong class="bold"><span class="kobospan" id="kobo.1088.1">Consultancy</span></strong><span class="kobospan" id="kobo.1089.1"> team page. </span><span class="kobospan" id="kobo.1089.2">Click on </span><strong class="bold"><span class="kobospan" id="kobo.1090.1">Integrations</span></strong><span class="kobospan" id="kobo.1091.1"> and click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.1092.1">Add integration</span></strong><span class="kobospan" id="kobo.1093.1"> button</span><a id="_idTextAnchor1862" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1094.1"> in the </span><span><span class="kobospan" id="kobo.1095.1">top-right corner.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1096.1">When we use </span><a id="_idTextAnchor1863" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1097.1">the search field to search for the Zabbix integration, we can see it immediately, as shown</span><a id="_idTextAnchor1864" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1098.1"> in the </span><span><span class="kobospan" id="kobo.1099.1">following screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer575">
<span class="kobospan" id="kobo.1100.1"><img alt="Figure 9.65 – Opsgenie, Add integration page" src="image/B19803_09_65.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1101.1">Figure 9.65 – Opsgenie, Add integration page</span></p>
<ol class="calibre16">
<li value="8" class="calibre15"><span class="kobospan" id="kobo.1102.1">Click on the </span><a id="_idIndexMarker780" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1103.1">Zabbix</span><a id="_idIndexMarker781" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1104.1"> integration. </span><span class="kobospan" id="kobo.1104.2">This will take you to the next page, where a </span><strong class="bold"><span class="kobospan" id="kobo.1105.1">Name</span></strong><span class="kobospan" id="kobo.1106.1"> and </span><strong class="bold"><span class="kobospan" id="kobo.1107.1">AP</span><a id="_idTextAnchor1865" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1108.1">I Key</span></strong><span class="kobospan" id="kobo.1109.1"> value will </span><span><span class="kobospan" id="kobo.1110.1">be generated:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer576">
<span class="kobospan" id="kobo.1111.1"><img alt="Figure 9.66 – Opsgenie, Add Zabbix integration page" src="image/B19803_09_66.JPG" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1112.1">Figure 9.66 – Opsgenie, Add Zabbix integration page</span></p>
<ol class="calibre16">
<li value="9" class="calibre15"><span class="kobospan" id="kobo.1113.1">Copy the </span><strong class="bold"><span class="kobospan" id="kobo.1114.1">API Key</span></strong><span class="kobospan" id="kobo.1115.1"> information and scroll to the bottom of the page. </span><span class="kobospan" id="kobo.1115.2">Here, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.1116.1">Save </span></strong><span><strong class="bold"><span class="kobospan" id="kobo.1117.1">in</span><a id="_idTextAnchor1866" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1118.1">tegration</span></strong></span><span><span class="kobospan" id="kobo.1119.1"> button.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1120.1">Now, navigate</span><a id="_idTextAnchor1867" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1121.1"> to your Zabbix server CLI and execute the </span><span><span class="kobospan" id="kobo.1122.1">following code.</span></span><p class="calibre3"><span class="kobospan" id="kobo.1123.1">For RHEL-based systems, use </span><span><span class="kobospan" id="kobo.1124.1">the following:</span></span></p><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1125.1">wget</span></strong> <strong class="bold1"><span class="kobospan1" id="kobo.1126.1">https://github.com/opsgenie/oec-scripts/releases/download/Zabbix-1.1.6_oec-1.1.3/opsgenie-zabbix-1.1.6.x86_64.rpm</span></strong></pre><p class="calibre3"><span class="kobospan" id="kobo.1127.1">For Ubuntu systems, use </span><span><span class="kobospan" id="kobo.1128.1">the following:</span></span></p><pre class="source-code"><strong class="bold1"><span class="kobospan1" id="kobo.1129.1">wget https://github.com/opsgenie/oec-scripts/releases/download/Zabbix-1.1.6_oec-1.1.3/opsgenie-zabbix_1.1.6_amd64.deb</span></strong></pre></li> <li class="calibre15"><span class="kobospan" id="kobo.1130.1">We can now </span><a id="_idIndexMarker782" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1131.1">install</span><a id="_idIndexMarker783" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1132.1"> the downloaded Zabbix Opsgenie plugin by issuing the </span><span><span class="kobospan" id="kobo.1133.1">following command(s):</span></span><p class="calibre3"><span class="kobospan" id="kobo.1134.1">For RHEL-based systems, use </span><span><span class="kobospan" id="kobo.1135.1">the following:</span></span></p><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1136.1">rpm -i opsgenie-zabbix-1.1.6.x86_64.rpm</span></strong></pre><p class="calibre3"><span class="kobospan" id="kobo.1137.1">For Ubuntu systems, use </span><span><span class="kobospan" id="kobo.1138.1">the following:</span></span></p><pre class="source-code"><strong class="bold1"><span class="kobospan1" id="kobo.1139.1">dpkg -i opsgenie-zabbix_1.1.6_amd64.deb</span></strong></pre></li> <li class="calibre15"><span class="kobospan" id="kobo.1140.1">Once you’ve installed the plugin, go to the Zabbix f</span><a id="_idTextAnchor1868" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1141.1">rontend. </span><span class="kobospan" id="kobo.1141.2">If you haven’t followed any </span><a id="_idTextAnchor1869" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1142.1">of the previous recipes, create a new user group for our media types by navigating to </span><strong class="bold"><span class="kobospan" id="kobo.1143.1">Users</span></strong><span class="kobospan" id="kobo.1144.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.1145.1">User groups</span></strong><span class="kobospan" id="kobo.1146.1"> and clicking the </span><strong class="bold"><span class="kobospan" id="kobo.1147.1">Create user group</span></strong><span class="kobospan" id="kobo.1148.1"> button in the top-right corner</span><a id="_idTextAnchor1870" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1149.1">. </span><span class="kobospan" id="kobo.1149.2">Add the following </span><span><span class="kobospan" id="kobo.1150.1">user group:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer577">
<span class="kobospan" id="kobo.1151.1"><img alt="Figure 9.67 – Zabbix Create user group page, the External services group for use with Opsgenie" src="image/B19803_09_67.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1152.1">Figure 9.67 – Zabbix Create user group page, the External services group for use with Opsgenie</span></p>
<ol class="calibre16">
<li value="13" class="calibre15"><span class="kobospan" id="kobo.1153.1">Click on the </span><strong class="bold"><span class="kobospan" id="kobo.1154.1">Permissions</span></strong><span class="kobospan" id="kobo.1155.1"> tab and click on </span><strong class="bold"><span class="kobospan" id="kobo.1156.1">Select</span></strong><span class="kobospan" id="kobo.1157.1">. </span><span class="kobospan" id="kobo.1157.2">Make sure that you select all the groups and subgroups with</span><a id="_idTextAnchor1871" class="pcalibre calibre6 pcalibre1"/> <strong class="bold"><span class="kobospan" id="kobo.1158.1">Read</span></strong><span class="kobospan" id="kobo.1159.1"> permissions, </span><span><span class="kobospan" id="kobo.1160.1">as follows:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer578">
<span class="kobospan" id="kobo.1161.1"><img alt="Figure 9.68 – Zabbix Create user group permissions page, the External services group for use with Opsgenie" src="image/B19803_09_17.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1162.1">Figure 9.68 – Zabbix Create user group permissions page, the External services group for use with Opsgenie</span></p>
<ol class="calibre16">
<li value="14" class="calibre15"><span class="kobospan" id="kobo.1163.1">Now, click on</span><a id="_idIndexMarker784" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1164.1"> the </span><a id="_idIndexMarker785" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1165.1">blue </span><strong class="bold"><span class="kobospan" id="kobo.1166.1">Add</span></strong><span class="kobospan" id="kobo.1167.1"> button and finish creating this </span><span><span class="kobospan" id="kobo.1168.1">user group.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1169.1">Let’s navigate to </span><strong class="bold"><span class="kobospan" id="kobo.1170.1">Users</span></strong><span class="kobospan" id="kobo.1171.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.1172.1">Users</span></strong><span class="kobospan" id="kobo.1173.1"> and click the blue </span><strong class="bold"><span class="kobospan" id="kobo.1174.1">Create user</span></strong><span class="kobospan" id="kobo.1175.1"> button. </span><span class="kobospan" id="kobo.1175.2">Add the </span><span><span class="kobospan" id="kobo.1176.1">following user:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer579">
<span class="kobospan" id="kobo.1177.1"><img alt="Figure 9.69 – Zabbix Create user page, Opsgenie user" src="image/B19803_09_69.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1178.1">Figure 9.69 – Zabbix Create user page, Opsgenie user</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.1179.1">Tip</span></p>
<p class="callout"><span class="kobospan" id="kobo.1180.1">When creating users for things such as alerting or just API access, it is best practice to also add the user to a user group that disables the frontend access. </span><span class="kobospan" id="kobo.1180.2">This is why we added the </span><strong class="bold"><span class="kobospan" id="kobo.1181.1">No access to the frontend</span></strong> <span><span class="kobospan" id="kobo.1182.1">group here.</span></span></p>
<ol class="calibre16">
<li value="16" class="calibre15"><span class="kobospan" id="kobo.1183.1">All users will also need a </span><strong class="bold"><span class="kobospan" id="kobo.1184.1">User</span></strong><span class="kobospan" id="kobo.1185.1"> role. </span><span class="kobospan" id="kobo.1185.2">To add it, go to </span><strong class="bold"><span class="kobospan" id="kobo.1186.1">Permissions</span></strong><span class="kobospan" id="kobo.1187.1"> and add </span><span><span class="kobospan" id="kobo.1188.1">the following:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer580">
<span class="kobospan" id="kobo.1189.1"><img alt="Figure 9.70 – Zabbix Create user media page, Opsgenie user, Permissions" src="image/B19803_09_70.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1190.1">Figure 9.70 – Zabbix Create user media page, Opsgenie user, Permissions</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.1191.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.1192.1">For convenience, we are adding the user in the </span><strong class="bold"><span class="kobospan" id="kobo.1193.1">Super admin</span></strong><span class="kobospan" id="kobo.1194.1"> user role in the example. </span><span class="kobospan" id="kobo.1194.2">This overrides the read-only permissions we assigned to the </span><strong class="bold"><span class="kobospan" id="kobo.1195.1">External services</span></strong><span class="kobospan" id="kobo.1196.1"> user group. </span><span class="kobospan" id="kobo.1196.2">To limit the permissions, choose a </span><strong class="bold"><span class="kobospan" id="kobo.1197.1">User</span></strong><span class="kobospan" id="kobo.1198.1"> or </span><strong class="bold"><span class="kobospan" id="kobo.1199.1">Admin</span></strong><span class="kobospan" id="kobo.1200.1"> role for your user, which will adhere to the host group permissions we </span><span><span class="kobospan" id="kobo.1201.1">assigned earlier.</span></span></p>
<ol class="calibre16">
<li value="17" class="calibre15"><span class="kobospan" id="kobo.1202.1">For use in our</span><a id="_idIndexMarker786" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1203.1"> action, we </span><a id="_idIndexMarker787" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1204.1">need to set up a script; to do so, navigate to </span><strong class="bold"><span class="kobospan" id="kobo.1205.1">Alerts</span></strong><span class="kobospan" id="kobo.1206.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.1207.1">Scripts</span></strong><span class="kobospan" id="kobo.1208.1"> and click on </span><strong class="bold"><span class="kobospan" id="kobo.1209.1">Create script</span></strong><span class="kobospan" id="kobo.1210.1"> in the </span><span><span class="kobospan" id="kobo.1211.1">top-right corner.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1212.1">We’ll name the script </span><strong class="source-inline1"><span class="kobospan" id="kobo.1213.1">Opsgenie connector</span></strong><span class="kobospan" id="kobo.1214.1">. </span><span class="kobospan" id="kobo.1214.2">Set </span><strong class="bold"><span class="kobospan" id="kobo.1215.1">Scope</span></strong><span class="kobospan" id="kobo.1216.1"> to </span><strong class="bold"><span class="kobospan" id="kobo.1217.1">Action operation</span></strong><span class="kobospan" id="kobo.1218.1">, </span><strong class="bold"><span class="kobospan" id="kobo.1219.1">Type</span></strong><span class="kobospan" id="kobo.1220.1"> to </span><strong class="bold"><span class="kobospan" id="kobo.1221.1">Script</span></strong><span class="kobospan" id="kobo.1222.1">, and </span><strong class="bold"><span class="kobospan" id="kobo.1223.1">Execute on</span></strong><span class="kobospan" id="kobo.1224.1"> to </span><span><strong class="bold"><span class="kobospan" id="kobo.1225.1">Zabbix server</span></strong></span><span><span class="kobospan" id="kobo.1226.1">.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1227.1">Paste the contents of the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1228.1">/home/opsgenie/oec/opsgenie-zabbix/actionCommand.txt</span></strong><span class="kobospan" id="kobo.1229.1"> file on the CLI into </span><strong class="bold"><span class="kobospan" id="kobo.1230.1">Commands</span></strong><span class="kobospan" id="kobo.1231.1">. </span><span class="kobospan" id="kobo.1231.2">It should look like the </span><span><span class="kobospan" id="kobo.1232.1">following screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer581">
<span class="kobospan" id="kobo.1233.1"><img alt="Figure 9.71 – Zabbix Opsgenie connector script" src="image/B19803_09_71.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1234.1">Figure 9.71 – Zabbix Opsgenie connector script</span></p>
<ol class="calibre16">
<li value="20" class="calibre15"><span class="kobospan" id="kobo.1235.1">Don’t forget to</span><a id="_idIndexMarker788" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1236.1"> press</span><a id="_idIndexMarker789" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1237.1"> the </span><strong class="bold"><span class="kobospan" id="kobo.1238.1">Add</span></strong><span class="kobospan" id="kobo.1239.1"> button at the bottom of the page to save this </span><span><span class="kobospan" id="kobo.1240.1">new script.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1241.1">Next, navigate to </span><strong class="bold"><span class="kobospan" id="kobo.1242.1">Alerts</span></strong><span class="kobospan" id="kobo.1243.1"> | </span><strong class="bold"><span class="kobospan" id="kobo.1244.1">Actions</span></strong><span class="kobospan" id="kobo.1245.1">. </span><span class="kobospan" id="kobo.1245.2">On the </span><strong class="bold"><span class="kobospan" id="kobo.1246.1">Trigger actions</span></strong><span class="kobospan" id="kobo.1247.1"> page, click on the blue </span><strong class="bold"><span class="kobospan" id="kobo.1248.1">Create action</span></strong><span class="kobospan" id="kobo.1249.1"> button in the </span><span><span class="kobospan" id="kobo.1250.1">top-right corner.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1251.1">In the </span><strong class="bold"><span class="kobospan" id="kobo.1252.1">Name</span></strong><span class="kobospan" id="kobo.1253.1"> field, type </span><strong class="source-inline1"><span class="kobospan" id="kobo.1254.1">Opsgenie action</span></strong><span class="kobospan" id="kobo.1255.1"> and add th</span><a id="_idTextAnchor1872" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1256.1">e following items </span><span><span class="kobospan" id="kobo.1257.1">to </span></span><span><strong class="bold"><span class="kobospan" id="kobo.1258.1">Conditions</span></strong></span><span><span class="kobospan" id="kobo.1259.1">:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer582">
<span class="kobospan" id="kobo.1260.1"><img alt="Figure 9.72 – Zabbix Create new action page, Opsgenie action" src="image/B19803_09_72.JPG" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1261.1">Figure 9.72 – Zabbix Create new action page, Opsgenie action</span></p>
<ol class="calibre16">
<li value="23" class="calibre15"><span class="kobospan" id="kobo.1262.1">Now, click </span><a id="_idTextAnchor1873" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1263.1">on the </span><span><strong class="bold"><span class="kobospan" id="kobo.1264.1">Operations</span></strong></span><span><span class="kobospan" id="kobo.1265.1"> tab.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1266.1">Cli</span><a id="_idTextAnchor1874" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1267.1">ck </span><a id="_idIndexMarker790" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1268.1">the </span><a id="_idIndexMarker791" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1269.1">underlined </span><strong class="bold"><span class="kobospan" id="kobo.1270.1">Add</span></strong><span class="kobospan" id="kobo.1271.1"> text option next to </span><strong class="bold"><span class="kobospan" id="kobo.1272.1">Operations</span></strong><span class="kobospan" id="kobo.1273.1"> to add your first operation. </span><span class="kobospan" id="kobo.1273.2">For the </span><strong class="bold"><span class="kobospan" id="kobo.1274.1">Operation</span></strong><span class="kobospan" id="kobo.1275.1"> dro</span><a id="_idTextAnchor1875" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1276.1">pdown, select </span><span><strong class="bold"><span class="kobospan" id="kobo.1277.1">Opsgenie connector</span></strong></span><span><span class="kobospan" id="kobo.1278.1">.</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer583">
<span class="kobospan" id="kobo.1279.1"><img alt="Figure 9.73 – Zabbix Create action operations window, Opsgenie connector" src="image/B19803_09_73.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1280.1">Figure 9.73 – Zabbix Create action operations window, Opsgenie connector</span></p>
<ol class="calibre16">
<li value="25" class="calibre15"><span class="kobospan" id="kobo.1281.1">Repeat </span><em class="italic"><span class="kobospan" id="kobo.1282.1">step 24</span></em><span class="kobospan" id="kobo.1283.1"> for </span><strong class="bold"><span class="kobospan" id="kobo.1284.1">Recovery operations</span></strong><span class="kobospan" id="kobo.1285.1"> and</span><a id="_idTextAnchor1876" class="pcalibre calibre6 pcalibre1"/> <strong class="bold"><span class="kobospan" id="kobo.1286.1">Upda</span><a id="_idTextAnchor1877" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1287.1">te opera</span><a id="_idTextAnchor1878" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1288.1">tions</span></strong><span class="kobospan" id="kobo.1289.1">. </span><span class="kobospan" id="kobo.1289.2">It should look </span><span><span class="kobospan" id="kobo.1290.1">like this:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer584">
<span class="kobospan" id="kobo.1291.1"><img alt="Figure 9.74 – Zabbix Create action operations page, Opsgenie action" src="image/B19803_09_74.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1292.1">Figure 9.74 – Zabbix Create action operations page, Opsgenie action</span></p>
<ol class="calibre16">
<li value="26" class="calibre15"><span class="kobospan" id="kobo.1293.1">Click on the</span><a id="_idIndexMarker792" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1294.1"> blue </span><strong class="bold"><span class="kobospan" id="kobo.1295.1">Add</span></strong><span class="kobospan" id="kobo.1296.1"> button </span><a id="_idIndexMarker793" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1297.1">at the bottom of the page to fin</span><a id="_idTextAnchor1879" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1298.1">ish setting up </span><span><span class="kobospan" id="kobo.1299.1">the action.</span></span></li>
<li class="calibre15"><span class="kobospan" id="kobo.1300.1">Now, you must configure the Opsgenie Zabbix integration. </span><span class="kobospan" id="kobo.1300.2">Edit the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1301.1">config</span></strong><span class="kobospan" id="kobo.1302.1"> file with the </span><span><span class="kobospan" id="kobo.1303.1">following command:</span></span><pre class="source-code">
<strong class="bold1"><span class="kobospan1" id="kobo.1304.1">vim /home/opsg</span><a id="_idTextAnchor1880" class="pcalibre calibre18 pcalibre1"/><span class="kobospan1" id="kobo.1305.1">enie/oec/conf/config.json</span></strong></pre></li> <li class="calibre15"><span class="kobospan" id="kobo.1306.1">Make sure that you edit the </span><strong class="source-inline1"><span class="kobospan" id="kobo.1307.1">apiKey</span></strong><span class="kobospan" id="kobo.1308.1">, </span><strong class="source-inline1"><span class="kobospan" id="kobo.1309.1">command_url</span></strong><span class="kobospan" id="kobo.1310.1">, </span><strong class="source-inline1"><span class="kobospan" id="kobo.1311.1">user</span></strong><span class="kobospan" id="kobo.1312.1">, and </span><strong class="source-inline1"><span class="kobospan" id="kobo.1313.1">password</span></strong><span class="kobospan" id="kobo.1314.1"> lines, as s</span><a id="_idTextAnchor1881" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1315.1">hown in the </span><span><span class="kobospan" id="kobo.1316.1">following screenshot:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer585">
<span class="kobospan" id="kobo.1317.1"><img alt="Figure 9.75 – Opsgenie config.json file" src="image/B19803_09_75.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1318.1">Figure 9.75 – Opsgenie config.json file</span></p>
<p class="callout-heading"><span class="kobospan" id="kobo.1319.1">Important note</span></p>
<p class="callout"><span class="kobospan" id="kobo.1320.1">You will need to edit </span><strong class="source-inline1"><span class="kobospan" id="kobo.1321.1">baseUrl</span></strong><span class="kobospan" id="kobo.1322.1"> if you are not located in the United States. </span><span class="kobospan" id="kobo.1322.2">I am in Europe, so I changed it </span><span><span class="kobospan" id="kobo.1323.1">to </span></span><a href="https://api.eu.opsgenie.com" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.1324.1">https://api.eu.opsgenie.com</span></span></a><span><span class="kobospan" id="kobo.1325.1">.</span></span></p>
<ol class="calibre16">
<li value="29" class="calibre15"><span class="kobospan" id="kobo.1326.1">That’s it! </span><span class="kobospan" id="kobo.1326.2">You can now see your alerts coming in and</span><a id="_idTextAnchor1882" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1327.1"> acknowledge them </span><span><span class="kobospan" id="kobo.1328.1">from Opsgenie:</span></span></li>
</ol>
<div class="calibre2">
<div class="img---figure" id="_idContainer586">
<span class="kobospan" id="kobo.1329.1"><img alt="Figure 9﻿﻿.76 – Opsgenie alert from Zabbix" src="image/B19803_09_76.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1330.1">Figure 9</span><a id="_idTextAnchor1883" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1884" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1331.1">.76 – Opsgenie alert from Zabbix</span></p>
<h2 id="_idParaDest-319" class="calibre7"><a id="_idTextAnchor1885" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1332.1">How it works…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1333.1">When an alert is </span><a id="_idIndexMarker794" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1334.1">created</span><a id="_idIndexMarker795" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1335.1"> in Zabbix, it is sent to Opsgenie via the Zabbix integration. </span><span class="kobospan" id="kobo.1335.2">This integration utilizes the Opsgenie API to catch our Zabbix information and send bac</span><a id="_idTextAnchor1886" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1336.1">k a reply if required. </span><span class="kobospan" id="kobo.1336.2">This way, we have two-way communicat</span><a id="_idTextAnchor1887" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1337.1">ion between the </span><span><span class="kobospan" id="kobo.1338.1">two applications:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer587">
<span class="kobospan" id="kobo.1339.1"><img alt="Figure 9.77 – Opsgenie setup diagram" src="image/B19803_09_77.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1340.1">Figure 9.77 – Opsgenie setup diagram</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1341.1">Opsgenie is an amazing tool that can take several tasks away from your Zabbix server. </span><span class="kobospan" id="kobo.1341.2">I’ve used it in the past to migrate away from another monitoring tool to Zabbix. </span><span class="kobospan" id="kobo.1341.3">Opsgenie makes it easy to receive alerts from our produc</span><a id="_idTextAnchor1888" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1342.1">ts and </span><span><span class="kobospan" id="kobo.1343.1">centralize notifications:</span></span></p>
<div class="calibre2">
<div class="img---figure" id="_idContainer588">
<span class="kobospan" id="kobo.1344.1"><img alt="Figure 9.78 – Opsgenie setup example, inspir﻿ed by Wadie" src="image/B19803_09_78.jpg" class="calibre4"/></span>
</div>
</div>
<p class="img---caption" lang="en-US" xml:lang="en-US"><span class="kobospan" id="kobo.1345.1">Figure 9.78 – Opsgenie setup example, inspir</span><a id="_idTextAnchor1889" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1346.1">ed by Wadie</span></p>
<p class="calibre3"><span class="kobospan" id="kobo.1347.1">Another great</span><a id="_idIndexMarker796" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1348.1"> feature </span><a id="_idIndexMarker797" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1349.1">of Atlassian Opsgenie is the integration it offers with other Atlassian products. </span><span class="kobospan" id="kobo.1349.2">We can build a setup like the one shown in the preceding diagram to integrate all</span><a id="_idTextAnchor1890" class="pcalibre calibre6 pcalibre1"/><a id="_idTextAnchor1891" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1350.1"> the products used in </span><span><span class="kobospan" id="kobo.1351.1">our company.</span></span></p>
<h2 id="_idParaDest-320" class="calibre7"><a id="_idTextAnchor1892" class="pcalibre calibre6 pcalibre1"/><span class="kobospan" id="kobo.1352.1">There’s more…</span></h2>
<p class="calibre3"><span class="kobospan" id="kobo.1353.1">Opsgenie doesn’t just allow us to send notifications. </span><span class="kobospan" id="kobo.1353.2">It also enables us to define entire on-call schedules within the product, making it super easy for us to create schedules within the program, where Zabbix might be a bit too static. </span><span class="kobospan" id="kobo.1353.3">Check out the following link for more information about how to </span><span><span class="kobospan" id="kobo.1354.1">do that:</span></span></p>
<p class="calibre3"><a href="https://support.atlassian.com/opsgenie/docs/manage-on-call-schedules-and-rotations/" class="pcalibre calibre6 pcalibre1"><span><span class="kobospan" id="kobo.1355.1">https://support.atlassian.com/opsgenie/docs/manage-on-call-schedules-and-rotations/</span></span></a></p>
<p class="calibre3"><span class="kobospan" id="kobo.1356.1">Furthermore, there are also competitive products that integrate just as well as Opsgenie. </span><span class="kobospan" id="kobo.1356.2">PagerDuty is one of these, with native Zabbix integration. </span><span class="kobospan" id="kobo.1356.3">It has a similar feature set and it all boils down to preference, other software we might already have, </span><span><span class="kobospan" id="kobo.1357.1">and… price!</span></span></p>
</div>
</body></html>