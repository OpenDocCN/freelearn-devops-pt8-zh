- en: Building and Managing Azure Active Directory
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Working with the several **Software-as-a-Service** (**SaaS**) offerings such
    as Office 365, Dynamics CRM or Visual Studio Online requires well-managed identities
    and an excellent basic structure in the Azure **Active Directory** (**AD**) that
    builds the heart of these solutions. You, as an administrator, need to provide
    a stable identity and access management platform to manage these services.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter explains how to configure a suitable Azure AD tenant, which we
    use throughout the whole book to explore, understand, and configure the different
    features and functions in the field of identity and access management with Microsoft
    Azure. We start with the cloud-only components, followed in the next chapters
    by the hybrid identity and access management approach.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we go directly to the configuration and learn how to configure
    and manage users, groups, roles, and administrative units to provide a user and
    group-based application and self-service access, including the audit functionality.
    The chapter focuses on the following :'
  prefs: []
  type: TYPE_NORMAL
- en: Implementation scenario overview
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementing a solid Azure Active Directory
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating and managing users and groups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Assigning roles and administrative units
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Protecting your administrative accounts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Providing user and group-based application access
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Activating password reset
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using standard security monitoring
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Integrating the Azure AD Join for Windows 10 clients
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring a custom domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configure Azure AD Domain Services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now, we can introduce the implementation scenario.
  prefs: []
  type: TYPE_NORMAL
- en: Implementation scenario overview
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After completing the next configuration tasks, you will see the rich functionality
    of Microsoft Azure in the field of identity and access management, starting with
    cloud identities. You can demonstrate the different capabilities in your own Microsoft
    Azure environment. The guidance will focus on the most essential feature sets
    to give you an idea about their capabilities. We will start to use the default
    directory, which we call `domain.onmicrosoft.com` for now, and will change it
    later to a custom domain name. Domain stands for your desired name like `example.com` ,
    this is also used for the userPrincipalName of the users in this chapter, e.g.
    don.hall@doamin.onmicrosoft.com is represented in the chapter by my example domain
    called inovitcloudlabs. Be aware that this name will be visible in different applications,
    such as SharePoint Online and Skype for Business, to the end user. We recommend
    the company name without the company form, for instance, inovit GmbH would be
    `inovit.onmicrosoft.com`. Use a different name for your tests, so that the domain
    for a productive environment stays free. This configuration will be the base for
    all further scenarios in the book. For this reason, we use an **Azure**, **Enterprise
    Mobility Suite**, and **Office 365** subscription to use all the available features.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following figure shows the different main areas we will focus on in this
    chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0b8b2f65-af26-4802-a14d-10cea740c9e5.png)'
  prefs: []
  type: TYPE_IMG
- en: Chapter scenario overview
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will start the configuration of the scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: Implementing a solid Azure Active Directory
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The first step we need to take is to get an Azure AD tenant. There are many
    ways to do this. You can start with an Azure subscription or use any other service
    from the Microsoft SaaS portfolio. The easiest way to get your solution to a working
    state is to start with an Office 365 trial subscription.
  prefs: []
  type: TYPE_NORMAL
- en: 'Open your browser and navigate to [http://bit.ly/1RVpFXe](http://bit.ly/1RVpFXe)[.](http://bit.ly/1aZa9Xk) Subscribe
    to a free Office 365 Enterprise E5 plan:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8c32e97f-eee1-4518-8540-a4a2e3646b47.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 E5 trial request
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow the registration process and define your user ID, such as `admin@domain.onmicrosoft.com`.
    We recommend using a nonpersonal ID, as shown in the next screenshot. Enter your
    new user ID and password. Your default directory will get the name you define
    behind the `@`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/78c60ffd-201d-4819-b980-0b00c9ba82bd.png)'
  prefs: []
  type: TYPE_IMG
- en: First Global Administrator creation
  prefs: []
  type: TYPE_NORMAL
- en: Afterward, you need to prove your identity with a text message or a phone call
    and enter the received code. Next, you need to click Create my account. Keep in
    mind that the provisioning process takes a few minutes and should end with a success
    message.
  prefs: []
  type: TYPE_NORMAL
- en: 'After the successful creation of your brand new Azure AD with an associated
    Office 365 E5 plan, you should be able to log on with your administrative credentials
    and see the following screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4e2a85d2-32cd-4671-a5a7-cf11b8c8aa9a.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 management portal
  prefs: []
  type: TYPE_NORMAL
- en: In the next step, we will assign an **Enterprise Mobility Suite** (**EMS**)
    E5 plan to the freshly created Azure AD tenant.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the Admin icon on the right, and you should see your current assigned
    Subscriptions under the Billing tab:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/50bc2cb8-4f66-4c88-8d17-cfb5d1a9307b.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 subscription management
  prefs: []
  type: TYPE_NORMAL
- en: 'Click Add subscriptions to add the EMS E5 trial plan to your Azure AD tenant:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9c9ba7e2-78c5-4290-ba29-ed16dfdfbe14.png)'
  prefs: []
  type: TYPE_IMG
- en: EM+S E5 trial request
  prefs: []
  type: TYPE_NORMAL
- en: Choose the EMS E5 plan and click Start free trial and follow the subscription
    process. After a successful subscription process, you can see the assigned Office
    365 E5 and the EMS E5 plan in your Azure AD tenant.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have created our Azure AD tenant, we need to subscribe for an Azure
    free trial subscription. This step is necessary to use Azure resources such as
    the Azure AD Domain Services or other functionality we will discuss in the next
    chapters.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also use the following ways to get an Azure subscription:'
  prefs: []
  type: TYPE_NORMAL
- en: Use an Azure subscription from scratch ([https://account.azure.com/organization](https://account.azure.com/organization))
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use an agreement-based Azure subscription
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Use an MSDN Azure subscription, as shown in the following figure:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/988e0fde-6054-44c1-a214-58f5036251ec.png)'
  prefs: []
  type: TYPE_IMG
- en: Visual Studio subscription benefits
  prefs: []
  type: TYPE_NORMAL
- en: Remember you can only sign up for one Azure AD free trial subscription.
  prefs: []
  type: TYPE_NORMAL
- en: Let's go to configure your administrative workstation and your personal Azure
    AD tenant.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring your administrative workstation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First of all, we need to set a functional administrative workstation to work
    through this guide. You need to have a Windows 10 Enterprise client machine in
    a work group configuration. We recommend using a freshly installed Windows 10
    Enterprise virtual machine. We need a Windows 10 device to use the Azure AD Join
    later in the book. If you are not able to access the Volume Licensed or MSDN version,
    you can use the Enterprise Evaluation version at [https://www.microsoft.com/en-gb/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-gb/evalcenter/evaluate-windows-10-enterprise)[.](http://bit.ly/1P6o8Yc)
  prefs: []
  type: TYPE_NORMAL
- en: 'In the code section of this chapter, you will find the following cmdlets to
    install the needed administrative tools on your client machine, basically, the
    Azure AD, MSOnline and the Azure Resource Manager PowerShell modules:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Install the Azure Active Directory PowerShell module:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the `MSOnline` PowerShell module:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the Azure Resource Manager PowerShell module:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Connect to the `MSOnline` interface with PowerShell:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Create your first test user to prove the Azure AD administrative connection:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Connect directly to the Azure AD interface to compare the output and capabilities
    with the `MSOnline` PowerShell module:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Unpack the deployment package from the code package. The `C:\Configuration\HRExports`
    directory contains the needed HR import and group creation scripts to configure
    your Azure AD tenant with some test data:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f0df30fb-d7e4-4381-8d74-60206f4b9f13.png)'
  prefs: []
  type: TYPE_IMG
- en: Example script set
  prefs: []
  type: TYPE_NORMAL
- en: 'In the `HRImportToAAD.ps1` script, the following important variables will be
    used:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: The domain variable will contain the `domain.onmicrosoft.com` name of your Azure
    AD default directory. We use this directory and not a registered domain name for
    different steps. At the end of the chapter, we will change to a custom domain
    so that you can explore the needed tasks. As you can see, the `dir` variable contains
    the path to the scripts and the simple HR export file called `NewHire.csv`. The
    `contoso.com` domain in the file will be replaced with your domain name, stored
    in the domain variable.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `NewHire.csv` file contains the following demo user set, which will be
    used in future configurations to demonstrate the different functionalities:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'With the next step, we will assign an EMS E5 plan license to our global administrator,
    `admin@domain.onmicrosoft.com`. The Office 365 E5 was already assigned through
    the creation process. Later in the chapter, we will assign licenses through dynamic
    group membership, which is an Azure AD Premium P2 license feature:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f5794e63-fefa-4de8-bda6-d0d5e9dac851.png)'
  prefs: []
  type: TYPE_IMG
- en: License assignment operation
  prefs: []
  type: TYPE_NORMAL
- en: 'Click Assign and add the EMS E5 plan license to your global administrator.
    The expected result will be as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d39afdb9-0bcd-4ad7-bbee-67b64266c995.png)'
  prefs: []
  type: TYPE_IMG
- en: Assigned license overview
  prefs: []
  type: TYPE_NORMAL
- en: We will get the correct message that we have no active subscription assigned
    to this user ID. Next, sign up for a Microsoft Azure subscription.
  prefs: []
  type: TYPE_NORMAL
- en: Custom company branding
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Most companies like to see how they can apply their corporate identity to Azure
    services. With a few easy steps, you can show the most important capabilities.
    To add custom branding, you need to use an Azure Active Directory Premium 1, Premium
    2, Basic, or Office 365 license. With the following simple example, you can see
    what you can customize. You can provide the customizing in different languages
    to address your own or your customers'' needs. These configuration tasks are always
    a good starting point in a demo or a proof of concept. You are free to use your
    pictures and designs for this setup:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/38cfa9f7-2341-4463-ae85-e03985c7548f.png)'
  prefs: []
  type: TYPE_IMG
- en: Customized portal example
  prefs: []
  type: TYPE_NORMAL
- en: 'The first thing we are going to change is the Name of the directory in the
    properties section. Just enter your desired name. We used `INOVITCLOUDLABS by
    inovit GmbH`. You can also provide your own technical and privacy contacts and
    links on the login page:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/cd9474b3-4ce3-45b0-912c-377478ae0181.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD tenant properties
  prefs: []
  type: TYPE_NORMAL
- en: 'Click Customize Branding, and you will see the following options. So that you
    can prepare your pictures and brands, we summarized the help information provided
    in Microsoft TechNet:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/23f666b3-df36-424d-bda2-99179cdac2d8.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD portal-customizing options
  prefs: []
  type: TYPE_NORMAL
- en: Next, you will see a configuration summary.
  prefs: []
  type: TYPE_NORMAL
- en: Summary and recommendations of the help information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following section provides you with several capabilities and summarizes
    the most important corporate identity features to customize your environment:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Banner logo**: Choose between the following options:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Displayed on the Azure AD sign-in page and `myapps.microsoft.com`
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: PNG or JPEG
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Can't be taller than 36 pixels or more extensive than 245 pixels
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Recommendation—no padding around the image
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sign-in page text body**:Choose between the following options:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Appears at the bottom of the Azure AD sign-in page
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Unicode text only with a maximum length of 256 characters
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Use to communicate the phone number to your help desk or include a legal statement
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Recommendation—don't add links or HTML tags
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sign-in page background image**:Choose from the following options:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Displayed on the side of the Azure AD sign-in page
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: PNG or JPEG
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Recommended 1420 x 1200 with a supported file size of 300 KB (max. 500 KB)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Keep the exciting part in the top-left corner (image gets resized and cropped)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Username hint**:Hint text that appears to users if they forget their username:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Unicode, without links or code
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Maximum 64 characters
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Show option to remain signed in**: Let your users remain signed in to Azure
    AD until explicitly signing out:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/c31c7dd1-1d42-47d5-8aa9-66a8d6fe0543.png)'
  prefs: []
  type: TYPE_IMG
- en: Login experience
  prefs: []
  type: TYPE_NORMAL
- en: You are also able to do some extensive customization with the help of the following
    article [https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/customize-branding](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/customize-branding).
  prefs: []
  type: TYPE_NORMAL
- en: 'Your expected result should be this:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/dd64f5f3-d08f-4669-8ebd-bed35ac9959a.png)'
  prefs: []
  type: TYPE_IMG
- en: Portal-customizing effect
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have provided an essential company branding, we can start to create
    and manage users and groups.
  prefs: []
  type: TYPE_NORMAL
- en: Creating and managing users and groups
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the next steps, we connect to our Azure AD and generate the test users and
    groups.
  prefs: []
  type: TYPE_NORMAL
- en: 'Start the Azure AD PowerShell console and connect to Azure AD by executing
    the following cmdlets and scripts:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Alternatively, you can also use `connect-msolservice` directly to connect without
    the use of a variable.
  prefs: []
  type: TYPE_NORMAL
- en: 'After starting the script, go directly to [https://portal.azure.com](https://portal.azure.com)
    with your `admin@domain.onmicrosoft.com` credentials. Select the users'' section
    under your Azure AD. You should find the users from the `HireUsers.csv` file under
    the All users tab:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e3f218da-1506-4b96-b0d6-284bc8247ed2.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD portal user management
  prefs: []
  type: TYPE_NORMAL
- en: 'Open [https://portal.office.com](https://portal.office.com) | Admin | Active
    Users, and you can see your users with active licenses in Office 365:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d215a69a-1195-4cd6-aa59-79edd28d1403.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 user management
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s create three example groups to represent the company organization with
    the following script:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, you will see the created groups:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1f30f127-d4b3-4edc-9e6d-1bf035502184.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD group management
  prefs: []
  type: TYPE_NORMAL
- en: 'Test your configuration, open [https://myapps.microsoft.com](https://myapps.microsoft.com),
    and log in with the user `Don.Hall@domain.onmicrosoft.com`, and you should see
    Office 365 SharePoint, Outlook, and many applications in the access panel UI.
    Click Outlook, and you should be able to open the app without additional login
    information to access your mailbox:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/3450e95d-3784-4d5b-844c-1a8cedc8dd75.png)'
  prefs: []
  type: TYPE_IMG
- en: User Inbox dialog
  prefs: []
  type: TYPE_NORMAL
- en: In the next steps, we provide an owner to our organizational groups.
  prefs: []
  type: TYPE_NORMAL
- en: Set group owners for organizational groups
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To provide group management by the manager of a department, we will assign
    the following users as owners of their department groups:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Accounting: `Brian.Cox@domain.onmicrosoft.com`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/6d12d6e3-01f5-4efe-b04d-804ae098e2a0.png)'
  prefs: []
  type: TYPE_IMG
- en: Group - user assignment
  prefs: []
  type: TYPE_NORMAL
- en: 'Do the same for:'
  prefs: []
  type: TYPE_NORMAL
- en: 'HR: `Don.Hall@domain.onmicrosoft.com`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Sales: `Doris.Sutton@domain.onmicrosoft.com`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Now that we have configured the owners, we will start to delegate management.
  prefs: []
  type: TYPE_NORMAL
- en: Delegated group management for organizational groups
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The default configuration of Azure AD allows an owner of a security or Office
    365 group to manage the group members based on the data owner concept in the Azure
    AD Access Panel and the Azure portal.
  prefs: []
  type: TYPE_NORMAL
- en: 'Furthermore, you can limit this functionality, based on your needs:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/95bb2542-206f-4f99-8166-b660ca4a378f.png)'
  prefs: []
  type: TYPE_IMG
- en: Group options in Azure AD
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in as `Don.Hall@domain.onmicrosoft.com` to [https://myapps.microsoft.com](https://myapps.microsoft.com).
    Click on the HR group and add `Ellen.Adams@domain.onmicrosoft.com` to the HR group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ad8cd3cd-ba45-465b-b4fd-9ae5da010c2e.png)'
  prefs: []
  type: TYPE_IMG
- en: Group view in Azure AD access panel UI
  prefs: []
  type: TYPE_NORMAL
- en: Review the Join policy under Edit details.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will configure the group self-service options.
  prefs: []
  type: TYPE_NORMAL
- en: Configure self-service group management
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Another request may be that users need to be able to create request-based security
    or Office 365 groups, for instance for projects or distribution groups. For this,
    they need the capability of an approval process. You can provide this functionality
    by activating the option under the group management general section. The feature
    set requires Azure Active Directory Premium:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0f17658c-e412-4a9b-89e6-fa2257ca59ce.png)'
  prefs: []
  type: TYPE_IMG
- en: Self-Service Group Management options
  prefs: []
  type: TYPE_NORMAL
- en: 'An Office 365 group includes a distribution list but also consists of these
    shared tools:'
  prefs: []
  type: TYPE_NORMAL
- en: Inbox for group email communication
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Calendar for scheduling group meetings and events
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Library for storing and working on group files and folders
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OneNote notebook for taking project and meeting notes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning tool for organizing and assigning tasks and getting updates on project
    progress
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Guest access (set up by the administrator)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Practical note: Use a different browser or the Private Browsing option for
    handling the different user sessions: one session on [https://portal.azure.com](https://portal.azure.com)
    as `admin@domain.onmicrosoft.com` (Admin) and another session as the explicit
    user (User) under [https://myapps.microsoft.com](https://myapps.microsoft.com).'
  prefs: []
  type: TYPE_NORMAL
- en: Create the sales internal news group as an Office 365 (distribution group)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Log in as `Doris.Sutton@domain.onmicrosoft.com` to [https://myapps.microsoft.com](https://myapps.microsoft.com)
    and create the `Sales Internal News` group as an Office 365 group. Check that
    the Group policy shows This group is open to join for all users:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61b195ff-f796-4176-81a1-b48e058cd356.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD access panel UI - group creation
  prefs: []
  type: TYPE_NORMAL
- en: 'Review the Join policy of your newly created group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1762e025-81fc-40b3-9b8e-1a1b5a2f475a.png)'
  prefs: []
  type: TYPE_IMG
- en: Group dialog - Azure AD access panel UI
  prefs: []
  type: TYPE_NORMAL
- en: 'In your Azure AD, under Groups, you will also find the newly created group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d826ab8f-8306-4a6b-805e-9735db6ea7d0.png)'
  prefs: []
  type: TYPE_IMG
- en: Group overview - Azure AD access panel UI
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, as the group owner, we change the group to request a managers'' approval
    with the group policy setting:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7d8134ac-00a8-4c61-a0c2-ce9268312fb4.png)'
  prefs: []
  type: TYPE_IMG
- en: Group editing dialog
  prefs: []
  type: TYPE_NORMAL
- en: 'Test the new configuration and log in as `Don.Hall@domain.onmicrosoft.com`
    to [https://myapps.microsoft.com](https://myapps.microsoft.com). Navigate to groups.
    Choose Sales Internal News:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5fbf00b9-cd83-4b37-855b-c48f568d86d8.png)'
  prefs: []
  type: TYPE_IMG
- en: Join group dialog
  prefs: []
  type: TYPE_NORMAL
- en: Join the Sales Internal News group and type a `Business justification`, click
    Request, and the process should be started.
  prefs: []
  type: TYPE_NORMAL
- en: Log in as `Doris.Sutton@domain.onmicrosoft.com` to [https://myapps.microsoft.com](https://myapps.microsoft.com).
  prefs: []
  type: TYPE_NORMAL
- en: Check your inbox. You should have received the join request mail and a notification,
    shown in the Access Panel UI.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on this request and approve it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c00bfa0d-daa6-4736-8f1a-e4532cedab53.png)'
  prefs: []
  type: TYPE_IMG
- en: Group join - Notifications
  prefs: []
  type: TYPE_NORMAL
- en: '**Note**: Next, you will see the group members of the Sales Internal News group.'
  prefs: []
  type: TYPE_NORMAL
- en: Log in as `Don.Hall@domain.onmicrosoft.com` on [https://myapps.microsoft.com](https://myapps.microsoft.com).
  prefs: []
  type: TYPE_NORMAL
- en: 'Check your inbox, and you should have received a successful approval message:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0784e51d-3031-415b-b7cd-1e460b03824f.png)'
  prefs: []
  type: TYPE_IMG
- en: Approval message - group membership
  prefs: []
  type: TYPE_NORMAL
- en: 'Check your group membership, and you should be a member of the Sales Internal
    News group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/87f8894f-57dd-4762-be3c-a14fe74f68e7.png)'
  prefs: []
  type: TYPE_IMG
- en: Group management in Azure AD access panel UI
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will configure dynamic group memberships.
  prefs: []
  type: TYPE_NORMAL
- en: Configure dynamic group memberships
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the next section, we will configure straightforward dynamic group memberships
    to use the department attribute to add users to their department group and build
    up a dynamic licensing assignment. Group-based licensing currently does not support
    groups that contain other groups (nested groups).
  prefs: []
  type: TYPE_NORMAL
- en: An Azure AD Premium P1 license is needed for every user in a dynamic group.
  prefs: []
  type: TYPE_NORMAL
- en: When enabling dynamic groups, current memberships will be lost.
  prefs: []
  type: TYPE_NORMAL
- en: The usage location of a user needs to be set to assign a license.
  prefs: []
  type: TYPE_NORMAL
- en: As the `admin@domain.onmicrosoft.com`, choose the Accounting group, navigate
    to properties, and change the membership type to Dynamic User.
  prefs: []
  type: TYPE_NORMAL
- en: Create a simple rule, department Equals (-eq) `Accounting:`
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b4e98202-681e-4998-9b18-a171ae9dabff.png)'
  prefs: []
  type: TYPE_IMG
- en: Dynamic group membership rule configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'Set the department attribute (profile section) on the accounting users `Brian
    Cox` and `Jeff Simpson` to Accounting:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bb725e0d-f542-4984-8e69-4b552a9e2d0e.png)'
  prefs: []
  type: TYPE_IMG
- en: Filling user attributes for dynamic group usage
  prefs: []
  type: TYPE_NORMAL
- en: 'The member should be added automatically. Check the group membership and verify
    the two new members:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/22c71e10-5bd3-4b5c-8ad3-c0b720b3a30a.png)'
  prefs: []
  type: TYPE_IMG
- en: Freshly calculated dynamic group membership
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will provide an automatic licensing solution.
  prefs: []
  type: TYPE_NORMAL
- en: 'Create the following security group:'
  prefs: []
  type: TYPE_NORMAL
- en: Office 365 full feature licensing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Group description: Automatic Office 365 Full Feature Licensing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Membership type: Dynamic User'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Dynamic query: `userType -eq Member`:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/c4c4cd37-530e-409e-8cb5-47e34850a679.png)'
  prefs: []
  type: TYPE_IMG
- en: Group properties dialog
  prefs: []
  type: TYPE_NORMAL
- en: 'Under Licenses | Products, assign the Office 365 E5 plan. Don''t choose any
    assignment options at the moment:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/562b5fba-363c-4973-ab41-77e714912df3.png)'
  prefs: []
  type: TYPE_IMG
- en: Group assignment options
  prefs: []
  type: TYPE_NORMAL
- en: '**Note**: With the assignment options, you can enable/disable features as needed.'
  prefs: []
  type: TYPE_NORMAL
- en: Wait until the membership has updated and check the license assignment for `Don.Hall@domain.onmicrosoft.com`.
  prefs: []
  type: TYPE_NORMAL
- en: 'You will see that the user gets the license through a direct and group-based
    assignment:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ee6dd666-83d0-46e9-919b-1406451e37a4.png)'
  prefs: []
  type: TYPE_IMG
- en: License assignment overview
  prefs: []
  type: TYPE_NORMAL
- en: This license solution is to give you a starter. You should remove the directly
    assigned licenses from all users that get licenses from group membership.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will configure role assignments to administrative units.
  prefs: []
  type: TYPE_NORMAL
- en: Assign roles to administrative units
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To delegate tasks, we use the creation of **administrative units** (**AUs**)
    and assign roles for specific tasks. In this configuration, we generate an `HR
    [AU]` , and we assign the manager of the HR department with the role to manage
    user accounts in this scope.
  prefs: []
  type: TYPE_NORMAL
- en: Creating an administrative unit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First of all, we need to connect to our Azure AD with the PowerShell cmdlet
    Connect-AzureAD for the `admin@domain.onmicrosoft.com` user.
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following cmdlets to create the `HR [AU]`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'View the expected output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2edc5d3b-a4f5-411a-8ae9-979c64d555ee.png)'
  prefs: []
  type: TYPE_IMG
- en: Newly created administrative unit
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will add the related users.
  prefs: []
  type: TYPE_NORMAL
- en: Adding users to an administrative unit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Next, we add the users of the HR department to the `HR [AU]`. Use the following
    cmdlets to do this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of the preceding command is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/52b56e88-dcd2-4670-ac9b-16ed3be345de.png)'
  prefs: []
  type: TYPE_IMG
- en: Newly added users overview
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will use the scoping options.
  prefs: []
  type: TYPE_NORMAL
- en: Scoping administrative roles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the next step, we assign the user account administrator role. Verify available
    roles with the following cmdlet:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, we enable the user account administrator role with the following cmdlet:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'Set variables and assign the user to the role:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'The output of the preceding command is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f7d834ec-285d-4e3f-aec8-1fa42f3cccad.png)'
  prefs: []
  type: TYPE_IMG
- en: User Account Administrator assignment
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will test our configuration.
  prefs: []
  type: TYPE_NORMAL
- en: Test your configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Open a new PowerShell and connect with the `Connect-MsolService` command to
    the Azure AD, and log in with `Don.Hall@domain.onmicrosoft.com` credentials.
  prefs: []
  type: TYPE_NORMAL
- en: 'Modify a user account assigned to the HR administrative unit:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify your modification:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: Next, we will protect an administrative account with the **Privileged Identity
    Management** (**PIM**) features of Azure AD Premium P2\. We recommend using Azure
    MFA to protect your administrative accounts, if you don't want to invest in Azure
    AD Premium P2.
  prefs: []
  type: TYPE_NORMAL
- en: Protect your administrative accounts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will use Azure AD Premium P2 PIM to protect an administrative
    account in a quick intro.
  prefs: []
  type: TYPE_NORMAL
- en: Open [https://portal.azure.com](https://portal.azure.com) as `admin@domain.onmicrosoft.com`
    to start the configuration.
  prefs: []
  type: TYPE_NORMAL
- en: Click All Services and choose the Azure AD Privileged Identity Management.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, we need to Consent to PIM to use the service:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c9f0e4b5-f6c1-4d83-875a-f61c3dcd8dad.png)'
  prefs: []
  type: TYPE_IMG
- en: Privileged Identity Management - enablement
  prefs: []
  type: TYPE_NORMAL
- en: 'You will need to verify your identity and provide your preferred security verification
    option, as you can see in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/dfe17d9b-67b4-4136-9c49-d8258c935cf2.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure MFA onboarding
  prefs: []
  type: TYPE_NORMAL
- en: If you already use the Microsoft Authenticator App on your mobile device, you
    can also register the mobile app.
  prefs: []
  type: TYPE_NORMAL
- en: 'Finish the verification process and click Consent—proceed:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bd2748e8-84d2-4391-ab5e-972133da85ed.png)'
  prefs: []
  type: TYPE_IMG
- en: Consent to finish the initialization
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we sign up under Azure AD Roles, so that users can enable Azure AD roles.
    Click Sign up PIM for Azure AD Roles to activate the functionality:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b5bab472-bb2f-4a28-9111-ba9682b91439.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD roles - PIM sign-up
  prefs: []
  type: TYPE_NORMAL
- en: Now that the feature is enabled, we can assign the roles to our users.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click Assign eligibility to start the task:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/174a70aa-bb70-4d6c-87a9-7cd5736241df.png)'
  prefs: []
  type: TYPE_IMG
- en: Role assignment procedure
  prefs: []
  type: TYPE_NORMAL
- en: 'Click the Global Administrator Role, view the actual members, and add your
    test account to the role:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9a590e41-8c0b-418f-972c-81049ad16c7b.png)'
  prefs: []
  type: TYPE_IMG
- en: User assignment to a role
  prefs: []
  type: TYPE_NORMAL
- en: 'View the expected result:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d5493368-3207-439f-bf6c-bed610195b87.png)'
  prefs: []
  type: TYPE_IMG
- en: New eligible user assigned to the role
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s test our configuration by opening an `InPrivate` browser session; open
    [https://portal.azure.com](https://portal.azure.com) and log in with your own
    test account. Click All Services and choose Azure AD Privileged Identity Management. Choose
    My roles and activate the Global Administrator role for your account:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4196a791-e576-4bfa-9c81-79a5330ddda4.png)'
  prefs: []
  type: TYPE_IMG
- en: Role activation procedure
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you need to verify your identity. Follow the process, register, and verify
    your account. You need to complete the registration process just once:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e6b1e12e-424b-41fb-910c-281a32abaa08.png)'
  prefs: []
  type: TYPE_IMG
- en: Starting the verification process
  prefs: []
  type: TYPE_NORMAL
- en: 'After the registration and verification processes are finished, you can Activate
    your role:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/48150c5b-c2f7-43c5-918c-83166b67bb56.png)'
  prefs: []
  type: TYPE_IMG
- en: Role activation
  prefs: []
  type: TYPE_NORMAL
- en: 'Provide a reason for your role activation. You will note that the role is limited
    for `1` hour and that you can define a custom activation time. Later in the book,
    we will configure different roles and features:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0715fc6f-715b-4967-974a-8a515e8f00b7.png)'
  prefs: []
  type: TYPE_IMG
- en: Activation options, such as Custom activation start time and Activation reason
  prefs: []
  type: TYPE_NORMAL
- en: 'Verify that your role is activated. You have successfully requested your Global
    Administrator role for the first time over Azure AD PIM. This is very useful so
    that high privileges are not permanently assigned to your account:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ae5aefa5-1669-400b-b764-f3c23fb19cb1.png)'
  prefs: []
  type: TYPE_IMG
- en: Active roles overview
  prefs: []
  type: TYPE_NORMAL
- en: We always recommend that you leave one Global Administrator permanently assigned,
    and that no Azure MFA is required to use the account. Use this account as a Breaking
    Glass account if the Azure AD PIM or MFA service is not available.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will configure user and group-based application access in Azure AD.
  prefs: []
  type: TYPE_NORMAL
- en: Provide user and group-based application access
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we configure a typical workplace, which a user can access under
    the Access Panel UI ([https://myapps.microsoft.com](https://myapps.microsoft.com)).
    We assign applications to users and groups to see the different capabilities.
    The steps don't contain all single sign-on or provisioning options. We will discuss
    these feature sets later in specific chapters.
  prefs: []
  type: TYPE_NORMAL
- en: Log in to [https://portal.azure.com](https://portal.azure.com) with your Global
    Administrator credentials and add several applications from the application gallery
    under the Enterprise applications section. After adding the applications, we assign
    the accounts, which are to be provided access.
  prefs: []
  type: TYPE_NORMAL
- en: 'Build a list of applications like the following, and assign all groups to access
    the applications, except the one with user provisioning:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/069e6d8d-610a-4a3c-8891-cb00f484a33e.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD application management
  prefs: []
  type: TYPE_NORMAL
- en: You will note the differences in the format with and without user provisioning.
  prefs: []
  type: TYPE_NORMAL
- en: 'Test your newly configured workplace and log in as `don.hall@domain.onmicrosoft.com`
    to [https://myapps.microsoft.com](https://myapps.microsoft.com):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ee83c137-357e-45f2-8b51-a27fc44dd801.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD access panel UI - application access
  prefs: []
  type: TYPE_NORMAL
- en: Also, test the user experience on Office 365 and log in as `don.hall@domain.onmicrosoft.com`
    to [https://portal.office.com](https://portal.office.com).
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will assign applications to users.
  prefs: []
  type: TYPE_NORMAL
- en: Assign applications to users and define login information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the next step, we will assign the LinkedIn application to Don Hall, with
    the company credentials. Don Hall will not be able to see the credentials. So,
    if he leaves the company, the credentials are still protected.
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the LinkedIn application from the application gallery and assign Don Hall
    to access this application:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7b66c8b1-aa54-494b-98db-b488b1dc004b.png)'
  prefs: []
  type: TYPE_IMG
- en: Application - Users and Groups assignment
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we provide valid LinkedIn credentials. If you don''t have a LinkedIn
    account, register a demo one:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c19c6bfa-faa4-4d0c-b319-ad05d671f35e.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Credentials store
  prefs: []
  type: TYPE_NORMAL
- en: 'If you assign an application to a group, you can decide whether the credentials
    will be shared:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following options for working with credential sets are available:'
  prefs: []
  type: TYPE_NORMAL
- en: '**View with shared credentials**: Users can view this just a few seconds after
    clicking the application. Test it with the Twitter app.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**View with no shared credentials**: Users need to add the preferred credentials once.
    Test it with the Twitter app.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You get the same behavior if you, as the administrator, don't provide the credentials.
  prefs: []
  type: TYPE_NORMAL
- en: Test this behavior with the user account, assign applications to groups, and
    define login information.
  prefs: []
  type: TYPE_NORMAL
- en: Assign applications to groups and define login information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the next steps, we do the same for groups, such as an HR group that uses
    these groups to get news from an individual Twitter channel:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9285b4e9-2641-4fb4-ada3-37a299f8073c.png)'
  prefs: []
  type: TYPE_IMG
- en: Filling the Azure AD Credentials store for application access
  prefs: []
  type: TYPE_NORMAL
- en: Add the Twitter app from the application gallery. Assign the HR group and configure
    the credentials. Check the application at [https://myapps.microsoft.com](https://myapps.microsoft.com)
    with a user of the HR group.
  prefs: []
  type: TYPE_NORMAL
- en: Now, we can configure the self-service application management.
  prefs: []
  type: TYPE_NORMAL
- en: Self-service application management
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we allow users to add their applications to their workplace
    under [https://myapps.microsoft.com](https://myapps.microsoft.com) to enjoy the
    Single Sign-On feature. Under your Azure AD in the Configure section, navigate
    to Enterprise applications. Activate the function shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/01e4a482-7c92-49ff-a6d9-83b2b201f85c.png)'
  prefs: []
  type: TYPE_IMG
- en: Enterprise applications management options
  prefs: []
  type: TYPE_NORMAL
- en: Log in as `Ellen.Adams@domain.onmicrosoft.com` to [https://myapps.microsoft.com](https://myapps.microsoft.com). Click
    Get more applications and add MailChimp. After you add MailChimp, click Manage
    applications and choose MailChimp.
  prefs: []
  type: TYPE_NORMAL
- en: As `admin@domain.onmicrosoft.com` on [https://manage.windowsazure.com](https://manage.windowsazure.com),
    you can see the newly added application under the Enterprise applications section
    of your Azure AD.
  prefs: []
  type: TYPE_NORMAL
- en: Configure the application, add some users, and test it!
  prefs: []
  type: TYPE_NORMAL
- en: Password reset self-service capabilities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we configure the password reset capabilities of Azure AD to
    reduce support costs and 24/7 availability. We use no restrictions on the service
    and we require just one verification option to reset the password:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b544f817-7ef2-4eba-8fda-f234fbb6e944.png)'
  prefs: []
  type: TYPE_IMG
- en: Password reset - Properties dialog to select the activation options
  prefs: []
  type: TYPE_NORMAL
- en: 'To verify the reset, we use several methods:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d08719a8-667b-48dd-a6aa-82e3420ed80d.png)'
  prefs: []
  type: TYPE_IMG
- en: Password reset - authentication options
  prefs: []
  type: TYPE_NORMAL
- en: 'The next option we activate forces the user to register:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/48184f13-684d-4c4a-b7d7-8b9985287653.png)'
  prefs: []
  type: TYPE_IMG
- en: Password reset - Registration requirement and confirming choices
  prefs: []
  type: TYPE_NORMAL
- en: Next, we configure the related notifications.
  prefs: []
  type: TYPE_NORMAL
- en: Configure notifications
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we configure the notifications options so that the administrator
    will be notified if anomalous sign-ins or administrator password resets happen:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Configure the Notifications as shown here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a68537a8-66ce-44a2-b1e0-974e16e18dd2.png)'
  prefs: []
  type: TYPE_IMG
- en: Password reset - NotificationS options
  prefs: []
  type: TYPE_NORMAL
- en: 'Users will be forced to register for a password reset, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0f422386-f61f-4ffc-b4b1-0d331b477f74.png)'
  prefs: []
  type: TYPE_IMG
- en: Registration enforcement
  prefs: []
  type: TYPE_NORMAL
- en: Now, we will test our newly configured feature and will see the registration
    scenario required for your verification options. Next, we will check the password
    reset.
  prefs: []
  type: TYPE_NORMAL
- en: Test the newly configured settings and log in as `Don.Hall@domain.onmicrosoft.com`
    to [https://myapps.microsoft.com](https://myapps.microsoft.com).
  prefs: []
  type: TYPE_NORMAL
- en: 'You will receive a message that you need to register for a password reset:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/641bcf1d-e047-46e0-9a72-335b4b2c02e7.png)'
  prefs: []
  type: TYPE_IMG
- en: Authenticator app - setup procedure
  prefs: []
  type: TYPE_NORMAL
- en: Add your preferred method for Don Hall. You will receive an SMS text message,
    an email to your mailbox, or another of your defined response methods.
  prefs: []
  type: TYPE_NORMAL
- en: Administrative users need two verification options by default.
  prefs: []
  type: TYPE_NORMAL
- en: Log in as `admin@domain.onmicrosoft.com` to [https://myapps.microsoft.com](https://myapps.microsoft.com) ,
    and you will see the request for two verification options.
  prefs: []
  type: TYPE_NORMAL
- en: In the next steps, we will verify the functionality.
  prefs: []
  type: TYPE_NORMAL
- en: Test the password reset process
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Open `https://myapps.microsoft.com` in your preferred browser and enter `Don.Hall@domain.onmicrosoft.com`. Click
    the Can't access your account? option or use the following link, [https://passwordreset.microsoftonline.com](https://passwordreset.microsoftonline.com),
    to start the password reset process. You will come into the verification process,
    and you need to follow the tasks. Finish the process and log in with the new password.
  prefs: []
  type: TYPE_NORMAL
- en: Using standard security monitoring
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will configure and simulate some typical events that get
    reported in the Azure AD Monitoring section.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we configure a Password protection feature, Custom smart lockout. We
    set the value to `10` incorrect logins:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/59936ce8-6a98-47e5-ad66-d4dc4295bd17.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD password protection features
  prefs: []
  type: TYPE_NORMAL
- en: 'You should receive the following message if you provide a wrong password 10
    times:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2195dd87-018b-498e-b26e-cb7b1f1990ed.png)'
  prefs: []
  type: TYPE_IMG
- en: Locked message dialog
  prefs: []
  type: TYPE_NORMAL
- en: 'You can see the activity under Monitoring | Sign-In:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6590a08a-0d8a-4591-b98d-95b87db3152f.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD monitoring capabilities
  prefs: []
  type: TYPE_NORMAL
- en: You can also test Sign-ins from multiple geographies with simulation software
    such as **CyberGhost** ([http://www.cyberghostvpn.com/en_us](http://www.cyberghostvpn.com/en_us)).
    Another option would be to use an Azure Virtual Machine.
  prefs: []
  type: TYPE_NORMAL
- en: 'Log in with an account between geographic regions that are far apart, such
    as Europe and Asia. This requires a remote machine from your location and in a
    different time zone, with logons as close together as possible:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in to [https://myapps.microsoft.com](https://myapps.microsoft.com) as `Don.Hall@domain.onmicrosoft.com`
    from your local PC
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Log in to [https://myapps.microsoft.com](https://myapps.microsoft.com) as `Don.Hall@domain.onmicrosoft.com`
    on a machine in a different time zone than your original PC
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To configure users with an anomalous sign-in activity, you can use the Tor
    browser:'
  prefs: []
  type: TYPE_NORMAL
- en: Utilize an anonymous browsing tool such as Tor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Download the secure Tor browser from [https://www.torproject.org/download/download-easy.html.en](https://www.torproject.org/download/download-easy.html.en)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Open the Tor browser, go to [https://myapps.microsoft.com](https://myapps.microsoft.com),
    and log in as `Don.Hall@domain.onmicrosoft.com`. Your user account will be locked.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following result is expected in security monitoring:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/50041110-ac0f-4e34-b18b-a4e6cbd65ef7.png)'
  prefs: []
  type: TYPE_IMG
- en: Security monitoring overview - Azure AD
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have had a short journey through the security-monitoring options,
    we will integrate our Windows 10 client into Azure AD.
  prefs: []
  type: TYPE_NORMAL
- en: Integrating Azure AD Join for Windows 10 clients
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will configure the Azure AD Join functionality and join
    our first Windows 10 client to Azure AD.
  prefs: []
  type: TYPE_NORMAL
- en: 'We configure a maximum of five devices per user and leave the other default
    values:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/236f791d-ef39-4bd4-9d4f-4f87197c6ca6.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD - Device settings
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we will join our client to Azure AD.
  prefs: []
  type: TYPE_NORMAL
- en: Join your Windows 10 client to Azure AD
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Log in to your freshly installed Windows 10 client machine and go to Settings.
    Choose Connect in the Access work or school section:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d043ca16-c8d9-48ad-979d-c2a24a1e5139.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Join process dialog
  prefs: []
  type: TYPE_NORMAL
- en: 'We sign in with `don.hall@domain.onmicrosoft.com` and join the Windows 10 client
    to Azure AD:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61c50821-945d-4bb0-8665-510745984f14.png)'
  prefs: []
  type: TYPE_IMG
- en: Join actions overview
  prefs: []
  type: TYPE_NORMAL
- en: 'Click through the Next sections and finish joining the client. Afterwards,
    we will check the new status. The expected result will be the connection to your
    Azure AD name:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7182198d-0a64-4cf7-a521-3637c4e479c8.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD joined client message
  prefs: []
  type: TYPE_NORMAL
- en: Afterward, we will verify the Azure AD Join process.
  prefs: []
  type: TYPE_NORMAL
- en: Verify the newly joined Windows 10 client
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Log in to the Windows 10 client with the credentials of `don.hall@domain.onmicrosoft.com`
    and click through the security policy configuration. Click Enforce these policies. Click
    through the PIN setup and finish the process, then test the user experience:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the mail application, and you will see that the system recognizes your
    user ID and Single Sign-On is provided.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Also, if you open [https://myapps.microsoft.com](https://myapps.microsoft.com),
    you will be directly logged in to the access panel UI:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/48fdb9c9-f5b9-4350-8193-a1b2bbdf8073.png)'
  prefs: []
  type: TYPE_IMG
- en: Different mail account options
  prefs: []
  type: TYPE_NORMAL
- en: After verifying the Azure AD Join, we will configure a custom domain. Be aware
    that you need to register a domain if you want to test the associated functionality.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a custom domain
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Under the Azure Active Directory | Custom domain section, click Add custom
    domain and complete the verification process to prove that you are the owner of
    the domain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/905e2a04-c21e-4430-804d-0e12897e9a3f.png)'
  prefs: []
  type: TYPE_IMG
- en: Actual configured domains
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the TXT entry shown to your DNS zone to verify the domain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/908703a0-f6d5-432d-82e9-c7bbb0959a58.png)'
  prefs: []
  type: TYPE_IMG
- en: Domain verification options
  prefs: []
  type: TYPE_NORMAL
- en: 'Click the Verify button on your Azure portal, and after successful verification,
    the new `DOMAIN NAME` will appear under DOMAINS. Choose the Make primary option:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8d7858b2-3efe-484e-9590-5796a1e6a59b.png)'
  prefs: []
  type: TYPE_IMG
- en: Custom domain overview and configuration options (Make primary or Download the
    Azure AD Connect tool)
  prefs: []
  type: TYPE_NORMAL
- en: 'Open [https://portal.office.com](https://portal.office.com) to complete the
    domain setup process under the admin section:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/27f4b243-77d5-4fda-b894-abe32104a5df.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 setup wizard
  prefs: []
  type: TYPE_NORMAL
- en: 'Choose the custom domain to be used for email addresses:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c68834d4-fa43-4034-a5b6-cf6398b047a4.png)'
  prefs: []
  type: TYPE_IMG
- en: Sign-in and mail options
  prefs: []
  type: TYPE_NORMAL
- en: 'The last step we need to take is to set the new `UserPrincipalNames` to the
    existing users. We do this with a small example scripting solution:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Connect to your Azure AD with your global administrator credentials:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'Export the existing users to a CSV file with the following cmdlet:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove all accounts you don''t want to modify and make the change with the
    following cmdlets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: 'You should get a result similar to this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3279dc33-05cc-4006-b039-56615013fb6f.png)'
  prefs: []
  type: TYPE_IMG
- en: Active users overview
  prefs: []
  type: TYPE_NORMAL
- en: The primary email will also be changed to the custom domain.
  prefs: []
  type: TYPE_NORMAL
- en: Next, we will configure the Azure AD Domain services to provide a transition
    scenario for a Kerberos-based application that is normally provided in on-premises
    infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: Configure Azure AD Domain Services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To integrate a legacy application based on Kerberos authentication in an Azure
    **infrastructure as a service** (**IaaS**) scenario, we configure Azure AD Domain
    Services. In this section, we configure the basic service and integrate an active
    example application:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/36d8ebde-f46e-4a3e-8b6b-208256dfa6b8.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Domain Services creation
  prefs: []
  type: TYPE_NORMAL
- en: 'To start the configuration, we need to specify the DNS domain name, the Azure
    Subscription we want to use, and the name of the Resource group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ef745788-6bed-4d25-bfae-dcb9566aa98d.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Domain Services configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'When enabling Azure AD Domain Services, you will need to specify which Azure
    virtual network to use. We use a range `192.168.x.x/20` to configure the network:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ef3a1a09-635f-41ac-9fb9-6342d9d19b15.png)'
  prefs: []
  type: TYPE_IMG
- en: Virtual network configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the admin account and your test user as a member of the Azure AD Domain
    Services Administrator group:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/64d43463-2317-4156-b42b-cb0d47a4e1a7.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Domain Services Administrator group members
  prefs: []
  type: TYPE_NORMAL
- en: 'The summary should look like the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/51ed8343-3fde-487d-ac50-35f5d0813012.png)'
  prefs: []
  type: TYPE_IMG
- en: Configuration summary
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you will be asked to update the DNS configuration to the addresses of
    your DNS servers provided by Azure AD Domain Services. In my case, these addresses
    were `192.168.0.4` and `192.168.0.5`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7c4b8809-8be4-4ffc-a62a-2423c961693b.png)'
  prefs: []
  type: TYPE_IMG
- en: DNS configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'The last important step that you need to complete to use the domain you have
    just created is to enable password synchronization:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e1789118-bd27-4eb7-af8e-fe036d4aba65.png)'
  prefs: []
  type: TYPE_IMG
- en: Instructions to synchronize users
  prefs: []
  type: TYPE_NORMAL
- en: By default, Azure AD does not store the credential hashes required for Kerberos
    authentication. You need to populate these credential hashes in Azure AD so that
    users can use them to authenticate against the domain. The process can be completed
    by changing the password of the user. You can use the accounts after 20 minutes
    in Azure AD Domain Services.
  prefs: []
  type: TYPE_NORMAL
- en: 'You have two options: let passwords expire for all users or instruct these
    end users to change their passwords.'
  prefs: []
  type: TYPE_NORMAL
- en: Users can use Azure AD's self-service password change mechanism from the Azure
    AD Access Panel page to change their passwords.
  prefs: []
  type: TYPE_NORMAL
- en: Test and verify your new Azure AD Domain Services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To test the Domain Services, we complete the following tasks:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Install a virtual Windows Server in your Azure IaaS environment by using a
    deployment template ([https://docs.microsoft.com/en-us/azure/active-directory-domain-services/active-directory-ds-join-windows-vm-template](https://docs.microsoft.com/en-us/azure/active-directory-domain-services/active-directory-ds-join-windows-vm-template)):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/176c3e40-bf42-4893-85e7-eefd9a880006.png)'
  prefs: []
  type: TYPE_IMG
- en: VM deployment configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'Install the administrative tools for Active Directory and DNS on the newly
    joined server:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'Connect to Active Directory Users and Computers (`dsa.msc`) and the Group Policy
    Management console to verify your configuration:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/8d20500e-2be9-40c1-b09e-920b53d549c6.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD Domain Services structure including synchronized objects
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we need to create a DNS HOST (A) record for our test application:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/29296039-78c7-4c59-a042-2e6bd17da1fd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, we can install a basic IIS configuration, used to handle the Kerberos
    part. For this, you need to install the IIS components, choose the Kerberos authentication
    feature, and activate it on the default website. Only Windows Authentication needs
    to be activated:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/565bf2f3-06b5-4f22-b906-41ae8c7bba19.png)'
  prefs: []
  type: TYPE_IMG
- en: IIS Authentication configuration for Kerberos example application
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we will install and configure the Azure AD App Proxy connector to provide
    the application to your users. We use the following cmdlets to configure the needed,
    resource-based KCD feature:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, we will activate and configure the Azure AD App Proxy. To make it simple,
    we disable the IE Enhanced Security Configuration so that we don''t need to provide
    any IE Security Zone configurations, just for the lab:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1611faf6-5ef3-4907-b230-a09b366bf6fd.png)'
  prefs: []
  type: TYPE_IMG
- en: Server Manager IE Enhanced Security Configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we need to download the connector and install it on the server:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0412bbc0-2f6a-417e-8f56-ee803bfe7c75.png)'
  prefs: []
  type: TYPE_IMG
- en: Application Proxy agent download and configuration
  prefs: []
  type: TYPE_NORMAL
- en: To configure the connector on the server, you need to provide a user with global
    administrator rights.
  prefs: []
  type: TYPE_NORMAL
- en: 'After installing and configuring the connector, we will add our example app:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/bf19fc3b-a969-4281-a9bd-e52a4ad22bb9.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure AD App Proxy Connector group configuration options
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we configure our example app as shown:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fc06c4d9-eaa9-4640-bee0-c7a0f5dcf1a1.png)'
  prefs: []
  type: TYPE_IMG
- en: Kerberos example configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we configure the **Integrated Windows Authentication** (**IWA**) option:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c190a5e3-f352-42c7-8a9a-b456703b65f9.png)'
  prefs: []
  type: TYPE_IMG
- en: Application IWA configuration
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we assign some users or groups and test the application at [https://myapps.microsoft.com](https://myapps.microsoft.com).
    As a result, you should see the IIS test page. We provided a sample Kerberos-based
    application to Azure AD Domain Services and used the Azure AD App Proxy functionality.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After working through this implementation scenario, you will be able to configure
    and manage a suitable Azure AD tenant for the most important tasks. You will also
    be able to integrate Windows 10 and Office 365 to build a productive workforce
    for your users without an on-premises infrastructure. Don't worry if you missed
    some functionality. This was just a warm-up.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will discuss the identity synchronization needed to
    start with your hybrid integration and to provide the correct identity synchronization
    scenario for your requirements.
  prefs: []
  type: TYPE_NORMAL
