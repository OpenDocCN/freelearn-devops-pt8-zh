- en: Chapter 3. Installing and Configuring Windows Azure Pack
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第三章：安装和配置 Windows Azure Pack
- en: In the previous chapter, we covered planning and configuration of Cloud Fabric
    Infrastructure, which is used to host the Cloud Fabric management and tenant workloads.
    Moving ahead, in this chapter we shall cover the installation and configuration
    of Windows Azure Pack websites, APIs, and authentication sites. We shall also
    cover post deployment steps such as customizing portal names and certificates
    as per enterprise and service providers' needs.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们讲解了云基础设施的规划与配置，它用于托管云基础设施管理和租户工作负载。接下来，本章将讲解 Windows Azure Pack 网站、API
    和认证站点的安装与配置。我们还将覆盖部署后的步骤，例如根据企业和服务提供商的需求自定义门户名称和证书。
- en: 'We will be covering the following topics in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将覆盖以下主题：
- en: Windows Azure Pack deployment model review
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Azure Pack 部署模型回顾
- en: Installing and configuring Windows Azure Pack
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装和配置 Windows Azure Pack
- en: Installing Windows Azure Pack in a distributed model
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在分布式模型中安装 Windows Azure Pack
- en: Required firewall ports for WAP components
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WAP 组件所需的防火墙端口
- en: Customizing WAP portals' accessibility and certificates summary
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义 WAP 门户的可访问性和证书总结
- en: Registering the Service Provider Foundation with WAP
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将服务提供商基础设施与 WAP 注册
- en: Windows Azure Pack deployment models review
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Windows Azure Pack 部署模型回顾
- en: In [Chapter 1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715
    "Chapter 1. Know Windows Azure Pack and Its Architecture"), *Know Windows Azure
    Pack and Its Architecture*, we covered the architecture and various deployment
    models for an organization's private cloud and a service provider's cloud needs.
    Let's have a review of possible and recommended deployment models before starting
    actual installation of **Windows Azure Pack** (**WAP**).
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第1章](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715 "第1章：了解
    Windows Azure Pack 及其架构")，*了解 Windows Azure Pack 及其架构*中，我们介绍了适用于组织私有云和服务提供商云需求的架构及各种部署模型。在开始实际安装
    **Windows Azure Pack**（**WAP**）之前，让我们回顾一下可能的和推荐的部署模型。
- en: '**Express Deployment Architecture**: In Express Deployment Architecture, all
    components of WAP (portals, APIs, and authentication sites) are installed on a
    single Windows Server 2012/Windows Server 2012 R2\. It doesn''t provide any high
    availability and is suitable only for testing, development, and deployments. For
    the purpose of evaluating WAP in this book, we shall be following the Express
    Deployment model.'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**快速部署架构**：在快速部署架构中，WAP 的所有组件（门户、API 和认证站点）都安装在单一的 Windows Server 2012/Windows
    Server 2012 R2 上。它不提供任何高可用性，仅适用于测试、开发和部署。为了在本书中评估 WAP，我们将遵循快速部署模型。'
- en: '**Distributed Deployment Architecture**: In Distributed Deployment Architecture,
    WAP roles such as Admin/Tenant portals or API''s. authentication sites are deployed
    in a distributed manner involving multiple Windows servers to provide scalability
    and high availability in a secure manner. Distributed Deployment Architecture
    can be customized as per requirement, such as adding a **high availability** (**HA**)
    layer only for particular roles instead of all. This is suitable for production
    deployments.'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分布式部署架构**：在分布式部署架构中，WAP 角色如管理员/租户门户或 API、认证站点以分布式方式部署，涉及多个 Windows 服务器，以提供可扩展性和高可用性，并确保安全性。分布式部署架构可以根据需求进行定制，例如只为某些角色添加
    **高可用性**（**HA**）层，而不是为所有角色添加。这种架构适用于生产环境部署。'
- en: Installing and configuring Windows Azure Pack
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装和配置 Windows Azure Pack
- en: '**Microsoft Web Platform Installer** (**WEB PI**) is used to install Windows
    Azure Pack components in both Express and Distributed Architectures. Microsoft
    Web Platform is a free tool available, which is used to download and install latest
    components of Microsoft Web platform-related components such as IIS, .NET, web
    development tools, web applications, Windows Azure Pack, and so on. Web PI automatically
    detects the operating system on which it''s executed and displays only compatible
    solutions available for download and installation.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '**Microsoft Web Platform Installer**（**WEB PI**）用于在快速部署和分布式架构中安装 Windows Azure
    Pack 组件。Microsoft Web Platform 是一款免费的工具，用于下载并安装最新的 Microsoft Web 平台相关组件，如 IIS、.NET、Web
    开发工具、Web 应用程序、Windows Azure Pack 等。Web PI 会自动检测执行它的操作系统，并仅显示可下载和安装的兼容解决方案。'
- en: Before downloading and starting Web Platform installer, we need to ensure that
    Windows Azure Pack installation prerequisites are completed. Let's finish up the
    prerequisites before starting the installation.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在下载并启动 Web 平台安装程序之前，我们需要确保 Windows Azure Pack 安装的前提条件已完成。在开始安装之前，先完成前提条件。
- en: WAP installation prerequisite
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: WAP 安装前提条件
- en: For the purpose of evaluation, we are installing Windows Azure Pack in the Express
    Deployment model. The following hardware and software prerequisites have to be
    met before starting the installation. Please follow [Chapter 1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715
    "Chapter 1. Know Windows Azure Pack and Its Architecture"), *Know Windows Azure
    Pack and Its Architecture*, for details on hardware requirements and for the deployment
    model of Express and Distributed Deployment Architectures.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估目的，我们正在以 Express 部署模型安装 Windows Azure Pack。在开始安装之前，必须满足以下硬件和软件的前提条件。请参阅
    [第 1 章](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715 "第 1 章。了解
    Windows Azure Pack 及其架构")，*了解 Windows Azure Pack 及其架构*，以获取硬件要求的详细信息以及 Express
    和分布式部署架构的部署模型。
- en: 'Active Directory user accounts:'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Active Directory 用户账户：
- en: 'Create the following user accounts and groups in Active Directory for Windows
    Azure Pack components authentication:'
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 Active Directory 中为 Windows Azure Pack 组件身份验证创建以下用户账户和组：
- en: '| Account Name | Purpose | Permissions |'
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| 账户名称 | 目的 | 权限 |'
- en: '| --- | --- | --- |'
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Wapsvc | Service account for WAP Web Services | Member of local administrator
    group on WAP servers and WAP Admins Group Member |'
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| Wapsvc | WAP Web 服务的服务账户 | WAP 服务器上的本地管理员组成员和 WAP Admins 组成员 |'
- en: '| Wapadmin | Administrator account to manage WAP Cloud | Member of local administrator
    group on WAP servers + WAPAdmins Group Member |'
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| Wapadmin | 管理 WAP 云的管理员账户 | WAP 服务器上的本地管理员组成员 + WAPAdmins 组成员 |'
- en: '| Wapadmins | WAP Administrators Group | Member of local administrator group
    on WAP servers |'
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_TB
  zh: '| Wapadmins | WAP 管理员组 | WAP 服务器上的本地管理员组成员 |'
- en: 'Hardware requirements:'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 硬件要求：
- en: Windows Server 2012 R2 VM or physical server
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2012 R2 虚拟机或物理服务器
- en: 8 GB RAM (no dynamic memory)
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 8 GB RAM（无动态内存）
- en: 50 GB of available disk space
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 50 GB 可用磁盘空间
- en: 'Software requirements:'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件要求：
- en: Windows Server 2012 /2012 R2 operating system. All the latest features and support
    are available with Windows Server 2012 R2\. See the feature compatibility guide
    if deploying on Windows Server 2012.
  id: totrans-30
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server 2012 /2012 R2 操作系统。Windows Server 2012 R2 提供了所有最新功能和支持。如果在 Windows
    Server 2012 上部署，请查看功能兼容性指南。
- en: Microsoft Web Platform Installer 5, available at [http://www.microsoft.com/web/downloads/platform.aspx](http://www.microsoft.com/web/downloads/platform.aspx).
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft Web 平台安装程序 5，下载地址 [http://www.microsoft.com/web/downloads/platform.aspx](http://www.microsoft.com/web/downloads/platform.aspx)。
- en: Microsoft .NET Framework 3.5 Service Pack. Install using the server manager
    and add features wizard.
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft .NET Framework 3.5 服务包。使用服务器管理器和添加功能向导进行安装。
- en: IIS (Internet Information Service). Component of Windows Server OS. Web Platform
    installer can install it automatically before WAP installation. Add Management
    Console manually later.
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: IIS（Internet 信息服务）。Windows Server 操作系统的组件。Web 平台安装程序可以在 WAP 安装之前自动安装它。稍后手动添加管理控制台。
- en: Microsoft .NET Framework 4.5 Extended with ASP.NET for Windows 8\. It can be
    installed using the Server Manager's Add Feature wizard. WEB PI can also automatically
    install this before starting WAP installation.
  id: totrans-34
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Microsoft .NET Framework 4.5 Extended with ASP.NET for Windows 8。可以使用服务器管理器的“添加功能”向导进行安装。WEB
    PI 也可以在启动 WAP 安装之前自动安装此组件。
- en: Internet Explorer enhanced security configuration for administrators should
    be disabled. Use Server Manager to disable it.
  id: totrans-35
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应该禁用管理员的 Internet Explorer 增强安全配置。请使用服务器管理器来禁用它。
- en: Note
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Installing .NET Framework 3.5 on Windows Server 2012 or 2012 R2 requires specifying
    an alternate location for .NET files in the Add Roles and Features wizard. Visit
    [https://technet.microsoft.com/en-in/library/dn482071.aspx](https://technet.microsoft.com/en-in/library/dn482071.aspx)
    for more information on this.
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在 Windows Server 2012 或 2012 R2 上安装 .NET Framework 3.5 时，需要在“添加角色和功能”向导中指定 .NET
    文件的备用位置。有关更多信息，请访问 [https://technet.microsoft.com/en-in/library/dn482071.aspx](https://technet.microsoft.com/en-in/library/dn482071.aspx)。
- en: 'Installing Windows Azure Pack: Portal and API Express'
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安装 Windows Azure Pack：Portal 和 API Express
- en: We can start installing Windows Azure Pack after successful completion of the
    prerequisites.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 在成功完成前提条件后，我们可以开始安装 Windows Azure Pack。
- en: 'Follow the following steps to install WAP Express:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤安装 WAP Express：
- en: Log on to the WAP server.
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录到 WAP 服务器。
- en: Start Microsoft Web PI (Microsoft Web Platform Installer).
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动 Microsoft Web PI（Microsoft Web Platform Installer）。
- en: 'Search **Windows Azure Pack: Portal and API Express**. Web PI will automatically
    detect that it''s running and Windows Server 2012 R2 will display only compatible
    products for download and installation.'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '搜索**Windows Azure Pack: Portal and API Express**。Web PI 会自动检测到其正在运行，并且 Windows
    Server 2012 R2 只会显示兼容的产品供下载和安装。'
- en: 'Search for **Windows Azure Pack: Portal and API Express**. This will automatically
    download and install all WAP components that are a part of Express Deployment.![Installing
    Windows Azure Pack: Portal and API Express](img/00035.jpeg)'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '搜索**Windows Azure Pack: Portal and API Express**。这将自动下载并安装作为 Express 部署一部分的所有
    WAP 组件。![Installing Windows Azure Pack: Portal and API Express](img/00035.jpeg)'
- en: Click **Add** to select the highlighted entry for download and installation.
  id: totrans-45
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**添加**以选择高亮显示的条目进行下载和安装。
- en: Select **Install** to proceed further.
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**安装**以继续操作。
- en: 'Web PI wizard will show the prerequisites and optional components that can
    be installed. You may choose to remove extra components such as partner provided
    extensions if you are not planning to use them.![Installing Windows Azure Pack:
    Portal and API Express](img/00036.jpeg)'
  id: totrans-47
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 'Web PI 向导将显示可以安装的先决条件和可选组件。如果不打算使用某些组件（如合作伙伴提供的扩展），可以选择删除它们。![Installing Windows
    Azure Pack: Portal and API Express](img/00036.jpeg)'
- en: Remove any extra or not used components and click **I Accept** to proceed further.
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除任何额外或未使用的组件，并点击**我接受**以继续操作。
- en: Select Microsoft updates settings as per your requirement. It is recommended
    to enable Microsoft updates to keep WAP and other components updated with the
    latest features and fixes using the Windows Update Console itself.
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据需求选择 Microsoft 更新设置。建议启用 Microsoft 更新，以便使用 Windows Update 控制台将 WAP 和其他组件更新到最新功能和修复版本。
- en: 'Wizard will start downloading and installing WAP components and prerequisites,
    as shown in the following screenshot:![Installing Windows Azure Pack: Portal and
    API Express](img/00037.jpeg)'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '向导将开始下载并安装 WAP 组件和先决条件，如下图所示：![Installing Windows Azure Pack: Portal and API
    Express](img/00037.jpeg)'
- en: 'Successful installation will take you to the **CONFIGURE** page, which provides
    details on configuring the WAP installed components, as shown in the following
    screenshot. WAP creates a site named Windows Azure Pack Configuration Site in
    IIS for configuration and integration of all the WAP components and databases
    during the initial setup. Click on **Continue** to proceed further. Clicking **Continue**
    will also open the configuration site page, which can be configured now or closed
    to configure the settings later.![Installing Windows Azure Pack: Portal and API
    Express](img/00038.jpeg)'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '安装成功后，将进入**配置**页面，页面上提供了关于配置 WAP 已安装组件的详细信息，如下图所示。在初始设置期间，WAP 会在 IIS 中创建一个名为
    Windows Azure Pack 配置站点的站点，用于配置和集成所有 WAP 组件和数据库。点击**继续**以继续操作。点击**继续**还会打开配置站点页面，您可以现在配置，或者稍后关闭页面再进行设置。![Installing
    Windows Azure Pack: Portal and API Express](img/00038.jpeg)'
- en: Review the installed components summary and finish the wizard. See installation
    logs in case of any errors. Exit the Web PI Console.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审核已安装组件的摘要并完成向导。如遇到错误，请查看安装日志。退出 Web PI 控制台。
- en: Installed components can be verified in the Programs and Features (`appwiz.cpl`)
    management console.
  id: totrans-53
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 已安装的组件可以在程序和功能（`appwiz.cpl`）管理控制台中验证。
- en: Tip
  id: totrans-54
  prefs:
  - PREF_IND
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Microsoft Web PI always contains the latest available version along with updates
    of Windows Azure Pack components.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: Microsoft Web PI 总是包含 Windows Azure Pack 组件的最新版本及其更新。
- en: Configuring Windows Azure Pack Express Deployment
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置 Windows Azure Pack Express 部署
- en: In the preceding topic, we only installed those WAP components that were not
    ready to be used yet. Now, we need to configure all the WAP components (installed
    on a single server) by integrating with its management database and so on. Windows
    Azure Pack Configuration Site is used to configure the installation. You can open
    WAP Configuration Site by opening IE and its URL, or by using the Start menu icon.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的话题中，我们只安装了那些尚未准备好使用的 WAP 组件。现在，我们需要通过将其与管理数据库等进行集成，来配置所有的 WAP 组件（已安装在单个服务器上）。Windows
    Azure Pack 配置站点用于配置安装。您可以通过打开 IE 和输入其 URL，或使用开始菜单图标来打开 WAP 配置站点。
- en: 'Steps to configure a WAP Express installation are as follows:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 配置 WAP Express 安装的步骤如下：
- en: Launch Internet Explorer with **Run as administrator**.
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用**以管理员身份运行**启动 Internet Explorer。
- en: Open Windows Azure Pack Configuration Site accessible at `https://localhost:30101/`.
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开可以通过`https://localhost:30101/`访问的 Windows Azure Pack 配置站点。
- en: If any SSL warning comes up, click **continue** to this website.
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果出现任何 SSL 警告，点击**继续访问此网站**。
- en: Click **configure now** to proceed further.![Configuring Windows Azure Pack
    Express Deployment](img/00039.jpeg)
  id: totrans-62
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**立即配置**继续下一步。![配置 Windows Azure Pack Express 部署](img/00039.jpeg)
- en: 'Provide the required information in the **Database Server Setup** wizard:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**数据库服务器设置**向导中提供所需的信息：
- en: '**SERVER NAME**: FQDN of the SQL Server used to the host cloud management database.'
  id: totrans-64
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务器名称**：用于托管云管理数据库的 SQL 服务器的 FQDN。'
- en: '**AUTHENTICATION TYPE**: Windows Authentication or SQL authentication.'
  id: totrans-65
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证类型**：Windows 身份验证或 SQL 身份验证。'
- en: '**DATABASE SERVER ADMIN USERNAME** and **DATABASE SERVER ADMIN PASSWORD**:
    The wizard will automatically detect if the username and password is correct before
    proceeding further.'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据库服务器管理员用户名**和**数据库服务器管理员密码**：向导将在继续之前自动检测用户名和密码是否正确。'
- en: '**Configuration Store Passphrase**: WAP uses encryption and decryption to store
    and retrieve secret data from the configuration stored on SQL. This passphrase
    will be used to encrypt and decrypt the data. The same passphrase has to be used
    while configuring all the servers in a Distributed Deployment.'
  id: totrans-67
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**配置存储密码短语**：WAP 使用加密和解密技术存储和检索 SQL 配置中存储的机密数据。此密码短语将用于加密和解密数据。在分布式部署中配置所有服务器时，必须使用相同的密码短语。'
- en: '![Configuring Windows Azure Pack Express Deployment](img/00040.jpeg)'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![配置 Windows Azure Pack Express 部署](img/00040.jpeg)'
- en: Select yes or no to participate in the **Customer Experience Improvement Program**.
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择是否参与**客户体验改进计划**。
- en: Review the components to be configured and click the checkmark at the bottom
    right-hand side.![Configuring Windows Azure Pack Express Deployment](img/00041.jpeg)
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审查需要配置的组件并点击右下角的勾选标记。![配置 Windows Azure Pack Express 部署](img/00041.jpeg)
- en: '**WINDOWS AZURE PACK SETUP** will start configuring each role. It will take
    a few minutes for the configuration to finish. Hit **finish** once the configuration
    is completed and is successful for all components.'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**WINDOWS AZURE PACK 设置**将开始配置每个角色。配置完成可能需要几分钟时间。配置完成并且所有组件都成功时，点击**完成**。'
- en: The configuration is completed. Now you can proceed further to verify the deployment
    and to the next steps.
  id: totrans-72
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置已完成。现在可以继续验证部署并进行后续步骤。
- en: Tip
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Log out and login back to the WAP server post completion of the configuration.
    This creates the necessary security permissions to log into portals.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 配置完成后，登出并重新登录到 WAP 服务器。这将创建必要的安全权限来登录门户。
- en: '![Configuring Windows Azure Pack Express Deployment](img/00042.jpeg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![配置 Windows Azure Pack Express 部署](img/00042.jpeg)'
- en: Validating a successful deployment
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 验证成功的部署
- en: 'After completion of the configuration wizard, it''s good to quickly run some
    tests to verify if deployment and database integration is completed successfully.
    Perform the following checks to verify if deployment is successful:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 配置向导完成后，建议快速运行一些测试，以验证部署和数据库集成是否成功完成。执行以下检查以验证部署是否成功：
- en: Verify if all Internet Information Services (IIS) websites and applications
    are created on the WAP server. Use **Internet Information Services (IIS) Manager**
    to verify this. Install IIS Manager using Server Manager if not installed.![Validating
    a successful deployment](img/00043.jpeg)
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证所有 Internet 信息服务（IIS）网站和应用程序是否已在 WAP 服务器上创建。使用**Internet 信息服务（IIS）管理器**进行验证。如果未安装
    IIS 管理器，请使用服务器管理器安装它。![验证成功的部署](img/00043.jpeg)
- en: Verify if all WAP databases are created on the SQL server specified during setup.
    Use SQL Management Studio to access the SQL Management Server. Access the WAP
    database server and expend databases to see all the databases created on the server:![Validating
    a successful deployment](img/00044.jpeg)
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证所有 WAP 数据库是否已在设置过程中指定的 SQL 服务器上创建。使用 SQL Management Studio 访问 SQL 管理服务器。访问
    WAP 数据库服务器并展开数据库，以查看所有在服务器上创建的数据库：![验证成功的部署](img/00044.jpeg)
- en: 'Verify login to the Admin portal and the Tenant portal accessibility. Try logging
    into the Admin portal:'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 验证管理员门户和租户门户的登录和可访问性。尝试登录管理员门户：
- en: 'Admin portal URL: `https://WAPServer:30091`'
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 管理员门户网址：`https://WAPServer:30091`
- en: 'Tenant portal URL: `https://WAPServer:30081`'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 租户门户网址：`https://WAPServer:30081`
- en: Run Microsoft Best Practice Analyzer for Windows Azure Pack to identify any
    gaps in deployment.
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 运行 Microsoft Best Practice Analyzer for Windows Azure Pack，识别部署中的任何缺口。
- en: Tip
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The account used to install WAP components has to be used for logging into the
    Admin portal. Additional co-administrators can be added by adding users in MgmtSvc
    Operators local group on the WAP server.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 用于安装WAP组件的帐户必须用于登录到管理门户。可以通过将用户添加到WAP服务器上的MgmtSvc Operators本地组来添加额外的共同管理员。
- en: Microsoft Best Practice Analyzer for Windows Azure Pack can be downloaded and
    installed using Microsoft Web Platform Installer (WebPI).
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过Microsoft Web Platform Installer（WebPI）下载并安装Windows Azure Pack的Microsoft最佳实践分析器。
- en: Installing Windows Azure Pack in a Distributed architecture
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在分布式架构中安装Windows Azure Pack
- en: 'Installation of Windows Azure Pack in a Distributed architecture is similar
    to Express installation. In a Distributed architecture, instead of selecting Windows
    Azure Pack: Portal and API Express, individual components such as Admin site and
    Admin authentication sites are selected and installed on multiple servers.'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: '在分布式架构中安装Windows Azure Pack与快速安装类似。在分布式架构中，选择的不是Windows Azure Pack: Portal
    and API Express，而是单独选择并在多个服务器上安装组件，例如管理员站点和管理员身份验证站点。'
- en: '**Microsoft Web Platform Installer** (**Web PI**) is used to select individual
    components and installation of each of them on all the WAP servers. Let''s have
    a look at the steps to deploy WAP in a Distributed architecture.'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: '**Microsoft Web Platform Installer**（**Web PI**）用于选择各个组件并在所有WAP服务器上安装它们。让我们来看一下在分布式架构中部署WAP的步骤。'
- en: Complete the hardware and software prerequisite on all WAP servers (see [Chapter
    1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715 "Chapter 1. Know
    Windows Azure Pack and Its Architecture"), *Know Windows Azure Pack and Its Architecture*,
    for various deployment topologies of WAP in a Distributed architecture, last topic
    for software prerequisites).
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在所有WAP服务器上完成硬件和软件的先决条件（请参阅[第1章](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715
    "Chapter 1. Know Windows Azure Pack and Its Architecture"), *了解Windows Azure Pack及其架构*，该章最后一部分讨论WAP在分布式架构中的各种部署拓扑，软件先决条件）。
- en: Verify required firewall ports allowed in Windows or network firewalls.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证Windows防火墙或网络防火墙中是否允许所需的防火墙端口。
- en: Deploy any load balancers (physical or logical) for WAP virtual machines as
    per architecture.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据架构部署任何负载均衡器（物理或逻辑），用于WAP虚拟机。
- en: Install and run Microsoft Web Platform Installer on WAP servers in a sequential
    manner.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按顺序在WAP服务器上安装并运行Microsoft Web Platform Installer。
- en: 'Follow the given sequence to install and configure WAP components on multiple
    servers:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照给定的顺序在多个服务器上安装和配置WAP组件：
- en: Install and configure WAP Service Management APIs (Admin API, Tenant API, and
    Tenant Public API)
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并配置WAP服务管理API（管理员API、租户API和租户公共API）
- en: Install and configure WAP Management portals (Admin site, Tenant site, and so
    on)
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并配置WAP管理门户（管理员站点、租户站点等）
- en: Install and configure authentication sites (Admin Authentication site and Tenant
    Authentication sites)
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并配置身份验证站点（管理员身份验证站点和租户身份验证站点）
- en: Install and configure other components such as resource providers, and so on
  id: totrans-98
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装并配置其他组件，如资源提供者等
- en: During configuration, provide SQL server details and the passphrase. Note down
    the passphrase as it has to be exactly the same while configuring all other components.
    It is a good idea to make a note of it, as there is no way to recover the passphrase
    if lost.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在配置过程中，提供SQL服务器的详细信息和密码短语。记下密码短语，因为在配置其他组件时必须完全一致。建议将其记录下来，因为一旦丢失，就无法恢复密码短语。
- en: Configure load balancers to distribute traffic and DNS records.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置负载均衡器以分配流量和DNS记录。
- en: Customize the portal and authentication site's URL and ports for load balanced
    names.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为负载均衡的名称自定义门户和身份验证站点的URL和端口。
- en: Replace self-signed certificates with trusted SSL certificates for websites.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用受信任的SSL证书替换自签名证书。
- en: Test deployment and complete post deployment best practices such as running
    BPA.
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 测试部署并完成后续部署最佳实践，例如运行BPA。
- en: Changing portal URLs and ports, and replacing SSL certificates, is covered in
    further topics.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 更改门户的URL和端口，以及更换SSL证书，将在后续主题中讨论。
- en: Note
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: By default, Windows Azure Pack portals uses HTTPS. If you try to open portals
    on HTTP, it will result in a page cannot be displayed error. To accept HTTP traffic
    for portals, create additional binding in IIS for each website pointing to port
    80 along with the default HTTPS.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Windows Azure Pack门户使用HTTPS。如果您尝试通过HTTP打开门户，将会显示页面无法显示的错误。要接受HTTP流量，请在IIS中为每个网站创建附加绑定，指向80端口，并与默认的HTTPS绑定一起使用。
- en: Web.Config of each portal already has a rule of redirecting HTTP traffic to
    HTTPS, which comes into action after adding binding for port 80.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 每个门户的 Web.Config 已经有一个将 HTTP 流量重定向到 HTTPS 的规则，该规则在为端口 80 添加绑定后生效。
- en: Required firewall ports for WAP components
  id: totrans-108
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: WAP 组件所需的防火墙端口
- en: The following networks ports have to be allowed in networks or any other external
    firewalls to enable communication between WAP components and websites access by
    admins or tenants.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 以下网络端口必须在网络中或任何其他外部防火墙中允许，以便实现 WAP 组件与管理员或租户访问网站之间的通信。
- en: Windows Azure Pack automatically creates rules in Windows firewall (if enabled)
    for these ports. Note that the following list includes only the default ports
    used by WAP components; add other ports if using any customized ports.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Azure Pack 会在 Windows 防火墙中自动创建这些端口的规则（如果已启用）。请注意，以下列表仅包括 WAP 组件使用的默认端口；如果使用任何自定义端口，请添加其他端口。
- en: '| WAP Service | Port Number | Scope |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| WAP 服务 | 端口号 | 范围 |'
- en: '| --- | --- | --- |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Admin API | 30004 | Any IP required to access Admin API. It is usually cloud
    management IP range. |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '| 管理员 API | 30004 | 需要访问管理员 API 的任何 IP 地址。通常是云管理 IP 范围。 |'
- en: '| Management portal for Admins | 30091 | Any IP required to access admin portal.
    It is usually cloud management IP range. |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '| 管理员管理门户 | 30091 | 需要访问管理员门户的任何 IP 地址。通常是云管理 IP 范围。 |'
- en: '| Windows authentication site (used for admin portal authentication) | 30072
    | Any IP required to access admin portal. It is usually cloud management IP range.
    |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| Windows 身份验证站点（用于管理员门户身份验证） | 30072 | 需要访问管理员门户的任何 IP 地址。通常是云管理 IP 范围。 |'
- en: '| Configuration site | 30101 | Local WAP components subnet. This will be accessed
    during initial setup. |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| 配置站点 | 30101 | 本地 WAP 组件子网。在初始设置时将访问该站点。 |'
- en: '| Monitoring site | 30020 | Any IP required to access monitoring services.
    It is usually cloud management range. |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| 监控站点 | 30020 | 需要访问监控服务的任何 IP 地址。通常是云管理范围。 |'
- en: '| MySQL Resource Provider | 30012 | Any IP address using specified service.
    |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| MySQL 资源提供程序 | 30012 | 使用指定服务的任何 IP 地址。 |'
- en: '| SQL Server or MySQL Resource Provider | 30010 | Any IP address using specified
    service. |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '| SQL Server 或 MySQL 资源提供程序 | 30010 | 使用指定服务的任何 IP 地址。 |'
- en: '| Tenant API | 30005 | Any IP address using specified service. |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| 租户 API | 30005 | 使用指定服务的任何 IP 地址。 |'
- en: '| Tenant public API | 30006 | Any IP address using specified service. Usually
    all Internet IP ranges. |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| 租户公共 API | 30006 | 使用指定服务的任何 IP 地址。通常是所有互联网 IP 范围。 |'
- en: '| Management portal for tenants | 30081 | Any IP address using specified service.
    Usually all Internet IP ranges. |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 租户管理门户 | 30081 | 使用指定服务的任何 IP 地址。通常是所有互联网 IP 范围。 |'
- en: '| Tenant authentication site | 30071 | Any IP address using specified service.
    Usually all Internet IP ranges. |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 租户身份验证站点 | 30071 | 使用指定服务的任何 IP 地址。通常是所有互联网 IP 范围。 |'
- en: '| Usage | 30022 | Any IP address using specified service. |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 用途 | 30022 | 使用指定服务的任何 IP 地址。 |'
- en: '| WebAppGallery | 30018 | Any IP address using specified service. |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| WebAppGallery | 30018 | 使用指定服务的任何 IP 地址。 |'
- en: Customizing WAP portal's accessibility and certificates
  id: totrans-126
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自定义 WAP 门户的可访问性和证书
- en: By default, WAP websites use server hostnames as website URL, default port number,
    and self-signed certificates. In this topic, we will change the website's name,
    that is, URL, default port (such as 30081 to 443 for tenant portal) and SSL certificate
    with internal or public certificates as required. It is recommended to customize
    these portals' configuration for better security and user experience.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，WAP 网站使用服务器主机名作为网站 URL、默认端口号以及自签名证书。在本主题中，我们将更改网站的名称，即 URL、默认端口（例如将 30081
    更改为 443 用于租户门户）以及根据需要使用的内部或公共 SSL 证书。建议自定义这些门户的配置，以提高安全性和用户体验。
- en: Assume a user experience of a tenant portal, also known as a customer portal,
    with complex enough URL and a custom port to add with disturbing security warnings
    of untrusted SSL certificates. Windows Azure Pack provides flexibilities to change
    URLs and ports along with trusted SSL certificates for WAP websites for improved
    security and smooth end user experience.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 假设一个租户门户（也称为客户门户）的用户体验，该门户具有足够复杂的 URL 和一个自定义端口，同时会出现不受信任的 SSL 证书的安全警告。Windows
    Azure Pack 提供了灵活性，可以更改 URL 和端口，并为 WAP 网站提供受信任的 SSL 证书，从而提高安全性和优化终端用户体验。
- en: 'Before getting things into action, let''s understand which websites come into
    the picture for the user logins (Admin or Tenant) WAP portal use claim-based authentication
    mechanism during the login process, as follows:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始操作之前，让我们了解哪些网站涉及用户登录（管理员或租户）。WAP 门户使用基于声明的身份验证机制进行登录过程，如下所示：
- en: The user opens their respective portals such as admin portal or tenant portal
    by entering the WAP server's hostname with the port.
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户通过输入 WAP 服务器的主机名和端口，打开各自的门户网站，如管理员门户或租户门户。
- en: The admin site redirects the webpage to the respective authentication site webpage.
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 管理员站点将网页重定向到相应的身份验证站点网页。
- en: The user enters their credentials with a mechanism such as Windows Authentication/ASP.NET
    Authentication, or ADFS. Upon successful authentication, the user is provided
    with a security access token and redirected to the portal webpage again.
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户通过 Windows 身份验证/ASP.NET 身份验证或 ADFS 等机制输入凭据。在身份验证成功后，用户将获得安全访问令牌，并再次被重定向到门户网页。
- en: The admin portal webpage accepts the security token of the user and display
    the portal as per services/permissions available with the user.
  id: totrans-133
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 管理员门户网页接受用户的安全令牌，并根据用户可用的服务/权限显示门户。
- en: 'As we learned, four websites plays a role in getting a user authenticated and
    getting their personalized portal as per role. In order to provide smooth user
    experience, we need to customize names, ports, and have trusted certificates for
    the following WAP websites:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 如我们所知，四个网站在验证用户身份并根据角色获取个性化门户方面发挥作用。为了提供流畅的用户体验，我们需要自定义名称、端口，并为以下 WAP 网站提供受信任的证书：
- en: Admin management portal
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理员管理门户
- en: Admin authentication site
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理员身份验证站点
- en: Tenant management portal
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 租户管理门户
- en: Tenant authentication site
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 租户身份验证站点
- en: For an organization's private cloud, in most cases all these websites will be
    accessible from inside the organizations only, which makes it feasible to use
    an internal **CA** (**Certification Authority**) provided SSL certificates for
    all websites.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 对于组织的私有云，在大多数情况下，所有这些网站将仅从组织内部访问，这使得可以使用内部 **CA**（**证书颁发机构**）提供的 SSL 证书来保护所有网站。
- en: In a service provider scenario, the Tenant portal will be accessible over the
    public Internet; whereas the Admin portal is likely to be accessed inside the
    provider's network only. In such cases, SSL certificates issued by public CA should
    be used for the Tenant management portal and Authentication site, whereas an internal
    CA can be leveraged for the Admin portal and Admin authentication site.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在服务提供商场景下，租户门户将通过公共互联网访问；而管理员门户则可能仅在提供商的网络内访问。在这种情况下，应为租户管理门户和身份验证站点使用由公共 CA
    发放的 SSL 证书，而管理员门户和管理员身份验证站点则可以使用内部 CA 提供的证书。
- en: This makes the recommendation clear that internal CA provided SSL certificates
    should be used for portal and authentication sites to be used inside corporate
    LAN, where any public portal or authentication sites should be assigned SSL certificates
    issued by Public trusted CAs.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 这使得建议明确：内部 CA 提供的 SSL 证书应用于企业局域网内使用的门户和身份验证站点，而任何公共门户或身份验证站点应分配由公共受信任的 CA 发放的
    SSL 证书。
- en: 'Overall, the following recommendations have to be performed for user accessible
    websites to improve user experience and security:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，为了改善用户体验和安全性，需要对用户可访问的网站执行以下建议：
- en: Use simpler URLs for Admin and Tenant websites
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为管理员和租户网站使用更简洁的 URL。
- en: Use standard ports such as 443 (HTTPS) to avoid any complexity in URLs
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用标准端口如 443（HTTPS）以避免 URL 中的复杂性。
- en: Use trusted SSL certificates to avoid any SSL related security warnings
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用受信任的 SSL 证书，以避免任何与 SSL 相关的安全警告。
- en: 'To implement the preceding recommendations, the following operations have to
    be performed in a WAP Cloud solution:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 为实现上述建议，需要在 WAP Cloud 解决方案中执行以下操作：
- en: Create DNS records for new URLs (in internal DNS and Public DNS servers.)
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为新 URL 创建 DNS 记录（在内部 DNS 和公共 DNS 服务器中）。
- en: Generate and import trusted SSL certificates for each website.
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为每个网站生成并导入受信任的 SSL 证书。
- en: Configure website bindings to use new URLs, ports, and certificates.
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 配置网站绑定，以使用新 URL、端口和证书。
- en: Update the Windows Azure Pack Configuration database with new URLs and ports.
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 更新 Windows Azure Pack 配置数据库，添加新的 URL 和端口。
- en: Configure portal's DNS names
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置门户的 DNS 名称。
- en: By default, WAP management portals and authentication sites use the following
    ports.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，WAP 管理门户和身份验证站点使用以下端口。
- en: 'The following are WAP websites'' default URLs and ports:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是 WAP 网站的默认 URL 和端口：
- en: '| Site Name | URL | Port |'
  id: totrans-154
  prefs: []
  type: TYPE_TB
  zh: '| 网站名称 | URL | 端口 |'
- en: '| --- | --- | --- |'
  id: totrans-155
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Management Portal for Administrator | `https://WAPServer:30091` | 30091 |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
  zh: '| 管理员管理门户 | `https://WAPServer:30091` | 30091 |'
- en: '| Admin Authentication Site | `https://WAPServer:30072` | 30072 |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| 管理员身份验证站点 | `https://WAPServer:30072` | 30072 |'
- en: '| Management Portal for Tenants | `https://WAPServer:30081` | 30081 |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 租户管理门户 | `https://WAPServer:30081` | 30081 |'
- en: '| Tenant Authentication Site | `https://WAPServer:30071` | 30071 |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| 租户身份验证站点 | `https://WAPServer:30071` | 30071 |'
- en: For evaluation purposes, we shall be changing URLs and ports as per the following
    table. Organizations and service providers may choose their own names and ports
    as per their choice.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估目的，我们将根据以下表格更改 URL 和端口。组织和服务提供商可以根据需要选择自己的名称和端口。
- en: '| Site Name | URL | Port |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 网站名称 | URL | 端口 |'
- en: '| --- | --- | --- |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| Management Portal for Administrator | `https://admin.wapcloud.com` | 443
    |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| 管理员管理门户 | `https://admin.wapcloud.com` | 443 |'
- en: '| Admin Authentication Site | `https://adminauth.wapcloud.com` | 443 |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| 管理员身份验证站点 | `https://adminauth.wapcloud.com` | 443 |'
- en: '| Management Portal for Tenants | `https://manage.wapcloud.com` | 443 |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 租户管理门户 | `https://manage.wapcloud.com` | 443 |'
- en: '| Tenant Authentication Site | `https://manageauth.wapcloud.com` | 443 |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 租户身份验证站点 | `https://manageauth.wapcloud.com` | 443 |'
- en: '"`A`" records and "`PTR`" records need to be created in internal and external
    DNS servers for the preceding names pointing to the WAP server. Changes in Public
    DNS servers are required if any of the services are accessible over the Internet
    like tenant portals and authentication sites.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '"`A`" 记录和 "`PTR`" 记录需要在内部和外部 DNS 服务器中创建，指向 WAP 服务器的前述名称。如果有任何服务可以通过互联网访问，如租户门户和身份验证站点，则需要更改公共
    DNS 服务器。'
- en: 'DNS Manager can be used to create records in the internal DNS server. Use the
    following steps to create the records:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用 DNS 管理器在内部 DNS 服务器上创建记录。使用以下步骤来创建记录：
- en: Open DNS Manager on the DNS server.
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 DNS 服务器上打开 DNS 管理器。
- en: Right click on **DNS Zone** and create a new record button.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 右键点击**DNS 区域**，然后点击创建新记录按钮。
- en: Provide the name and IP of portal and WAP server, as follows:![Configure portal's
    DNS names](img/00045.jpeg)
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供门户和 WAP 服务器的名称及 IP，如下所示：![配置门户的 DNS 名称](img/00045.jpeg)
- en: Select **Create associated pointer (PTR) record**.
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**创建关联的指针（PTR）记录**。
- en: Create all required records using the same method.
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用相同的方法创建所有所需的记录。
- en: Getting SSL certificates for WAP websites
  id: totrans-174
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 获取 WAP 网站的 SSL 证书
- en: Getting SSL certificates for WAP management portals and authentication sites
    is similar to getting SSL for any other websites running on any web server. SSL
    certificates are usually requested and assigned online by any CA authority, or
    offline by creating a certificate request file at the IIS server and then submitting
    a certificate request file to Public CA providers to get the required SSL.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 获取 WAP 管理门户和身份验证站点的 SSL 证书类似于为任何其他运行在 web 服务器上的网站获取 SSL 证书。SSL 证书通常由任何 CA 权威在线请求并分配，或者通过在
    IIS 服务器上创建证书请求文件，然后将证书请求文件提交给公共 CA 提供商以获得所需的 SSL。
- en: Active Directory Certificate Services, that is, internal Enterprise CA can be
    used to assign certificates for portals accessible inside corporate networks only,
    such as management portals for administrators and so on. For the purpose of evaluation,
    we shall be using internal Windows ADCS Services as a CA to assign certificates
    to the websites.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: Active Directory 证书服务，即内部企业 CA，可以用于为仅在公司网络内可访问的门户分配证书，例如管理员的管理门户等。为了评估目的，我们将使用内部
    Windows ADCS 服务作为 CA 来为这些网站分配证书。
- en: 'Assuming that you already have an Enterprise CA configured inside your organization
    (Active Directory Certificate Services), the following are the steps required
    to request and assign SSL certificates for WAP websites:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 假设您已经在组织内部配置了企业 CA（Active Directory 证书服务），以下是请求和分配 WAP 网站 SSL 证书所需的步骤：
- en: Log on to WAP server and open IIS Manager.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 登录 WAP 服务器并打开 IIS 管理器。
- en: Select Your IIS server name and then **Server Certificates** on the homepage.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择您的 IIS 服务器名称，然后在主页上点击**服务器证书**。
- en: The **Server Certificates** window will display all existing self-signed or
    other certificates being used in the IIS server.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**服务器证书**窗口将显示所有现有的自签名证书或其他在 IIS 服务器中使用的证书。'
- en: Click **Request Domain Certificate** in the actions pane.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击操作窗格中的**请求域名证书**。
- en: Providing the **Common Name**, **Organization**, **Organizational Unit**, **City/locality**,
    **State/province** and **Country/region** details as requested, as shown in the
    following screenshot. The **Common name** would be the FQDN of the website it
    is being requested for.![Getting SSL certificates for WAP websites](img/00046.jpeg)
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供所要求的**通用名称**、**组织**、**组织单位**、**城市/地区**、**州/省**和**国家/地区**的详细信息，如下图所示。**通用名称**将是为其请求证书的网站的FQDN。![获取WAP网站的SSL证书](img/00046.jpeg)
- en: Specify the CA name and server name where ADCS is running and configured. Assign
    a friendly name for the certificate for easy identification and management.![Getting
    SSL certificates for WAP websites](img/00047.jpeg)
  id: totrans-183
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定运行和配置ADCS的CA名称和服务器名称。为证书分配一个友好的名称，方便识别和管理。![获取WAP网站的SSL证书](img/00047.jpeg)
- en: Clicking on **Finish** will request and import certificates in IIS, as shown
    in the following screenshot:![Getting SSL certificates for WAP websites](img/00048.jpeg)
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**完成**将会在IIS中请求并导入证书，如下图所示：![获取WAP网站的SSL证书](img/00048.jpeg)
- en: Request certificates for all three remaining websites.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为剩余的三个网站请求证书。
- en: 'To request the SSL certificate from a Public CA, perform the following steps:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 要从公共CA请求SSL证书，请执行以下步骤：
- en: Open **IIS Manager** | **IIS Server Home** | **Server Certificates**.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开**IIS管理器** | **IIS服务器主页** | **服务器证书**。
- en: Click **Create Certificate Request** in the **Actions** pane.
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**操作**面板中点击**创建证书请求**。
- en: Provides the **Common Name**, **Organization**, **Organizational Unit**, **City/locality**,
    **State/province** and **Country/region** details as requested. The **Common name**
    would be the FQDN of the website it is being requested for.
  id: totrans-189
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供所要求的**通用名称**、**组织**、**组织单位**、**城市/地区**、**州/省**和**国家/地区**的详细信息。**通用名称**将是为其请求证书的网站的FQDN。
- en: Select **Cryptographer service provider** and **Bit length** as per the Public
    CA.
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据公共CA的要求，选择**加密服务提供商**和**位长度**。
- en: Specify the file name and location to extract the certificate request file.
  id: totrans-191
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 指定文件名和位置以提取证书请求文件。
- en: Submit this request file to Public CA online or through offline method. CA will
    generate SSL certificates as per details received in the certificate request file.
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将此请求文件提交给公共CA在线或通过离线方式。CA将根据证书请求文件中收到的详细信息生成SSL证书。
- en: Click **Complete Certificate request** in the **Actions** pane of IIS Manager's
    server certificate menu.
  id: totrans-193
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在IIS管理器的服务器证书菜单中，点击**完成证书请求**。
- en: Provide file path for the certificate file provided by CA.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供由CA提供的证书文件的文件路径。
- en: The certificate will be added into IIS.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 证书将会被添加到IIS中。
- en: Configuring site binding to use new URL's, port and SSL
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置站点绑定以使用新的URL、端口和SSL证书。
- en: 'Now, we need to configure WAP websites to use these new names, ports, and SSL
    certificates. Follow these steps to do this:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要配置WAP网站以使用这些新的名称、端口和SSL证书。按照以下步骤操作：
- en: Open IIS Manager on the WAP server and browse through the websites.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开WAP服务器上的IIS管理器，浏览网站。
- en: Select **MgmtSvc-AdminSite** to select Management portals for the administrator
    site.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**MgmtSvc-AdminSite**以选择管理员站点的管理门户。
- en: Click on **Bindings** on the **Actions** pane.
  id: totrans-200
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**操作**面板中点击**绑定**。
- en: Select existing HTTPS binding and click **Edit Bindings**.
  id: totrans-201
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择现有的HTTPS绑定，点击**编辑绑定**。
- en: Provide a new **Port** number and **Host name** and select newly created **SSL
    certificate** for the Admin site.
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供新的**端口**号和**主机名**，并选择新创建的**SSL证书**用于管理员站点。
- en: Select the **Require Server Name Indication** checkbox.
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**要求服务器名称指示**复选框。
- en: Submit the changes by clicking **OK**.
  id: totrans-204
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**确定**提交更改。
- en: Repeat the preceding steps for the remaining websites.![Configuring site binding
    to use new URL's, port and SSL](img/00049.jpeg)
  id: totrans-205
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对剩余的网站重复上述步骤。![配置站点绑定以使用新URL、端口和SSL证书](img/00049.jpeg)
- en: 'The following are the IIS website names and the corresponding WAP websites:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是IIS网站名称和相应的WAP网站：
- en: '| IIS WebSite Name | WAP component |'
  id: totrans-207
  prefs: []
  type: TYPE_TB
  zh: '| IIS网站名称 | WAP组件 |'
- en: '| --- | --- |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| MgmtSvc-AdminSite | Management Portal for Administrators |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| MgmtSvc-AdminSite | 管理员管理门户 |'
- en: '| MgmtSvc-WindowsAuthSite | Admin Authentication Site |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '| MgmtSvc-WindowsAuthSite | 管理员认证站点 |'
- en: '| MgmtSvc-TenantSite | Management Portal for Administrators |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| MgmtSvc-TenantSite | 管理员管理门户 |'
- en: '| MgmtSvc-AuthSite | Tenant Authentication Site |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '| MgmtSvc-AuthSite | 租户认证站点 |'
- en: Updating changes in the Windows Azure Pack database
  id: totrans-213
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 更新Windows Azure Pack数据库中的更改。
- en: All changes performed in the previous steps have to be updated in the Windows
    Azure Pack configuration store to make them effective. Let's update the changes
    made in portal URLs and ports in the WAP Configuration database residing on the
    Management SQL Server.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面步骤中进行的所有更改必须在 Windows Azure Pack 配置存储中更新，才能生效。接下来，我们将在管理 SQL 服务器上的 WAP 配置数据库中更新门户
    URL 和端口的更改。
- en: 'Windows Azure Pack PowerShell will be used to update the changes. We need to
    update the value in the following three configurations in the WAP DB for both
    admin and tenant portals:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 将使用 Windows Azure Pack PowerShell 来更新更改。我们需要更新 WAP 数据库中管理员和租户门户的以下三个配置项的值：
- en: '**Portal FQDN**: Configured by using `Set-MgmtSvcFqdn` in the PowerShell cmdlet,
    this will update FQDN for websites'' portals in the WAP database such as `admin.wapcloud.com`.'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**门户 FQDN**：通过在 PowerShell 命令中使用 `Set-MgmtSvcFqdn` 配置，这将更新 WAP 数据库中网站门户的 FQDN，例如
    `admin.wapcloud.com`。'
- en: '**Authentication Service Relay**: Configured by using `Set-MgmtSvcRelyingPartySettings`
    in the PowerShell cmdlet, this will update the URL of the authentication site
    in the WAP database. This URL will be used by the portal to redirect when the
    user accesses the portal without any security token.'
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证服务中继**：通过在 PowerShell 命令中使用 `Set-MgmtSvcRelyingPartySettings` 配置，这将更新
    WAP 数据库中身份验证站点的 URL。该 URL 将用于当用户在没有任何安全令牌的情况下访问门户时，由门户进行重定向。'
- en: '**Authentication Service Redirection**: Configured by using `Set-MgmtSvcIdentityProviderSettings`
    in the PowerShell cmdlet, this updates the redirection URL used by the authentication
    site post user authentication. This URL will be used by the authentication site
    to redirect the user to the admin or tenant portal after authentication.'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**身份验证服务重定向**：通过在 PowerShell 命令中使用 `Set-MgmtSvcIdentityProviderSettings` 配置，这将更新身份验证站点在用户身份验证后使用的重定向
    URL。该 URL 将用于身份验证站点在用户身份验证后将其重定向到管理员或租户门户。'
- en: 'Sample URLs are given in PowerShell cmdlets next, they need to be replaced
    with actual names for production deployments. Steps for updating new websites''
    URLs and ports in the WAP database are as follows:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来给出的 PowerShell 命令中的示例 URL 需要在生产环境中替换为实际的名称。更新 WAP 数据库中新网站的 URL 和端口的步骤如下：
- en: Log into WAP Server as a WAP administrator.
  id: totrans-220
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以 WAP 管理员身份登录到 WAP 服务器。
- en: Run Windows PowerShell as an administrator.
  id: totrans-221
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以管理员身份运行 Windows PowerShell。
- en: 'Import the Windows Azure Pack PowerShell module by executing the following
    commands:'
  id: totrans-222
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下命令导入 Windows Azure Pack PowerShell 模块：
- en: '[PRE0]'
  id: totrans-223
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Update the Admin portal FQDN by issuing the following command in the PowerShell.
    FQDN in this cmdlet is the admin portal''s FQDN:'
  id: totrans-224
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在 PowerShell 中执行以下命令更新管理员门户的 FQDN。此命令中的 FQDN 是管理员门户的 FQDN：
- en: '[PRE1]'
  id: totrans-225
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Update the Admin Authentication site FQDN by issuing the following PowerShell.
    FQDN in this cmdlet is admin authentication site''s FQDN:'
  id: totrans-226
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新管理员身份验证站点的 FQDN。此命令中的 FQDN 是管理员身份验证站点的 FQDN：
- en: '[PRE2]'
  id: totrans-227
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Update the Admin Authenticate site redirection changes by issuing the following
    PowerShell. FQDN in this cmdlet is admin authentication site''s FQDN:'
  id: totrans-228
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新管理员身份验证站点重定向的更改。此命令中的 FQDN 是管理员身份验证站点的 FQDN：
- en: '[PRE3]'
  id: totrans-229
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Update the Authenticate Service redirection by issuing the following PowerShell.
    FQDN in this cmdlet is admin portal''s FQDN:'
  id: totrans-230
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新身份验证服务的重定向。此命令中的 FQDN 是管理员门户的 FQDN：
- en: '[PRE4]'
  id: totrans-231
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Update the Tenant Admin portal FQDN by issuing the following PowerShell. FQDN
    in this cmdlet is the Tenant portal''s FQDN:'
  id: totrans-232
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新租户管理员门户的 FQDN。此命令中的 FQDN 是租户门户的 FQDN：
- en: '[PRE5]'
  id: totrans-233
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Update the Tenant Authentication portal FQDN by issuing the following PowerShell.
    FQDN in this cmdlet is the tenant authentication portal''s FQDN:'
  id: totrans-234
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新租户身份验证门户的 FQDN。此命令中的 FQDN 是租户身份验证门户的 FQDN：
- en: '[PRE6]'
  id: totrans-235
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Update the Tenant Authenticate redirection site changes by issuing the following
    PowerShell. FQDN in this cmdlet is the tenant authentication site''s FQDN:'
  id: totrans-236
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新租户身份验证重定向站点的更改。此命令中的 FQDN 是租户身份验证站点的 FQDN：
- en: '[PRE7]'
  id: totrans-237
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Update the tenant Authenticate Service redirection by issuing the following
    PowerShell. FQDN in this cmdlet is the tenant admin portal''s FQDN:'
  id: totrans-238
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过执行以下 PowerShell 更新租户身份验证服务的重定向。此命令中的 FQDN 是租户管理员门户的 FQDN：
- en: '[PRE8]'
  id: totrans-239
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Successful updated configuration will give an output as follows:![Updating changes
    in the Windows Azure Pack database](img/00050.jpeg)
  id: totrans-240
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 成功更新的配置将输出如下：![在 Windows Azure Pack 数据库中更新更改](img/00050.jpeg)
- en: Verifying portal customizations
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 验证门户自定义设置
- en: 'The following steps can be followed to verify if customization made in the
    previous section is effective:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 可以按照以下步骤验证前一节中的自定义设置是否生效：
- en: Verify if portal URLs and port customizations are working fine by logging into
    both tenant and admin portals.
  id: totrans-243
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过登录租户和管理员门户验证门户URL和端口自定义是否正常工作。
- en: Check SSL certificates of websites by clicking on the SSL button in the web
    browser for the website.
  id: totrans-244
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过点击网站浏览器中的SSL按钮来检查网站的SSL证书。
- en: Verify no SSL trust related warnings are displayed during login or accessing
    the portal.
  id: totrans-245
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 验证登录或访问门户时没有显示SSL信任相关的警告。
- en: Registering Service Provider Foundation with WAP
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用WAP注册服务提供商基础架构
- en: Now that we have our portal ready for Admin and Tenant usage, it's time to integrate
    or make WAP APIs communicate with Fabric prepared in the previous chapter. In
    this section, we will register Service Provider Foundation with Windows Azure
    pack Service Management APIs.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经准备好管理员和租户使用的门户，接下来是将WAP API与前一章中准备的Fabric进行集成或通信。在本节中，我们将使用Windows Azure
    Pack服务管理API注册服务提供商基础架构。
- en: See [Chapter 1](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715
    "Chapter 1. Know Windows Azure Pack and Its Architecture"), *Know Windows Azure
    Pack and Its Architecture*, System Centre integration section, to learn more about
    integration between WAP APIs and SPF.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 请参阅[第1章](part0015_split_000.html#E9OE1-b479cf466c26404ca54119871a9b2715 "第1章.
    了解Windows Azure Pack及其架构")，*了解Windows Azure Pack及其架构*，系统中心集成部分，了解WAP API与SPF之间的集成。
- en: 'Before registering, verify if SPF is deployed and configured properly to ensure
    successful registration:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 在注册之前，验证SPF是否已正确部署和配置，以确保注册成功：
- en: There is network reachability on required ports between the WAP server and SPF
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WAP服务器和SPF之间的必需端口已实现网络连通性
- en: SPF application pools identity are running as a domain user
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SPF应用程序池身份以域用户身份运行
- en: The SPF App Pool identity user has admin permissions on SCVMM and SPF DB
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SPF应用程序池身份用户对SCVMM和SPF数据库具有管理员权限
- en: The local user is created on SPF server for WAP integration. Ensure that this
    local user is added to the SPF Local Groups Server (`SPF_Admin`, `SPF_Provider`,
    `SPF_Usage`, and `SPF_VMM`)
  id: totrans-253
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本地用户在SPF服务器上为WAP集成创建。确保该本地用户已添加到SPF本地组服务器（`SPF_Admin`，`SPF_Provider`，`SPF_Usage`，`SPF_VMM`）
- en: 'Steps to register SPF Endpoint in WAP are as follows:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 注册SPF端点到WAP的步骤如下：
- en: Log into the WAP admin portal using WAP administrator credentials.
  id: totrans-255
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用WAP管理员凭据登录WAP管理员门户。
- en: Select VM clouds. Opening the VM clouds page will give the option to register
    SPF. If not available, click on the Quick Start(![Registering Service Provider
    Foundation with WAP](img/00051.jpeg)) button.
  id: totrans-256
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择虚拟机云。打开虚拟机云页面时会出现注册SPF的选项。如果不可用，请点击快速启动（![使用WAP注册服务提供商基础架构](img/00051.jpeg)）按钮。
- en: Select **Register System Center Service Provider Foundation**.![Registering
    Service Provider Foundation with WAP](img/00052.jpeg)
  id: totrans-257
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择**注册系统中心服务提供商基础架构**。![使用WAP注册服务提供商基础架构](img/00052.jpeg)
- en: 'Provide the SPF server FQDN and login credentials:'
  id: totrans-258
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 提供SPF服务器的FQDN和登录凭据：
- en: 'SPF Server: `https://WAPMGT-SCSPF-01:8090/`'
  id: totrans-259
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: SPF服务器：`https://WAPMGT-SCSPF-01:8090/`
- en: Use the spflocal account created earlier in [Chapter 2](part0023_split_000.html#LTSU2-b479cf466c26404ca54119871a9b2715
    "Chapter 2. Getting the Cloud Fabric Ready"), *Getting the Cloud Fabric Ready*,
    during SPF installation. Do not provide any domain name or computer name in the
    login name.
  id: totrans-260
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用[第2章](part0023_split_000.html#LTSU2-b479cf466c26404ca54119871a9b2715 "第2章.
    准备云Fabric")，*准备云Fabric*中SPF安装时创建的spflocal帐户。登录名中不要提供任何域名或计算机名称。
- en: '![Registering Service Provider Foundation with WAP](img/00053.jpeg)'
  id: totrans-261
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![使用WAP注册服务提供商基础架构](img/00053.jpeg)'
- en: The registration task starts by clicking on the checkmark.![Registering Service
    Provider Foundation with WAP](img/00054.jpeg)
  id: totrans-262
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册任务通过点击勾选框开始。![使用WAP注册服务提供商基础架构](img/00054.jpeg)
- en: Click **OK** once registration is successfully completed:![Registering Service
    Provider Foundation with WAP](img/00055.jpeg)
  id: totrans-263
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册成功完成后，点击**确定**：![使用WAP注册服务提供商基础架构](img/00055.jpeg)
- en: Now, we can start integrating SCVMM and building IaaS services, which will be
    covered in next chapter.
  id: totrans-264
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以开始集成SCVMM并构建IaaS服务，这将在下一章中讨论。
- en: Summary
  id: totrans-265
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we learned about installation and configuration of Windows
    Azure Pack in the Express Deployment model and Distributed Deployment model. We
    did an installation and configuration walkthrough of different WAP components.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了在快速部署模型和分布式部署模型中安装和配置 Windows Azure Pack。我们进行了不同 WAP 组件的安装和配置演示。
- en: We also covered customizing portals' URLs, ports, and SSL certificates to provide
    better user experience and to comply with organizations' and cloud providers'
    needs. At the end of this chapter, we customized Admin and Tenant portals accessible
    for users (Admin and Tenant users), waiting to offer cloud services.
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还涵盖了定制门户网站的 URL、端口和 SSL 证书，以提供更好的用户体验并符合组织和云服务提供商的需求。在本章结束时，我们定制了可供用户（管理员和租户用户）访问的管理员和租户门户，准备提供云服务。
- en: In the next chapter, we shall be building IaaS cloud offering catalogues.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，我们将构建 IaaS 云服务目录。
