<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring Azure Information Protection Solutions</h1>
                </header>
            
            <article>
                
<p class="mce-root">After working through the theory and the detection and <span>identification</span> of sensitive information, we will work through some practical tips from our projects to help you to attain a better understanding of the technology and the associated processes. Always attempt to start projects with classification and without protection to avoid data loss and bad project marketing, because business processes don't work when users can't access the information they regularly use. In addition, always align training to your end users. This chapter will extend your lab environment and provide you with the important PowerShell cmdlets to administer your solution. Finally, we will configure <strong>Azure Information Protection</strong> (<strong>AIP</strong>) through some practical examples.</p>
<p class="mce-root">The chapter is divided into the following sections:</p>
<ul>
<li>Preparing to configure and manage <span>AIP</span></li>
<li>Azure RMS management with PowerShell</li>
<li>Configuring <span>AIP</span></li>
</ul>
<p>Yeah! Let's start with the preparation tasks.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Preparing to configure and manage AIP</h1>
                </header>
            
            <article>
                
<p>To configure and manage our <span>AIP</span> solution, we need to prepare the administrative Windows 10 workstation with the necessary tools. We need to have the following PowerShell modules installed on the workstation:</p>
<ul>
<li>Azure AD Preview: <kbd>Install-Module -Name AzureADPreview</kbd></li>
<li>Azure RMS: <kbd>Install-Module -Name AADRM</kbd></li>
</ul>
<p>Additionally, we install the <span>AIP</span> client on the machine from the following source: <a href="https://bit.ly/2ccqSu0">https://bit.ly/2ccqSu0</a>.</p>
<p>For our use cases and the lab challenge, we need to create the required email-enabled groups. We choose to use Office 365 dynamic groups. You can use the following PowerShell cmdlets to create the required groups.</p>
<p>The first bunch of groups is required and the second one is optional:</p>
<pre><strong># Connect to Azure AD and provide global administrator credentials</strong><br/><strong>Connect-AzureAD<br/><br/></strong><strong>New-AzureADMSGroup -Description "Finance and Accounting Department Users" -DisplayName "Finance and Accounting" -MailEnabled $true -SecurityEnabled $true -MailNickname "financeandaccounting" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Accounting"")" -MembershipRuleProcessingState "On"<br/><br/></strong><strong>New-AzureADMSGroup -Description "Sales Department Users" -DisplayName "Sales" -MailEnabled $true -SecurityEnabled $true -MailNickname "sales" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -eq ""Sales"") -or (user.department -eq ""Sales Engagement Management"")" -MembershipRuleProcessingState "On"<br/></strong><br/><strong>New-AzureADMSGroup -Description "Project Management Department Users" -DisplayName "Project Management" -MailEnabled $true -SecurityEnabled $true -MailNickname "projectmanagement" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Project Management"")" -MembershipRuleProcessingState "On"<br/><br/></strong><strong><span>New-AzureADMSGroup -Description "Senior Management Department Users" -DisplayName "</span>Senior Management</strong><span><strong>" -MailEnabled $true -SecurityEnabled $true -MailNickname "seniormanagement" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Senior Management"")" -MembershipRuleProcessingState "On"</strong><br/><br/></span><strong>New-AzureADMSGroup -Description "Sales Department Users" -DisplayName "Sales" -MailEnabled $true -SecurityEnabled $true -MailNickname "sales" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -eq ""Sales"") -or (user.department -eq ""Sales Engagement Management"")" -MembershipRuleProcessingState "On"<br/><br/></strong><strong>New-AzureADMSGroup -Description "Strategy Consulting Department Users" -DisplayName "Strategy Consulting<span>" -MailEnabled $true -SecurityEnabled $true -MailNickname "strategyconsulting" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Strategy Consulting"")" -MembershipRuleProcessingState "On"<br/><br/></span></strong><strong><span>New-AzureADMSGroup -Description "Human Resources Department Users" -DisplayName "Human Resources" -MailEnabled $true -SecurityEnabled $true -MailNickname "humanresources" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Human Resources"")" -MembershipRuleProcessingState "On"<br/><br/>New-AzureADMSGroup -Description "Executives Department Users" -DisplayName "Executives" -MailEnabled $true -SecurityEnabled $true -MailNickname "executives" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Executive"")" -MembershipRuleProcessingState "On"</span></strong></pre>
<p>The following bunch of groups is optional:</p>
<pre><strong>New-AzureADMSGroup -Description "Project Management Department Users" -DisplayName "Project Management" -MailEnabled $true -SecurityEnabled $true -MailNickname "projectmanagement" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Project Management"")" -MembershipRuleProcessingState "On"<br/></strong><br/><strong>New-AzureADMSGroup -Description "Operations Department Users" -DisplayName "Operations" -MailEnabled $true -SecurityEnabled $true -MailNickname "operations" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -eq ""Operations"") -or (user.department -eq ""Engineering Operations"")" -MembershipRuleProcessingState "On"</strong><br/><br/><strong>New-AzureADMSGroup -Description "Marketing Department Users" -DisplayName "Marketing" -MailEnabled $true -SecurityEnabled $true -MailNickname "marketing" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Marketing"")" -MembershipRuleProcessingState "On"</strong><br/><br/><strong>New-AzureADMSGroup -Description "Engineering Department Users" -DisplayName "Engineering" -MailEnabled $true -SecurityEnabled $true -MailNickname "engineering" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Engineering"")" -MembershipRuleProcessingState "On"<br/></strong><br/><strong>New-AzureADMSGroup -Description "Contractors" -DisplayName "Contractor" -MailEnabled $true -SecurityEnabled $true -MailNickname "contractor" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""1099 Contractor"")" -MembershipRuleProcessingState "On"<br/></strong><br/><strong>New-AzureADMSGroup -Description "Content Management Consulting Department Users" -DisplayName "Content Management Consulting" -MailEnabled $true -SecurityEnabled $true -MailNickname "contentmanagementconsulting" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -eq "" Content Management Consulting"")" -MembershipRuleProcessingState "On"<br/></strong><br/><strong>New-AzureADMSGroup -Description "Customer Relationship Management Department Users" -DisplayName "Customer Relationship Management" -MailEnabled $true -SecurityEnabled $true -MailNickname "customerrelationshipmanagement" -GroupTypes "DynamicMembership","Unified" -MembershipRule "(user.department -contains ""Customer Relationship Management"")" -MembershipRuleProcessingState "On"</strong></pre>
<p>Furthermore, we need to set the correct mail suffix of the Office 365 groups. You can use the following commands to set the addresses:</p>
<pre><strong># Set your preferred PowerShell execution policy</strong><br/><strong>Set-ExecutionPolicy Unrestricted</strong><br/><strong># Provide global administrator rights</strong><br/><strong>$UserCredential = Get-Credential</strong><br/><strong>$Session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://outlook.office365.com/powershell-liveid/ -Credential $UserCredential -Authentication Basic -AllowRedirection</strong><br/><strong>Import-PSSession $Session</strong><br/><strong># Set the correct suffix</strong><br/><strong>set-UnifiedGroup -Identity Sales -PrimarySmtpAddress "sales@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity Marketing -PrimarySmtpAddress "marketing@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Strategy Consulting" -PrimarySmtpAddress "strategyconsulting@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Project Management" -PrimarySmtpAddress "projectmanagement@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity Operations -PrimarySmtpAddress "operations@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Human Resources" -PrimarySmtpAddress "humanresources@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity Executives -PrimarySmtpAddress "executives@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity Engineering -PrimarySmtpAddress "engineering@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity Contractor -PrimarySmtpAddress "contractor@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Finance and Accounting" -PrimarySmtpAddress "financeandaccounting@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Customer Relationship Management" -PrimarySmtpAddress "customerrelationshipmanagement@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Content Management Consulting" -PrimarySmtpAddress "contentmanagementconsulting@inovitdemos.ch"</strong><br/><strong>set-UnifiedGroup -Identity "Senior Management" -PrimarySmtpAddress "seniormanagement@inovitdemos.ch"</strong></pre>
<p class="mce-root">Be aware that this is a list of users that are fully equipped with a Microsoft 365 E5 license:</p>
<p class="mce-root CDPAlignCenter CDPAlign"><img src="Images/28945f8e-0358-4c76-b8ae-2ca47bbb7b62.png" style="width:39.17em;height:20.25em;" width="944" height="488"/></p>
<p class="mce-root">We have prepared our workstation and created the related use cases resources. Next, we will discuss the most important PowerShell cmdlets to configure and manage the Azure RMS service.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure RMS management with PowerShell</h1>
                </header>
            
            <article>
                
<p>In the following section, we will discuss and use the most important PowerShell commands to configure and manage Azure RMS. You will get a good overview of the features and how to start the configuration.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure RMS super users</h1>
                </header>
            
            <article>
                
<p>We will start with the connection to the Azure RMS service and the management of the super users<span> feature. This feature is disabled by default. To use its functionality, we need to enable the feature and assign a mail-enabled group to it. We highly recommend adding the AIP Scanner account permanently to the group, and all the other required users as and when required. It doesn't matter when the user is added to decrypt information from the past.</span></p>
<p>The Azure RMS super users feature provides the following functionality in Azure RMS:</p>
<ul>
<li>Full control over all rights-protected content that is managed by rights management</li>
<li>Full owner rights to super users for all user licenses that are issued by the subscriber's organization</li>
<li>Decryption of any rights-protected content file and removal of rights-protection from it for content previously protected within that organization</li>
</ul>
<p>Typical use cases for the super user feature are:</p>
<ul>
<li>Read-protected information from an employee that leaves the organization</li>
<li>Replacement of a currently assigned protection policy</li>
<li>Usage of search operations in Exchange Online (eDiscovery)</li>
<li>Support for security solutions that need to inspect protected information</li>
</ul>
<p>With the following steps, you can configure the super users feature:</p>
<ol>
<li>Connect to the Azure RMS service with global administrator rights, as follows:</li>
</ol>
<pre style="padding-left: 60px"><strong>Connect-AadrmService</strong></pre>
<ol start="2">
<li>Get all super user commands<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-Command "*SuperUser*"</strong></pre>
<ol start="3">
<li>Check the super user feature<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmSuperUserFeature</strong></pre>
<ol start="4">
<li>Enable the super user feature<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Enable-AadrmSuperUserFeature</strong></pre>
<ol start="5">
<li>Get all super users<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmSuperUser</strong><br/><strong>Get-AadrmSuperUserGroup</strong></pre>
<ol start="6">
<li>Next, we create a <span class="packt_screen">Mail-enabled security group</span> in the <span class="packt_screen">Exchange Online</span> administrative center.</li>
<li>Navigate to <span class="packt_screen">R</span><span class="packt_screen">ecipients</span> | <span class="packt_screen">G</span><span class="packt_screen">roups</span> and create a new <span class="packt_screen">Mail-enabled security group</span><span>, as follows:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/843f8422-48e5-4a6e-ab7e-941d056239c8.png" style="width:30.17em;height:10.42em;" width="434" height="150"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Mail-enabled security group creation</div>
<ol start="8">
<li>After we create the group, we will also use <span class="packt_screen">Access reviews</span> to review the membership quarterly of the group, because the group is very powerful and shouldn't be filled with old users.</li>
<li>Open the Azure portal at <a href="https://portal.azure.com">https://portal.azure.com</a> and navigate to the Azure AD blade.<a href="https://portal.azure.com"/></li>
<li>Choose <span class="packt_screen">Organizational relationships</span> | <span class="packt_screen">Access reviews</span>.</li>
<li>Click <span class="packt_screen">Onboard</span> and <span class="packt_screen">Create</span> for the actual Azure AD.</li>
<li>Use the <span class="packt_screen">Default Program</span> and under <span class="packt_screen">Manage</span> | <span class="packt_screen">Controls</span>.</li>
<li>Click <span class="packt_screen">New access review</span><span>, as follow</span><span>s:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/f56452d5-fea5-4d58-8f19-7f53581289a0.png" width="933" height="231"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Access review creation</div>
<ol start="14">
<li>Choose the following settings for the review and assign your personal test account as a reviewer:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/c6e34a0a-255c-44e5-911b-34e7a2a3cc87.png" style="width:34.58em;height:51.17em;" width="554" height="819"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Access review properties</div>
<ol start="15">
<li>Next, we will assign the group as super users group.Set a super user group<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Set-AadrmSuperUserGroup -GroupEmailAddress "azurermssuperusers@inovitdemos.ch"</strong></pre>
<p>Now, we are safe if the organization starts encrypting information. All the protected content can be unprotected and recovered by the users in the super user group.</p>
<p>To administer the Azure RMS service, we can delegate administrative rights with the following cmdlets:</p>
<pre><strong>Get-AadrmRoleBasedAdministrator</strong><br/><strong>Add-AadrmRoleBasedAdministrator</strong></pre>
<div class="packt_tip">If you use a group for this delegation, the group does not need to be mail-enabled.</div>
<p>On the other hand, you should assign the administration for <span>AIP</span> in the Azure AD <strong>Privileged Identity Management</strong> (<strong>PIM</strong>) blade, as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/bff1b079-d3f1-4440-b125-1d3dab6d95fc.png" width="1349" height="240"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Information Protection Administrator - description on Azure AD</div>
<p>In the next section, we will discuss onboarding controls.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Onboarding controls</h1>
                </header>
            
            <article>
                
<p>It's recommended to do a planned roll out of <span>AIP</span>, including the RMS protection functionality in an organization. For this reason, Microsoft has implemented the onboarding controls feature. <span class="fontstyle0">You can check the default configuration with the following command:</span></p>
<pre><strong>Get-AadrmOnboardingControlPolicy</strong> </pre>
<p><span class="fontstyle0">Open an elevated PowerShell after you have established a connection to the Azure RMS service with the</span> following <span class="fontstyle0">command:</span></p>
<pre><strong>Connect-AadrmService</strong></pre>
<p>The feature is disabled by default.</p>
<p>To enable onboarding controls, you can use the following command:</p>
<pre style="padding-left: 30px"><strong>Set-AadrmOnboardingControlPolicy</strong></pre>
<p>With onboarding controls, you can enable a <span>group-based </span>rollout. To be that the users and associated computers are already prepared to use <span>AIP</span>. To prepare your users, you can use the following source: <a href="https://bit.ly/2CvBfF7">https://bit.ly/2CvBfF7</a>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure RMS templates</h1>
                </header>
            
            <article>
                
<p>Azure RMS templates are basically used over labels in <span>AIP</span>. If an organization doesn't use <span>AIP</span> for classification and labeling information, they can still use the basic Azure RMS service to protect content. Azure RMS templates can be created over the <span>AIP</span> blade under a label or by PowerShell. The actual Azure RMS usage rights are documented at <a href="https://bit.ly/2HkDK2F">https://bit.ly/2HkDK2F</a>. To manage Azure RMS templates, we can use the following procedures:</p>
<ol>
<li>Get all template commands<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-Command -Module AADRM Template</strong></pre>
<ol start="2">
<li>Get all templates<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmTemplate</strong></pre>
<p style="padding-left: 60px">The output of the preceding command is as follows:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1151a62a-6816-47e3-80d8-ec5484e3b525.png" width="1315" height="305"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Get all actual RMS templates</div>
<ol start="3">
<li>Remove templates<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Remove-AadrmTemplate -TemplateId "template ID"</strong></pre>
<ol start="4">
<li>Create a new template<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px">$names = @{}<br/> $names[1033] = "<strong>Template Name</strong>"<br/> $descriptions = @{}<br/> $descriptions[1033] = "<strong>Template description</strong>"<br/> $r1 = New-AadrmRightsDefinition -DomainName "<strong>yourdomain1.com</strong>" -Rights "VIEW","EXPORT"<br/> $r2 = New-AadrmRightsDefinition -EmailAddress "<strong>Email address of group or user</strong>" -Rights "OWNER"<br/> Add-AadrmTemplate -Names $names -Descriptions $Descriptions -LicenseValidityDuration 7 -RightsDefinitions $r1, $r2 -Status Published</pre>
<p>In the next section, we will provide some important information about the Azure RMS logging features.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Azure RMS logging</h1>
                </header>
            
            <article>
                
<p>In this section, we will verify the default enabled Azure RMS logging. Perform the following steps to analyze the usage of the Azure RMS service:</p>
<ol>
<li>Get the actual Azure RMS configuration, as follows:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmConfiguration</strong></pre>
<ol start="2">
<li>Get all the log commands<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-Command "*Log*" -Module AADRM</strong></pre>
<p style="padding-left: 60px">Create an AIP log directory and set the variables<span>, as follows</span>:</p>
<pre style="padding-left: 60px"><strong>New-Item -ItemType directory -Path C:\AIPLogs\User</strong><br/><strong>New-Item -ItemType directory -Path C:\AIPLogs\Admin</strong><br/><strong>$UserLogs = "<span>C:\AIPLogs\User"<br/></span>$AdminLogs = "<span>C:\AIPLogs\Admin"</span></strong></pre>
<ol start="3">
<li>Get the user logs<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmUserLog -Path <span>$UserLogs</span> -FromDate (Get-Date).AddDays(-45)</strong></pre>
<ol start="4">
<li>Get the admin logs<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmAdminLog -Path <span>$AdminLogs</span>\admin.log</strong></pre>
<ol start="5">
<li>Get the status from the document tracking feature<span>, as follows</span>:</li>
</ol>
<pre style="padding-left: 60px"><strong>Get-AadrmDocumentTrackingFeature</strong></pre>
<p>The next section will take you through an introduction to the AIP PowerShell capabilities.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">AIP client PowerShell</h1>
                </header>
            
            <article>
                
<p>With the AIP client installed, you can gather information about your configuration and do classification and protection activities. You can use the following command with the <span>AIP</span> cmdlets:</p>
<pre><strong>Get-Command -Module AzureInformationProtection</strong></pre>
<p>With the following cmdlet, you get the actual available RMS templates on a client:</p>
<pre><strong>Get-RMSTemplate</strong></pre>
<p>You can get the actual state of a file with the following cmdlet:</p>
<pre><strong>Get-AIPFileStatus .\Q3_Product_Strategy.docx<br/></strong></pre>
<p class="CDPAlignCenter CDPAlign"><img src="Images/5410e5c8-f27a-4d2c-97ab-3fee779b89d7.png" style="width:27.00em;height:14.50em;" width="511" height="272"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">AIP file status information</div>
<p>You can set a label with <span>the following cmdlet</span>:</p>
<pre><strong>Set-AIPFileLabel -LabelId de82bccd-c50f-4162-b113-8aa9e98ed45f -Path .\Testfile.docx</strong></pre>
<p>After this administrative introduction section, we will follow up with different use cases to configure and use <span>AIP</span>.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring AIP</h1>
                </header>
            
            <article>
                
<p>Configuring and managing <span>AIP</span> should always start with the global approach for all users. The most important task to do before you start touching the technology is to work on a clear classification schema and the associated policies. Doing the configuration is the smallest part in a classification and information project. You should consider the default labels based on your classification schema, and start without encryption and a lot of automatic classification rules. Start with the global users that understand and work with the new technology. Keep in mind to use a step-by-step approach and work through the specific requirements in the most sensitive departments, such as human resources, legal, or finance. Don't overwhelm your users and don't teach them to lie to your concept and classification system.</p>
<p>Here are some additional tips for data classification:</p>
<ul>
<li><span>Gather the support of the management and employees who will use the system</span></li>
<li>Tagging and categorizing everything is nearly impossible</li>
<li><span>Use an effective metadata strategy</span></li>
<li><span>Use data cleansing technology to remove redundant or obsolete data</span></li>
<li>Provide availability</li>
<li><span>Consider the confidentiality and security of the data to be classified</span></li>
</ul>
<p>Microsoft has carried out some intensive research and usability testing on the labels used to apply your classification to the data. Try to start with the default labels of <span>AIP</span>, for example:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/cff04985-b457-43a4-bf01-8845405aaee2.png" width="1343" height="46"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">AIP default label set</div>
<div class="packt_tip">You can also customize every label in <span>AIP</span> to fulfill your needs.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating the classification schema</h1>
                </header>
            
            <article>
                
<p>The first step in configuring a <span>AIP</span> solution is to start with the creation of the classification schema. Let's create our classification schema for our demo organization in the following steps:</p>
<ol>
<li>Open the <span>AIP</span> blade at <a href="https://portal.azure.com">https://portal.azure.com</a>.</li>
</ol>
<div class="packt_infobox">From <a href="fc1b4a15-de45-4f25-a356-94c9c18589e2.xhtml" target="_blank">Chapter 14</a>, <em>Understanding Encryption Key Management Strategies</em>, we have an enabled HYOK label. We will remove this label for now, because we don't want to include the on-premises part in our solution.</div>
<ol start="2">
<li>The default schema should look like the following:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/d8f38b61-2231-4d8d-ac0b-32ddeec75baa.png" width="873" height="472"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Default classification/label schema of <span>AIP</span></div>
<p style="padding-left: 60px">A good starting point is that you start labeling your information with a default label and disable the encryption functionality for the <span class="packt_screen">Confidential</span> and <span class="packt_screen">Highly Confidential</span> labels.</p>
<ol start="3">
<li>You find the configuration under <span class="packt_screen">Policy</span> | <span class="packt_screen">Global</span>.</li>
<li>Use <span class="packt_screen">General</span> as default label and ensure that all the information is required to be classified for your global users, for example:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/27dac743-d181-43bf-b630-fab86c07bc01.png" width="809" height="467"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Default label activation and other global settings</div>
<div class="packt_tip">We highly recommend that you provide your users with an additional source for more information about data classification. In our projects, we use a very often used website for the users.</div>
<ol start="5">
<li>Set the labels that have protection enabled to <span class="packt_screen">Not configured</span>, as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/5095a361-7cd8-40e0-8880-ff63eb860bbf.png" style="width:29.00em;height:5.50em;" width="417" height="79"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Protection disabled option</div>
<ol start="6">
<li>Test the result on one of the test clients, as Don Hall.</li>
<li>A new document or email gets automatically classified as <span class="packt_screen">General</span>, as follows:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/44254a4e-3912-49d5-9c01-2e65960d2c82.png" width="1120" height="31"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Default labeling result</div>
<p style="padding-left: 60px">Business data under <span class="packt_screen">General</span> label is not intended for public consumption. However, this can be shared with external partners as required. Examples include a company's internal telephone directory, organizational charts, internal standards, and most internal communications.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating sub-labels and scoped policies</h1>
                </header>
            
            <article>
                
<p>Now that we have provided the first set to our users, we can start to provide a basic configuration for our sensitive departments. We can do that with scoped policies to provide the changes only to specific department users. Scoped policies require AIP P2 licenses.</p>
<p>With the following steps, we will create the required sub-labels:</p>
<ol>
<li>Under <span class="packt_screen">Classifications</span> | <span class="packt_screen">Labels</span>. Create a new sub-label under the <span class="packt_screen">Confidential</span> label, as follows:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/4010194b-346a-4beb-9e27-1e166663ba6c.png" width="1068" height="154"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Adding a sub-label</div>
<ul>
<li style="list-style-type: none">
<ul>
<li><span class="packt_screen">Name</span>: <kbd>Finance and Accounting</kbd></li>
<li><span class="packt_screen">Description</span>: <kbd>Finance and Accounting</kbd> sensitive data that is not intended for consumption outside the department</li>
<li>Add the following conditions: credit card number and <strong>International Banking Account Name</strong> (<strong>IBAN</strong>)</li>
<li>Leave <span class="packt_screen">Recommended</span> to apply the label</li>
</ul>
</li>
</ul>
<ol start="2">
<li>Next, we will configure the custom policy for the <span class="packt_screen">Finance and Accounting</span> department.</li>
</ol>
<ol start="3">
<li>Under <span class="packt_screen">Classifications</span> | <span class="packt_screen">Policies</span>. Create one policy for <kbd>Finance and Accounting</kbd>.</li>
<li>Assign the <kbd>Finance and Accounting</kbd> group to the policy.</li>
<li>Click <span class="packt_screen">Add or remove labels</span>.</li>
<li>Add the <span class="packt_screen">Finance and Accounting</span> label.</li>
</ol>
<div class="packt_tip"><span>AIP</span> is currently limited to providing only one sub-level label.</div>
<ol start="7">
<li>Leave the other settings as their defaults<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/fd76911b-3c9f-42b5-a626-53733af1db36.png" width="811" height="607"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Scoping for Finance and Accounting users</div>
<ol start="8">
<li>Log in as <kbd>Karim Manar</kbd> from the <span class="packt_screen">Finance and Accounting</span> group on the second test client, and open Word.</li>
<li>You should see the new label<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/9c8e6e34-9e8d-4a08-b310-f92a7246d8b3.png" style="width:42.33em;height:7.33em;" width="668" height="116"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Finance and Accounting label result</div>
<p style="padding-left: 60px">All other users will receive the default label set.</p>
<ol start="10">
<li>The next feature we already activated is the recommendation of the label if the specific condition matches.</li>
<li>Log in as <kbd>Karim Manar</kbd>.</li>
<li><span>Open</span> Word <span>and create a document with the content </span><kbd>My AMEX card number is 344047014854133</kbd>.</li>
<li>Save the document and the recommendation for the label appears<span> as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/18acc017-9aff-42ee-b506-376f502d0bb7.png" width="934" height="192"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">AIP label recommendation feature example</div>
<div class="packt_infobox">Remember, we start without encrypting the information to teach your users and to avoid problems with the end user experience and use of encrypted information. We also want to gather more information about the rules to have a clear identifier before starting automatic encryption.</div>
<p>With this option, you can also define a specific default label for each policy. This is a very helpful feature to support the usability of a specific department user, because the <span class="packt_screen">Finance and Accounting</span> department handles mostly <span class="packt_screen">Confidential</span> content. Define the default label, <span>as follows</span>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/b9b4ba6a-c112-480d-936c-2e7743970a87.png" width="805" height="69"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Scoping the default label on custom policies</div>
<p>Create more sub-labels for the following departments to get an idea of how you can design your labels. In a real project, test and monitor the use of labels and leave it at a minimum, for example:</p>
<ul>
<li><span class="packt_screen">Strategy Consulting</span></li>
<li><span class="packt_screen">Senior Management</span></li>
<li><span class="packt_screen">Human Resources</span></li>
<li class="azc-grid-hierarchical-icon"><span><span class="packt_screen">Executives</span></span></li>
</ul>
<div class="packt_tip">If you are using more policies, <span>t</span><span>he last policy wins</span> <span>in a conflicting</span> setting.</div>
<p>The next screenshot shows the classification schema:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/ece9f9bb-d4bf-4368-92cb-78288ddba63b.png" style="width:52.17em;height:37.83em;" width="711" height="516"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Modified classification schema</div>
<p>You can use the same strategy for sensitive projects for other departments. Always think, discuss the real requirement for a new label, and assign it to the associated user group. It's very important to have an explicit usage and a proper handling for the user to provide a successful solution. </p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using visual markings</h1>
                </header>
            
            <article>
                
<p class="mce-root">The next option we can add is the marking option, to make the classification also visible in the content of the mail or document as a header, footer, or watermark. By default, the marking option is applied under the <span class="packt_screen">Confidential</span> and <span class="packt_screen">Highly Confidential</span> labels.</p>
<p class="mce-root">With the next steps in this section we will reach and view the following result:</p>
<ul>
<li>View the default behavior for the <span class="packt_screen">Confidential</span> label</li>
<li>Open Word as Don Hall and apply the <span class="packt_screen">Confidential</span> | <span class="packt_screen">All Employees</span> label</li>
<li>You will notice the footer contains <span class="packt_screen">Classified as Confidential</span></li>
</ul>
<p>If you work with templates that already use the header/footer section, you need to test the templates to ensure that the classification doesn't crash your template design. By default, no watermark will be applied.</p>
<div class="packt_tip">Use the following source to customize the visual markings: <a href="https://bit.ly/2Cu8BnU">https://bit.ly/2Cu8BnU</a>.</div>
<p>A typical example could be <kbd>Classified as ${Item.Label} from ${User.Name} at ${Event.DateTime}</kbd>.</p>
<p>If you are using the new <span class="packt_screen">AutoSave</span> option, we recommend enabling the continuous classification feature in the <span class="packt_screen">Advanced settings</span> with the following strings <span class="packt_screen">NAME</span>: <span class="packt_screen">RunPolicyInBackground</span>, <span class="packt_screen">VALUE</span>: <span class="packt_screen">True</span><span>, for example</span><span>:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6fbe7f59-b256-495c-ac4f-08717d8fd4a2.png" width="1067" height="151"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">AIP policy advanced settings</div>
<p>You will find additional features in this area<span>, as follows</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ab3fbed4-dc2a-49f7-87d0-79979f5809e2.png" style="width:36.25em;height:24.75em;" width="569" height="390"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Configured advanced settings in the policy</div>
<p>Next, we will explore the automatic classification feature.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring automatic classification and protection</h1>
                </header>
            
            <article>
                
<p><span>AIP</span> also provides automatic classification. The feature requires the <strong>Azure Information Protection P2</strong> licensing. The feature is included in the <strong>EMS E5</strong> and <strong>Microsoft 365 E5</strong> plan.</p>
<p>Start with clear rules and identifiers with automatic classification. For example, if a company uses an identifier in the document, such as <kbd>Approved for public consumption</kbd>, you can build an easy condition like we do in the following steps:</p>
<ol>
<li>Edit the <span class="packt_screen">Highly Confidential</span> | <span class="packt_screen">All Employee</span><span class="packt_screen">s</span> label and add the following condition:</li>
</ol>
<p class="mce-root"/>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1ee23459-9e6a-4000-b338-4633e7641406.png" style="width:37.33em;height:32.17em;" width="570" height="490"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Keyword definition for automatic classification</div>
<ol start="2">
<li>Change <span class="packt_screen">Select how this label is applied: automatically or recommended to user</span> to <span class="packt_screen">Automatic</span><span>, as follows:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/1f841ff5-f292-4448-86dc-b6f0b8f4d081.png" style="width:37.08em;height:8.17em;" width="537" height="117"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Activating automatic classification</div>
<ol start="3">
<li>Test the configuration with Don Hall.</li>
<li>Create a new Word document with <kbd>My password is Pass@word1</kbd><span> in the document.</span></li>
<li>The document will be classified automatically as <span class="packt_screen">Highly Confidential</span> | <span class="packt_screen">All Employees</span>.</li>
</ol>
<p>We can also use Cloud App Security to automatically classify and protect content by following these steps:</p>
<ol>
<li>Open <a href="https://portal.cloudappsecurity.com">https://portal.cloudappsecurity.com</a> as a global administrator.</li>
<li>Click <span class="packt_screen">Create policies</span> in the <span class="packt_screen">Get started</span> section.</li>
<li>Use the following template for our example (be sure that you put some Personal Identifiable Information PII files from the code package to your test user OneDrive):</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/3020cbd3-43ad-49ff-a2c5-9eee26e55923.png" width="936" height="77"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Cloud App Security PII scan result</div>
<ol start="4">
<li>Use the following settings in your new policy:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/d6c7f00f-2a11-4c84-ad9f-a93f7423b89e.png" style="width:42.92em;height:17.42em;" width="844" height="343"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Policy creation in Cloud App Security to catch PII information</div>
<ol start="5">
<li>Choose <span class="packt_screen">Microsoft OneDrive for Business</span> and choose the <span class="packt_screen">Confidential-All Employees</span> label<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/575c31ef-e0f3-48b5-afdc-b7f151d4457d.png" width="828" height="525"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Cloud App Security automatic classification option</div>
<ol start="6">
<li>You will notice that if you click another app such as <span class="packt_screen">Dropbox</span> or <span class="packt_screen">Salesforce</span> the options are not available.</li>
</ol>
<ol start="7">
<li>Next, move back to the dashboard and you will receive alerts with a match to our freshly created file policy<span>,</span> <span>as follows:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/d6a305a1-b9c2-483a-ab19-95af4a0bbd20.png" style="width:25.58em;height:18.08em;" width="509" height="358"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Rule results after scanning</div>
<ol start="8">
<li>Click on the OneDrive alert and view the result; the file contains the PII information and it's classified:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/737d9c3e-260e-41a6-a180-23f8ded515ee.png" width="995" height="253"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Automatically classified document</div>
<p>Another option to automatically classify and protect sensitive information can be found in Office 365 by using the following steps:</p>
<ol>
<li>Navigate to the Office 365 portal at <a href="https://portal.office.com">https://portal.office.com</a> and sign in as a global administrator.</li>
<li>You will notice the following <span class="packt_screen">Recommendation</span> to protect sensitive information. This is because the system has already detected some files you uploaded from the code package to OneDrive:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/78289529-1428-4e4e-b4c3-21e8d906f93f.png" style="width:39.75em;height:15.75em;" width="749" height="296"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">DLP options in Office 365</div>
<ol start="3">
<li>Click <span class="packt_screen">View recommendation</span> and the system will give you the following option to create a policy to protect the information:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/90516a28-bf8b-4eed-8bc6-fce78bef9a45.png" style="width:33.67em;height:31.08em;" width="612" height="564"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Scanning for sensitive information, such as credit card details</div>
<ol start="4">
<li>Click <span class="packt_screen">Create a policy</span> at the bottom of the message.</li>
<li>You will find the newly created policy under <a href="https://bit.ly/2FMYBJS">https://bit.ly/2FMYBJS</a>, and it will be called <span class="packt_screen">Default Data Loss Protection Policy</span><span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/fc73eabf-a956-4cf9-b11a-81b0484c65ec.png" style="width:30.75em;height:11.67em;" width="537" height="204"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Policy creation wizard to use the rules</div>
<ol start="6">
<li>Edit the policy and view the settings<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/d8bca498-2460-4456-9752-645f91c2de28.png" width="821" height="365"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Policy summary</div>
<ol start="7">
<li>Edit the rule under <span class="packt_screen">Location</span>; remove <span class="packt_screen">SharePoint sites</span> and <span class="packt_screen">OneDrive accounts</span><span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/f29d061a-7f5f-4d8e-95c8-08597b656e1c.png" width="885" height="384"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Location definition for the policy</div>
<ol start="8">
<li>Edit the rule under <span class="packt_screen">Actions</span>; choose <span class="packt_screen">Encrypt</span> messages:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/68fddb25-64dd-46d1-a020-1287af072c8f.png" width="965" height="320"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Enable encryption if sensitive content is detected</div>
<ol start="9">
<li>Let's test the policy with Don Hall on one of our test clients.</li>
<li>Open Outlook and send a message to Ye Xu and your private mail account with the following content.</li>
<li>You can create a credit card number on the following source (<a href="https://bit.ly/2KeZHR1">https://bit.ly/2KeZHR1</a>):
<ul>
<li><strong>Card Type</strong>: <kbd>MasterCard</kbd></li>
<li><strong>Card Number</strong>: <kbd>5131493203693245</kbd></li>
<li><strong>Expiration Date</strong>: <kbd>06/2027</kbd></li>
<li><strong>CVV</strong>: <span><kbd>225</kbd></span></li>
</ul>
</li>
</ol>
<p style="padding-left: 60px">The following screenshot shows the mail with the sensitive content:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/72a25904-e966-4ccf-bd2d-b80e6efce4c0.png" style="width:23.92em;height:15.50em;" width="376" height="244"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Test mail with sensitive content</div>
<ol start="12">
<li>Open your private mail account:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/a70ba14a-a640-4494-856d-b8f05ef5461f.png" width="890" height="49"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Private mail account expected result</div>
<ol start="13">
<li>Click <span class="packt_screen">Read the message</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1f3ec975-c40e-4b8f-9f37-8be11626ea90.png" style="width:36.42em;height:33.42em;" width="603" height="552"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Read the encrypted message dialog</div>
<ol start="14">
<li>You will get two options to access the protected content:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/529ed973-7ee1-48cf-ac44-5945a6907e0e.png" style="width:33.00em;height:22.08em;" width="626" height="419"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Sign in or one-time passcode authentication option</div>
<ol start="15">
<li>Choose the <span class="packt_screen">one-time passcode</span> option to see the passcode behavior.</li>
<li>You will receive a mail with the passcode:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/e0a68b5b-7aa0-4519-9753-9ab4dfd5c5b4.png" style="width:20.17em;height:7.50em;" width="532" height="195"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Received verification code</div>
<ol start="17">
<li>Enter the passcode and click <span class="packt_screen">Continue</span><span>:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/84cd9668-97c5-473d-9214-c8f58738988e.png" style="width:29.00em;height:12.75em;" width="608" height="267"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Code verification</div>
<ol start="18">
<li>And you can read the mail:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/977e3ef3-0294-47f2-93e8-29f448063cab.png" style="width:23.25em;height:20.75em;" width="429" height="382"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Message in plaintext</div>
<p>After working through a few automatic options, we will start using the justification option.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Using justification</h1>
                </header>
            
            <article>
                
<p>The justification feature is a good option to change a recommended label or modify an existing label to address the sensitivity of a modified document. You can enable this feature under the policy settings:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/925fa9bc-3beb-4c37-b58f-2cf1fc411c30.png" style="width:38.00em;height:4.00em;" width="561" height="58"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Justification enabled</div>
<p>To test the functionality, open a document and downgrade it to the personal label:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/722ba8ea-62bb-449f-85eb-4826b1edb658.png" style="width:29.67em;height:16.17em;" width="427" height="233"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Providing a justification</div>
<p>After a while, you will be able to see the following modification in the activity logs:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/c5263e1d-87a9-4e1a-aa03-49368c5b34fb.png" width="900" height="35"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Log information for the justification</div>
<p>We recommend using the activity logs to provide information on your classification life cycle. You particularly need this information to improve your automatic rules. Maybe your conditions are no longer valid or not clear and data gets recommended for the wrong classification label.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring protection options</h1>
                </header>
            
            <article>
                
<p>Once your classification labels are appropriate and the users have been trained with the new methods,<span> we can increase the protection options to achieve a more protected state.</span></p>
<p>For email messages, we can use the option to increase the mail classification based on the highest attachment classification. We highly recommend using this as a recommended option and only if you have a crystal clear use case for the automatic option. With the following steps, you can configure this use case:</p>
<ol>
<li>You can find the option in the policy configuration:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1c658a61-d05b-4561-9d76-308662de3859.png" width="808" height="115"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Recommended classification option</div>
<ol start="2">
<li>Log in as Don Hall to a test client and create two Word documents, one classified as <kbd>Public</kbd> and the other as<span> </span><kbd>Confidential</kbd>.</li>
<li>Next, create a test email with the two attachments and send it to <kbd>Ye Xu</kbd>, as follows:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/3f07b985-73ae-4c0d-96c9-13b275b6c626.png" style="width:36.25em;height:20.25em;" width="649" height="363"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Recommendation in action</div>
<p>The following two options are useful for using custom protection:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/27ceaf5f-4c51-4714-8b9e-fc1e3b933976.png" style="width:21.92em;height:8.17em;" width="316" height="117"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Additional protection features for Office users</div>
<p>We will test the options with Don Hall in the following steps:</p>
<ol>
<li>Log in as Don Hall and create a new Word document.</li>
<li>Click the <span class="packt_screen">Protect</span> icon and use the <span class="packt_screen">Custom Permissions</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/90c69119-6cd2-4441-97f4-40109868ff6c.png" width="785" height="402"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Custom permissions dialog</div>
<ol start="3">
<li>Assign co-author permissions to Ye Xu and one external user<span>, as follows:</span></li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1021621b-3659-4300-8d87-d8e24dd17c05.png" style="width:35.08em;height:21.83em;" width="580" height="360"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Using the custom permission options, including external accounts</div>
<ol start="4">
<li>Send the mail with the document attached to the two recipients.</li>
<li>Open the mail and the attachment on the external user's computer:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/92b9b564-1b35-4e0b-b327-b403aa86954b.png" width="1095" height="387"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">External users, view of the protected information</div>
<p>Be aware that the behavior of Azure RMS protected content is slightly different and depends on the configuration and RMS enablement of the recipient. If the other user also uses Office 365, there should be a transparent usage for the recipient without login prompt. When the user is not using any Microsoft cloud service and no Azure AD, the recipient will be automatically processed to create an ad hoc Azure AD account in order to use the Azure RMS functionality. Prepare your external recipients and include them in the training you do for your internal users:</p>
<div class="packt_tip">If you want to regulate all Azure RMS protected content, you should build a label for the process and hide the button.</div>
<ol>
<li>Use the <span class="packt_screen">Do Not Forward</span> button in Outlook to encrypt the message:</li>
</ol>
<div class="CDPAlignCenter packt_figref CDPAlign"><img src="Images/7e4e7cbd-914c-451b-88fe-e9a892bc11f7.png" width="819" height="296"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Do Not Forward button in Outlook (not in other Office products)</div>
<div class="packt_tip">Provide a fully explained Business to Business and Business to Customer protection scenario.</div>
<ol start="2">
<li>You can provide this functionality inside your labels.</li>
<li>We can create a custom label called <kbd>Partners</kbd> <span>under <span class="packt_screen">Confidential</span> and assign </span>it to the global policy, as follows:</li>
</ol>
<div class="packt_figref CDPAlignCenter CDPAlign"><img src="Images/3fd4f264-8819-4a3d-8d9d-cfb6cbea07c5.png" width="1161" height="535"/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Using the custom protection options in a label</div>
<ol start="4">
<li>Use a custom footer with the following text "classified as partner confidential".</li>
<li>Log in as Don Hall to a test client.</li>
<li>Create a Word document and test the new functionality<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/4642bcf0-fb3c-45b3-9d67-fcfd6ead2db9.png" style="width:31.33em;height:19.25em;" width="585" height="359"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Testing the custom permission option in Word</div>
<ol start="7">
<li>Create a new mail in Outlook and test the new functionality<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/b7aa6f6b-5963-4ee1-bd0b-c9220c063e89.png" width="953" height="280"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Testing the Do Not Forward button in Outlook</div>
<div class="packt_tip">Keep in mind that online Office components can't use protected information.</div>
<p>Actually, Microsoft supports many different applications and file formats to classify and protect; you can see the applications in the following screenshot:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/6471d373-e38e-477d-ac64-8b14c6a8924e.png" style="width:45.50em;height:23.33em;" width="1206" height="619"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Document types supported by Azure RMS</div>
<p>Microsoft also provides a universal solution over the integration that we can use to classify and protect sensitive data. The following steps show the procedure:</p>
<ol>
<li>Log on as Don Hall and open your <kbd>OneDrive</kbd> folder<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/27c08799-e499-4301-bede-17d06ea5641b.png" width="688" height="408"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Using the desktop classification option</div>
<ol start="2">
<li>Right-click on the <kbd>Finance</kbd> folder and choose <span class="packt_screen">Classify and protect</span>.</li>
</ol>
<ol start="3">
<li>Use the <span class="packt_screen">Confidential</span> | <span class="packt_screen">All Employees</span> label to basically classify the documents<span>, as follows</span>:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/e8a7380b-3a72-47fb-97c9-c147cb4e1b97.png" width="916" height="415"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Choosing the All Employees label to classify the information</div>
<ol start="4">
<li>Later, if you have your complete process in place, you can provide a specific label and protect the information.</li>
<li>You will be able to see a report of all actions:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/c39074bd-4209-4b15-b4d9-ed51e8d5b7c4.png" width="774" height="153"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Specific label reporting</div>
<p>With this option, you can classify and protect several different files, based on the automatic rules or your manually chosen label.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Activating unified labeling</h1>
                </header>
            
            <article>
                
<p>With the strategy of Microsoft to build a complete Information Protection solution, Office 365 and <span>AIP</span> labels will be merged together. With this option, you will have full integration with the most important services.</p>
<p>In the following steps, we will activate the unified labeling functionality:</p>
<ol>
<li>You can activate unified labeling by opening <a href="https://bit.ly/2RHzZZZ">https://bit.ly/2RHzZZZ</a> with global administrator credentials.</li>
<li>Click the <span class="packt_screen">Activate</span> button and <span class="packt_screen">Publish</span> your labels, as follows:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/588201fb-a894-4dc9-a98d-250e3a53d9d1.png" style="width:26.50em;height:9.50em;" width="496" height="177"/></p>
<div class="packt_figref CDPAlignCenter CDPAlign">Unified labeling activation</div>
<ol start="3">
<li>Navigate to <a href="https://protection.office.com/">https://protection.office.com/</a> and click on <span class="packt_screen">Classifications and Labels</span> to review the migrated labels.</li>
</ol>
<p>Next, we will let you run through a lab challenge to discover more <span>AIP</span> capabilities.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Lab challenge</h1>
                </header>
            
            <article>
                
<p>Build up a complete classification schema with several processes using the actually created groups and test all the different functionalities. Try to implement the following processes:</p>
<ul>
<li>Partner and customer processes</li>
<li>Sensitive project content management</li>
<li>Internal collaboration processes between departments</li>
<li>Email protection for external users</li>
<li>Protecting your SharePoint/OneDrive sharing of information/data</li>
<li>Prevent data leakage in other platforms, such as Dropbox and Salesforce</li>
</ul>
<p>Good luck!</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>Working through this chapter enabled you to start to optimize your Information Protection solutions inside your organization or with your customers. We provided a starting lab environment to test all the required functionality and processes of <span>AIP</span>. With the key PowerShell cmdlets, you should be up and running, and ready to start your configuration tasks. Furthermore, with the overview of typical configuration tasks, we provided you a few examples of the experiences we learned during our many projects.</p>
<p>In the last chapter of the book, we will work through an AIP-enabled example application to give you more insights into the <span>AIP</span> technology.</p>


            </article>

            
        </section>
    </div>



  </body></html>