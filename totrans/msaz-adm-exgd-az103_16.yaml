- en: Azure Security Groups and Azure DNS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we covered the third part of the *Deploying and Managing
    Virtual Networks*objective by covering how to monitor and troubleshoot your network
    traffic in Azure Network Watcher. We've covered how to use Azure Network Watcher
    for network traffic inside Azure, as well as for on-premises and external networks.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we are first going to focus on **Network Security Groups**
    (**NSGs)** in Azure. We will cover the basics of NSGs, and how you can use them
    to filter network traffic, and you will also learn how to create and configure
    them. We are also going to associate an NSG with a subnet or **Network Interfaces** (**NICs**),
    and we are going to create and evaluate security rules for NSGs. In the second
    part of this chapter, we are going to cover Azure DNS. You will learn how to set
    up Azure DNS and how to add DNS zones and DNS records.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: NSGs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating and configuring an NSG
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Associating an NSG with a subnet or NIC
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating and evaluating security rules
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure DNS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring private and public DNS zones
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The source code for our sample application can be downloaded from [https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter12](https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter12)[.](https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter12)
  prefs: []
  type: TYPE_NORMAL
- en: NSGs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can use an NSG to filter network traffic to and from Azure resources that
    reside in an Azure virtual network. An NSG is an access control list inside Azure
    where you can add inbound and outbound security rules that allow or deny traffic
    from several types of resources.
  prefs: []
  type: TYPE_NORMAL
- en: When a connection is established between VMS, VNets, or other cloud services,
    this list is checked to see whether the connection is allowed or denied. NSGs
    can be applied to one or more subnets or individual NICs. This means that all
    resources that are associated with this subnet or NIC will automatically have
    all the rules applied. NSG rules are processed in priority order using the five-tuple
    information (source, source port, destination, destination port, and protocol)
    to allow or deny traffic. They are evaluated by priority, with lower numbers before
    higher numbers, and they can be applied to inbound or outbound traffic.
  prefs: []
  type: TYPE_NORMAL
- en: There is a limit to how many rules per NSG can create per Azure location and
    subscription. For details, see the documentation on Azure limits at : [https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits](https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits?toc=%2fazure%2fvirtual-network%2ftoc.json#azure-resource-manager-virtual-networking-limits).
  prefs: []
  type: TYPE_NORMAL
- en: Service tags
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To help minimize the complexity of security rule creation, Azure offers service
    tags. They represent a group of IP address prefixes and you can use service tags
    in place of specific IP addresses when creating security rules. These service
    tags can't be created manually; they are created and managed by Azure.
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure offers an exhaustive list of service tags, such as the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '**VirtualNetwork**: This tag includes the virtual network address space, all
    connected on-premises address spaces, peered virtual networks, and all virtual
    networks connected to a virtual network gateway.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**AzureLoadBalancer**:This tag covers the Azure Load Balancer. It translates
    to the virtual IP address of the host from where the health probes originate.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Internet**: This tag is for the IP address space that is outside the virtual
    network and reachable from the public internet.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**AzureKeyVault**: This tag is for the address prefixes of the Azure Key Vault
    service. If you specify `AzureKeyVault` for the value, traffic is allowed or denied
    to Azure Key Vault. You can also only access Azure Key Vault in a specific region.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: For a complete overview of all the service tags that Azure has to offer, you
    can refer to the documentation at: [https://docs.microsoft.com/en-us/azure/virtual-network/security-overview](https://docs.microsoft.com/en-us/azure/virtual-network/security-overview).
  prefs: []
  type: TYPE_NORMAL
- en: In the next demonstration, we are going to create and configure an NSG in the
    Azure portal.
  prefs: []
  type: TYPE_NORMAL
- en: Creating and configuring an NSG
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: NSGs can be created from the Azure portal, PowerShell, and CLI. In this demonstration,
    we are going to create an NSG from the Azure portal and configure it. We are going
    to associate the NSG with a subnet and create and evaluate security rules.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create an NSG from the Azure portal, take the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Create a resource** in the left menu and type `Network Security Group` into
    the search bar.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a new NSG.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Add the following settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Name**: `PacktNSG`.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Subscription**: Select the subscription that we used for creating the VNet
    in [Chapter 9](9477b805-9d4d-4908-9cbf-577c2e973203.xhtml), *Implementing and
    Managing Virtual Networking*.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group**: Select the subscription that we used for creating the VNet
    in [Chapter 9](9477b805-9d4d-4908-9cbf-577c2e973203.xhtml), *Implementing and
    Managing Virtual Networking. *In my case, this is `PacktVNetResourceGroup`.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Location**: (US) East US:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/ce5942ea-c709-46e5-99c1-f464aa6f9cbd.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating a new NSG
  prefs: []
  type: TYPE_NORMAL
- en: Click **Create**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We have now created a new NSG and added it to the `PacktVNetResourceGroup`.
    This is the same resource group as where the virtual networks reside. In the next
    part of this demonstration, we are going to associate the NSG with a subnet and
    NIC.
  prefs: []
  type: TYPE_NORMAL
- en: Associating an NSG with a subnet or NIC
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To associate the NSG with a subnet, you have to take the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: After creating the NSG, navigate to its overview page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Under **Settings**, select **Subnets** to associate the NSG with a subnet.
    Click **Associate** in the top menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7f035d88-70bb-437f-bf1f-701f8b31fe25.png)'
  prefs: []
  type: TYPE_IMG
- en: Associating an NSG with a subnet
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to select a virtual network. Select `PacktVNet`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1e9e7a93-3ede-4c71-bbd7-1623506c0383.png)'
  prefs: []
  type: TYPE_IMG
- en: Selecting a virtual network
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, we need to select **Subnet**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/684dd592-5921-4c34-80bd-10d8436c7963.png)'
  prefs: []
  type: TYPE_IMG
- en: Selecting the subnet
  prefs: []
  type: TYPE_NORMAL
- en: Click **OK**. The NSG will now be associated with the subnet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To associate the NSG with an NIC, under **Settings**, select Network interfaces.
    Select **Associate** in the top menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/27b8fe7c-dd35-4edd-bbd4-62c68d4b803c.png)'
  prefs: []
  type: TYPE_IMG
- en: Associating NSG with a NIC
  prefs: []
  type: TYPE_NORMAL
- en: 'There, you can select an NIC that resides in the same region as where the NSG
    was created:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/708715ee-aa23-442d-92a5-c31ece432045.png)'
  prefs: []
  type: TYPE_IMG
- en: Selecting an NIC
  prefs: []
  type: TYPE_NORMAL
- en: After selecting the NIC, the NSG is associated with it.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In this demonstration, we've covered how to associate an NSG with a subnet and
    a NIC. In the next demonstration, we are going to cover how to create and evaluate security
    rules.
  prefs: []
  type: TYPE_NORMAL
- en: Creating and evaluating security rules
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'When you create an NSG, there are some default inbound and outbound security
    rules created for you automatically. The default rules are low-priority rules.
    You can also add custom rules to them. You can create inbound and outbound security
    rules. In this demonstration, we are going to create an inbound security rule
    that denies RDP traffic to the associated subnet. Therefore, you have to take
    the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, go the overview page of the NSG. In there, you can see the default inbound
    and outbound security rules:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f6a98a5d-2272-4376-95a4-76d1176bd6e2.png)'
  prefs: []
  type: TYPE_IMG
- en: Default security rules
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, under **Settings**, select **Inbound security rules** to add a custom
    rule. Then click **Add** in the top menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3c400c35-9f54-4b29-8734-29383f085a22.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We are going to deny all traffic over port `3389`, which is the RDP port. Therefore,
    we select the **Service Tag for Source** field and the **Internet for Source**
    service tag,set the destination to VirtualNetwork and the destination port ranges
    to `3389` over any protocol. The action will be set to **Deny**. We are going
    to set the priority to **100**, which is the highest priority:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/af5cc6ab-d809-4b8c-a10e-c470cdf999bc.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating a security rule
  prefs: []
  type: TYPE_NORMAL
- en: Click **Add**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: We have now created an inbound security rule that denies all RDP traffic. This
    rule is bound to the subnet, because we associated this NSG with a subnet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To evaluate this security rule, deploy a VM inside this resource group, virtual
    network, and subnet. Also, enable RDP for it. After deployment, try connecting
    to it. If the security rule got applied correctly, you should receive the following
    error message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5d3d8c17-dbaf-40da-a521-906d0c53af5f.png)'
  prefs: []
  type: TYPE_IMG
- en: Error message
  prefs: []
  type: TYPE_NORMAL
- en: This concludes the Azure NSG section. In the last part of this chapter, we are
    going to cover **Azure DNS**.
  prefs: []
  type: TYPE_NORMAL
- en: Azure DNS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure DNS is a hosting service for DNS domains that can be used for name resolution. The
    process of name resolution involves converting a hostname (such as `www.packt.com`)
    into an IP address (such as `192.168.1.1`). DNS servers eliminate the need for
    humans to memorize difficult IP addresses. In Azure, you can manage your DNS records
    using the Microsoft Azure infrastructure and the same tools and billing as you
    use for your other Azure resources.
  prefs: []
  type: TYPE_NORMAL
- en: Azure DNS can't be used as a domain registrar, However, you can host your DNS
    names that are registered somewhere else, such as a third-party domain name registrar,
    for instance, in Azure DNS for record management. You then have to delegate the
    domain to Azure DNS in order for the DNS queries for a certain domain to reach
    Azure DNS.
  prefs: []
  type: TYPE_NORMAL
- en: Domain names
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The DNS consists of a hierarchy of different domains. They are globally distributed
    over DNS servers around the world. The rootdomain is simply named `.`. Below the
    root domain comes the top-level domains, such as `.``com`, `.``net.`, `.org`,
    and more. Below that comes the second-level domains, such as `.``org.uk`.
  prefs: []
  type: TYPE_NORMAL
- en: You can buy your domain name from a domain registrar. This will give the right
    to control the DNS hierarchy under that name allowing you to do things, such as
    redirecting the domain to your own website. You can let the registrar host the
    domain at its nameservers on your behalf, or you can specify alternative nameservers
    for your domain. Azure DNS can be used as such an alternative name server where
    you can control the DNS hierarchy.
  prefs: []
  type: TYPE_NORMAL
- en: Public DNS zones
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To start hosing your domain in Azure DNS, you first need to create a DNS zone
    for your domain. This is used to host all the different DNS records. For instance,
    the `www.packt.com` domain can contain multiple DNS records, such as `mail.packt.com` for
    a mail server and `www.packt.com` for the company website.
  prefs: []
  type: TYPE_NORMAL
- en: 'When you create a DNS zone in Azure DNS, you have to keep the following things
    in mind:'
  prefs: []
  type: TYPE_NORMAL
- en: The name of the zone must be unique within the resource group. The zone must also
    not already exist in the resource group.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can reuse the same zone across different resource groups or different subscriptions.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When you have multiple zones with the same name across different resource groups
    or subscriptions, each instance must contain a different nameserver address. Only
    one set of addresses can be configured with the domain name registrar.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Private DNS zones
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With **private DNS zones**, you can manage and resolve domain names in a virtual
    network without the need to add a custom DNS solution. You can use your own custom
    DNS names, rather than the Azure-provided names that are available. You can use
    these custom domain names to tailor your virtual network architecture to suit
    your organization's needs.
  prefs: []
  type: TYPE_NORMAL
- en: Private DNS zones provide name resolution for VMs within a VNet and between
    different VNets. You can also configure zone names that share private and public
    DNS zones to share the same name.
  prefs: []
  type: TYPE_NORMAL
- en: To publish a private DNS zone to a VNet, you first need to specify a list of
    virtual networks that are allowed to resolve records within the private DNS zone.
    These virtual networks are then called **resolution virtual networks**. You can
    also specify a registration virtual network, which is then used by Azure DNS for
    maintaining the hostname records when a VM is created. It is also used for IP
    changes of the VM, and when a VM is deleted.
  prefs: []
  type: TYPE_NORMAL
- en: At the time of writing this book, the Azure DNS private zone feature is in public
    preview.
  prefs: []
  type: TYPE_NORMAL
- en: Record types
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Each DNS record that you create inside the DNS zone has a name and a type. The
    different records are organized into various types according to the type of data
    that they contain. For instance, an A record maps the domain name to an IPv4 address.
    Another example is an MX record, which maps a name to a mail server.
  prefs: []
  type: TYPE_NORMAL
- en: For more information about the different record types, you can go to [https://docs.microsoft.com/en-in/azure/dns/dns-zones-records](https://docs.microsoft.com/en-in/azure/dns/dns-zones-records).
    SPF records are represented using TXT records in Azure DNS: [https://docs.microsoft.com/en-in/azure/dns/dns-zones-records#spf-records](https://docs.microsoft.com/en-in/azure/dns/dns-zones-records#spf-records).
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also create record sets in Azure DNS. They can be used to map different
    records in a zone together that have the same name and are of the same type—for
    instance, when you have a company website that is hosted on two different IP addresses:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: When you've created the A record in the `packt.com` zone pointing to the first
    IP address,  you can then add the second record to the existing records set, instead
    of creating a new an additional record set.
  prefs: []
  type: TYPE_NORMAL
- en: In the upcoming section, we are going to configure private and public DNS zones
    in Azure DNS.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a public DNS zone
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To configure private and public DNS zones from the Azure portal, you have to
    take the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Create a resource** in the left menu and type `DNS Zone` in the search
    bar. Create a new DNS zone.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Add the following values to create a new DNS zone:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Subscription**: Select a subscription.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group**: Create a new one, and call it `PacktDNSResourceGroup`.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Name**: `packtdns.com`.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group location:** (US) East US:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/d4bc0192-5e14-4739-8de1-998d57f63264.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating a new DNS zone
  prefs: []
  type: TYPE_NORMAL
- en: Click **Review + create**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'When the resource is deployed, you can add DNS records to it. From the overview
    page, in the top menu, select + Record set:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/bc5a8c2a-027c-463e-b585-69ac6c0caa4a.png)'
  prefs: []
  type: TYPE_IMG
- en: '[Adding a new record]'
  prefs: []
  type: TYPE_NORMAL
- en: 'To create an A record, add the following values:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Name**: `www`.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Type**: Select **A**.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**TTL**: Type `1`. The **Time-to-live** (**TTL**) parameter of the DNS request
    specifies for how long DNS servers and clients can cache a response.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**TTL unit**: Select **Hours**. This is the time unit for the **TTL** value.'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**IP address**: `10.10.10.10`:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/82c0a6ee-7abc-4aaa-8cc2-a1ecb6418505.png)'
  prefs: []
  type: TYPE_IMG
- en: Adding a new record
  prefs: []
  type: TYPE_NORMAL
- en: Click **OK**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'When the record is added, we can test it using the `nslookup` command.First,
    we need to copy one of the nameservers:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f69755e1-a563-4f6a-bcc0-e686125a68c3.png)'
  prefs: []
  type: TYPE_IMG
- en: Copying the name server value
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, open a command prompt and enter the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'You will see something such as the following, which means that name resolution
    is working correctly:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ec332e26-ece9-4e78-a273-48da51138cf3.png)'
  prefs: []
  type: TYPE_IMG
- en: DNS name resolution
  prefs: []
  type: TYPE_NORMAL
- en: In this demonstration, we configured a public DNS zone. In the next demonstration,
    we are going to cover how you can configure a private DNS zone using the CLI and
    Azure Cloud Shell.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a private DNS zone
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this demonstration, we are going to create a private DNS zone in a new resource
    group.
  prefs: []
  type: TYPE_NORMAL
- en: 'To configure a private DNS zone using the CLI from Azure Cloud Shell, you have
    to take the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the top-right menu, select the Azure Cloud Shell icon. Make sure that **Bash**
    is selected.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'First, we need to create a new resource group. Add the following command for
    this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, we are going to create a new VNet:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, we need to create the private DNS zone:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, create two virtual machines to test the private DNS zone. You need to
    provide an admin password when you run this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'We are going to create an additional DNS in the `private.packtdns.com` DNS
    zone. We are going to create a record with the relative name of `db` in the `private.packt.com` DNS
    zone. The fully qualified name of the record set is `db.private.packtdns.com`.
    The record type is A, with an IP address of `10.2.0.4`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'We can now test the name resolution for the private zone. We are going to ping
    both the VMs, and therefore we need to configure the firewall for both VMs to
    allow inbound ICMP packets. Connect to both VMs using RDP, and open a Windows
    PowerShell window with administrator privileges. Enter the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'After configuring both the VMs, from `PacktVM02`, enter the following command
    in PowerShell to ping `PacktVM01`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'You will see an output similar to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6dea188d-7c70-4b71-b2f9-8d2adbc3c9d5.png)'
  prefs: []
  type: TYPE_IMG
- en: Private DNS output
  prefs: []
  type: TYPE_NORMAL
- en: In this demonstration, we configured a private DNS zone using the CLI.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered how to configure and manage NSGs and Azure DNS.
    We covered the basics for both NSGs and Azure DNS. You have also learned how to
    create and configure NSGs. We have also covered how to create public and private
    zones using Azure DNS, and how to add DNS records to it.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will cover the last part of the *Deploying and Managing
    Virtual Networks*objective, by covering how to implement **Azure Load Balancer**.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Answer the following questions to test your knowledge of the information in
    this chapter. You can find the answers in the *Assessments* section at the end
    of this book:'
  prefs: []
  type: TYPE_NORMAL
- en: Can you assign an NSG to a subnet and a NIC?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Can you buy a domain name using Azure DNS and host it on there?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Private DNS zones cannot be configured from the Azure portal.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'True'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'False'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can check out the following links for more information about the topics
    that were covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Security groups*: [https://docs.microsoft.com/en-us/azure/virtual-network/security-overview](https://docs.microsoft.com/en-us/azure/virtual-network/security-overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Create, change, or delete an NSG*: [https://docs.microsoft.com/en-us/azure/virtual-network/manage-network-security-group](https://docs.microsoft.com/en-us/azure/virtual-network/manage-network-security-group)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*What is Azure DNS?*: [https://docs.microsoft.com/en-in/azure/dns/dns-overview](https://docs.microsoft.com/en-in/azure/dns/dns-overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Overview of DNS zones and records*: [https://docs.microsoft.com/en-in/azure/dns/dns-zones-records](https://docs.microsoft.com/en-in/azure/dns/dns-zones-records)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Quickstart: Create an Azure DNS zone and record using the Azure portal*: [https://docs.microsoft.com/en-us/azure/dns/dns-getstarted-portal](https://docs.microsoft.com/en-us/azure/dns/dns-getstarted-portal)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Use Azure DNS for private domains*: [https://docs.microsoft.com/en-us/azure/dns/private-dns-overview](https://docs.microsoft.com/en-us/azure/dns/private-dns-overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
