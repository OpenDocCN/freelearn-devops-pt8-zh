- en: Getting Started with Amazon ECS and Amazon Fargate
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入门 Amazon ECS 和 Amazon Fargate
- en: Docker can be installed on the most commonly used OS platforms. CoreOS has Docker
    pre-installed, and is designed specifically for running Docker containers. Docker
    for AWS provides an out-of-the-box Docker swarm mode in which a cluster of nodes,
    called a swarm, provides a distributed platform for running Docker container applications.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Docker 可以安装在最常用的操作系统平台上。CoreOS 预安装 Docker，并且专为运行 Docker 容器而设计。Docker for AWS
    提供了一个开箱即用的 Docker swarm 模式，在这个模式中，一个节点集群（称为 swarm）提供分布式平台以运行 Docker 容器应用程序。
- en: '**Problem:** All the aforementioned Docker platforms are only different types
    of Docker installations, and require Docker containers to run and be managed on
    the command line.'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: '**问题：** 所有上述 Docker 平台仅是不同类型的 Docker 安装，并且需要在命令行中运行并管理 Docker 容器。'
- en: '**Solution:** Amazon **ECS** (**Elastic Container Service**) is a managed service
    for Docker containers with built-in support for scaling, load balancing, networking,
    storage, logging, and other Docker container management tasks. Amazon ECS supports
    two launch types: EC2 and Fargate.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '**解决方案：** Amazon **ECS**（**弹性容器服务**）是一个为 Docker 容器提供的托管服务，内置支持扩展、负载均衡、网络、存储、日志记录和其他
    Docker 容器管理任务。Amazon ECS 支持两种启动类型：EC2 和 Fargate。'
- en: With the EC2 launch type, EC2 instances are started to run Docker containers.
    The Fargate launch type, which was introduced recently (November 2017), hosts
    tasks that encapsulate Docker containers. The tasks are directly made accessible
    to the user via an **Elastic Network Interface** (**ENI**). The EC2 instances
    on which Fargate is provisioned are not exposed to the user and are not directly
    accessible.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在 EC2 启动类型下，会启动 EC2 实例来运行 Docker 容器。Fargate 启动类型（于 2017 年 11 月推出）则托管封装 Docker
    容器的任务。任务通过 **弹性网络接口**（**ENI**）直接向用户提供。Fargate 提供的 EC2 实例不会暴露给用户，也无法直接访问。
- en: 'In this chapter, we will learn about the following:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章内容包括以下内容：
- en: What Amazon Fargate is
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是 Amazon Fargate
- en: Benefits of Fargate
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Fargate 的好处
- en: Amazon ECS objects
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon ECS 对象
- en: Compute resources in Amazon ECS Fargate
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon ECS Fargate 中的计算资源
- en: What's new in the Amazon Fargate launch type mode?
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon Fargate 启动类型模式中的新变化是什么？
- en: What Amazon Fargate is
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是 Amazon Fargate
- en: '**Amazon Fargate** is a new launch type for Amazon ECS and Amazon **EKS** (**Elastic
    Kubernetes Service**)-managed orchestration services for Docker containers on
    AWS. With the Fargate launch type, the infrastructure is fully provisioned by
    Fargate. It is serverless, and no EC2 instances are exposed to the user. Docker
    containers are defined as container definitions within a task definition. A service
    implements the task definition to run one or more tasks. Each task is associated
    with an ENI. If the auto-assignment of the public IP at the task level is enabled,
    a public IP on which an external client may access a task is automatically assigned
    to a task. Tasks communicate with each other over a private IP.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '**Amazon Fargate** 是 Amazon ECS 和 Amazon **EKS**（**弹性 Kubernetes 服务**）管理的用于
    AWS 上 Docker 容器编排服务的全新启动类型。在 Fargate 启动类型下，基础设施完全由 Fargate 提供。它是无服务器的，且没有 EC2
    实例暴露给用户。Docker 容器在任务定义中作为容器定义进行定义。服务实现任务定义来运行一个或多个任务。每个任务与一个 ENI 关联。如果启用了任务级别的公共
    IP 自动分配，则会自动将外部客户端可访问任务的公共 IP 分配给任务。任务之间通过私有 IP 进行通信。'
- en: Benefits of Fargate
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Fargate 的好处
- en: 'The benefits in ECS are as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: ECS 的好处如下：
- en: A managed service for containerized applications that does not require much
    user input to run Docker applications
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个为容器化应用程序提供的托管服务，无需用户过多操作即可运行 Docker 应用程序
- en: Microservices consisting of multiple applications run in isolated containers
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由多个应用程序组成的微服务在隔离的容器中运行
- en: Auto scales tasks based on application load
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据应用程序负载自动扩展任务
- en: Integrates with other AWS services including IAM, CloudWatch Logs, Elastic Load
    Balancing, CloudFormation templates, EBS Volumes, Batch, ECR, and CloudTrail logs
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与其他 AWS 服务集成，包括 IAM、CloudWatch 日志、弹性负载均衡、CloudFormation 模板、EBS 卷、批处理、ECR 和 CloudTrail
    日志
- en: A **virtual private cloud** (**VPC**) with no resources shared with other users
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个 **虚拟私有云**（**VPC**），没有与其他用户共享的资源
- en: Provides support for running a CodePipeline with ECS as the deployment platform
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供对使用 ECS 作为部署平台的 CodePipeline 的支持
- en: Supports the latest Docker version 17.0
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 支持最新的 Docker 版本 17.0
- en: 'Fargate provides the following additional benefits:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: Fargate 提供以下额外的好处：
- en: With a Fargate launch type, a user does not create or manage any EC2 instances,
    as none are exposed on the cluster.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tasks are directly exposed to the user via an ENI.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The underlying infrastructure is provisioned by Fargate. EC2 instances are not
    to be managed with the Fargate launch type.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CodePipeline supports Fargate as a deployment platform.
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microservices based on Container definitions encapsulated in a task definition
    are explicitly linked, and are not to be linked with any additional options, such
    as links.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: CloudWatch Logs may be auto configured.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Amazon ECS objects
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Amazon ECS objects with Fargate are the same as for the EC2 launch type. An
    ECS cluster is the outermost encapsulation, and it consists of one or more services.
    A cluster could be distributed over multiple availability zones. A service is
    an implementation of a task definition, and runs one or more tasks. A task definition
    could have one or more task revisions. A task revision is a distinct task definition
    with a set of tasks and a service associated with it. One Fargate instance is
    associated with a set of tasks in a service. A task definition consists of zero
    or more container definitions. Typically, a task definition would be associated
    with one or more container definitions, and a task definition that does not consist
    of any container definition would not run any task containers. A diagram of ECS
    objects is shown as follows:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d19da398-819a-4a30-8926-7b851be6f251.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
- en: A Task definition is an application template and describes one or more containers.
    While some attributes or settings are configured at the task level, most of them
    are configured at the container level. Multiple revisions may be associated with
    a task definition.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: A Service implements a task definition, and defines a desired count for tasks
    to run for a task definition. Optional features such as auto scaling and load
    balancing are configured in the service.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: A Cluster in an ECS service is a grouping of one or more container services.
    A cluster name must be unique within an account. A cluster called default is provisioned
    by default.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Compute resources in Amazon ECS Fargate
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Task size consists of Task memory (GB) and Task CPU (vCPU). While optional in
    the EC2 launch type, task size is required with the Fargate launch type. Docker
    container level memory and CPU settings may optionally be defined, but are overridden
    by task definition level settings. Only specific combinations of task memory and
    task CPU are supported, and the ECS wizard indicates with a message the supported
    value (or range of values) for a selected value. As an example, the valid CPU
    range for 1 GB memory is 0.25 vCPU to 0.5 vCPU. The total resources (memory or
    CPU) configured at the container level must not exceed the task level resource
    settings. As an example, if a task definition consists of two containers (MySQL and
    WordPress) with a memory limit of 128 MB for each container, the task level memory
    must be at least 256 MB. Also, the total of container level memory must not exceed
    256 MB. Similarly for the CPU. Two memory limits may be defined at the container
    level: Soft limit and Hard limit. The Soft limit corresponds to the `memoryReservation`
    attribute at the task level, and the Hard limit corresponds to the `memory` attribute
    at the task level. The sum of container memory reservations (Soft limits) must
    not exceed the task memory. The Hard limit for each container must not exceed
    the memory configured at the task level. A minimum of 4 GB must be specified by
    default for a container.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: 'An example task size is shown in the following screenshot, in which the Task
    memory (`memory` attribute) is set to 0.5 GB (512 GB), and the Task CPU is set
    to 0.25 vCPU. At the container level, as configured in the two container definitions,
    the memory reservation is 128 MB for each container, which makes the total memory
    reservation of 256 MB well within the 512 GB allocated at the task level. The
    task size is allocated to a task, whether used or not. Similarly, the number of CPU
    Units configured for each container is 10, which makes the total CPU units 20
    for containers within the CPU units, 25 are allocated at the task level. Refer
    to the following screenshot:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/090df530-6159-4804-8bd6-b851d8cc3084.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
- en: Task size configuration and allocation for containers
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
- en: What is new in the Amazon Fargate launch type mode?
  id: totrans-40
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In addition to and concomitant with the Fargate benefits discussed earlier,
    Fargate supports the following new features:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: Networking mode, `awsvpc`, is the only supported mode
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host port mappings are not valid with the Fargate launch type networking mode
    (`awsvpc`), and host ports on which an application is exposed are the same as
    the container ports
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`ecsTaskExecutionRole` is added for the Fargate launch type to allow for pulling
    Docker images and sending logs to CloudWatch Logs'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Only the `awslogs` log configuration and `awslogs` log driver are supported
    with CloudWatch Logs
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Task placement is not supported, as no ECS instances are provisioned to define
    placement constraints for
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Only Docker images on Docker Hub and Amazon ECR are supported
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Privileged Windows containers are not supported for the Fargate launch type
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Fargate 启动类型不支持特权 Windows 容器
- en: Host devices cannot be exposed to a container
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主机设备不能暴露给容器
- en: The `host` and `sourcePath` parameters for volumes are not supported with the
    Fargate launch type
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Fargate 启动类型不支持 `host` 和 `sourcePath` 参数用于卷
- en: Summary
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this introductory chapter, we discussed the benefits of using the Fargate
    launch type, how compute resources are distributed and configured with the Fargate
    launch type, how the ECS objects with Fargate are the same as for the EC2 launch
    type, and the new features in Fargate. In the next chapter, we shall discuss networking
    as used with Fargate.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章简介中，我们讨论了使用 Fargate 启动类型的好处，计算资源如何在 Fargate 启动类型下分配和配置，使用 Fargate 的 ECS 对象与
    EC2 启动类型的相同之处，以及 Fargate 中的新特性。在下一章，我们将讨论与 Fargate 配合使用的网络配置。
