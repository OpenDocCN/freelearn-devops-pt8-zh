- en: 5\. Enabling secure, remote work with Microsoft Azure AD and WVD
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 5. 使用 Microsoft Azure AD 和 WVD 启用安全远程工作
- en: In the previous chapter, we learned that transitioning to the cloud isn't just
    about moving on-premises resources to the cloud, but it is a journey that involves
    improving scalability, security, and cloud-based productivity to enable remote
    collaboration work from anywhere.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们学习到，向云过渡不仅仅是将本地资源迁移到云端，而是一个涉及提升可扩展性、安全性和基于云的生产力的过程，从而实现随时随地的远程协作工作。
- en: 'In this chapter, we will address common infrastructure challenges that organizations
    face when trying to enable remote work, and how Azure core infrastructure components
    such as networking, identity, security, compute, and storage can empower today''s
    modern digital workspace. In this chapter, we will cover:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将讨论组织在启用远程工作时常见的基础设施挑战，以及如何利用 Azure 核心基础设施组件（如网络、身份、安全、计算和存储）来赋能现代数字工作空间。本章将覆盖以下内容：
- en: The fundamentals of deploying remote work infrastructure
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 部署远程工作基础设施的基本原理
- en: Azure Active Directory
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure Active Directory
- en: Enabling remote connectivity
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 启用远程连接
- en: Securing and managing traffic to your workloads
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 保护和管理流量到您的工作负载
- en: Enabling remote workers with Windows Virtual Desktop
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 Windows 虚拟桌面赋能远程工作者
- en: We'll begin by talking about the fundamentals of deploying remote work with
    Azure.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将从讨论如何使用 Azure 部署远程工作基础设施的基本原理开始。
- en: The fundamentals of deploying remote work infrastructure
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 部署远程工作基础设施的基本原理
- en: Remote working has been an imperative transition for most organizations in the
    past year and has brought multiple challenges for people who used to work from
    corporate offices full-time.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 远程工作在过去一年里成为大多数组织的必要转型，并为曾经全职在公司办公室工作的人员带来了多重挑战。
- en: Enabling working from home is the key to helping people stay connected across
    an organization and with partners and customers. By leveraging **Azure Active
    Directory** (**Azure AD**), not only will you be able to enable remote working
    but you will also be able to allow users to securely access the applications they
    need from outside the corporate network.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 启用居家办公是帮助人们保持跨组织以及与合作伙伴和客户连接的关键。通过利用**Azure Active Directory**（**Azure AD**），您不仅能够启用远程工作，还可以允许用户安全地访问他们需要的应用程序，即使是在公司网络外部。
- en: It is important to have a strong identity foundation in the cloud, and Azure
    AD is the key component to empower users working remotely. Azure AD is a cloud-based
    offering from Microsoft that provides identity and access management capabilities.
    This means that Azure AD can span across different environments, allowing employees
    access to resources that can be located in their actual on-premises datacenter
    or cloud-based applications.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在云中拥有强大的身份基础至关重要，而 Azure AD 是赋能远程工作的关键组件。Azure AD 是微软提供的基于云的身份和访问管理服务。这意味着 Azure
    AD 可以跨不同环境使用，使得员工可以访问位于实际本地数据中心或云应用中的资源。
- en: Azure AD is the largest cloud-based identity service provided in the world,
    with over 200,000 organizations and more than 30 billion daily authentication
    requests. Azure AD also helps you detect and remediate security threats. One of
    the main challenges for organizations looking to use identity and access management
    services includes the onboarding process.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 是全球最大规模的基于云的身份服务，已有超过 20 万个组织使用，每天处理超过 300 亿次身份验证请求。Azure AD 还帮助您检测和修复安全威胁。组织在使用身份和访问管理服务时面临的主要挑战之一是入职流程。
- en: Let's take a quick look at the key components and configurations that can help
    you securely enable application access.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速了解一下可以帮助您安全启用应用程序访问的关键组件和配置。
- en: Azure Active Directory
  id: totrans-15
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Azure Active Directory
- en: 'Before we review Azure AD''s capabilities for enabling remote work, it is important
    to understand that Azure AD is a cloud-based service for identity and access management.
    Therefore, it is suitable for different types of users, such as:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们回顾 Azure AD 启用远程工作的能力之前，重要的是要理解，Azure AD 是一个基于云的身份和访问管理服务。因此，它适用于不同类型的用户，例如：
- en: IT admins looking to control access to applications while protecting user identities
    and credentials to meet governance requirements.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IT 管理员希望控制对应用程序的访问，同时保护用户身份和凭证，以满足治理要求。
- en: App developers who can use Azure AD's capabilities and integration with Azure
    AD APIs to provide personalized app experiences.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用开发人员可以利用 Azure AD 的功能和与 Azure AD API 的集成来提供个性化的应用程序体验。
- en: Subscribers to multiple services such as Microsoft 365, Dynamics 365, or Microsoft
    Azure.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订阅多个服务的用户，如 Microsoft 365、Dynamics 365 或 Microsoft Azure。
- en: There are some considerations that you should take into account when choosing
    Azure AD, which we will cover next.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在选择 Azure AD 时，您需要考虑一些因素，接下来我们将讨论这些内容。
- en: Plan your environment
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 规划您的环境
- en: 'Prior to performing any deployment for Azure AD, we need to ensure that we
    have the right licensing model that will allow us to properly configure Azure
    AD with the features needed for our organization. There are three main Azure AD
    licensing tiers:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行 Azure AD 部署之前，我们需要确保拥有正确的许可模型，以便能够正确配置 Azure AD，并为我们的组织提供所需的功能。Azure AD
    主要有三个许可层级：
- en: Azure AD Free
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD 免费
- en: Azure AD Premium P1
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD Premium P1
- en: Azure AD Premium P2
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD Premium P2
- en: 'Starting with **Azure AD Free**, this tier will provide you with some basic
    features such as user and group management, on-premises directory synchronization,
    self-service password change for cloud users, and single sign-on across cloud
    platforms like Azure, Microsoft 365, and third-party SaaS solutions, as seen in
    *Figure 5.1*:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 从**Azure AD 免费**开始，此层级将为您提供一些基本功能，如用户和组管理、本地目录同步、云用户的自助密码更改，以及跨云平台（如 Azure、Microsoft
    365 和第三方 SaaS 解决方案）的单点登录，如*图 5.1*所示：
- en: '![A representation of the Azure AD free tierworkflow](img/B17153_05_01.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![Azure AD 免费层工作流程的表示](img/B17153_05_01.jpg)'
- en: 'Figure 5.1: Azure AD'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.1：Azure AD
- en: 'If you''re looking to allow users that are part of your organization access
    across both on-premises and cloud resources, then **Azure AD Premium P1** could
    fit your organization''s primary needs. This tier supports dynamic groups and
    self-service group management, and it enables Microsoft Identity Manager and cloud
    write-back capabilities to allow your on-premises users to perform a self-service
    password reset, as shown in *Figure 5.2*:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望允许组织中的用户访问本地和云端资源，那么**Azure AD Premium P1**可能会满足您组织的主要需求。此层级支持动态组和自助组管理，并启用
    Microsoft Identity Manager 和云端回写功能，允许您的本地用户执行自助密码重置，如*图 5.2*所示：
- en: '![A representation of the Azure AD hybrid environment](img/B17153_05_02.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![Azure AD 混合环境的表示](img/B17153_05_02.jpg)'
- en: 'Figure 5.2: Azure AD hybrid environment'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.2：Azure AD 混合环境
- en: '**Azure AD Premium P2** is the ideal tier if your organization is looking to
    take advantage of advanced security capabilities such as risk-based access policies
    based on Azure AD identity protection, which can detect malicious activities by
    using cloud-scale machine learning algorithms, as shown in *Figure 5.3*:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: '**Azure AD Premium P2** 是理想的层级，如果您的组织希望利用先进的安全功能，例如基于 Azure AD 身份保护的风险访问策略，可以通过云规模的机器学习算法检测恶意活动，如*图
    5.3*所示：'
- en: '![A representation of Azure AD Conditional Access](img/B17153_05_03.jpg)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![Azure AD 条件访问的表示](img/B17153_05_03.jpg)'
- en: 'Figure 5.3: Azure AD conditional access'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.3：Azure AD 条件访问
- en: When your organization signs up for a Microsoft service such as Azure, Microsoft
    Intune, or Microsoft 365, it will be entitled to a dedicated Azure AD service
    instance called a tenant. A tenant represents an organization.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 当您的组织注册使用 Microsoft 服务，如 Azure、Microsoft Intune 或 Microsoft 365 时，将会获得一个专用的
    Azure AD 服务实例，称为租户。租户代表一个组织。
- en: You can leverage the creation of your Azure AD tenant using the Azure portal,
    in which you can configure and do all the administrative tasks related to Azure
    AD. In addition, you can make use of the Microsoft Graph API to access Azure AD
    resources.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过 Azure 门户创建 Azure AD 租户，在其中配置和执行所有与 Azure AD 相关的管理任务。此外，您还可以利用 Microsoft
    Graph API 访问 Azure AD 资源。
- en: Now that we have gone through the various scenarios and licensing models available
    for Azure AD, we will proceed to review the configuration of the actual deployment
    of the Azure AD tenant.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经了解了 Azure AD 的各种场景和许可模型，接下来我们将回顾实际部署 Azure AD 租户的配置。
- en: Configuring Azure AD and hybrid environments
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置 Azure AD 和混合环境
- en: 'While you might be familiar with most of the **Active Directory Domain Services**
    (**AD DS**) capabilities, it is important to highlight that Azure AD and AD DS
    have some similarities and differences, and it is worth performing a quick review
    to better understand the scope of each product. The following table summarizes
    some of the core differences:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管您可能熟悉大部分**Active Directory 域服务**（**AD DS**）的功能，但需要强调的是，Azure AD 和 AD DS 有一些相似之处和差异，值得进行简要回顾，以便更好地理解每个产品的范围。下表总结了它们的一些核心差异：
- en: '![Comparison between Azure Active Directory and Active Directory Domain Services](img/B17153_Table_05_01.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![Azure Active Directory 与 Active Directory 域服务的比较](img/B17153_Table_05_01.jpg)'
- en: 'Table 5.1: Comparison between AD DS and Azure AD'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.1：AD DS 和 Azure AD 的比较
- en: Azure AD managed identities can be used if your organization has Linux workloads
    and needs to provide secure access and communication to those resources.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的组织有 Linux 工作负载并需要为这些资源提供安全访问和通信，则可以使用 Azure AD 管理标识。
- en: In order to start working with Azure AD, you are required to use a tenant, which
    usually represents an organization. It is possible to start working with an existing
    tenant, or you can create a new Azure AD tenant.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 为了开始使用 Azure AD，您需要使用一个租户，通常表示一个组织。您可以选择使用现有租户，也可以创建一个新的 Azure AD 租户。
- en: When you create an Azure subscription, it will have a trust relationship with
    Azure AD to authenticate users, services, and devices. Your organization can have
    multiple Azure subscriptions, establish a trust relationship with an instance
    of Azure AD, and leverage a security principal to provide access to the resources
    that are secured by the Azure AD tenant.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 当您创建 Azure 订阅时，它将与 Azure AD 建立信任关系，以验证用户、服务和设备。您的组织可以拥有多个 Azure 订阅，建立与 Azure
    AD 实例的信任关系，并利用安全主体来提供访问已由 Azure AD 租户保护的资源。
- en: 'Based on the types of users your application is going to authenticate, there
    are two main types of environments that can be created:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您的应用程序要验证的用户类型，可以创建两种主要的环境：
- en: Azure AD accounts (or Microsoft accounts)
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD 账户（或 Microsoft 账户）
- en: Azure AD B2C accounts
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD B2C 账户
- en: The Azure AD accounts, or Microsoft accounts, refer to accounts such as outlook.com
    and live.com or work- and school-related accounts. The Azure AD B2C accounts refer
    to using local or social accounts such as your social identity for Facebook or
    Twitter, among other identities, to get single sign-on access to your applications
    and APIs.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 账户或 Microsoft 账户指的是像 outlook.com 和 live.com 这样的账户，或与工作和学校相关的账户。Azure
    AD B2C 账户指的是使用本地或社交账户，如您的 Facebook 或 Twitter 社交身份，以及其他身份，来获得对您的应用程序和 API 的单点登录访问权限。
- en: Creating your Azure AD tenant
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建您的 Azure AD 租户
- en: 'The creation of a new Azure AD tenant can be done through the Azure portal.
    Once you have your Azure subscription ready to use, the next step is to go to
    the Azure portal, then select the Azure Active Directory option, as shown in *Figure
    5.4*:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 新的 Azure AD 租户可以通过 Azure 门户创建。一旦您的 Azure 订阅准备好使用，下一步是进入 Azure 门户，然后选择 Azure
    Active Directory 选项，如*图 5.4*所示：
- en: '![Selecting the Azure Active Directory option in the Azure portal](img/B17153_05_04.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![在 Azure 门户中选择 Azure Active Directory 选项](img/B17153_05_04.jpg)'
- en: 'Figure 5.4: Azure AD in the Azure portal'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.4：Azure 门户中的 Azure AD
- en: 'On the overview page, click on Create a tenant, as shown in *Figure 5.5*:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在概览页面，点击创建租户，如*图 5.5*所示：
- en: '![Clicking the Create a tenant button in the Overview pane](img/B17153_05_05.jpg)'
  id: totrans-54
  prefs: []
  type: TYPE_IMG
  zh: '![点击概览面板中的创建租户按钮](img/B17153_05_05.jpg)'
- en: 'Figure 5.5: Create a tenant'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.5：创建租户
- en: 'Then, on the Basics pane, you can choose the type of tenant you want to create.
    Select Azure Active Directory or Azure Active Directory (B2C), as shown in *Figure
    5.6*:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，在基础面板中，您可以选择要创建的租户类型。选择 Azure Active Directory 或 Azure Active Directory (B2C)，如*图
    5.6*所示：
- en: '![Selecting the AzureAD tenant type](img/B17153_05_06.jpg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![选择 AzureAD 租户类型](img/B17153_05_06.jpg)'
- en: 'Figure 5.6: Azure AD tenant type'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.6：Azure AD 租户类型
- en: 'In the Configuration pane, you can provide a name for the organization and
    the initial domain name you want to use, as shown in *Figure 5.7*:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置面板中，您可以为组织提供一个名称，并输入您想使用的初始域名，如*图 5.7*所示：
- en: '![Providing the organization and the initial domain names under the Configuration
    tab](img/B17153_05_07.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![在配置标签下提供组织和初始域名](img/B17153_05_07.jpg)'
- en: 'Figure 5.7: Azure AD configuration'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.7：Azure AD 配置
- en: 'Next, Azure is going to validate your deployment. Once it is complete, click
    on Create, as shown in *Figure 5.8*:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，Azure 将验证您的部署。完成后，点击创建，如*图 5.8*所示：
- en: '![Reviewing and validating the configurations for the Azure AD tenant](img/B17153_05_08.jpg)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![审查并验证 Azure AD 租户的配置](img/B17153_05_08.jpg)'
- en: 'Figure 5.8: Creating the Azure AD tenant'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.8：创建 Azure AD 租户
- en: 'You should see a notification in the Azure portal related to the creation of
    the Azure AD tenant, as shown here:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该在 Azure 门户中看到与创建 Azure AD 租户相关的通知，如此处所示：
- en: '![Notification showing tenant creation in progress](img/B17153_05_09.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![通知显示租户创建过程](img/B17153_05_09.jpg)'
- en: 'Figure 5.9: Tenant creation in progress'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.9：租户创建中
- en: 'In just a few minutes, your new Azure AD tenant should be ready. You will see
    the notification in the Azure portal, as shown in *Figure 5.10*:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 几分钟后，你的新 Azure AD 租户应该已经准备好。你将在 Azure 门户中看到通知，如*图 5.10*所示：
- en: '![Notification confirmingthe successful creation of the Azure ADtenant](img/B17153_05_10.jpg)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![确认 Azure AD 租户成功创建的通知](img/B17153_05_10.jpg)'
- en: Figure 5.10 Azure AD tenant creation successful
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.10 Azure AD 租户创建成功
- en: 'Click on the notification to be redirected to your new tenant page, as shown
    in *Figure 5.11*:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 点击通知以跳转到你的新租户页面，如*图 5.11*所示：
- en: '![Clicking on the notification to open the new tenant page](img/B17153_05_11.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![点击通知以打开新租户页面](img/B17153_05_11.jpg)'
- en: 'Figure 5.11: Azure AD tenant'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.11：Azure AD 租户
- en: For hybrid environments, it is recommended that you use Azure AD Connect to
    achieve hybrid identity integration, as it provides the features required to synchronize
    users on-premises with Azure AD, but also allows users to use the same password
    on-premises and in the cloud without the need for the additional infrastructure
    of a federated environment.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 对于混合环境，建议使用 Azure AD Connect 实现混合身份集成，因为它提供了同步本地用户与 Azure AD 所需的功能，同时允许用户在本地和云端使用相同的密码，无需额外的联合环境基础设施。
- en: Although federation is an optional configuration, Azure AD Connect can be helpful
    for hybrid configurations that are using an on-premises **Active Directory Federation
    Services** (**AD FS**) infrastructure.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然联合是一个可选配置，但 Azure AD Connect 对于使用本地**Active Directory 联合服务**（**AD FS**）基础设施的混合配置是非常有用的。
- en: Preparing the infrastructure for Windows Virtual Desktop
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 为 Windows 虚拟桌面准备基础设施
- en: 'Whether your organization already has Active Directory on-premises or is just
    starting with Azure AD, it is possible to enable remote working through a hybrid
    environment and take advantage of the **Azure Resource Manager** (**ARM**) templates
    to simplify the creation of your cloud environment. The ARM template shown in
    *Figure 5.12* will assist you with the deployment of a virtual machine with Active
    Directory and Azure AD Connect installed:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 无论你的组织是否已经在本地部署了 Active Directory，还是刚开始使用 Azure AD，都可以通过混合环境启用远程办公，并利用**Azure
    资源管理器**（**ARM**）模板简化云环境的创建。如*图 5.12*所示的 ARM 模板将帮助你部署一个安装了 Active Directory 和 Azure
    AD Connect 的虚拟机：
- en: '![Depicting the relationship between different ARM template components](img/B17153_05_12.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![描绘不同 ARM 模板组件之间的关系](img/B17153_05_12.jpg)'
- en: 'Figure 5.12: ARM template components'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.12：ARM 模板组件
- en: 'This ARM template will provision the following resources:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 该 ARM 模板将提供以下资源：
- en: One virtual network
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个虚拟网络
- en: One subnet
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个子网
- en: 'One **Network Security Group** (**NSG**):'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个**网络安全组**（**NSG**）：
- en: Permits AD traffic, permits **Remote Desktop Protocol** (**RDP**) incoming traffic,
    and restricts **Demilitarized Zone** (**DMZ**) access
  id: totrans-84
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许 AD 流量，允许**远程桌面协议**（**RDP**）传入流量，并限制**隔离区**（**DMZ**）访问
- en: DNS configured to point to the domain controller
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 配置 DNS 指向域控制器
- en: 'One virtual machine:'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个虚拟机：
- en: AD DS is installed and configured.
  id: totrans-87
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 已安装并配置 AD DS。
- en: Test users are created in the domain.
  id: totrans-88
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在域中创建测试用户。
- en: Azure AD Connect is installed and ready for configuration.
  id: totrans-89
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure AD Connect 已安装并准备好进行配置。
- en: One public IP address assigned for remote administration via RDP
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分配一个公共 IP 地址用于通过 RDP 进行远程管理
- en: Once the ARM template is deployed, the status will change to **complete**. At
    this point, the domain controller is ready for RDP connectivity.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦 ARM 模板部署完成，状态将更改为**完成**。此时，域控制器已准备好进行 RDP 连接。
- en: Note
  id: totrans-92
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 注意
- en: 'You can also try different ARM templates based on your needs and pull them
    from the Azure Quickstart templates, such as:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以根据需要尝试不同的 ARM 模板，并从 Azure 快速入门模板中获取，例如：
- en: 'active directory new domain HA 2 DC zones: [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-ha-2-dc-zones](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-ha-2-dc-zones)'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 新域高可用 2 个 DC 区域： [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-ha-2-dc-zones](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-ha-2-dc-zones)
- en: 'active-directory-new-domain-module-use: [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-module-use](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-module-use)'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 'active-directory-new-domain-module-use: [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-module-use](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain-module-use)'
- en: 'active-directory-new-domain: [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain)'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 'active-directory-new-domain: [https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain](https://github.com/Azure/azure-quickstart-templates/tree/master/active-directory-new-domain)'
- en: 'Now we can proceed to configuring Azure AD Connect with AD DS. You can connect
    to the Azure virtual machine recently provisioned to install Azure AD Connect
    using this link: [https://www.microsoft.com/download/confirmation.aspx?id=47594](https://www.microsoft.com/download/confirmation.aspx?id=47594)'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以继续配置Azure AD Connect与AD DS。您可以通过此链接连接到最近配置的Azure虚拟机来安装Azure AD Connect：[https://www.microsoft.com/download/confirmation.aspx?id=47594](https://www.microsoft.com/download/confirmation.aspx?id=47594)
- en: Configuring Azure AD Connect with AD DS
  id: totrans-98
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 配置Azure AD Connect与AD DS
- en: As mentioned previously, Azure AD Connect will help you achieve hybrid identity
    integration as it provides features to synchronize users on-premises.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，Azure AD Connect将帮助您实现混合身份集成，因为它提供了将本地用户同步到Azure AD的功能。
- en: The next step in the process is to connect to the domain controller and configure
    Azure AD Connect. If your organization has a single-forest topology, then you
    can use the **Express Settings**.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 该过程的下一步是连接到域控制器并配置Azure AD Connect。如果您的组织采用单森林拓扑，则可以使用**Express设置**。
- en: 'You can find more details on the installation of Azure AD Connect here: [https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-install-custom](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-install-custom).'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在此处找到有关安装Azure AD Connect的更多详细信息：[https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-install-custom](https://docs.microsoft.com/azure/active-directory/hybrid/how-to-connect-install-custom)。
- en: 'The following figure shows the Azure AD Connect wizard:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了Azure AD Connect向导：
- en: '![Azure AD Connect wizard](img/B17153_05_13.jpg)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![Azure AD Connect向导](img/B17153_05_13.jpg)'
- en: 'Figure 5.13: Azure AD Connect wizard'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.13：Azure AD Connect向导
- en: At this point, we have reviewed Azure AD Connect with AD DS in order to synchronize
    with Azure AD. Once your organization has Azure AD properly configured, it is
    important to protect employees' identities with stronger authentication mechanisms
    and minimize potential identity attacks.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经回顾了与AD DS同步的Azure AD Connect。一旦您的组织正确配置了Azure AD，保护员工身份的安全就显得尤为重要，必须采用更强的认证机制，最大限度地减少潜在的身份攻击。
- en: Secure your identity infrastructure
  id: totrans-106
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 保护您的身份基础设施
- en: We live in a world where passwords are no longer good enough and the majority
    of attacks happen to be related to password weaknesses and data breaches, most
    of them involving phishing. It is important to protect your identity with stronger
    authentication mechanisms. Azure AD **Multi-Factor Authentication** (**MFA**)
    is one of them—let's have a look.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 我们生活在一个密码已不再足够安全的世界，大多数攻击都与密码漏洞和数据泄露有关，其中大部分涉及钓鱼攻击。保护身份的安全需要更强的认证机制。Azure AD
    **多重身份验证**（**MFA**）就是其中之一——我们来看看。
- en: Azure AD Multi-Factor Authentication
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure AD多重身份验证
- en: Strong authentication using Azure AD can prevent up to 99.9% of identity attacks.
    As you develop your strategy for strengthening your credentials, you should deploy
    the most secure, usable, and cost-effective methods for your organization and
    your users. One of the main benefits of using Azure AD is the support for MFA,
    which requires the use of at least two verification methods. This way, Azure AD
    MFA helps secure access to data and applications.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Azure AD的强身份验证可以防止99.9%的身份攻击。在制定强化凭据的策略时，您应该为组织和用户部署最安全、最易用且最具成本效益的方法。使用Azure
    AD的主要优势之一是它支持MFA（多重身份验证），要求至少使用两种验证方法。通过这种方式，Azure AD MFA有助于保护对数据和应用程序的访问。
- en: 'Azure AD MFA capabilities are available and licensed in different ways. You
    can refer to the documentation for more details: [https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings).'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD MFA 功能通过不同的方式提供并授权。你可以参考文档获取更多详细信息：[https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings](https://docs.microsoft.com/azure/active-directory/authentication/howto-mfa-mfasettings)。
- en: 'Azure AD MFA requires at least two of the following authentication methods:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD MFA 至少需要以下两种身份验证方法：
- en: Something you know—a username and password is the most common way a user would
    provide credentials.
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你知道的某物——用户名和密码是用户提供凭据的最常见方式。
- en: Something you have—this could be a trusted device such as your phone or a hardware
    key.
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你拥有的某物——这可以是你的手机或硬件密钥等受信设备。
- en: Something you are—such as a fingerprint or face scan.
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你是的某物——例如指纹或面部扫描。
- en: As an administrator, it is possible to define what forms of secondary authentication
    can be used.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 作为管理员，你可以定义可使用的二次身份验证形式。
- en: Azure AD Identity Protection
  id: totrans-116
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure AD 身份保护
- en: Implementing a user risk security policy using Azure AD Identity Protection
    can help you to identify potential risks and take manual actions for each of them
    if needed. There are different risk detection types that you can identify and,
    as an administrator, you can use key reports for your investigations. Azure AD
    Premium P2 edition or an EMS E5 subscription is needed to use Azure AD Identity
    Protection.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure AD 身份保护实施用户风险安全策略可以帮助你识别潜在风险，并在需要时对每个风险采取手动措施。你可以识别不同的风险检测类型，作为管理员，你可以使用关键报告进行调查。使用
    Azure AD 身份保护需要 Azure AD Premium P2 版或 EMS E5 订阅。
- en: 'There are primarily two risk policies that can be enabled in Azure AD: **sign-in
    risk policy** and **user risk policy**. While both policies work to automate the
    response to risk detection in your environment, it is worth understanding the
    difference between them:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Azure AD 中，主要有两种风险策略可以启用：**登录风险策略**和**用户风险策略**。虽然这两种策略都致力于自动响应环境中的风险检测，但了解它们之间的区别是值得的：
- en: A sign-in risk policy is an automated response that you can configure for a
    specific sign-in risk level and block access to resources, requiring the user
    to pass MFA to prove their identity in order to gain access to a specific resource.
    When configuring a sign-in risk policy, you need to set the users and groups that
    it applies to.
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 登录风险策略是一种自动响应，你可以为特定的登录风险级别配置它，阻止访问资源，并要求用户通过 MFA 证明其身份，以便访问特定资源。在配置登录风险策略时，你需要设置其适用的用户和组。
- en: On the other hand, an IT administrator can customize the login experience based
    on the user's previous risky logins with a user risk policy. A user risk policy
    is also an automated response that remediates users when they meet a specific
    risk level or there's a high probability that their credentials have been compromised.
    This policy will allow you to block access to the resources or require the user
    to reset their password to keep their identity safe.
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 另一方面，IT 管理员可以根据用户之前的高风险登录自定义登录体验，使用用户风险策略。用户风险策略也是一种自动响应，当用户达到特定风险级别或其凭据有高概率被泄露时，会对其进行修复。此策略将允许你阻止访问资源，或要求用户重置密码以保持其身份安全。
- en: 'Here''s a reference for you to configure risk policies: [https://docs.microsoft.com/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies](https://docs.microsoft.com/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies).'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 这是配置风险策略的参考：[https://docs.microsoft.com/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies](https://docs.microsoft.com/azure/active-directory/identity-protection/howto-identity-protection-configure-risk-policies)。
- en: Privileged Identity Management
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 特权身份管理
- en: '**Privileged Identity Management** (**PIM**) is useful for those organizations
    who are moving to (if not already in) the cloud and are looking to minimize risks,
    particularly when it comes to privileged accounts assigned to roles in the organization.
    We are referring to accounts that can access a lot of resources and data.'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: '**特权身份管理**（**PIM**）对于那些正在迁移到云端（如果尚未迁移）并希望最小化风险的组织特别有用，尤其是当涉及到分配给组织角色的特权账户时。我们指的是那些可以访问大量资源和数据的账户。'
- en: PIM is a service in Azure AD that helps you reduce these risks by enforcing
    **Just in Time** (**JIT**) and **Just Enough Access** (**JEA**) for these accounts.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: PIM 是 Azure AD 中的一项服务，通过强制执行 **按需访问**（**JIT**）和 **足够访问**（**JEA**）来帮助您降低这些风险。
- en: PIM forces administrators in the organization who need to use administrative
    privileges to elevate their privilege in order to use it, so it requires approval
    to activate privileged rules and enforces MFA.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: PIM 强制组织中的管理员在需要使用管理权限时提升其权限，因此需要批准才能激活特权规则并强制执行 MFA。
- en: 'You can follow these steps to configure PIM for your organization: [https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-security-wizard](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-security-wizard).'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以按照以下步骤为您的组织配置 PIM：[https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-security-wizard](https://docs.microsoft.com/azure/active-directory/privileged-identity-management/pim-security-wizard)。
- en: Azure AD Application Proxy
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure AD 应用代理
- en: The security experience in Azure AD provides you with a one-stop shop for all
    identity security capabilities. By using Azure AD Application Proxy, you can enable
    remote work access to on-premises resources. This means that Azure AD Application
    Proxy allows you to publish on-premises applications to users outside the corporate
    network, while extending Azure AD capabilities as a central management point for
    all the applications in the organization.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 中的安全体验为您提供了所有身份安全功能的一站式服务。通过使用 Azure AD 应用代理，您可以启用对本地资源的远程访问。这意味着，Azure
    AD 应用代理允许您将本地应用程序发布给企业网络外的用户，同时将 Azure AD 功能扩展为所有组织内应用程序的中央管理点。
- en: This brings some benefits, such as MFA and Conditional Access. More importantly,
    it avoids the limitations of traditional solutions such as VPNs, as there's no
    need to open access to the entire network. Azure AD Application Proxy allows you
    to control what resources should be accessible and works across many devices,
    including mobile and desktop.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 这带来了一些好处，如 MFA 和条件访问。更重要的是，它避免了传统解决方案（如 VPN）的局限性，因为无需开放整个网络的访问权限。Azure AD 应用代理允许您控制哪些资源应可访问，并支持多种设备，包括移动设备和桌面设备。
- en: An organization can have a corporate network with multiple applications across
    departments within the DMZ with multiple segments, as well as users outside the
    network who need to get access to these resources in the corporate network.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 一个组织可以在 DMZ 内拥有多个部门跨应用的企业网络，并且有多个子网，同时也有需要访问企业网络资源的外部用户。
- en: In order to enable Azure AD Application Proxy, you first have to install local
    agents in the network, which are called **connectors**.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 要启用 Azure AD 应用代理，您首先需要在网络中安装本地代理，称为 **连接器**。
- en: These connectors are agents that are executed on a Windows Server machine in
    your corporate network and are responsible for the communication between your
    on-premises application and Azure AD Application Proxy.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 这些连接器是运行在您企业网络中的 Windows 服务器上的代理，负责在本地应用程序与 Azure AD 应用代理之间进行通信。
- en: 'The connectors can also be integrated with the on-premises Active Directory
    depending on the single sign-on mechanism that you need. It is important to note
    that Azure AD Application Proxy requires the Azure AD Premium P1 or P2 license:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 连接器还可以根据所需的单点登录机制与本地 Active Directory 集成。需要注意的是，Azure AD 应用代理需要 Azure AD Premium
    P1 或 P2 许可证：
- en: '![Azure AD Application Proxy workflow](img/B17153_05_14.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![Azure AD 应用代理工作流程](img/B17153_05_14.jpg)'
- en: 'Figure 5.14: Azure AD Application Proxy workflow'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.14：Azure AD 应用代理工作流程
- en: 'The Azure AD Application Proxy workflow, as seen in *Figure 5.14*, is as follows:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图 5.14*所示，Azure AD 应用代理的工作流程如下：
- en: Your organization can have a public-facing application through an endpoint that
    can be a URL.
  id: totrans-137
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您的组织可以通过一个公共访问端点来拥有一个面向外部的应用程序，该端点可以是一个 URL。
- en: External users can connect to the application using that URL.
  id: totrans-138
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 外部用户可以使用该 URL 连接到应用程序。
- en: External users will be redirected to a cloud service; the identity provider,
    which is Azure AD, will authenticate the user using MFA, Conditional Access, or
    any other method.
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 外部用户将被重定向到云服务；身份提供者，即 Azure AD，将使用 MFA、条件访问或其他任何方法来验证用户。
- en: Once authenticated, Azure AD will send the token to the user's client device.
  id: totrans-140
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦验证通过，Azure AD 会将令牌发送到用户的客户端设备。
- en: Then, Azure AD will send the token to the Azure AD Application Proxy service,
    and the user will be re-directed to the on-premises application using the Application
    Proxy connector.
  id: totrans-141
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后，Azure AD 会将令牌发送到 Azure AD 应用程序代理服务，用户将通过应用程序代理连接器重新定向到本地应用程序。
- en: The Azure AD Application Proxy connector will perform additional authentication
    on behalf of the user if single sign-on is configured.
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果配置了单一登录，Azure AD 应用程序代理连接器将代表用户执行额外的身份验证。
- en: Lastly, the connector sends the request to the on-premises application, and
    the response is sent back to the user through the connector and Azure AD Application
    Proxy service.
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，连接器将请求发送到本地应用程序，并通过连接器和 Azure AD 应用程序代理服务将响应发送回用户。
- en: As you can see, Azure AD Application Proxy can be used for your on-premises
    applications that need to be accessed from outside the corporate network.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 正如你所看到的，Azure AD 应用程序代理可用于需要从公司网络外部访问的本地应用程序。
- en: Azure AD Conditional Access
  id: totrans-145
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure AD 条件访问
- en: To enable remote work for users trying to reach applications both on-premises
    and in the cloud, administrators need to ensure the right people get the right
    permissions to access the resources. Conditional Access is a premium feature in
    Azure AD that addresses these challenges by providing a mechanism to control access
    to the resources based on policies.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 为了使用户能够访问本地和云中的应用程序，管理员需要确保合适的人拥有访问资源的权限。条件访问是 Azure AD 的一项高级功能，通过提供基于策略控制资源访问的机制来解决这些挑战。
- en: Using Azure AD Conditional Access, you as an administrator can easily protect
    your organization's assets and apply the right access controls through policies
    that can be configured based on some common signals, such as device, application,
    IP location, and user or group membership.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure AD 条件访问，作为管理员的你可以轻松保护组织资产，并通过基于一些常见信号（如设备、应用程序、IP 位置以及用户或组成员身份）配置的策略来应用合适的访问控制。
- en: 'Examples of Azure AD Conditional Access include:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: Azure AD 条件访问的示例包括：
- en: '**Location**: Users accessing a resource when they''re off the corporate network
    should be required to use MFA.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**位置**：当用户在公司网络之外访问资源时，应该要求使用 MFA（多因素身份验证）。'
- en: '**Device platform**: Define a policy for each device platform that blocks access.
    For instance, allow only iOS devices but not Android.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**设备平台**：为每个设备平台定义一个阻止访问的策略。例如，只允许 iOS 设备访问，但不允许 Android 设备。'
- en: '**Cloud apps**: Requires that apps which use sensitive information are blocked
    if Azure AD detects a risky sign-in.'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**云应用**：要求当 Azure AD 检测到存在风险的登录时，阻止使用敏感信息的应用程序。'
- en: This ends our detailed look at Azure AD. Let's move on to the other ways Azure
    can help you to enable remote connectivity.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们对 Azure AD 的详细介绍。接下来我们将讨论 Azure 如何帮助你启用远程连接的其他方式。
- en: Enabling remote connectivity
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 启用远程连接
- en: When it comes to connectivity, Azure Virtual Network is the fundamental building
    block to extend your connectivity to Azure and provide the best application experience
    and connectivity across the organization, partners, and customers. Azure provides
    a variety of networking capabilities to provide connectivity and enable remote
    work in a secure manner.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 在连接性方面，Azure Virtual Network 是扩展到 Azure 并为组织、合作伙伴和客户提供最佳应用体验和连接性的基本构建块。Azure
    提供了多种网络功能，以便安全地提供连接并支持远程工作。
- en: 'These networking capabilities include several Azure networking services. There
    are three main services that enable remote work: Azure Virtual WAN, Azure VPN,
    and ExpressRoute.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 这些网络功能包括多个 Azure 网络服务。有三个主要服务可以支持远程办公：Azure Virtual WAN、Azure VPN 和 ExpressRoute。
- en: Azure Virtual WAN
  id: totrans-156
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure Virtual WAN
- en: Azure Virtual WAN provides a unified framework for network security and routing
    capabilities for you to connect and span across different regions. It also allows
    you to deploy Azure **Network Virtual Appliances** (**NVAs**) inside a Virtual
    WAN hub.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Virtual WAN 提供了一个统一的网络安全和路由框架，帮助你在不同地区之间建立连接并扩展。它还允许你在 Virtual WAN 中心部署
    Azure **网络虚拟设备**（**NVA**）。
- en: A Virtual WAN hub is basically a virtual network where you can deploy gateways
    integrated with ExpressRoute and NVAs. In order to enable remote work, you can
    use Azure Virtual WAN's capabilities to provide a better connectivity experience
    for remote users. It can connect multiple branches through Site-to-Site VPNs and
    remote users through Point-to-Site VPNs.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: Virtual WAN中心本质上是一个虚拟网络，你可以在其中部署集成了ExpressRoute和NVA的网关。为了支持远程办公，你可以利用Azure Virtual
    WAN的功能，为远程用户提供更好的连接体验。它可以通过站对站VPN连接多个分支，通过点对站VPN连接远程用户。
- en: When you use Azure Virtual WAN, you can expand the connectivity with multiple
    hubs to get a fully meshed hub that allows you to achieve an any-to-any connectivity
    approach. This way, you can connect a remote user to Azure while at the same time
    interconnecting an ExpressRoute endpoint or a branch behind a Site-to-Site VPN.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Azure Virtual WAN时，你可以通过多个中心扩展连接，构建一个完全网状的中心，允许你实现任意到任意的连接方式。这样，你可以将远程用户连接到Azure的同时，也能将ExpressRoute终端或通过站对站VPN连接的分支互联起来。
- en: It is important to highlight that every Azure Virtual WAN has a router that
    controls the routes with all the other gateways in the hub. It also enables network-to-network
    transit capabilities with up to 50 Gbps in aggregation capacity.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 需要强调的是，每个Azure Virtual WAN都有一个路由器，控制与中心内其他网关的路由。它还支持网络到网络的传输功能，聚合能力可达50 Gbps。
- en: Azure Virtual WAN comes with built-in security capabilities. You can deploy
    a hub per region and provision multiple firewalls, which can be managed through
    Azure Firewall Manager. This way, you can use Azure Firewall Manager to work across
    subscriptions, regions, and deployments, and create policies to secure all the
    traffic going through the network.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Virtual WAN具有内置的安全功能。你可以为每个区域部署一个中心，并配置多个防火墙，这些防火墙可以通过Azure Firewall Manager进行管理。这样，你可以使用Azure
    Firewall Manager跨订阅、区域和部署工作，并创建策略来保护所有通过网络的流量。
- en: 'Most organizations today are relying on partners and vendors to enable these
    networking capabilities through hardware or virtual-based appliances. These can
    be migrated to Azure as you have the ability to deploy an NVA through the Azure
    Marketplace and integrate it inside the Virtual WAN hub. Also, there are BGP capabilities
    built in to enable transit routing across multiple networks and exchange routes
    that inform on-premises devices and Azure VPN gateways about whether they are
    reachable or not:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 目前大多数组织依赖合作伙伴和供应商通过硬件或虚拟设备启用这些网络功能。这些设备可以迁移到Azure，因为你可以通过Azure Marketplace部署NVA，并将其集成到Virtual
    WAN中心中。此外，Azure还内置了BGP功能，支持跨多个网络的传输路由，并交换路由信息，通知本地设备和Azure VPN网关它们是否可达：
- en: '![An overview of Azure networking services](img/B17153_05_15.jpg)'
  id: totrans-163
  prefs: []
  type: TYPE_IMG
  zh: '![Azure网络服务概览](img/B17153_05_15.jpg)'
- en: 'Figure 5.15: Azure networking'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.15：Azure网络
- en: You can provision multiple virtual networks in Azure across multiple regions,
    providing remote workers with a Point-to-Site VPN connection or a Site-to-Site
    connection for your VPN gateway connection from your on-premises network to the
    virtual network. This is shown in *Figure 5.15*.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在Azure中跨多个区域配置多个虚拟网络，为远程工作者提供点对站点VPN连接或站对站VPN连接，连接你从本地网络到虚拟网络的VPN网关。如*图5.15*所示。
- en: Azure VPN
  id: totrans-166
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure VPN
- en: An Azure VPN gateway enables you to send encrypted traffic across on-premises
    locations and Azure virtual networks over the internet or between other virtual
    networks. It is possible to have multiple connections to the same VPN gateway;
    however, you can only have a single VPN connection per virtual network.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: Azure VPN网关使你能够通过互联网或其他虚拟网络发送加密流量，连接本地位置和Azure虚拟网络。你可以有多个连接到同一个VPN网关，但每个虚拟网络只能有一个VPN连接。
- en: 'Before provisioning a specific type of VPN gateway, we need to understand the
    configurations available for VPN gateway connections and evaluate which one is
    the best fit for your organization. Azure provides multiple connection topologies
    that you can choose from to meet your organization''s needs: **Site-to-Site**
    (**S2S**), multi-site, **Point-to-Site** (**P2S**), and ExpressRoute.'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置特定类型的VPN网关之前，我们需要了解可用的VPN网关连接配置，并评估哪个最适合你的组织。Azure提供了多种连接拓扑，你可以选择最适合你组织需求的连接方式：**站对站**（**S2S**）、多站点、**点对站**（**P2S**）和ExpressRoute。
- en: Let's discuss each of them in turn.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们逐一讨论它们。
- en: Site-to-Site and Multi-Site
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 站对站和多站点
- en: 'Site-to-Site VPN gateway is the best fit for your organization if you''re looking
    to achieve hybrid configurations between your on-premises location and virtual
    networks. S2S is a connection over an IPsec/IKE (IKEv1 or IKEv2) VPN tunnel, which
    means that in order to deploy this type of connection you will need a VPN device
    located in your on-premises datacenter and a public IP address assigned to it.
    The following figure shows an S2S VPN connectivity schema:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 站点到站点 VPN 网关最适合您的组织，如果您希望实现本地位置与虚拟网络之间的混合配置。S2S 是通过 IPsec/IKE（IKEv1 或 IKEv2）VPN
    隧道建立的连接，这意味着要部署此类型的连接，您需要在本地数据中心部署 VPN 设备，并为其分配一个公共IP地址。下图展示了 S2S VPN 连接架构：
- en: '![An example of a Site-to-Site VPN connection](img/B17153_05_16.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![站点到站点VPN连接示例](img/B17153_05_16.jpg)'
- en: 'Figure 5.16: Site-to-Site VPN'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.16：站点到站点VPN
- en: 'If your organization has multiple on-premises locations, it is possible to
    connect branches to the same virtual network using a multi-site connection approach
    through a route-based VPN. Bear in mind that virtual networks can only have a
    single VPN gateway; all the connections going through the same VPN gateway will
    share the available bandwidth:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的组织有多个本地位置，您可以通过基于路由的VPN实现多站点连接方法，将多个分支连接到同一虚拟网络。请记住，虚拟网络只能有一个 VPN 网关；所有通过同一
    VPN 网关的连接将共享可用带宽：
- en: '![An example of a Multi-Site VPN connection](img/B17153_05_17.jpg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![多站点VPN连接示例](img/B17153_05_17.jpg)'
- en: 'Figure 5.17: Multi-site VPN'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.17：多站点VPN
- en: In addition, you can configure a network-to-network connection and combine it
    with a multi-site configuration as seen in *Figure 5.17*. You can establish connectivity
    with multiple virtual networks in the same or different subscriptions, regions,
    and deployment models.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您可以配置网络到网络的连接，并将其与如*图 5.17*所示的多站点配置结合使用。您可以与同一订阅、不同订阅、不同区域和不同部署模型中的多个虚拟网络建立连接。
- en: Point-to-Site VPN
  id: totrans-178
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 点对站点VPN
- en: 'If you''re looking to give remote users access to resources in Azure, you can
    utilize P2S VPN gateway connections. In this deployment mode, there''s no need
    for a VPN device on-premises; instead, the connection is directly established
    from the client device as seen in *Figure 5.18*:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望远程用户访问 Azure 中的资源，可以利用 P2S VPN 网关连接。在此部署模式下，您无需在本地部署 VPN 设备；连接直接从客户端设备建立，如*图
    5.18*所示：
- en: '![An example of a Point-to-Site VPN connection](img/B17153_05_18.jpg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![点对站VPN连接示例](img/B17153_05_18.jpg)'
- en: 'Figure 5.18: Point-to-Site VPN'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.18：点对站VPN
- en: This type of connection is cost-effective if you want to allow a few remote
    users to access resources in the cloud through a virtual network.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望让少量远程用户通过虚拟网络访问云中的资源，这种类型的连接具有成本效益。
- en: ExpressRoute
  id: totrans-183
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ExpressRoute
- en: As is very often heard in the field, ExpressRoute is your **Ethernet cable to
    Azure**. It provides connectivity between your on-premises location and Azure
    using a private connection through a partner known as the **connection provider**.
    ExpressRoute offers Layer 3 connectivity, which supports any-to-any network connections,
    point-to-point Ethernet connections, or a virtual cross-connection.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在行业中常常听到这样一句话，ExpressRoute 就是您通往 Azure 的**以太网电缆**。它通过一个名为**连接提供商**的合作伙伴提供私有连接，连接您本地位置与
    Azure。ExpressRoute 提供第三层连接，支持任何对任何网络连接、点对点以太网连接或虚拟跨连接。
- en: 'Based on your organization''s needs and the connectivity provider, you can
    choose how you want to create a connection to the cloud. There are four ways to
    create a connection:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您组织的需求和连接提供商，您可以选择如何创建到云的连接。有四种创建连接的方式：
- en: '**CloudExchange co-location**: If your datacenter is co-located in a facility
    with a cloud exchange, you can leverage Layer 2 cross-connections, or managed
    Layer 3 cross-connections through the provider''s Ethernet exchange to connect
    your infrastructure and Azure.'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CloudExchange 联合定位**：如果您的数据中心与云交换设施位于同一地点，您可以通过服务提供商的以太网交换利用第二层跨连接或托管的第三层跨连接，连接您的基础设施与
    Azure。'
- en: '**Point-to-point Ethernet connection**: On this model, you can connect your
    datacenter to Azure through Ethernet providers that offer Layer 2 connections,
    or managed Layer 3 connections and build your private connection using point-to-point
    Ethernet links.'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**点对点以太网连接**：在此模型中，您可以通过提供第二层连接或托管第三层连接的以太网服务商将您的数据中心连接到Azure，并通过点对点以太网链路构建您的私有连接。'
- en: '**Any-to-Any (IPVPN) connection**: You can enable WAN connectivity between
    Azure and branch offices or datacenters, usually offered as a managed Layer 3
    connectivity.'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**任意对任意（IPVPN）连接**：你可以启用Azure与分支机构或数据中心之间的WAN连接，通常以托管的第三层连接形式提供。'
- en: '**ExpressRoute Direct**: You can plug into Microsoft''s global network and
    achieve an Active/Active connectivity at scale to cover different needs such as
    massive data ingestion into Azure services or connectivity isolation.'
  id: totrans-189
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ExpressRoute Direct**：你可以接入微软的全球网络，并实现规模化的Active/Active连接，满足不同的需求，例如大规模数据导入到Azure服务或连接隔离。'
- en: 'ExpressRoute circuits, as in *Figure 5.19*, provide a wide range of bandwidth,
    from 50 Mbps up to 10Gbps, and dynamic scaling without downtime:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 如*图5.19*所示，ExpressRoute电路提供从50 Mbps到10 Gbps的宽带，并且可以在不中断的情况下动态扩展：
- en: '![ExpressRoute connectivity model](img/B17153_05_19.jpg)'
  id: totrans-191
  prefs: []
  type: TYPE_IMG
  zh: '![ExpressRoute 连接模型](img/B17153_05_19.jpg)'
- en: 'Figure 5.19: ExpressRoute'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.19：ExpressRoute
- en: In addition, it is possible to have an ExpressRoute circuit and an S2S connection
    at the same time. Although they can coexist, it requires two virtual network gateways
    for the same virtual network, one using the gateway type VPN, and the other using
    the gateway type ExpressRoute.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，可以同时拥有ExpressRoute电路和S2S连接。尽管它们可以共存，但这需要为同一个虚拟网络配置两个虚拟网络网关，一个使用VPN类型的网关，另一个使用ExpressRoute类型的网关。
- en: With your connections to Azure established, let's look at how you can secure
    and manage the traffic to your cloud-based applications.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 在建立了与Azure的连接后，我们来看看如何保护和管理流量到你的云应用程序。
- en: Securing and managing traffic to your workloads
  id: totrans-195
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 保护和管理流量到你的工作负载
- en: Security is a shared responsibility between Microsoft, partners, and customers.
    Azure provides security controls and services to protect identity, network, and
    data resources.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 安全性是微软、合作伙伴和客户之间的共同责任。Azure提供安全控制和服务来保护身份、网络和数据资源。
- en: In the previous section *Azure Active Directory*, we reviewed how you can leverage
    identity and management features available with Azure AD to ensure secure access
    to data and resources. Protecting the infrastructure and workloads for remote
    access on a daily basis is a critical task and Microsoft provides enterprise-grade
    solutions to secure the traffic to your applications, whether they are delivered
    through Azure or from an on-premises location.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节*Azure Active Directory*中，我们回顾了如何利用Azure AD提供的身份和管理功能，确保对数据和资源的安全访问。保护基础设施和远程访问的工作负载是日常工作中的一项关键任务，微软提供了企业级解决方案来保障应用程序的流量，无论它们是通过Azure提供，还是来自本地环境。
- en: Azure can help protect your cloud infrastructure by using network security controls
    to manage traffic, configuring access rules, extending connectivity to your on-premises
    resources, and protecting your virtual network.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: Azure可以通过使用网络安全控制来保护你的云基础设施，管理流量，配置访问规则，将连接扩展到本地资源，并保护你的虚拟网络。
- en: 'One of the principal services that you can use to protect web applications
    is **Azure Web Application Firewall** (**WAF**), shown in *Figure 5.20*:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以用来保护Web应用程序的主要服务之一是**Azure Web应用防火墙**（**WAF**），如*图5.20*所示：
- en: '![Azure WAF overview](img/B17153_05_20.jpg)'
  id: totrans-200
  prefs: []
  type: TYPE_IMG
  zh: '![Azure WAF 概述](img/B17153_05_20.jpg)'
- en: 'Figure 5.20: Azure WAF'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 图5.20：Azure WAF
- en: 'Azure WAF is compliant with various compliance standards, including but not
    limited to PCI-DSS, HIPAA, SOC, ISO, and CDSA. A complete list of compliance offerings
    can be found here: [https://docs.microsoft.com/azure/compliance/](https://docs.microsoft.com/azure/compliance/).'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: Azure WAF符合各种合规标准，包括但不限于PCI-DSS、HIPAA、SOC、ISO和CDSA。完整的合规服务列表可以在此找到：[https://docs.microsoft.com/azure/compliance/](https://docs.microsoft.com/azure/compliance/)。
- en: Application Gateway with WAF
  id: totrans-203
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 带有WAF的应用程序网关
- en: Your organization may be running applications in the cloud or on-premises, with
    remote users trying to reach those workloads. Application Gateway is a key **Platform
    as a Service** (**PaaS**) component that can facilitate this. It is a lightweight
    **Application Delivery Controller** (**ADC**) that provides support for SSL termination,
    session affinity, and content-based routing. This set of capabilities makes Application
    Gateway a flexible service. It can be deployed, along with Azure WAF or Azure
    Front Door, to improve scaling capabilities and protect your applications on-premises
    or in the cloud against OWASP and other vulnerabilities, without the need for
    additional configurations.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 您的组织可能在云端或本地运行应用程序，远程用户尝试访问这些工作负载。应用网关是一个关键的**平台即服务**（**PaaS**）组件，可以帮助实现这一目标。它是一个轻量级的**应用交付控制器**（**ADC**），提供
    SSL 终止、会话亲和性和基于内容的路由支持。这一系列功能使得应用网关成为一个灵活的服务。它可以与 Azure WAF 或 Azure Front Door
    一起部署，以提高扩展能力，并保护您的应用程序，无论是在本地还是在云中，免受 OWASP 和其他漏洞的影响，而无需额外配置。
- en: 'Both Application Gateway and Azure WAF are PaaS managed services, so you can
    save some time and provide the right protection for your applications while Azure
    takes care of the underlying infrastructure, as shown in the following figure:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 应用网关和 Azure WAF 都是 PaaS 托管服务，因此您可以节省时间，并在 Azure 负责底层基础设施的同时为您的应用程序提供正确的保护，如下图所示：
- en: '![Azure App Gateway with the Azure WAF model](img/B17153_05_21.jpg)'
  id: totrans-206
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 应用网关与 Azure WAF 模型](img/B17153_05_21.jpg)'
- en: 'Figure 5.21: Azure Application Gateway and Azure WAF'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.21：Azure 应用网关和 Azure WAF
- en: 'The key benefits of Azure WAF include:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: Azure WAF 的主要好处包括：
- en: Preconfigured protection against the OWASP Top 10 attacks.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 预配置的防护，防止 OWASP 十大攻击。
- en: Bot protection.
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 机器人保护。
- en: A custom rules engine (geo-filtering, IP restriction, HTTP parameter filtering,
    and size restriction).
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自定义规则引擎（地理过滤、IP 限制、HTTP 参数过滤和大小限制）。
- en: Logs and metrics for detection and alerts.
  id: totrans-212
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用于检测和警报的日志和指标。
- en: Another common use case is integration with Azure Front Door, which provides
    a global application acceleration and delivery service in Azure, in addition to
    regional load balancing for web applications.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个常见的用例是与 Azure Front Door 的集成，Azure Front Door 提供全球应用加速和交付服务，除了为 Web 应用提供区域负载均衡外，还能加速传输。
- en: 'A key benefit of using Azure Front Door with Azure WAF is the ability to detect
    and prevent attacks against your web applications before they reach the virtual
    network. You can stop malicious attacks close to the sources before they enter
    your virtual network and create rate limits or request thresholds to protect your
    application against floods. We can see how this works in *Figure 5.22*:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure Front Door 配合 Azure WAF 的一个关键好处是能够在攻击到达虚拟网络之前，检测并防止针对您 Web 应用程序的攻击。您可以在恶意攻击接近源头时将其阻止，防止它们进入虚拟网络，并创建速率限制或请求阈值，以保护您的应用免受洪水攻击。我们可以在*图
    5.22*中看到它是如何工作的：
- en: '![Azure Front Door with Azure WAF overview](img/B17153_05_22.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![Azure Front Door 与 Azure WAF 概述](img/B17153_05_22.jpg)'
- en: 'Figure 5.22: Azure Front Door and Azure WAF'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.22：Azure Front Door 和 Azure WAF
- en: This can allow you to publish and secure your web applications whether they
    are hosted on-premises or in the cloud.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以让您发布和保护您的 Web 应用程序，无论它们是托管在本地还是云中。
- en: Azure Firewall
  id: totrans-218
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure 防火墙
- en: The next security control at the perimeter that your organization can use to
    protect your virtual network resources is Azure Firewall. Azure Firewall allows
    you to create, enforce, and log applications and network connectivity policies
    from Layer 3 up to Layer 7 of the OSI model and span across subscriptions and
    virtual networks.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 组织可以用于保护虚拟网络资源的下一个边界安全控制是 Azure 防火墙。Azure 防火墙允许您创建、强制执行并记录应用程序和网络连接策略，覆盖 OSI
    模型的第 3 层到第 7 层，并跨订阅和虚拟网络进行管理。
- en: 'Azure Firewall is critical when considering remote work as it can provide protection
    for your Windows Virtual Desktop infrastructure deployments on Azure, along with
    threat intelligence so remote users can properly access their virtual desktops.
    It is recommended that you use **Fully Qualified Domain Names** (**FQDNs**) when
    using Windows Virtual Desktop to simplify access. Azure Firewall provides a simplified
    integration for Windows Virtual Desktop by enabling filtering capabilities for
    outbound traffic, as shown in *Figure 5.23*:'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 在考虑远程办公时，Azure 防火墙至关重要，它能为你在 Azure 上部署的 Windows 虚拟桌面基础设施提供保护，同时提供威胁情报，确保远程用户能够正确访问其虚拟桌面。建议在使用
    Windows 虚拟桌面时，使用**完全限定域名**（**FQDNs**）来简化访问。Azure 防火墙通过启用出站流量过滤功能，为 Windows 虚拟桌面提供简化集成，如*图
    5.23*所示：
- en: '![An overview of Azure Firewall](img/B17153_05_23.jpg)'
  id: totrans-221
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 防火墙概述](img/B17153_05_23.jpg)'
- en: 'Figure 5.23: Azure Firewall'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.23：Azure 防火墙
- en: It is important to note that Azure Firewall is a fully cloud-based managed service
    and Azure takes care of the underlying infrastructure.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，Azure 防火墙是一个完全基于云的托管服务，Azure 会负责底层基础设施。
- en: Azure Load Balancer and cross-region load balancing
  id: totrans-224
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure 负载均衡器与跨区域负载均衡
- en: Very often, organizations struggle with cloud-based workloads when there's an
    increase in application traffic and want to provide a better customer experience.
    Azure provides built-in load balancing capabilities for cloud resources so you
    can create highly available and scalable web applications.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: 很多时候，当应用流量增加，组织会面临基于云的工作负载挑战，并希望提供更好的客户体验。Azure 提供了内置的负载均衡功能，供云资源使用，这样你就可以创建高可用且可扩展的
    Web 应用程序。
- en: The main component for achieving high availability is Azure Load Balancer, as
    seen in *Figure 5.24*. It operates at Layer 4 of the OSI model and represents
    a single point of contact for clients. Azure Load Balancer is optimized for cloud
    workloads to distribute inbound traffic to back-end pool instances.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 实现高可用性的主要组件是 Azure 负载均衡器，如*图 5.24*所示。它在 OSI 模型的第 4 层运行，并代表客户端的单一接入点。Azure 负载均衡器经过优化，能将流量分配到后端池实例，适用于云工作负载。
- en: 'Azure Load Balancer can be public facing, so it can load balance internet traffic
    to your applications living in Azure, or it can be internally facing, where private
    IPs are needed on the front-end side only:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 负载均衡器可以面向公网，负载均衡来自互联网的流量到你在 Azure 上的应用程序，或者它可以面向内网，仅在前端需要私有 IP 地址：
- en: '![Azure Load Balancer schema](img/B17153_05_24.jpg)'
  id: totrans-228
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 负载均衡器架构](img/B17153_05_24.jpg)'
- en: 'Figure 5.24: Azure Load Balancer'
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.24：Azure 负载均衡器
- en: You will find two main Azure Load Balancer profiles, Basic and Standard. Previously,
    you were only able to add network interfaces associated to virtual machines or
    virtual machine scale sets in the back-end pool of a load balancer. However, due
    to recent improvements that allow load balancing across IP addresses, you are
    now able to load balance resources living in Azure via private IPv4 or IPv6 addresses
    through the Standard profile, which extends the capability for load balancing
    across containers.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 你将发现 Azure 负载均衡器有两种主要配置文件：Basic 和 Standard。以前，你只能将与虚拟机或虚拟机规模集相关联的网络接口添加到负载均衡器的后端池中。然而，由于最近的改进，允许跨
    IP 地址进行负载均衡，现在你可以通过 Standard 配置文件，使用私有 IPv4 或 IPv6 地址对 Azure 中的资源进行负载均衡，从而扩展了容器负载均衡的能力。
- en: 'In the past, Azure Load Balancer was able to load balance only in a given region.
    Now, you can use Azure Load Balancer for cross-region load balancing to distribute
    inbound traffic and enable geo-redundant high-availability scenarios:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 过去，Azure 负载均衡器只能在特定区域内进行负载均衡。现在，你可以使用 Azure 负载均衡器进行跨区域负载均衡，分配流入流量，并启用地理冗余高可用性场景：
- en: '![Cross-region load balancer overview](img/B17153_05_25.jpg)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![跨区域负载均衡器概述](img/B17153_05_25.jpg)'
- en: 'Figure 5.25: Cross-region load balancer'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.25：跨区域负载均衡器
- en: It is possible to build cross-regional capabilities on top of an existing load
    balancer solution, and a huge benefit is the ability to use a static front-end
    IP configuration.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 在现有的负载均衡器解决方案上构建跨区域功能是可能的，一个重要的好处是能够使用静态前端 IP 配置。
- en: Azure Bastion and Just-in-Time (JIT) access
  id: totrans-235
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure Bastion 和即时（JIT）访问
- en: Sometimes organizations need to provide remote access to resources in Azure
    and want to provide a secure way to connect to these resources without the need
    of having a VPN connection or assigning public IPs to a virtual machine.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，组织需要提供远程访问 Azure 中的资源，并希望提供一种安全的方式连接这些资源，而不需要 VPN 连接或为虚拟机分配公共 IP。
- en: 'Azure Bastion enables you to manage your resources in a secure manner by providing
    RDP/SSH connectivity to virtual machines deployed within a virtual network, without
    needing public IPs directly from the Azure portal:'
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Bastion 通过提供 RDP/SSH 连接，让你以安全的方式管理资源，允许你通过虚拟网络中的虚拟机，而无需直接使用公共 IP。
- en: '![An overview of Azure Bastion](img/B17153_05_26.jpg)'
  id: totrans-238
  prefs: []
  type: TYPE_IMG
  zh: '![Azure Bastion 概览](img/B17153_05_26.jpg)'
- en: 'Figure 5.26: Azure Bastion'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.26：Azure Bastion
- en: Azure Bastion is a managed solution and, in the back-end, a virtual machine
    scale set that is deployed within your virtual network so that remote users can
    connect via RDP/SSH with no exposure to public IPs. This means it also has the
    capability to scale as needed depending on the number of concurrent sessions.
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: Azure Bastion 是一种托管解决方案，后端是一个部署在你的虚拟网络中的虚拟机规模集，远程用户可以通过 RDP/SSH 连接，而无需暴露公共 IP。这意味着它还具备按需扩展的能力，取决于并发会话的数量。
- en: Along with protection and connectivity capabilities, Azure Security Center can
    be used to implement JIT access, which enables you to lock down inbound traffic
    to your virtual machines to reduce exposure to attacks and easily audit access
    to the virtual machine.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 除了保护和连接功能，Azure 安全中心还可以用于实施 JIT 访问，使你能够限制虚拟机的入站流量，减少遭受攻击的风险，并轻松审核对虚拟机的访问。
- en: JIT access can also be used with Azure Firewall to reduce exposure to network
    volumetric attacks by creating policies to define the ports that you want to protect,
    for instance, to set how long they should remain open for, and filtering the IPs
    that should have access to the virtual machine.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: JIT 访问还可以与 Azure 防火墙一起使用，通过创建策略来减少对网络流量攻击的暴露，定义你想保护的端口，例如，设置端口应保持打开的时间，并过滤应该访问虚拟机的
    IP。
- en: 'Now that we have discussed the main services that can enable your organization
    to better secure and manage traffic to your applications, let''s take a look at
    the final piece: enabling remote work through the Azure Windows Virtual Desktop
    infrastructure.'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经讨论了能够帮助你的组织更好地保护和管理应用程序流量的主要服务，让我们来看看最后一块拼图：通过 Azure Windows 虚拟桌面基础设施启用远程工作。
- en: Enabling remote work with Windows Virtual Desktop
  id: totrans-244
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 启用远程工作与 Windows 虚拟桌面
- en: In the past few months, we all have experienced an impact on how we collaborate
    with colleagues within our organizations, as well as partners and customers. Companies
    of all sizes have invested in the adoption of collaboration tools that can enable
    remote work and provide the best experience for employees to keep connected during
    business disruption and improve productivity.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在过去几个月里，我们都经历了如何与组织内的同事、合作伙伴和客户进行协作的改变。各类企业都投入了采用可以支持远程工作的协作工具，并为员工提供最佳的体验，使他们在业务中断期间保持联系并提高生产力。
- en: '**Virtual Desktop Infrastructure** (**VDI**) is a virtualization solution that
    provides a desktop environment for remote users as if they were working on their
    local computer. Windows Virtual Desktop makes remote work possible while providing
    the best experience to maintain the underlying infrastructure, and it can even
    be built in minutes.'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: '**虚拟桌面基础设施**（**VDI**）是一种虚拟化解决方案，为远程用户提供类似于在本地计算机上工作的桌面环境。Windows 虚拟桌面使远程工作成为可能，同时提供最佳的体验来维护基础设施，甚至可以在几分钟内构建完成。'
- en: 'Windows Virtual Desktop supports a variety of operating systems, including
    Windows 10 Enterprise, Windows 10 Enterprise multi-session, Windows 7 Enterprise,
    and Windows Server 2012 R2, 2016, and 2019\. Depending on your organization''s
    needs, you can make use of a specific licensing model such as Microsoft 365 E3,
    E5, A3, A5, or F3; Business Premium; Windows E3, E5, A3, or A5; or RDS client
    access licenses. *Figure 5.27* demonstrates how Windows Virtual Desktop works:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 虚拟桌面支持多种操作系统，包括 Windows 10 企业版、Windows 10 企业版多会话版、Windows 7 企业版，以及 Windows
    Server 2012 R2、2016 和 2019。根据组织的需求，你可以选择特定的许可模式，如 Microsoft 365 E3、E5、A3、A5 或
    F3；Business Premium；Windows E3、E5、A3 或 A5；或 RDS 客户端访问许可证。*图 5.27* 展示了 Windows
    虚拟桌面的工作原理：
- en: '![Windows Virtual Desktop architecture](img/B17153_05_27.jpg)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
  zh: '![Windows 虚拟桌面架构](img/B17153_05_27.jpg)'
- en: 'Figure 5.27: Windows Virtual Desktop architecture'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.27：Windows 虚拟桌面架构
- en: On the left, the endpoints are usually in the on-premises network and can extend
    connectivity through S2S or Express Route, and Azure AD Connect can integrate
    the on-premises AD DS with Azure AD.
  id: totrans-250
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 左侧的终端通常位于本地网络中，可以通过 S2S 或 Express Route 扩展连接，而 Azure AD Connect 可以将本地 AD DS
    与 Azure AD 集成。
- en: Your organization can manage AD DS, Azure AD, Azure subscriptions, virtual networks,
    storage, and the Windows Virtual Desktop host pools and workspaces.
  id: totrans-251
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 你的组织可以管理 AD DS、Azure AD、Azure 订阅、虚拟网络、存储以及 Windows 虚拟桌面主机池和工作区。
- en: Microsoft manages the Windows Virtual Desktop control plane, which handles web
    access, gateway, broker, diagnostics, and extensibility components such as REST
    APIs.
  id: totrans-252
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 微软管理 Windows 虚拟桌面的控制平面，负责处理 Web 访问、网关、代理、诊断以及扩展性组件（如 REST API）。
- en: In order for your organization to utilize Windows Virtual Desktop, you need
    Azure AD, a Windows Server Active Directory instance in sync with Azure AD, and
    an Azure subscription. The virtual machines for Windows Virtual Desktop can be
    standard domain-joined or hybrid AD-joined.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 为了让你的组织能够使用 Windows 虚拟桌面，你需要 Azure AD，一个与 Azure AD 同步的 Windows Server Active
    Directory 实例，以及一个 Azure 订阅。Windows 虚拟桌面的虚拟机可以是标准的域加入或混合 AD 加入。
- en: The new ARM-based experience for Windows Virtual Desktop makes it easier to
    manage your environment. It includes a new integrated monitoring UI with Log Analytics
    and management UI through the Azure portal. It also enables you to manage your
    environment using the Azure PowerShell module for Windows Virtual Desktop.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 基于 ARM 的新体验使 Windows 虚拟桌面的管理变得更加轻松。它包括一个集成的新监控 UI，结合了日志分析和通过 Azure 门户的管理 UI。它还允许你使用
    Azure PowerShell 模块来管理 Windows 虚拟桌面环境。
- en: The ARM-based experience also provides better admin access control as it leverages
    Azure **Role-Based Access Control** (**RBAC**) with built-in custom roles. You
    can also publish applications and manage access through Azure AD user groups and
    individual users. In addition, you are now able to specify the geography you prefer
    for storage.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 基于 ARM 的体验还提供了更好的管理员访问控制，因为它利用了 Azure **基于角色的访问控制**（**RBAC**）和内置的自定义角色。你还可以通过
    Azure AD 用户组和单个用户来发布应用程序并管理访问权限。此外，现在你可以指定你希望用于存储的地理位置。
- en: 'The following diagram provides you with a high-level overview of the Windows
    Virtual Desktop architecture:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表为你提供了 Windows 虚拟桌面架构的高级概述：
- en: '![A high-level overview of the Windows Virtual Desktop architecture](img/B17153_05_28.jpg)'
  id: totrans-257
  prefs: []
  type: TYPE_IMG
  zh: '![Windows 虚拟桌面架构的高级概述](img/B17153_05_28.jpg)'
- en: 'Figure 5.28: Windows Virtual Desktop structure'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.28：Windows 虚拟桌面结构
- en: 'Through the Azure portal, you will have a seamless experience managing your
    Windows Virtual Desktop deployment, including host pools, application groups,
    workspaces, and users:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Azure 门户，你将获得无缝的体验来管理 Windows 虚拟桌面的部署，包括主机池、应用程序组、工作区和用户：
- en: '![Managing Windows Virtual Desktop through the Azure portal](img/B17153_05_29.jpg)'
  id: totrans-260
  prefs: []
  type: TYPE_IMG
  zh: '![通过 Azure 门户管理 Windows 虚拟桌面](img/B17153_05_29.jpg)'
- en: 'Figure 5.29: Managing Windows Virtual Desktop through the Azure portal'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5.29：通过 Azure 门户管理 Windows 虚拟桌面
- en: You can use ARM capabilities to provision Windows Virtual Desktop. You need
    to register the `Microsoft.DesktopVirtualization` resource provider, then create
    the host pools as needed, including the specification of the virtual machine details,
    and provide the parameters for the Azure virtual network. After this, you can
    proceed to create the application groups and add Azure AD users or user groups
    to them. Finally, you configure your Windows Virtual Desktop workspace and then
    install the Windows Virtual Desktop client for Windows on the client device.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 ARM 功能来配置 Windows 虚拟桌面。你需要注册 `Microsoft.DesktopVirtualization` 资源提供程序，然后根据需要创建主机池，包括指定虚拟机详细信息，并提供
    Azure 虚拟网络的参数。完成这些操作后，你可以继续创建应用程序组，并将 Azure AD 用户或用户组添加到其中。最后，配置你的 Windows 虚拟桌面工作区，然后在客户端设备上安装
    Windows 虚拟桌面客户端。
- en: 'There''s a learning path on Microsoft Learn on how to deliver remote desktops
    and apps from Azure with Windows Virtual Desktop: [https://docs.microsoft.com/learn/paths/m365-wvd/](https://docs.microsoft.com/learn/paths/m365-wvd/).'
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Microsoft Learn 上有一条学习路径，教你如何通过 Windows 虚拟桌面从 Azure 提供远程桌面和应用程序：[https://docs.microsoft.com/learn/paths/m365-wvd/](https://docs.microsoft.com/learn/paths/m365-wvd/)。
- en: 'Also, you can leverage the ARM templates to automate the deployment process
    of your Windows Virtual Desktop environment: [https://github.com/Azure/RDS-Templates/](https://github.com/Azure/RDS-Templates/).'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，你还可以利用 ARM 模板来自动化部署 Windows 虚拟桌面环境的过程：[https://github.com/Azure/RDS-Templates/](https://github.com/Azure/RDS-Templates/)。
- en: Components you can manage in Windows Virtual Desktop
  id: totrans-265
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 你可以在 Windows 虚拟桌面中管理的组件
- en: 'The following table compares the resources that Microsoft manages in Windows
    Virtual Desktop and the ones that you can take care of:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格比较了 Microsoft 在 Windows 虚拟桌面中管理的资源与你可以管理的资源：
- en: '![Responsibilities for the management of resources](img/B17153_Table_05_02.jpg)'
  id: totrans-267
  prefs: []
  type: TYPE_IMG
  zh: '![资源管理的责任](img/B17153_Table_05_02.jpg)'
- en: 'Table 5.2: Responsibilities for the management of resources'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.2：资源管理的责任
- en: 'These are the components managed by Microsoft:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是由 Microsoft 管理的组件：
- en: '**Web access**: Through this service, users are able to access their desktops
    using an HTML5-compatible web browser.'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Web 访问**：通过该服务，用户可以使用兼容 HTML5 的 web 浏览器访问其桌面。'
- en: '**Gateway**: This service enables remote users to establish a connection with
    Windows Virtual Desktop apps and desktops from any device that can execute the
    Windows Virtual Desktop client.'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网关**：该服务使远程用户能够从任何能够执行 Windows 虚拟桌面客户端的设备连接到 Windows 虚拟桌面应用和桌面。'
- en: '**Connection broker**: This service manages user connections and provides load
    balancing capabilities.'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**连接代理**：该服务管理用户连接并提供负载均衡功能。'
- en: '**Diagnostics**: This is an event-based aggregator to identify potential failures
    of the components.'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**诊断**：这是一个基于事件的聚合器，用于识别组件可能出现的故障。'
- en: '**Extensibility components**: This includes third-party tools and additional
    extensions that can be enabled for Windows Virtual Desktop.'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**扩展性组件**：这包括可以为 Windows 虚拟桌面启用的第三方工具和额外的扩展。'
- en: 'These are the components you manage:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: 这些是你管理的组件：
- en: '**Azure virtual networks**: You can configure the network topology as needed
    to provide access to desktops and applications based on your organization''s policies.'
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure 虚拟网络**：你可以根据组织的政策配置网络拓扑，以提供对桌面和应用程序的访问。'
- en: '**Azure AD**: While this is a pre-requisite for using Windows Virtual Desktop,
    you can manage Azure AD integration and security features to keep your environment
    compliant.'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Azure AD**：虽然这是使用 Windows 虚拟桌面的前提条件，但你可以管理 Azure AD 集成和安全功能，以确保你的环境符合合规要求。'
- en: '**AD DS**: This is a pre-requisite for enabling Windows Virtual Desktop that
    includes synchronization with Azure AD. You can also leverage Azure AD Connect
    to associate AD DS with Azure AD.'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**AD DS**：这是启用 Windows 虚拟桌面的前提条件，包括与 Azure AD 的同步。你还可以使用 Azure AD Connect 将
    AD DS 与 Azure AD 关联。'
- en: '**Windows Virtual Desktop session hosts**: You can run a variety of operating
    systems, including Windows 10 Enterprise; Windows 10 Enterprise multi-session;
    Windows 7 Enterprise; Windows Server 2012 R2, 2016, and 2019; and also custom
    Windows images.'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 虚拟桌面会话主机**：你可以运行各种操作系统，包括 Windows 10 企业版；Windows 10 企业版多会话版；Windows
    7 企业版；Windows Server 2012 R2、2016 和 2019；以及自定义 Windows 镜像。'
- en: '**Windows Virtual Desktop workspace**: This is a workspace for managing and
    publishing host pool resources.'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Windows 虚拟桌面工作区**：这是一个用于管理和发布主机池资源的工作区。'
- en: Sizing your Windows Virtual Desktop environment
  id: totrans-281
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 确定 Windows 虚拟桌面环境的规模
- en: In the past, sizing your Windows Virtual Desktop environment was a bit of a
    challenge due to the availability of only some basic guidance. Now you can utilize
    the Windows Virtual Desktop Experience Estimator, a tool that can help you to
    find the right size for your environment for your organization's needs.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 过去，由于只有一些基本的指导，确定 Windows 虚拟桌面环境的规模是一个挑战。现在，你可以使用 Windows 虚拟桌面体验评估器，这是一款可以帮助你根据组织需求找到合适规模的工具。
- en: The Windows Virtual Desktop Experience Estimator is available at [https://azure.microsoft.com/services/virtual-desktop/assessment/](https://azure.microsoft.com/services/virtual-desktop/assessment/).
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 虚拟桌面体验评估器可以通过 [https://azure.microsoft.com/services/virtual-desktop/assessment/](https://azure.microsoft.com/services/virtual-desktop/assessment/)
    获取。
- en: 'Initially, you will find a table that shows the region with the lowest round
    trip time from your current location and also provides a reference to the size
    of the virtual machines and network services needed for your implementation:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: 初始时，你将看到一个表格，展示了从当前位置出发的最低往返时间区域，并提供了虚拟机和网络服务的大小参考，这些服务对于你的实现至关重要：
- en: '![Round trip times for different Azure regions](img/B17153_Table_05_03.jpg)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
  zh: '![不同 Azure 区域的往返时间](img/B17153_Table_05_03.jpg)'
- en: 'Table 5.3: Round trip times for different Azure regions'
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.3：不同 Azure 区域的往返时间
- en: Based on your current location, you can choose a preferred region to provide
    a better user experience. Bear in mind that there are also additional components
    that might impact your deployment, such as network conditions, end user devices,
    and the configuration of the virtual machines.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 根据您当前的位置，您可以选择一个首选区域，以提供更好的用户体验。请记住，还有一些其他组件可能会影响您的部署，如网络条件、终端设备和虚拟机的配置。
- en: Network guidelines
  id: totrans-288
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 网络指南
- en: 'As we have already discussed, networking components are critical to enabling
    remote work. Bandwidth is one of the key metrics that you should look at when
    sizing your environment as it will impact the user experience. The following table
    demonstrates some recommendations based on different types of workloads and can
    be found at [https://docs.microsoft.com/windows-server/remote/remote-desktop-services/network-guidance](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/network-guidance):'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们已经讨论过的，网络组件对于支持远程工作至关重要。带宽是您在规划环境时需要关注的关键度量标准之一，因为它会影响用户体验。下表展示了基于不同类型工作负载的一些建议，您可以在[https://docs.microsoft.com/windows-server/remote/remote-desktop-services/network-guidance](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/network-guidance)找到：
- en: '![Recommended bandwidth for different workload types](img/B17153_Table_05_04.jpg)'
  id: totrans-290
  prefs: []
  type: TYPE_IMG
  zh: '![不同工作负载类型的推荐带宽](img/B17153_Table_05_04.jpg)'
- en: 'Table 5.4: Recommended bandwidth for different workload types'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.4：不同工作负载类型的推荐带宽
- en: 'The display resolution is another form factor along with the bandwidth. The
    following table shows the recommended bandwidth for an optimal user experience:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
  zh: 显示分辨率是与带宽一起影响用户体验的另一个因素。下表展示了为获得最佳用户体验推荐的带宽：
- en: '![Recommended bandwidth for different display resolutions at 30fps](img/B17153_Table_05_05.jpg)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
  zh: '![30fps下不同显示分辨率的推荐带宽](img/B17153_Table_05_05.jpg)'
- en: 'Table 5.5: Recommended bandwidth for different display resolutions at 30 fps'
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.5：30 fps下不同显示分辨率的推荐带宽
- en: 'With regard to the virtual machines for your Windows Virtual Desktop environment,
    Microsoft provides examples of different workload types to properly size the virtual
    machines that you need for your environment:'
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: 关于 Windows 虚拟桌面环境中的虚拟机，Microsoft 提供了不同工作负载类型的示例，帮助您正确配置所需的虚拟机大小：
- en: '![Examples of different workload types](img/B17153_Table_05_06.jpg)'
  id: totrans-296
  prefs: []
  type: TYPE_IMG
  zh: '![不同工作负载类型的示例](img/B17153_Table_05_06.jpg)'
- en: 'Table 5.6: Examples of different workload types'
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.6：不同工作负载类型的示例
- en: In addition, an example of a metric that you should take into consideration
    based on the workloads is the number of users reaching the same application at
    the same time. That said, you can consider the multi-session or single-session
    recommendations based on your organization's needs.
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，您应该考虑的一个度量标准是同时有多少用户访问相同的应用程序。也就是说，您可以根据组织的需求考虑多会话或单会话的建议。
- en: 'Microsoft provides a virtual machine size based on the maximum suggested number
    of users per **virtual CPU** (**vCPU**) and examples of Azure instances that match
    the minimum virtual machine configuration:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: Microsoft 根据每个**虚拟 CPU**（**vCPU**）的最大建议用户数量提供虚拟机大小，并提供与最小虚拟机配置匹配的 Azure 实例示例：
- en: '![Multi-sessionrecommendations](img/B17153_Table_05_07.jpg)'
  id: totrans-300
  prefs: []
  type: TYPE_IMG
  zh: '![多会话建议](img/B17153_Table_05_07.jpg)'
- en: 'Table 5.7: Multi-session recommendations'
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: 表 5.7：多会话建议
- en: As a general recommendation, it is a good idea to use Premium SSD disks for
    critical workloads and consider GPUs if you plan to run graphics-intensive programs
    on your virtual machines.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 一般建议是，对于关键工作负载，使用高级 SSD 磁盘，并且如果计划在虚拟机上运行图形密集型程序，可以考虑使用 GPU。
- en: Managing user profiles with Azure Files and NetApp Files
  id: totrans-303
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用 Azure 文件和 NetApp 文件管理用户配置文件
- en: While Azure offers a wide range of storage solutions, FSLogix profile containers
    are one of the recommended user profile solutions for a Windows Virtual Desktop
    service as they are designed to roam profiles in non-persistent remote computing
    environments.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然 Azure 提供了多种存储解决方案，但 FSLogix 配置文件容器是 Windows 虚拟桌面服务推荐的用户配置文件解决方案之一，因为它们被设计用于在无状态的远程计算环境中漫游配置文件。
- en: When a user performs a sign-in, a container is dynamically attached to the computing
    environment. You can also create profile containers using Azure NetApp Files to
    quickly provision SMB volumes for Windows Virtual Desktop.
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 当用户执行登录操作时，一个容器会动态地附加到计算环境中。您还可以使用 Azure NetApp Files 创建配置文件容器，以快速为 Windows
    虚拟桌面配置 SMB 卷。
- en: 'The following table provides a comparison between the different solutions available
    for Windows Virtual Desktop FSLogix profile container user profiles:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
- en: '![Comparison between different WVDFSLogix profile container user profiles](img/B17153_Table_05_08.jpg)'
  id: totrans-307
  prefs: []
  type: TYPE_IMG
- en: 'Table 5.8: Windows Virtual Desktop FSLogix profile container user profiles'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
- en: To look up the regional availability details for Azure NetApp Files and other
    products, visit [https://azure.microsoft.com/global-infrastructure/services/](https://azure.microsoft.com/global-infrastructure/services/).
  id: totrans-309
  prefs: []
  type: TYPE_NORMAL
- en: 'The following table provides a comparison of the storage solutions Azure Storage
    offers for Windows Virtual Desktop that are supported on Azure with FSLogix profile
    container user profiles:'
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
- en: '![Storage solutions for Windows Virtual Desktop supported on Azure with FSLogix
    profile container user profiles](img/B17153_Table_05_09.jpg)'
  id: totrans-311
  prefs: []
  type: TYPE_IMG
- en: 'Table 5.9: Storage solutions Azure Storage offers for Windows Virtual Desktop'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some relevant links to further information:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
- en: 'Microsoft compliance offerings: [https://docs.microsoft.com/compliance/regulatory/offering-home](https://docs.microsoft.com/compliance/regulatory/offering-home)'
  id: totrans-314
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Azure Files integration with AD: [https://docs.microsoft.com/azure/storage/files/storage-files-active-directory-overview](https://docs.microsoft.com/azure/storage/files/storage-files-active-directory-overview)'
  id: totrans-315
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Azure NetApp Files integration with AD: [https://docs.microsoft.com/azure/azure-netapp-files/azure-netapp-files-faqs#does-azure-netapp-files-support-azure-active-directory](https://docs.microsoft.com/azure/azure-netapp-files/azure-netapp-files-faqs#does-azure-netapp-files-support-azure-active-directory)'
  id: totrans-316
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Azure Monitor for Windows Virtual Desktop
  id: totrans-317
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: It is important for you to minimize the risk of failures in the Windows Virtual
    Desktop environment. Azure provides native integration with Azure Monitor to quickly
    identify issues through a single dashboard.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
- en: 'You can review the following activity logs:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
- en: Management activities
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Connections
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host registration
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Errors
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Checkpoints
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In order to monitor your Windows Virtual Desktop environment, you need to create
    a Log Analytics workspace via the Azure portal or PowerShell and then connect
    the virtual machines to Azure Monitor.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have onboarded your Windows Virtual Desktop into Log Analytics, you
    will be able to run custom queries using **Kusto Query Language** (**KQL**) to
    analyze the health of your Windows Virtual Desktop environment. A simple use case
    could be if there''s a need to find session duration by the user, as shown in
    the following code:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In this code, we are using a `let` statement for the `Event` instance called
    `WVDConnections` and filtering tables for rows that match the users with a `connected`
    state. Then, as good practice, we use `project` to select just the columns we
    need before performing the `join`. We pull events with the first `EventType` and
    with the second `EventType` and then join the two sets on `CorrelationId`.
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
- en: After this, we rename the timestamp column and sort the results in ascending
    order.
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
- en: 'You can use Azure Monitor workbooks to create custom visualizations of your
    Windows Virtual Desktop performance. You can find an example of a workbook for
    Windows Virtual Desktop here: [https://github.com/wvdcommunity/AzureMonitor/blob/master/WVD-ARM-monitoring-workbook.json](https://github.com/wvdcommunity/AzureMonitor/blob/master/WVD-ARM-monitoring-workbook.json).'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
- en: Windows Virtual Desktop partner integrations
  id: totrans-331
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Microsoft partners are a key component in order to fully enable an organization's
    remote work capabilities; there are Windows Virtual Desktop partner integrations
    with Citrix and VMware.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
- en: Citrix extended its Virtual Apps and Desktops offering to Azure, which can be
    consumed as a managed service and is available through the Azure Marketplace.
    This is a combination of new technology and new entitlements. It supports a multi-session
    Windows 10 experience and, if you have the appropriate RDS license, you can use
    Windows Server. It also supports persistent and non-persistent single-session
    or multi-session experiences.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
- en: 'You can read more about Virtual Apps and Desktops for Azure here: [https://azure.microsoft.com/services/virtual-desktop/citrix-virtual-apps-desktops-for-azure/](https://azure.microsoft.com/services/virtual-desktop/citrix-virtual-apps-desktops-for-azure/).'
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
- en: VMware is an approved Windows Virtual Desktop provider that simplifies the deployment
    of hybrid Windows Virtual Desktop environments through its Horizon Control Plane
    to enable a single management interface for both on-premises and cloud-based deployments.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
- en: 'Customers can leverage Windows 10 multi-sessions and the platform is available
    via the Horizon Universal License, which includes the ability to deploy VMware
    Horizon on any supported platform:'
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
- en: 'You can read more about VMware Horizon Cloud on Microsoft Azure here: [https://azuremarketplace.microsoft.com/marketplace/apps/vmware-inc.hc-azure](https://azuremarketplace.microsoft.com/marketplace/apps/vmware-inc.hc-azure
    )'
  id: totrans-337
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Quickstart Guide for Windows Virtual Desktop: [https://azure.microsoft.com/resources/quickstart-guide-to-windows-virtual-desktop/](https://azure.microsoft.com/resources/quickstart-guide-to-windows-virtual-desktop/)'
  id: totrans-338
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Windows Virtual Desktop Migration Guide for RDS: [https://azure.microsoft.com/resources/windows-virtual-desktop-migration-guide-for-remote-desktop-services/](https://azure.microsoft.com/resources/windows-virtual-desktop-migration-guide-for-remote-desktop-services/)'
  id: totrans-339
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary
  id: totrans-340
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this chapter, we reviewed common infrastructure-related challenges that organizations
    face when trying to enable remote work, and how Azure AD can help your organization
    keep its employees' identities and resources protected. We also learned how you
    can use Azure networking components to enable connectivity and secure access to
    your organization's workloads both on-premises and in the cloud. Lastly, we reviewed
    how you can provide a better end user experience through Windows Virtual Desktop
    and saw guidance on the sizing and configuration of your environment.
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一章中，我们回顾了组织在尝试启用远程工作时面临的常见基础设施挑战，以及 Azure AD 如何帮助你的组织保护员工的身份和资源。我们还学习了如何使用
    Azure 网络组件来实现连接性，并确保组织的工作负载在本地和云端的安全访问。最后，我们回顾了如何通过 Windows Virtual Desktop 提供更好的终端用户体验，并查看了关于环境规模和配置的指导。
- en: The next chapter will provide you with a security baseline and recommendations
    on how you can use the security services available to your organization so that
    you can apply standard security control frameworks to your Azure deployments and
    enforce governance across all your resources.
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 下一章将为你提供安全基准，并推荐如何使用可用的安全服务，以便你可以将标准的安全控制框架应用到你的 Azure 部署中，并在所有资源上强制执行治理。
