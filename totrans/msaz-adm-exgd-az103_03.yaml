- en: Analyzing Resource Utilization and Consumption
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we covered how to create and manage the different aspects
    of Azure subscriptions and resources.
  prefs: []
  type: TYPE_NORMAL
- en: This chapter will cover the second part of *M**anaging Azure Subscriptions and
    Resources *objective. In this chapter, we are going to illustrate how to monitor
    your different Azure resources using Azure Monitor. You will learn about the different
    capabilities of Azure Monitor and how to create and analyze different metrics
    and alerts, thereby using Azure Monitor to provide valuable insights about the
    performance and behavior of all your Azure resources. To finish this chapter,
    we're going to look at Azure Log Analytics and how it's integrated inside Azure
    Monitor. You'll also learn how to create Log Search Query functions.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Azure Monitor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating and analyzing metrics and alerts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Creating action groups
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring diagnostic settings on resources
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Log Analytics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Utilizing Log Search Query functions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Monitor
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Monitor is a monitoring solution in the Azure portal that delivers a comprehensive
    solution for collecting, analyzing, and acting on telemetry from cloud and on-premises
    environments. It can be used to monitor various aspects (for instance, the performance
    of applications) and identify issues affecting those applications and other resources
    that depend on them.
  prefs: []
  type: TYPE_NORMAL
- en: 'The data that is collected by Azure Monitor fits into two fundamental types:
    metrics and logs. Metrics describe an aspect of a system at a particular point
    in time and are displayed in numerical values. They are capable of supporting
    near real-time scenarios. Logs are different from metrics. They contain data that
    is organized into records, with different sets of properties for each type. Data
    like events, traces, and performance data are stored as logs. They can then be
    combined for analysis purposes.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Azure Monitor supports data collection from a variety of Azure resources, which
    are all displayed in the overview page in the Azure portal. Azure Monitor provides
    the following metrics and logs:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Application monitoring data**: This will consist of data about the functionality
    and performance of the application and the code that is written, regardless of
    its platform.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Guest OS monitoring data**: This will consist of data about the operating
    system on which your application is running. This could be running in any cloud
    or on-premises.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure resource monitoring data**: This will consist of data about the operation
    of an Azure resource.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure subscription monitoring data**: This will consist of data about the
    operation and management of an Azure subscription, as well as data about the health
    and operation of Azure itself.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure tenant monitoring data**: This will consist of data about the operation
    of tenant-level Azure services, such as Azure Active Directory.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Azure Monitor now integrates the capabilities of Log Analytics and Application
    Insights together. You can also keep using Log Analytics and Application Insights
    on their own.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have some basic knowledge about Azure Monitor, we are going to look
    at how to analyze alerts and metrics across subscriptions.
  prefs: []
  type: TYPE_NORMAL
- en: Creating and analyzing metrics and alerts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To analyze alerts and metrics across Azure Monitor, we need to go to the monitoring
    resource inside the Azure portal. In the upcoming sections, we will set up metrics
    and alerts and show you how to analyze them.
  prefs: []
  type: TYPE_NORMAL
- en: Metrics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Metrics describe an aspect of a system at a particular point in time and are
    displayed in numerical values. They are capable of supporting near real-time scenarios.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a metric
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To display the metrics for the various Azure resources in Azure Monitor, perform
    the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the left-hand menu, select Monitoring to open the Azure Monitor overview
    blade:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6730de09-ae3d-4896-8951-3e490ba7ac8c.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure Monitor overview
  prefs: []
  type: TYPE_NORMAL
- en: First, we're going to look at metrics. Therefore, in the left-hand menu, select **Metrics**,
    or select the **Explore Metrics** button from the overview blade.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the Metrics overview blade, click on the **+ Select a resource** button.
    A new blade will open up where you can select the subscription, the resource group,
    and the resource type. Select the subscription that was used for the demonstration
    of the previous chapter, select `PacktResourceGroup`, and then select the VM (in
    my case, Linux). You can filter by other resource types, as well:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/fced2333-7433-40e0-a817-3b436698a79a.png)'
  prefs: []
  type: TYPE_IMG
- en: Selecting the resources
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Apply**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Then, you can select the metric type. Select **CPU ****Credits Consumed**, for
    instance:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d8d61712-0cb0-4d74-873c-54ca969fe289.png)'
  prefs: []
  type: TYPE_IMG
- en: Metric type
  prefs: []
  type: TYPE_NORMAL
- en: Take some time to look at the different metrics that you can choose from. This
    may be a part of the exam questions.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can select a different type of aggregation as well, like the count, average,
    and more, in the filter box. In the top-right of the blade, you can select a different
    time range for your metric as well:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/76bedc2d-dd64-4018-91c6-fccea0679000.png)'
  prefs: []
  type: TYPE_IMG
- en: Time ranges
  prefs: []
  type: TYPE_NORMAL
- en: 'You can also pin this metric to the overview dashboard in the Azure portal.
    Therefore, click on the **Pin to dashboard** button, and then choose to pin it
    to the current dashboard or create a new dashboard for it. For now, select **Pin**
    **to current dashboard**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3645735b-7874-488b-b9c1-8270642b0412.png)'
  prefs: []
  type: TYPE_IMG
- en: Pin metric to dashboard
  prefs: []
  type: TYPE_NORMAL
- en: If you now select **Dashboard** from the left-hand menu, you'll see that this
    metric is added to it. This way, you can easily analyze this metric without the
    need to open Azure Monitor.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Metrics are also available directly from the Azure resource blades. So, for
    instance, if you have a VM, go to the VM resource by selecting it. Then, in the
    left-hand menu, under **Monitoring**, you can select **Metrics**.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we're going to look at how to set up and analyze alerts
    in Azure Monitor.
  prefs: []
  type: TYPE_NORMAL
- en: Alerts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With alerts, Azure can proactively notify you when critical conditions occur
    in the Azure or on-premises environment. Alerts can also attempt to take corrective
    actions automatically. Alert rules that are based on metrics will provide near
    real-time alerting, based on the metric. Alerts that are created based on logs
    can merge data from different resources together.
  prefs: []
  type: TYPE_NORMAL
- en: The alerts in Azure Monitor use action groups, which are unique sets of recipients
    and actions that can be shared across multiple rules. These action groups can
    use Webhooks to start external actions, based on the requirements that are set
    up for this alert. These external actions can then be picked up by different Azure
    resources, like runbooks, functions, or logic apps. Webhooks can also be used
    for adding these alerts to external **IT Service Management** (**ITSM**) tools.
  prefs: []
  type: TYPE_NORMAL
- en: You can also set alerts for all the different Azure resources. In the following
    sections, we are going to create an alert.
  prefs: []
  type: TYPE_NORMAL
- en: Creating an alert
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To create an alert, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: From the Azure Monitor overview blade, in the left-hand menu, select **Alerts**.
    You can also go to the alerts settings by clicking on **Create alert** in order to
    create an alert directly**.**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the Alerts blade, click on **+ New alert rule **in the top menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/144ea88e-610f-43c6-a992-66e27f3e4eae.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating a new alert
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Create rule** blade is displayed. Here, you can create the rule and action
    groups. To create a new rule, you need to first select the resource. Click on
    the **Select** button under the RESOURCE section:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/dbdde4fc-b227-45cc-bf08-195ef17f1e24.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating a new rule
  prefs: []
  type: TYPE_NORMAL
- en: 'In the next blade, you can filter by the subscription and resource type. Select
    Virtual machines:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/aa20ea67-3a97-48b9-9523-5051c4dd5178.png)'
  prefs: []
  type: TYPE_IMG
- en: Filtering by subscription and resource type
  prefs: []
  type: TYPE_NORMAL
- en: Select the VM that we created in the previous chapter from the list and click **Done**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now that we have a resource selected, we're going to set up the condition. Click
    on **Add condition**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The condition blade is open, and so we can filter by a certain signal. Select
    **Percentage CPU** and click **Done**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1dfccb7a-fb8f-4901-8186-10c2198469b3.png)'
  prefs: []
  type: TYPE_IMG
- en: Filtering on a signal
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, you can set the alert logic for this alert. You can choose multiple operators,
    set the aggregation type, and set the threshold value for this alert. Set the
    following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Operator**: Greater than'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Aggregation type**: Average'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Threshold Value**: 90%'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Leave Evaluated based on with its default settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This alert will notify you when the CPU of the virtual machines is greater
    than 90% over a five minute period of time. Azure Monitor will check this every
    minute:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/901eb9dd-8f07-419d-ae00-26c3265180f3.png)'
  prefs: []
  type: TYPE_IMG
- en: Setting condition values
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Done** to create this condition.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, we have to create an action group to send the alert to. This is then responsible
    for handling the alert and taking further action on it. The action group that
    you create here can be reused across other alerts as well. So, in our case, we
    will create an email action group that will send out an email to a certain email
    address. After its creation, you can add this existing action group to other alerts.
    Under **Action group**, select the **Create new** button.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the Action Group blade, add the following settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Action group name**: `Send email`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Short name**: `email`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Subscription**: Select the subscription where the VM is created, as well'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group**: Select Default-ActivitiyLogAlerts (to be created)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Then, we have to provide the actual action. Add the following values:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Action name**: `email`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Action type**: Email/SMS/Push/Voice'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Then, select Edit details and select the Email checkbox. Provide an email address
    and click on the OK button:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/47529632-fd70-4510-966f-879c0a612eda.png)'
  prefs: []
  type: TYPE_IMG
- en: Creating an action group
  prefs: []
  type: TYPE_NORMAL
- en: Click on **OK** again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Finally, you have to specify an alert name, set the severity level of the alert,
    and click on **Create alert rule**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2a72ed4b-9c8d-41bc-b4b6-605832027b16.png)'
  prefs: []
  type: TYPE_IMG
- en: Alert settings
  prefs: []
  type: TYPE_NORMAL
- en: We have now created an alert and an action group that will alert a user via
    email when the CPU goes over 90%. In the next section, we're going to configure
    diagnostic settings on resources.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring diagnostic settings on resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can also configure diagnostic settings on different Azure resources. There
    are two types of diagnostic logs available in Azure Monitor:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Tenant logs**: These logs consist of all the tenant-level services that exist
    outside of an Azure subscription. An example of this is the Azure Active Directory
    logs.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource logs**: These logs consist of all the data from the resources that
    are deployed inside an Azure subscription; for example, virtual machines, storage
    accounts, and network security groups.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The contents of these logs are different for every Azure resource. These logs
    differ from guest OS-level diagnostic logs. To collect OS-level logs, an agent
    needs to be installed on the virtual machine. The diagnostic logs don't require
    an agent to be installed; they can be accessed directly from the Azure portal.
  prefs: []
  type: TYPE_NORMAL
- en: The logs that can be accessed are stored inside a storage account and can be
    used for auditing or manual inspection purposes. You can specify the retention
    time in days by using the resource diagnostic settings.You can also stream the
    logs to event hubs to analyze them in PowerBI, or insert them into a third-party
    service. These logs can also be analyzed with Azure Monitor. Then, there will
    be no need to store them in a storage account first.
  prefs: []
  type: TYPE_NORMAL
- en: Enabling diagnostic settings
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To enable the diagnostic settings for resources, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go to the VM that we created in the previous chapter again. Make sure that the
    VM is running, and in the left-hand menu, under **Monitoring**, select **Diagnostic
    settings**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Diagnostic Settings blade will open up. You will need to select a storage
    account where the metrics can be stored.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click on the **Enable guest-level monitoring** button to update the diagnostic
    settings for the virtual machine:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/83053967-e924-44a4-8e7b-909ac8faf189.png)'
  prefs: []
  type: TYPE_IMG
- en: Enabling diagnostic settings for a virtual machine
  prefs: []
  type: TYPE_NORMAL
- en: When the settings are updated, you can go to Metrics in the top menu to set
    the metrics that are collected. The syslog blade is used for setting the minimum
    log level.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: New metrics will be available from the metrics blade after enabling diagnostic
    logging in Azure Monitor. You can analyze them in the same way that we did earlier
    in this chapter, in the *Metrics* section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the next section, we're going to look at the Azure Log Analytics service,
    which is now a part of Azure Monitor as well.
  prefs: []
  type: TYPE_NORMAL
- en: Viewing alerts in Log Analytics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Log Analytics is a service that collects telemetry data from various Azure
    resources and on-premises resources. All of that data is stored inside a Log Analytics
    workspace, which is based on the Azure Data Explorer. It uses the Kusto Query
    Language, which is also used by Azure Data Explorer to retrieve and analyze the
    data.
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing this data can be done from Azure Monitor. All the analysis functionalities
    are integrated in there. The term Log Analytics now primarily applies to the blade
    in the Azure portal where you can analyze metric data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before we are able to display, monitor, and query the logs from Azure Monitor,
    we need to create a Log Analytics workspace. For that, we have to perform the
    following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Create a new resource**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Type `Log Analytics` in the search box and create a new workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Add the following values:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Log Analytics workspace**: `PacktWorkspace`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Subscription**: Select a subscription'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Resource group**: Create a new one and call it `PacktWorkspace`'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Location**: West US'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pricing tier**: Keep the default one, which is **per GB**'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Click on the **OK **button to create the workspace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can also create this workspace from Azure Monitor. Go to the Azure Monitor
    blade, and under **Insights** in the left-hand menu, select **More**. When no
    workspace has been created, Azure will ask to create one.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have created a Log Analytics workspace, we can use it inside Azure
    Monitor to create some queries to retrieve data. We will do this in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: Utilizing Log Search Query functions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Azure Monitor is now integrated with the features and capabilities that Log
    Analytics was offering. This also includes creating search queries across the
    different logs and metrics by using the Kusto Query Language.
  prefs: []
  type: TYPE_NORMAL
- en: To retrieve any type of data from Azure Monitor, a query is required. Whether
    you are configuring an alert rule, analyzing data in the Azure portal, retrieving
    data using the Azure Monitor Logs API, or being notified of a particular condition,
    a query is used.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following list provides an overview of all the different ways queries are
    used by Azure Monitor:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Portal**: From the Azure portal, an interactive analysis of log data can
    be performed. In there, you can create and edit queries and analyze the results
    in a variety of formats and visualizations.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Dashboards**: The results of a query can be pinned to a dashboard. This way,
    results can be visualized and shared with other users.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Views**: By using the View Designer in Azure Monitor, you can create custom
    views of your data. This data is provided by queries as well.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Alert rules**: Alert rules are also made up of queries.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Export**: Exports of data to Excel or PowerBI are created with queries. The
    query defines the data to export.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Azure Monitor Logs API**: The Azure Monitor Logs API allows any REST API
    client to retrieve log data from the workspace. The API request includes a query
    to retrieve the data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**PowerShell**: You can run a PowerShell script from a command line or an Azure
    Automation runbook that uses `Get-AzOperationalInsightsSearchResults` to retrieve
    log data from Azure Monitor. You need to create a query for this cmdlet to retrieve
    the data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the following section, we are going to create some queries to retrieve data
    from the logs in Azure Monitor.
  prefs: []
  type: TYPE_NORMAL
- en: Querying logs in Azure Monitor
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To query logs in Azure monitor, perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the left-hand menu, select Monitoring to open the Azure Monitor overview
    blade. Under **Insights**,select **More**. This will open the Log Analytics workspace
    that we created in the previous step.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'On the overview page, click on **Logs** in the top menu. This will open the
    Azure Monitor query editor:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6be43f8e-e690-43d1-a3fe-27cbf3a03a4e.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure Monitor query editor
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, you can select some default queries. They are displayed at the bottom
    part of the screen. There are queries for retrieving unavailable computers, the
    last heartbeat of a computer, and much more. Add the following queries to the
    query editor window to retrieve data:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This query will retrieve the top 10 computers with the most error events over
    the past day:'
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This query will create a line chart with the processor utilization for each
    computer from last week:'
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: A detailed overview and tutorial on how to get started with the Kusto Query
    Language is beyond the scope of this book. If you want to find out more about
    this query language, you can refer to [https://docs.microsoft.com/en-us/azure/azure-monitor/log-query/get-started-queries](https://docs.microsoft.com/en-us/azure/azure-monitor/log-query/get-started-queries).
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered the second part of the *Managing Azure Subscriptions
    and Resources* objective. We covered the various aspects of Azure Monitor and
    how you can use metrics to monitor all of your Azure resources and alerts in order
    to get notified when certain things are happening with your Azure resources. We
    also used Azure Log Analytics and created queries so that we could get valuable
    data out of the logs.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will cover the third (and final) part of this exam objective.
    In that chapter, we will cover how to manage **role-based access control** (**RBAC**).
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Answer the following questions to test your knowledge of the information in
    this chapter. You can find the answers in the *Assessments* section at the end
    of this book:'
  prefs: []
  type: TYPE_NORMAL
- en: Is Azure Log Analytics now a part of Azure Monitor?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Suppose that you want to create a query to retrieve specific log data from a
    virtual machine. Do you need to write a SQL statement to retrieve this?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Are action groups used to enable metrics for Azure Monitor?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Yes'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'No'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can check out the following links for more information about the topics
    that were covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Azure Monitor overview*: [https://docs.microsoft.com/en-us/azure/azure-monitor/overview](https://docs.microsoft.com/en-us/azure/azure-monitor/overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Collect and consume log data from your Azure resources*: [https://docs.microsoft.com/en-us/azure/azure-monitor/platform/diagnostic-logs-overview](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/diagnostic-logs-overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Analyze log data in Azure Monitor*: [https://docs.microsoft.com/en-us/azure/azure-monitor/log-query/log-query-overview](https://docs.microsoft.com/en-us/azure/azure-monitor/log-query/log-query-overview)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Create custom views by using View Designer in Azure Monitor*: [https://docs.microsoft.com/en-us/azure/azure-monitor/platform/view-designer](https://docs.microsoft.com/en-us/azure/azure-monitor/platform/view-designer)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Azure Monitor naming and terminology changes*: [https://docs.microsoft.com/en-us/azure/azure-monitor/terminology](https://docs.microsoft.com/en-us/azure/azure-monitor/terminology)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
