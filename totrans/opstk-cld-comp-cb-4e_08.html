<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;8.&#xA0;Swift &#x2013; OpenStack Object Storage" id="344B21-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08" class="calibre1"/>Chapter 8. Swift – OpenStack Object Storage</h1></div></div></div><p class="calibre10">In this chapter, we will cover the following topics:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Introduction – OpenStack Object Storage</li><li class="listitem">Creating object containers</li><li class="listitem">Deleting object containers</li><li class="listitem">Uploading objects</li><li class="listitem">Uploading large objects</li><li class="listitem">Downloading objects</li><li class="listitem">Deleting objects</li><li class="listitem">Container ACLs</li></ul></div></div>

<div class="book" title="Chapter&#xA0;8.&#xA0;Swift &#x2013; OpenStack Object Storage" id="344B21-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Introduction – OpenStack Object Storage"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch08lvl1sec102" class="calibre1"/>Introduction – OpenStack Object Storage</h1></div></div></div><p class="calibre10">OpenStack <a id="id468" class="calibre1"/>Object Storage, also known as <span class="strong"><strong class="calibre2">Swift</strong></span>, is the service that allows for massively scalable and highly redundant storage on commodity hardware. This <a id="id469" class="calibre1"/>service is implemented by Rackspace as Cloud Files, and it is also analogous to Amazon's S3 storage service and managed in a similar way under OpenStack. With OpenStack Object Storage, we can store many objects of virtually unlimited size—restricted only by the available hardware—and grow our environment as needed, to accommodate our storage. The highly redundant nature of OpenStack Object Storage is ideal for archiving data (such as logs and backup archives) as well as for providing a storage system that OpenStack Compute can use for virtual machine instance images.</p><p class="calibre10">The architecture of OpenStack Object Storage is straightforward. There is the API service that runs on the controller nodes. Then there are Swift proxy services that can either be deployed onto the controller nodes, or separated onto their own dedicated servers—depending on your requirements, followed by the actual storage nodes that store the data. The storage nodes are the servers that are designed to scale out as your requirements for storage grows.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note38" class="calibre1"/>Note</h3><p class="calibre10">Scaling the characteristics and design of Swift is beyond the scope of this book.</p></div><p class="calibre10">A typical, simplified <a id="id470" class="calibre1"/>view of the architecture is show here:</p><div class="mediaobject"><img src="../images/00151.jpeg" alt="Introduction – OpenStack Object Storage" class="calibre16"/></div><p class="calibre17"> </p><p class="calibre10">Essentially, requests (for example, to upload or download an object) are sent to the API through the load balance pool, and then the data is sent through to the physical storage nodes by the <code class="email">Swift-Proxy</code> service. The <code class="email">Swift-Proxy</code> service would fetch and store the data back to and from the end user.</p><p class="calibre10">As the name states, OpenStack Object Storage operates on what is known as objects. Objects can be anything from a file, to an object named as a complete folder and filename – to OpenStack Object Storage, anything it sees, regardless of the filename, is still one single <a id="id471" class="calibre1"/>object. Objects are stored in <span class="strong"><strong class="calibre2">Containers</strong></span>. A great <a id="id472" class="calibre1"/>analogy is a bucket. In a bucket, you can store anything that would fit in it, from grains of sand to tools you have laying in your shed!</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Creating object containers" id="352RK1-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec103" class="calibre1"/>Creating object containers</h1></div></div></div><p class="calibre10">To get <a id="id473" class="calibre1"/>started using OpenStack Object Storage, we must first create a <span class="strong"><strong class="calibre2">container</strong></span>. A container in this case is quite similar to a folder on Windows or Linux file directory. However, containers cannot be nested, though deep structures can be created in a fashion similar to the nested folder structure using both container and object names (pseudo folders) when we come to uploading the objects that are stored in these containers. Names we assigned containers and objects are analogous to labels that allow us to interpret as folder structures through the use of a <code class="email">/</code> character in these labels.</p></div>

<div class="book" title="Creating object containers" id="352RK1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec311" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you are logged on to a correctly configured OpenStack client as described in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, with the <code class="email">cookbook4</code> password; we have also granted this user with the <code class="email">swiftoperator</code> privileges.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="tip77" class="calibre1"/>Tip</h3><p class="calibre10">Refer to <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, for details of setting up your environment to use OpenStack command-line client.</p></div></div></div>

<div class="book" title="Creating object containers" id="352RK1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec312" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To create a Swift <code class="email">container</code> on our environment, follow these steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">To create a container, execute the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container create books</strong></span>
</pre></div></li><li class="listitem" value="2">Once the container is created, you will see the following output:<div class="mediaobject"><img src="../images/00152.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="3">To view all the available containers, type this command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container list</strong></span>
</pre></div><p class="calibre22">This will give an output like the following:</p><div class="mediaobject"><img src="../images/00153.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="4">Once <a id="id474" class="calibre1"/>the container is created, we can set additional details or <span class="strong"><strong class="calibre2">metadata</strong></span> on it by executing the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container set books --property title=cookbooks</strong></span>
</pre></div></li><li class="listitem" value="5">To <a id="id475" class="calibre1"/>view container details, type the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container show books</strong></span>
</pre></div><p class="calibre22">This will give the following output:</p><div class="mediaobject"><img src="../images/00154.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="6">As described in the introduction, names that we assigned to containers and objects are very much like labels; so, to create a pseudo-folder in the container, use <code class="email">/</code> delimiter in the container name:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container create books/chapter1</strong></span>
</pre></div><p class="calibre22">This will return output like the following:</p><div class="mediaobject"><img src="../images/00155.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="7">To view details of the pseudo-folder, execute the <code class="email">container show</code> command by including the full pseudo-folder name:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container show books/chapter1</strong></span>
</pre></div><p class="calibre22">This will give the information like the following:</p><div class="mediaobject"><img src="../images/00156.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Creating object containers" id="352RK1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How it works…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec313" class="calibre1"/>How it works…</h2></div></div></div><p class="calibre10">In OpenStack Object Storage, users with the <code class="email">admin</code> or <code class="email">swiftoperator</code> privileges can utilize the Object Storage service. To do so, we first must create <span class="strong"><strong class="calibre2">containers</strong></span>, where the objects will be <a id="id476" class="calibre1"/>stored. Containers may not be nested, though we may create pseudo-folders using the <code class="email">/</code> delimiter in the container name. To create a container, follow this command-line syntax:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container create container_name</strong></span>
</pre></div><p class="calibre10">To list available containers, use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container list</strong></span>
</pre></div><p class="calibre10">We can also set metadata on each container. Use the following command for setting additional info on a container:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container set container_name</strong></span>
<span class="strong"><strong class="calibre2">    --property key=value</strong></span>
</pre></div><p class="calibre10">Multiple pairs of metadata may be set on each container.</p><p class="calibre10">To view container details, execute this command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container show &lt;container_name&gt;</strong></span>
</pre></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Deleting object containers" id="361C61-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec104" class="calibre1"/>Deleting object containers</h1></div></div></div><p class="calibre10">Deleting <a id="id477" class="calibre1"/>OpenStack Object Storage containers is quite simple. Any container can be deleted, for as long as they are empty.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note39" class="calibre1"/>Note</h3><p class="calibre10">In this case, the OpenStack CLI has different behavior from the Swift CLI tool. The Swift CLI will <span class="strong"><em class="calibre18">delete container with all of its</em></span> contents, while the OpenStack CLI will not. In this example, we are using the OpenStack CLI.</p></div></div>

<div class="book" title="Deleting object containers" id="361C61-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec314" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that <a id="id478" class="calibre1"/>you are logged on to a correctly configured OpenStack client and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span> with the <code class="email">cookbook4</code> password. We have also granted this user the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Refer to <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, for details of setting up your environment to use OpenStack command-line client.</p></div></div>

<div class="book" title="Deleting object containers" id="361C61-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec315" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To delete a Swift container in our environment, execute the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, list the available containers:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container list</strong></span>
</pre></div><p class="calibre22">This will give an output like the following:</p><div class="mediaobject"><img src="../images/00153.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="2">View container details to make sure that it is empty:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container show books</strong></span>
</pre></div><p class="calibre22">This will show an output like the following:</p><div class="mediaobject"><img src="../images/00157.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="3">Now delete the container using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container delete books</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note40" class="calibre1"/>Note</h3><p class="calibre10">There is no output from this command.</p></div></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Deleting object containers" id="361C61-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How it works…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec316" class="calibre1"/>How it works…</h2></div></div></div><p class="calibre10">In OpenStack <a id="id479" class="calibre1"/>Object Storage, empty containers can be deleted by a user that created them. First, we must make sure that the container is empty by viewing its details:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container show container_name</strong></span>
</pre></div><p class="calibre10">Then, delete the container with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container delete container_name</strong></span>
</pre></div><p class="calibre10">Verify that container is gone by listing available containers:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container list</strong></span>
</pre></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Uploading objects" id="36VSO1-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec105" class="calibre1"/>Uploading objects</h1></div></div></div><p class="calibre10">Once we <a id="id480" class="calibre1"/>have created one or more containers, we can start uploading objects to them. While OpenStack Object Storage does not support nested containers, we can simulate folders or file directories with object names. This presents similar structure to the pseudo-folders we used in container names and both achieve similar end goals to a user expecting a tree-like structure to their object storage use.</p></div>

<div class="book" title="Uploading objects" id="36VSO1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec317" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you are logged on to a correctly configured OpenStack client and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, with the <code class="email">cookbook4</code> password; we have also granted this user <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Refer to <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, for details of setting up your environment to use OpenStack command-line client.</p></div></div>

<div class="book" title="Uploading objects" id="36VSO1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec318" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To upload objects to an OpenStack Object Storage container, follow the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">We will upload the <code class="email">intro.txt</code> file into the <code class="email">books</code> container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object create books intro.txt</strong></span>
</pre></div><p class="calibre22">This will give the following output:</p><div class="mediaobject"><img src="../images/00158.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="2">List objects in a container by providing the container name:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books</strong></span>
</pre></div><p class="calibre22">This will give an output like the following:</p><div class="mediaobject"><img src="../images/00159.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p><div class="note" title="Note"><h3 class="title2"><a id="note41" class="calibre1"/>Note</h3><p class="calibre10">Here <code class="email">chapter1</code> is the <span class="strong"><em class="calibre18">pseudo-folder</em></span> we created in the <span class="strong"><em class="calibre18">Creating object containers</em></span> recipe and it shows as an object.</p></div></li><li class="listitem" value="3">We can <a id="id481" class="calibre1"/>upload an object into the pseudo-folder called <code class="email">books/chapter1</code> as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object create books/chapter1 swift.txt</strong></span>
</pre></div><p class="calibre22">This will give an output like the following:</p><div class="mediaobject"><img src="../images/00160.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="4">To list objects in a container, issue the following against the container name:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books</strong></span>
</pre></div><p class="calibre22">This will list the objects available under this container:</p><div class="mediaobject"><img src="../images/00161.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="5">To list all objects in the pseudo-folder container name, use a <code class="email">prefix</code> flag:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books --prefix chapter1/</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00162.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p><div class="note" title="Note"><h3 class="title2"><a id="tip78" class="calibre1"/>Tip</h3><p class="calibre10">You can use <code class="email">--prefix</code> to list any object that begins with the prefixed letters.</p></div></li><li class="listitem" value="6">To list <a id="id482" class="calibre1"/>all top-level objects in a container, use a <span class="strong"><strong class="calibre2">delimiter</strong></span> flag. In this example, the delimiter is <code class="email">/</code>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books --delimiter /</strong></span>
</pre></div><div class="mediaobject"><img src="../images/00159.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="7">To show <a id="id483" class="calibre1"/>information about an object, issue the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object show books chapter1/swift.txt</strong></span>
</pre></div><p class="calibre22">This will give information about that object:</p><div class="mediaobject"><img src="../images/00163.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Uploading objects" id="36VSO1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How it works…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec319" class="calibre1"/>How it works…</h2></div></div></div><p class="calibre10">In order <a id="id484" class="calibre1"/>to store files in OpenStack Object Storage, <span class="strong"><strong class="calibre2">objects</strong></span> have to be uploaded to a <span class="strong"><strong class="calibre2">container</strong></span>. Containers cannot be nested; however, pseudo-folders or pseudo-directories can be created using the <code class="email">/</code> delimiter. Once a container is created, you can upload files by using the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object create container_name object_1 [object_2 …]</strong></span>
</pre></div><div class="informalexample" title="Note"><h3 class="title2"><a id="tip79" class="calibre1"/>Tip</h3><p class="calibre10">Multiple objects can be uploaded with one command.</p></div><p class="calibre10">To list objects that were uploaded to a container, execute the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list container_name</strong></span>
</pre></div><p class="calibre10">When listing objects in a container, enable filtering using the <code class="email">--prefix</code> and <code class="email">--delimiter</code> flags.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note42" class="calibre1"/>Note</h3><p class="calibre10">By default, a maximum of 10,000 objects will be listed. Use pagination or the <code class="email">--all</code> flag to view more than the default number of objects.</p></div><p class="calibre10">To view details of individual object, use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object show container_name object_name</strong></span>
</pre></div><div class="informalexample" title="Note"><h3 class="title2"><a id="note43" class="calibre1"/>Note</h3><p class="calibre10">Regular object size is limited in Swift. By default, only objects 5 GB or smaller can be uploaded with the <code class="email">openstack object create</code> command. Refer to the <span class="strong"><em class="calibre18">Uploading large objects</em></span> recipe on how to upload large objects.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Uploading large objects"><div class="book" id="37UDA2-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec106" class="calibre1"/>Uploading large objects</h1></div></div></div><p class="calibre10">Every OpenStack <a id="id485" class="calibre1"/>Object Storage cluster has a limit on how large the uploaded objects can be. Usually that limit is set to 5 GB, though each cluster can have its own limit. However, this doesn't mean that you are limited to uploading only 5 GB or smaller objects to OpenStack Object Storage. Swift provides large object support via already configured and deployed middleware by splitting up large objects into smaller parts. There are two types of large object support: dynamic and static.</p></div>

<div class="book" title="Uploading large objects">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec320" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you are logged on to a correctly configured OpenStack client and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span> with the <code class="email">cookbook4</code> password. We also granted this user with the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Since the OpenStack CLI does not provide all the functionality required through the individual OpenStack project client, we will need to use the Swift CLI for this recipe. Ensure that you have the Swift command-line client installed. If you do not, install it:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">pip install python-swiftclient</strong></span>
</pre></div></div></div>

<div class="book" title="Uploading large objects">
<div class="book" title="How to do it.."><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec321" class="calibre1"/>How to do it..</h2></div></div></div><p class="calibre10">To upload large objects to OpenStack Object Storage container, follow these steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, we can list available containers with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift list</strong></span>
</pre></div><p class="calibre22">This will give a list of the containers we have:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">books</strong></span>
</pre></div></li><li class="listitem" value="2">To upload a large file, we will specify the <span class="strong"><em class="calibre18">segment size</em></span> of the objects in <span class="strong"><em class="calibre18">bytes</em></span> with the <code class="email">–S</code> flag:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift upload -S 25000 books nova.txt</strong></span>
</pre></div><p class="calibre22">This will show the object being split into <span class="strong"><strong class="calibre2">segments</strong></span> in the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">nova.txt segment 1</strong></span>
<span class="strong"><strong class="calibre2">nova.txt segment 0</strong></span>
<span class="strong"><strong class="calibre2">nova.txt segment 5</strong></span>
<span class="strong"><strong class="calibre2">nova.txt segment 2</strong></span>
<span class="strong"><strong class="calibre2">nova.txt segment 3</strong></span>
<span class="strong"><strong class="calibre2">nova.txt segment 4</strong></span>
<span class="strong"><strong class="calibre2">nova.txt</strong></span>
</pre></div><p class="calibre22">In this example, the segment size is 25000 bytes, and our 128 K <code class="email">nova.txt</code> file was split into 6 segments before being uploaded to the Swift cluster.</p></li><li class="listitem" value="3">Verify that the <a id="id486" class="calibre1"/>file has been uploaded by listing the available objects in the container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift list books</strong></span>
</pre></div><p class="calibre22">This shows our <code class="email">nova.txt</code> file available:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">nova.txt</strong></span>
</pre></div><p class="calibre22">Even though the file was split into 6 parts for uploading, it appears as one file in Swift's <code class="email">books</code> container. The segments are listed separately in a new container.</p></li><li class="listitem" value="4">To view the available containers, issue this command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift list</strong></span>
</pre></div><p class="calibre22">This gives us our containers with a new one automatically created:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">books</strong></span>
<span class="strong"><strong class="calibre2">books_segments</strong></span>
</pre></div><p class="calibre22">You will notice that a new <code class="email">books_segments</code> container has been created automatically.</p></li><li class="listitem" value="5">List objects in the <code class="email">books_segments</code> container to view individual objects:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift list books_segments</strong></span>
</pre></div><p class="calibre22">This shows our segmented file objects:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000000</strong></span>
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000001</strong></span>
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000002</strong></span>
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000003</strong></span>
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000004</strong></span>
<span class="strong"><strong class="calibre2">nova.txt/1512361523.073429/131024/25000/00000005</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note44" class="calibre1"/>Note</h3><p class="calibre10">Do not modify or delete these objects individually.</p></div></li><li class="listitem" value="6">View the details of the uploaded object in the <code class="email">books</code> container using the <code class="email">stat</code> command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift stat books nova.txt</strong></span>
</pre></div><p class="calibre22">This gives a number of details about our <code class="email">nova.txt</code> file in the <code class="email">books</code> container:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">               Account: AUTH_402e8fe274c143ea91fe905a1b8c7614</strong></span>
<span class="strong"><strong class="calibre2">             Container: books</strong></span>
<span class="strong"><strong class="calibre2">                Object: nova.txt</strong></span>
<span class="strong"><strong class="calibre2">          Content Type: text/plain</strong></span>
<span class="strong"><strong class="calibre2">        Content Length: 131024</strong></span>
<span class="strong"><strong class="calibre2">         Last Modified: Sun, 17 Dec 2017 06:36:32 GMT</strong></span>
<span class="strong"><strong class="calibre2">                  ETag: "cd0ef1b80a6261f0b6b7db9efa739938"</strong></span>
<span class="strong"><strong class="calibre2">              Manifest: books_segments/nova.txt/1512361523.073429/131024/25000/Meta Mtime: 1512361523.073429</strong></span>
<span class="strong"><strong class="calibre2">         Accept-Ranges: bytes</strong></span>
<span class="strong"><strong class="calibre2">           X-Timestamp: 1513492591.13264</strong></span>
<span class="strong"><strong class="calibre2">            X-Trans-Id: tx4fa6e7a4e53a459a86430-005a3611ad</strong></span>
<span class="strong"><strong class="calibre2">X-Openstack-Request-Id: tx4fa6e7a4e53a459a86430-005a3611ad</strong></span>
</pre></div><p class="calibre22">Take a look at the <code class="email">manifest</code> field in the information provided. The <code class="email">manifest</code> field will include the <code class="email">container</code> details that was created for individual segments, the original file size, and segment size.</p></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Uploading large objects">
<div class="book" title="How it works"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec322" class="calibre1"/>How it works</h2></div></div></div><p class="calibre10">Since the <a id="id487" class="calibre1"/>OpenStack CLI does not provide large file upload support at the time of this recipe's writing, we will use the Swift command-line client. In order to store large files in OpenStack Object Storage, objects have to be split up or segmented before uploading to a container. This segmentation is done for us by specifying the <code class="email">-S</code> flag in the <code class="email">swift upload</code> command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift upload -S size_in_bytes container large_object</strong></span>
</pre></div><p class="calibre10">When uploading large files, Swift automatically creates a new container and pseudo-folders for individual segments of the uploaded object. Individual segments may be listed the same way as regular objects; however, do not manipulate them directly.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Downloading objects" id="38STS1-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec107" class="calibre1"/>Downloading objects</h1></div></div></div><p class="calibre10">Once objects <a id="id488" class="calibre1"/>have been uploaded to a container, one may also want to download them. In this recipe, we will show you how to download objects to your local disk.</p></div>

<div class="book" title="Downloading objects" id="38STS1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec323" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you <a id="id489" class="calibre1"/>are logged on to a correctly configured OpenStack client and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span> with the <code class="email">cookbook4</code> password. We have also granted this user the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Refer to <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, for details of setting up your environment to use the OpenStack command-line client.</p></div></div>

<div class="book" title="Downloading objects" id="38STS1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec324" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To download objects from a Swift cluster, carry out the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">List the available objects in a container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books</strong></span>
</pre></div><p class="calibre22">This will give a list of objects in our <code class="email">books</code> container:</p><div class="mediaobject"><img src="../images/00164.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="2">To download the desired file, for example, <code class="email">intro.txt</code>, issue the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object save books intro.txt</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note45" class="calibre1"/>Note</h3><p class="calibre10">There is no output to this command. The file will be saved to the current directory.</p></div></li><li class="listitem" value="3">We can also download a file and specify the destination file:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object save books nova.txt --file /tmp/nov</strong></span>
<span class="strong"><strong class="calibre2">a.txt</strong></span>
</pre></div></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Downloading objects" id="38STS1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How it works…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec325" class="calibre1"/>How it works…</h2></div></div></div><p class="calibre10">In order <a id="id490" class="calibre1"/>to download files from the OpenStack Object Storage, issue the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object save container object --file file_name</strong></span>
</pre></div><p class="calibre10">The <code class="email">--file</code> flag is optional. If not specified, the object will be saved to the current directory.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note46" class="calibre1"/>Note</h3><p class="calibre10">Large objects do not require special treatment when downloading; the same command will work on large and small objects.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Deleting objects" id="39REE1-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec108" class="calibre1"/>Deleting objects </h1></div></div></div><p class="calibre10">Deleting <a id="id491" class="calibre1"/>objects from OpenStack Object Storage is fairly trivial, whether for small or large files.</p></div>

<div class="book" title="Deleting objects" id="39REE1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec326" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you are logged on to a correctly configured OpenStack client and can access the OpenStack environment as a user with the <code class="email">swiftoperator</code> privileges. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, with the <code class="email">cookbook4</code> password. We have also granted this user the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Refer to <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, for details of setting up your environment to use the OpenStack command-line client.</p></div></div>

<div class="book" title="Deleting objects" id="39REE1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec327" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To delete objects from our Swift cluster, carry out the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">List available objects in a container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books</strong></span>
</pre></div><p class="calibre22">This will give a list of objects in our <code class="email">books</code> container:</p><div class="mediaobject"><img src="../images/00164.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="2">Delete the object from a container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object delete books intro.txt</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note47" class="calibre1"/>Note</h3><p class="calibre10">There will be no output from this command.</p></div></li><li class="listitem" value="3">List objects in the <code class="email">books</code> container after deletion:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object list books</strong></span>
</pre></div><p class="calibre22">The <a id="id492" class="calibre1"/>container listing will show that <code class="email">intro.txt</code> is no longer present:</p><div class="mediaobject"><img src="../images/00165.jpeg" alt="How to do it…" class="calibre16"/></div><p class="calibre23"> </p></li><li class="listitem" value="4">To delete <span class="strong"><em class="calibre18">all objects</em></span> from a container and <span class="strong"><em class="calibre18">then delete container</em></span>, issue the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack container delete -r books</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note48" class="calibre1"/>Note</h3><p class="calibre10">There is no output to this command.</p></div></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Deleting objects" id="39REE1-189e69df43a248268db97cde1b1a8e47">
<div class="book" title="How it works"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec328" class="calibre1"/>How it works</h2></div></div></div><p class="calibre10">In order to delete files from the OpenStack Object Storage cluster, specify the container and object that should be deleted with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">openstack object delete container object</strong></span>
</pre></div><p class="calibre10">Use the <code class="email">-r</code> flag for deleting container and all its contents.</p></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Container ACLs"><div class="book" id="3APV02-189e69df43a248268db97cde1b1a8e47"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch08lvl1sec109" class="calibre1"/>Container ACLs</h1></div></div></div><p class="calibre10">OpenStack <a id="id493" class="calibre1"/>Object Storage containers are usually owned by the user that created them. However, through Swift's <span class="strong"><strong class="calibre2">ACLs</strong></span> (<span class="strong"><strong class="calibre2">Access Control Lists</strong></span>), containers <a id="id494" class="calibre1"/>can be made accessible to different OpenStack users or made completely public. The owner of the container can set specific read and write rules. The read and write rules must be set separately and have to be enabled explicitly on each container. The owner of the container can make the container completely public or set rules based on the project, user, or rule set.</p></div>

<div class="book" title="Container ACLs">
<div class="book" title="Getting ready"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch08lvl2sec329" class="calibre1"/>Getting ready</h2></div></div></div><p class="calibre10">Ensure that you are logged on to a correctly configured OpenStack client and can access the OpenStack <a id="id495" class="calibre1"/>environment as a user with the <code class="email">swiftoperator</code> privileges and an <code class="email">admin</code> user. We will use the <code class="email">developer</code> user created in the <span class="strong"><em class="calibre18">Common OpenStack identity tasks</em></span> recipe in <a class="calibre1" title="Chapter 2. The OpenStack Client" href="part0024_split_000.html#MSDG1-189e69df43a248268db97cde1b1a8e47">Chapter 2</a>, <span class="strong"><em class="calibre18">The OpenStack Client</em></span>, with the <code class="email">cookbook4</code> password. We have also granted this user the <code class="email">swiftoperator</code> privileges.</p><p class="calibre10">Since the OpenStack CLI does not provide all the functionality available through the individual OpenStack project client, we will need to use Swift CLI for this recipe. Ensure that you have the Swift command-line client installed. If you do not, install it:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">pip install python-swiftclient</strong></span>
</pre></div></div></div>

<div class="book" title="Container ACLs">
<div class="book" title="How to do it…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch08lvl2sec330" class="calibre1"/>How to do it…</h2></div></div></div><p class="calibre10">To view and modify ACLs on containers, follow the following steps:</p><div class="book"><ol class="orderedlist"><li class="listitem" value="1">First, view existing ACLs on a container, if any:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift stat books</strong></span>
</pre></div><p class="calibre22">This gives the information about our container called <code class="email">books</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">               Account: AUTH_402e8fe274c143ea91fe905a1b8c7614</strong></span>
<span class="strong"><strong class="calibre2">             Container: books</strong></span>
<span class="strong"><strong class="calibre2">               Objects: 3</strong></span>
<span class="strong"><strong class="calibre2">                 Bytes: 32764</strong></span>
<span class="strong"><strong class="calibre2">              Read ACL:</strong></span>
<span class="strong"><strong class="calibre2">             Write ACL:</strong></span>
<span class="strong"><strong class="calibre2">               Sync To:</strong></span>
<span class="strong"><strong class="calibre2">              Sync Key:</strong></span>
<span class="strong"><strong class="calibre2">         Accept-Ranges: bytes</strong></span>
<span class="strong"><strong class="calibre2">      X-Storage-Policy: default</strong></span>
<span class="strong"><strong class="calibre2">         Last-Modified: Mon, 18 Dec 2017 06:09:45 GMT</strong></span>
<span class="strong"><strong class="calibre2">           X-Timestamp: 1512278405.11522</strong></span>
<span class="strong"><strong class="calibre2">            X-Trans-Id: tx484e741deb754fdb86f7a-005a375e4c</strong></span>
<span class="strong"><strong class="calibre2">          Content-Type: text/plain; charset=utf-8</strong></span>
<span class="strong"><strong class="calibre2">X-Openstack-Request-Id: tx484e741deb754fdb86f7a-005a375e4c</strong></span>
</pre></div></li><li class="listitem" value="2">In our example, there are no read or write ACLs set yet. Let's set a <code class="email">read</code> ACL to make the <code class="email">books</code> container <span class="strong"><em class="calibre18">public</em></span>:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post books --read-acl ".r:*,.rlistings"</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note49" class="calibre1"/>Note</h3><p class="calibre10">There is no output from this command.</p></div></li><li class="listitem" value="3">To make the <code class="email">books</code> container <span class="strong"><em class="calibre18">writable</em></span> by everybody, issue the following:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post books --write-acl "*:*"</strong></span>
</pre></div><div class="note" title="Note"><h3 class="title2"><a id="note50" class="calibre1"/>Note</h3><p class="calibre10">There is no output from this command.</p></div></li><li class="listitem" value="4">Now <a id="id496" class="calibre1"/>check the details on the books container again with the stat command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift stat books</strong></span>
</pre></div><p class="calibre22">We can see that the <code class="email">Read ACL</code> and <code class="email">Write ACL</code> fields have been populated:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">               Account: AUTH_402e8fe274c143ea91fe905a1b8c7614</strong></span>
<span class="strong"><strong class="calibre2">             Container: books</strong></span>
<span class="strong"><strong class="calibre2">               Objects: 3</strong></span>
<span class="strong"><strong class="calibre2">                 Bytes: 32764</strong></span>
<span class="strong"><strong class="calibre2">              Read ACL: .r:*,.rlistings</strong></span>
<span class="strong"><strong class="calibre2">             Write ACL: *:*</strong></span>
<span class="strong"><strong class="calibre2">               Sync To:</strong></span>
<span class="strong"><strong class="calibre2">              Sync Key:</strong></span>
<span class="strong"><strong class="calibre2">         Accept-Ranges: bytes</strong></span>
<span class="strong"><strong class="calibre2">            X-Trans-Id: txc0d0d64ed54e48989f3f6-005a3760ba</strong></span>
<span class="strong"><strong class="calibre2">      X-Storage-Policy: default</strong></span>
<span class="strong"><strong class="calibre2">         Last-Modified: Mon, 18 Dec 2017 06:22:56 GMT</strong></span>
<span class="strong"><strong class="calibre2">           X-Timestamp: 1512278405.11522</strong></span>
<span class="strong"><strong class="calibre2">          Content-Type: text/plain; charset=utf-8</strong></span>
<span class="strong"><strong class="calibre2">X-Openstack-Request-Id: txc0d0d64ed54e48989f3f6-005a3760ba</strong></span>
</pre></div></li><li class="listitem" value="5">Since operating <span class="strong"><em class="calibre18">world-writable</em></span> and <span class="strong"><em class="calibre18">readable</em></span> containers are not very good security practice, we can remove the ACLs from the container. To remove the <span class="strong"><em class="calibre18">read</em></span> ACL, issue this command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post -r "" books</strong></span>
</pre></div></li><li class="listitem" value="6">To remove the <span class="strong"><em class="calibre18">write</em></span> ACL, use this command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post -w "" books</strong></span>
</pre></div></li><li class="listitem" value="7">If you need to share your container with another user in your OpenStack environment, you can set permissions based on the <span class="strong"><em class="calibre18">project</em></span> and <span class="strong"><em class="calibre18">user</em></span>. In our example, we will set the <code class="email">books</code> container's access to be readable by everyone in the <code class="email">admin</code> project:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post -r "admin:*" books</strong></span>
</pre></div><p class="calibre22">The asterisk (<code class="email">*</code>) after <code class="email">:</code> indicates that all users in the <code class="email">admin</code> project will have access to the <code class="email">books</code> container.</p></li><li class="listitem" value="8">Now <a id="id497" class="calibre1"/>check the details of the <code class="email">books</code> container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift stat -v books</strong></span>
</pre></div><p class="calibre22">This will produce output like the following:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">                   URL: http://172.29.236.100:8080/v1/AUTH_402e8fe/books</strong></span>
<span class="strong"><strong class="calibre2">            Auth Token: gAAAAABaODQ8R93x7kW46CW_u9ZS3               </strong></span>
<span class="strong"><strong class="calibre2">               Account: AUTH_402e8fe274c143ea91fe905a1b8c7614</strong></span>
<span class="strong"><strong class="calibre2">             Container: books</strong></span>
<span class="strong"><strong class="calibre2">               Objects: 3</strong></span>
<span class="strong"><strong class="calibre2">                 Bytes: 32764</strong></span>
<span class="strong"><strong class="calibre2">              Read ACL: admin:*</strong></span>
<span class="strong"><strong class="calibre2">             Write ACL:</strong></span>
<span class="strong"><strong class="calibre2">               Sync To:</strong></span>
<span class="strong"><strong class="calibre2">              Sync Key:</strong></span>
<span class="strong"><strong class="calibre2">         Accept-Ranges: bytes</strong></span>
<span class="strong"><strong class="calibre2">            X-Trans-Id: tx20b0d0d8394b4b0a81cba-005a38343c</strong></span>
<span class="strong"><strong class="calibre2">      X-Storage-Policy: default</strong></span>
<span class="strong"><strong class="calibre2">         Last-Modified: Mon, 18 Dec 2017 21:24:27 GMT</strong></span>
<span class="strong"><strong class="calibre2">           X-Timestamp: 1512278405.11522</strong></span>
<span class="strong"><strong class="calibre2">          Content-Type: text/plain; charset=utf-8</strong></span>
<span class="strong"><strong class="calibre2">X-Openstack-Request-Id: tx20b0d0d8394b4b0a81cba-005a38343c</strong></span>
</pre></div><p class="calibre22">Notice the <code class="email">URL</code> of the container in the details. Anybody wishing to access this container will need to pass the <code class="email">URL</code> field as a parameter.</p></li><li class="listitem" value="9">As an <code class="email">admin</code> user, test the access to the <code class="email">books</code> container:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift</strong></span>
<span class="strong"><strong class="calibre2">    --os-storage-url http://172.29.236.100:8080/v1/AUTH_402e8fe/books list</strong></span>
</pre></div><p class="calibre22">This will give objects from our shared container at the specified URL:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">chapter1</strong></span>
<span class="strong"><strong class="calibre2">chapter1/swift.txt</strong></span>
<span class="strong"><strong class="calibre2">intro.txt</strong></span>
</pre></div><p class="calibre22">In our example, the <code class="email">admin</code> user is part of the <code class="email">admin</code> project and therefore is able to access the <code class="email">books</code> container via the <code class="email">--os-storage-url</code> flag.</p></li></ol><div class="calibre20"/></div></div></div>

<div class="book" title="Container ACLs">
<div class="book" title="How it works…"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch08lvl2sec331" class="calibre1"/>How it works…</h2></div></div></div><p class="calibre10">Containers <a id="id498" class="calibre1"/>can be shared with other users by setting <span class="strong"><em class="calibre18">read</em></span> and <span class="strong"><em class="calibre18">write</em></span> <span class="strong"><strong class="calibre2">ACLs</strong></span> on them. Currently, the ACLs functionality is not available in the OpenStack client, so we are using the Swift CLI in our examples.</p><p class="calibre10">There are two types of ACLs that can be set on a container, <span class="strong"><em class="calibre18">read</em></span> and <span class="strong"><em class="calibre18">write</em></span>, and they have to be set individually.</p><p class="calibre10">Set read ACL with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post -r "project:user" container</strong></span>
</pre></div><p class="calibre10">Set write ACL as follows: </p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post -w "project:user" container</strong></span>
</pre></div><p class="calibre10">Here both the project and user can be substituted with a wild card (<code class="email">*</code>).</p><p class="calibre10">To make a container completely public, use the following commands:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift post --read-acl ".r:*,.rlistings" container</strong></span>
<span class="strong"><strong class="calibre2">swift post --write-acl "*:*" container</strong></span>
</pre></div><p class="calibre10">With the <code class="email">.r:*</code> and <code class="email">.rlistings</code> elements set, the <code class="email">books</code> container is publicly accessible. The <code class="email">.r*</code> element allows access to the objects in a container, and <code class="email">.rlistings</code> allows listing of the container's content.</p><div class="informalexample" title="Note"><h3 class="title2"><a id="note51" class="calibre1"/>Note</h3><p class="calibre10">With write ACL set to <code class="email">"*:*"</code>, the container can be updated by anybody, so use it with care.</p><p class="calibre10">The <code class="email">-r</code> and <code class="email">--read-acl</code> commands as well as <code class="email">-w</code> and <code class="email">--write-acl</code> are the short and long forms of the same flag. That is, <code class="email">-r</code> and <code class="email">--read-acl</code> are interchangeable as well as <code class="email">-w</code> and <code class="email">--write-acl</code>.</p></div><p class="calibre10">Once access to containers is enabled for other users, find the URL of a container with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift stat -v container | grep URL</strong></span>
</pre></div><p class="calibre10">To access <a id="id499" class="calibre1"/>another user's container once access been enabled, use this command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong class="calibre2">swift --os-storage-url URL list</strong></span>
</pre></div><div class="informalexample" title="Note"><h3 class="title2"><a id="tip80" class="calibre1"/>Tip</h3><p class="calibre10">If you are always accessing the same storage URL, it can be set as the <code class="email">OS_STORAGE_URL</code> environment variable.</p></div></div></div></body></html>