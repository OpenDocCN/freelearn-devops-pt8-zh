- en: 7\. Offers, support, resources, and tips to optimize cost in Azure
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 7. 提供优惠、支持、资源和优化 Azure 成本的建议
- en: In the previous chapter, you saw the fundamentals of protecting your applications
    against cybercrime. We will now focus on various offers provided by Azure and
    the support you get from Microsoft to optimize costs, various tools that can be
    used to bring down costs, and tips for managing these costs.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，你了解了保护应用程序免受网络犯罪的基础知识。现在我们将重点介绍 Azure 提供的各种优惠和 Microsoft 提供的支持，以优化成本，介绍可用于降低成本的各种工具，以及管理这些成本的建议。
- en: As organizations begin their journey to the cloud, one of the main things they
    have to learn is how to optimize their costs. From a customer point of view, cost
    forecasting can be based on how to reduce their datacenter footprint, OPEX pricing
    models, staff productivity, and other factors.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 随着组织开始迈向云端，必须学习的关键事项之一就是如何优化成本。从客户的角度来看，成本预测可以基于如何减少数据中心的占地面积、运营支出定价模型、员工生产力以及其他因素。
- en: 'In this chapter, we will cover the following:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下内容：
- en: Understanding and forecasting your costs
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解和预测你的成本
- en: Strategies for optimizing your costs
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 优化成本的策略
- en: The first step is understanding and planning for the costs your organization
    faces.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步是理解并规划你组织所面临的成本。
- en: Understanding and forecasting your costs
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 理解和预测你的成本
- en: Organizations should perform timely analysis on their Azure invoice to monitor
    costs and reduce the overhead required to manage their IT resources. Using tools
    such as Azure Cost Management and Billing and Azure Advisor, you can analyze,
    manage, and optimize your workloads. Before we take a look at these tools and
    the benefits they provide, we must first understand the factors that are most
    critical for forecasting your costs in a cloud infrastructure.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 组织应该及时分析他们的 Azure 发票，以监控成本并减少管理 IT 资源所需的开销。使用 Azure 成本管理和计费以及 Azure 顾问等工具，你可以分析、管理并优化工作负载。在我们深入了解这些工具及其提供的好处之前，我们必须先理解在云基础设施中预测成本时最关键的因素。
- en: Cloud economics
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 云经济学
- en: It is important for businesses to understand cloud economics so they can forecast
    their costs and maximize their cloud investment. Businesses should analyze what
    their **return on investment** (**ROI**) should be when migrating from an on-premises
    workload to the cloud or switching from other workloads to Azure. Primarily, you
    will need to benchmark the cost of running your current datacenter. This can include
    capital costs, maintenance and operational costs, and software licensing costs.
    You should also determine the cost of migrating your IT operations to the cloud.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 企业理解云经济学至关重要，这样他们才能预测成本并最大化云投资。企业应该分析从本地工作负载迁移到云端或从其他工作负载切换到 Azure 时的**投资回报率**（**ROI**）。首先，你需要基准测试当前数据中心的运行成本。这可能包括资本支出、维护和运营成本以及软件许可费用。你还应确定将
    IT 操作迁移到云端的成本。
- en: 'To sum up cloud economics, your organization''s focus should be on the following
    eight-point formula:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 总结云经济学，你组织的关注点应该是以下八点公式：
- en: Reduce your datacenter footprint by streamlining operations.
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过简化操作来减少数据中心占地面积。
- en: Focus on utilizing on-demand cloud benefits as part of an operational expenditure
    model.
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 聚焦于将按需云服务作为运营支出模型的一部分来利用。
- en: Increase productivity by freeing up your staff from maintenance tasks.
  id: totrans-14
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过解放员工免于维护任务，提升生产力。
- en: Strive for business sustainability.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 力求业务可持续发展。
- en: Explore your scalability options and deliver resources when they're needed.
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 探索你的可扩展性选项，并在需要时提供资源。
- en: Meet security and compliance standards.
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 满足安全和合规标准。
- en: Use high-availability cloud infrastructure to ensure business continuity.
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用高可用性的云基础设施来确保业务连续性。
- en: Optimize workload and usage costs.
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 优化工作负载和使用成本。
- en: Azure offers solutions to help you toward all these goals, which we will explore
    in the following sections.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 提供的解决方案可以帮助你实现这些目标，我们将在接下来的章节中进行探讨。
- en: Cost management tools
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 成本管理工具
- en: Azure has a wide range of tools to provide a great developer and operations
    experience and to help with understanding the cost of the resources being used
    in Azure. All the cost management solutions discussed in this chapter have a business
    impact if utilized properly. Let's take a look at the list of tools available
    to you in Azure.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 提供了一系列工具，以提供卓越的开发和运维体验，并帮助了解在 Azure 中使用的资源的成本。本章讨论的所有成本管理解决方案，如果正确使用，将对业务产生影响。让我们来看看
    Azure 中可用的工具列表。
- en: Azure Cost Management and Billing
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure 成本管理和计费
- en: 'With its full set of cloud cost management capabilities and a single, unified
    view across all your clouds, Azure Cost Management and Billing helps you increase
    organizational accountability and manage your cloud spending with confidence.
    The **Cost Management and Billing** service enables you to check out billing scopes,
    drill down into your cost management, review your management groups, and diagnose
    and troubleshoot problems:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 成本管理和计费具有完整的云成本管理功能，并提供跨所有云的单一统一视图，帮助您提高组织的问责制，并自信地管理云支出。**成本管理和计费**服务使您能够查看计费范围，深入分析成本管理，审查管理组，并诊断和排除问题：
- en: '![The Cost Management + Billing pane in the Azure portal](img/B17153_07_01.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 门户中的成本管理 + 计费窗格](img/B17153_07_01.jpg)'
- en: 'Figure 7.1: Cost Management + Billing page'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.1：成本管理 + 计费页面
- en: Management groups are a unique way to group subscriptions and costs. While this
    chapter is not on management groups, it's worth noting that they're still a useful
    Azure resource to manage your subscriptions.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 管理组是一种独特的方式，用于对订阅和成本进行分组。虽然本章并不讨论管理组，但值得注意的是，它们仍然是管理订阅的有用 Azure 资源。
- en: 'Organizations need to take a unique approach to provide access to cost management
    to users that aren''t in the financial part of the organization. There are ways
    to allow these cost structures to be visible to your organization''s operations
    and development side. Power BI dashboards and APIs can be used to pull reports
    and create neat, unique dashboards to access cost information; you can read more
    about this here: [https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management](https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management).
    As well as Power BI, Azure allows integration with custom-written apps, as well
    as SaaS applications like CRM for digesting and using your data.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 组织需要采取独特的方法，向非财务部门的用户提供成本管理访问权限。有多种方式可以使这些成本结构对组织的运营和开发人员可见。可以使用 Power BI 仪表板和
    API 来提取报告，并创建整洁、独特的仪表板来访问成本信息；您可以在此处阅读更多内容：[https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management](https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management)。除了
    Power BI，Azure 还允许与自定义应用程序集成，以及与像 CRM 这样的 SaaS 应用程序集成，以消化和使用您的数据。
- en: 'As mentioned, management groups can help provide a better view of costs, and
    you can use tags to assign the budget codes within an organization. The following
    screenshot demonstrates how costs can be visualized on a service basis:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，管理组可以帮助提供更好的成本视图，您还可以使用标签在组织内分配预算代码。以下截图展示了如何按服务基础来可视化成本：
- en: '![An overview of costs grouped by service](img/B17153_07_02.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![按服务分组的成本概览](img/B17153_07_02.jpg)'
- en: 'Figure 7.2: Costs grouped by service'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.2：按服务分组的成本
- en: With Azure, your organization can easily manage the costs of hybrid cloud environments
    (Azure and AWS, say) from a single location, getting the best insights from data
    from both clouds.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 借助 Azure，您的组织可以轻松地从一个位置管理混合云环境（例如 Azure 和 AWS）的成本，从两个云的数据中获得最佳的洞察。
- en: 'Let''s take a quick look at the **Cost Management** section for the pay-as-you-go
    model (a pricing model we will discuss later in the chapter):'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们快速了解一下 **成本管理** 部分，适用于按需付费模式（我们将在本章后面讨论的定价模型）：
- en: '![The Cost Management section in the Azure portal](img/B17153_07_03.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 门户中的成本管理部分](img/B17153_07_03.jpg)'
- en: 'Figure 7.3: Cost Management section'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.3：成本管理部分
- en: As you can see, the **Cost Management** section allows you to analyze costs,
    create cost alerts, assign budgets, and get advisor recommendations. When you
    click on **Cost analysis**, you'll get a breakdown of the resources within the
    resource group's scope, such as data stores or serverless accounts.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，**成本管理**部分允许您分析成本、创建成本警报、分配预算并获取顾问推荐。当您点击 **成本分析** 时，您将获得资源组范围内资源的详细分解，例如数据存储或无服务器帐户。
- en: 'You can also set cost alerts, which is an excellent tool to help monitor overspend
    on non-production environments, by setting a threshold and then receiving alerts.
    Alerting can be used in conjunction with budgets, as shown in the following screenshot:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以设置成本警报，这是一个极好的工具，可以通过设置阈值来监控非生产环境的超支，并收到警报。警报可以与预算结合使用，如下截图所示：
- en: '![The Cost alerts pane as seen in the Azure portal](img/B17153_07_04.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 门户中显示的成本警报窗格](img/B17153_07_04.jpg)'
- en: 'Figure 7.4: Alerts for budget threshold'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.4：预算阈值警报
- en: Budgets and alerts are an invaluable next step for organizations after they
    have visualized their current spending. You should monitor and analyze your Azure
    bill to ensure there aren't any charges or hidden infrastructure that have made
    their way through. This is generally essential for non-production environments,
    where things are a little bit more loosely controlled than in production.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 在组织可视化当前支出后，预算和警报是一个不可或缺的下一步。您应当监控和分析您的 Azure 账单，确保没有任何费用或隐藏的基础设施被遗漏。这在非生产环境中尤其重要，因为这些环境的控制通常不如生产环境严格。
- en: When an alert is triggered, you should undertake a cost review to isolate the
    causes and determine whether any action needs to be taken. This could be in the
    form of revising your budgets or implementing additional Azure Policy controls,
    to name a few. Assigning budgets also helps with controlling the costs of your
    different teams' projects and business units.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 当触发警报时，您应进行成本审查以找出原因，并确定是否需要采取任何措施。这可能包括修订预算或实施额外的 Azure 策略控制等。为不同团队的项目和业务部门分配预算，也有助于控制其成本。
- en: To read about Azure Policy and its important role in governance, visit [https://docs.microsoft.com/azure/governance/policy/overview](https://docs.microsoft.com/azure/governance/policy/overview).
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解 Azure 策略及其在治理中的重要作用，请访问 [https://docs.microsoft.com/azure/governance/policy/overview](https://docs.microsoft.com/azure/governance/policy/overview)。
- en: To find out more about the capabilities of Azure Cost Management and Billing,
    visit [https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview](https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview).
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于 Azure 成本管理和计费的功能，请访问 [https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview](https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview)。
- en: Azure pricing calculator
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure 定价计算器
- en: The Azure pricing calculator is a free tool that can be used to get real-time
    cost estimates of subscription services. You can personalize your view of the
    estimates through a central dashboard. The pricing calculator can be combined
    with other utilities, such as the Azure **Total Cost of Ownership** (**TCO**)
    calculator, for better cost optimization. We can create estimates and save them
    to our accounts, or share them with relevant parties.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 定价计算器是一个免费的工具，可以用来实时估算订阅服务的成本。您可以通过中央仪表板个性化查看估算。定价计算器还可以与其他工具结合使用，例如 Azure
    **总拥有成本**（**TCO**）计算器，以实现更好的成本优化。我们可以创建估算并将其保存到账户中，或与相关方共享。
- en: 'Azure regions can sometimes affect the cost of resources in Azure, so it is
    helpful to use the Azure pricing calculator to predict costs before selecting
    a resource:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 区域有时会影响 Azure 资源的成本，因此在选择资源之前，使用 Azure 定价计算器来预测成本是非常有帮助的：
- en: '![Azure Pricing Calculator overview](img/B17153_07_05.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![Azure 定价计算器概览](img/B17153_07_05.jpg)'
- en: 'Figure 7.5: The Azure pricing calculator'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.5：Azure 定价计算器
- en: 'The Azure pricing calculator can be found here: [https://azure.microsoft.com/pricing/calculator/](https://azure.microsoft.com/pricing/calculator/).'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 定价计算器可以在此找到：[https://azure.microsoft.com/pricing/calculator/](https://azure.microsoft.com/pricing/calculator/)。
- en: One of the hurdles organizations can run into when using the pricing calculator
    is factoring in the infrastructure around the resources, they are looking for
    to get the right estimate. You should always take into account all of the network
    infrastructure needed to deploy your applications to the cloud.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 使用定价计算器时，组织可能会遇到的一大障碍是考虑到资源周围的基础设施，以便获得准确的估算。您应始终考虑部署应用程序到云所需的所有网络基础设施。
- en: For example, consider an organization with two VMs, one running a website and
    the other running services to support that website, which wants to move both VMs
    out to the cloud. They go to the pricing calculator, input the two VMs in the
    pricing calculator, and discover their average monthly cost.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，考虑一个有两个虚拟机（VM）的组织，一个运行网站，另一个运行支持该网站的服务，它希望将这两个虚拟机迁移到云端。他们使用定价计算器，输入这两个虚拟机的信息，并发现它们的平均月度成本。
- en: One of the things that they should have done in this scenario is look at the
    VMs' usage to right-size them in Azure. A lot of organizations over-allocate machines
    that are needed for future expansion, but in the cloud, you can expand any time
    you need to, so you don't need to put oversized resources into play. The organization
    also missed the routers and firewalls and didn't take into account VM scale sets,
    or the ability to protect their infrastructure should a VM go down. As you can
    see, a good plan can go a long way.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，他们应该做的一件事是查看虚拟机的使用情况，以便在 Azure 中正确配置其资源。许多组织过度分配了未来扩展所需的机器，但在云端，你可以随时扩展资源，因此无需配置过大的资源。该组织还忽视了路由器和防火墙，并未考虑虚拟机规模集，或者在虚拟机故障时保护基础设施的能力。如你所见，一个好的计划可以带来长远的效益。
- en: Total Cost of Ownership calculator
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 总拥有成本计算器
- en: When businesses want to take a bigger, holistic view of what it means to migrate
    their Azure solutions, they can use the TCO calculator. This provides detailed
    information about moving on-premises workloads to the cloud and what it will take
    to make the transition smoother.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 当企业想要更全面地了解将 Azure 解决方案迁移的意义时，他们可以使用 TCO 计算器。这个工具提供了关于将本地工作负载迁移到云端的详细信息，并帮助企业了解如何使迁移过程更加顺利。
- en: You can find more information about this calculator at [https://azure.microsoft.com/pricing/tco/calculator/](https://azure.microsoft.com/pricing/tco/calculator/).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在[https://azure.microsoft.com/pricing/tco/calculator/](https://azure.microsoft.com/pricing/tco/calculator/)找到更多关于该计算器的信息。
- en: Azure Migrate
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure Migrate
- en: Another tool to use if you're choosing to migrate from on-premises to the cloud
    is Azure Migrate. Azure Migrate provides a centralized single pane of glass view
    to assess and migrate on-premises servers, infrastructures, applications, and
    data to the cloud. This assists organizations by providing a wide range of tools
    and options to help the process of assessing and migrating these different resources
    and workloads to Azure.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可以使用的工具是 Azure Migrate，特别是当你决定从本地迁移到云时。Azure Migrate 提供了一个集中的、统一的视图，用于评估和迁移本地服务器、基础设施、应用程序和数据到云端。它为组织提供了一系列工具和选项，帮助评估和迁移这些不同的资源和工作负载到
    Azure。
- en: For more information on how to use Azure Migrate, go to [https://docs.microsoft.com/azure/migrate/migrate-services-overview](https://docs.microsoft.com/azure/migrate/migrate-services-overview).
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 有关如何使用 Azure Migrate 的更多信息，请访问[https://docs.microsoft.com/azure/migrate/migrate-services-overview](https://docs.microsoft.com/azure/migrate/migrate-services-overview)。
- en: Choosing the right pricing model
  id: totrans-59
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 选择合适的定价模型
- en: 'As well as tools, it is equally important to understand the various pricing
    models Azure offers to better forecast your resources and their costs. In Azure,
    there are two standard pricing models for services:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 除了工具外，了解 Azure 提供的各种定价模型同样重要，这有助于更好地预测资源和成本。在 Azure 中，服务有两种标准定价模型：
- en: The pay-as-you-go model, also known as the consumption-based model
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按需付费模型，也称为基于消费的模型
- en: The fixed-price model
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 固定价格模型
- en: Most Azure resources, such as PaaS or serverless, will use the consumption-based
    model. An example of fixed pricing is Azure **Reserved Virtual Machine Instances**
    (**RIs**), or **Azure Reservations** more broadly.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 Azure 资源，如 PaaS 或无服务器服务，都将使用基于消费的模型。固定价格的一个例子是 Azure **预留虚拟机实例**（**RIs**），或者更广泛的
    **Azure 预留**。
- en: The fixed-price model is more predictable, while the pay-as-you-go model can
    be variable, so you need to consider business requirements when choosing between
    them. We'll go into detail about both models in the following sections.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 固定价格模型更具可预测性，而按需付费模型则可能变化，因此在选择两者时需要考虑业务需求。我们将在接下来的章节中详细讨论这两种模型。
- en: Consumption-based model
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 基于消费的模型
- en: The consumption-based, or pay-as-you-go, model follows a utility-based structure.
    This means that you pay for what you use and there is no monthly or fixed cost
    for the resources. An example of this would be a function application, where you'd
    pay one dollar for a million uses of the app.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 按消耗付费或按需付费模型遵循基于公用事业的结构。这意味着你只为实际使用的部分付费，资源没有固定的月度费用或固定成本。举个例子，像功能应用程序这样的服务，你为一百万次应用使用支付一美元。
- en: This pay-for-what-you-use model can help you control costs, but could also potentially
    increase them. An example of this might be something like CosmosDB, which is based
    on usage or request units and can become very costly at the end of the day depending
    on how many times queries are run.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 这种按使用付费的模型可以帮助你控制成本，但也可能导致成本增加。举个例子，像CosmosDB这样的服务基于使用量或请求单元收费，取决于查询运行的次数，最终可能会非常昂贵。
- en: You can use architectural patterns like base load-leveling and autoscaling of
    services to help with fixed minimum performance levels. If you need burst workloads,
    you can use something like a throttle pattern to maintain the quality of the service
    under load.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用架构模式，如基准负载平衡和服务的自动伸缩，来帮助实现固定的最低性能水平。如果需要突发工作负载，可以使用类似节流模式的方式，在负载下保持服务的质量。
- en: Fixed-price model
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 固定价格模型
- en: Under a fixed-price model, you pay for a resource whether it is used or not.
    We already mentioned Azure reservations and specifically RIs, but another example
    would be an App Service plan in Azure. When you select a type of resource you
    incur a monthly cost, and regardless of how many people utilize the application,
    you still pay this cost. This costing model helps organizations predict their
    spending in Azure a little better, but it can also be a problem based on utilization.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在固定价格模型下，无论资源是否被使用，你都需要为其支付费用。我们已经提到过Azure预留实例（RIs），但另一个例子是Azure中的应用服务计划。当你选择某种资源类型时，你会产生每月费用，无论有多少人使用该应用，你仍然需要支付这个费用。这个定价模型帮助组织更好地预测在Azure中的支出，但也可能根据使用情况出现问题。
- en: Organizations buy reserved instances when they plan to make extensive use of
    VMs for their applications. In return for committing to resources for fixed terms,
    Azure can provide them at discounted rates. When you first migrate to the cloud,
    there may be uncertainty around your resource usage, so depending on your workloads,
    it may be best to get a handle on this before you consider RIs.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 当组织计划大规模使用虚拟机（VM）来支持应用时，它们会购买预留实例。作为对固定期限资源承诺的回报，Azure会提供折扣价格。当你首次迁移到云时，可能会对资源使用情况产生不确定性，因此根据你的工作负载，最好在考虑预留实例之前先掌握这些情况。
- en: There is a trade-off between scalability and predictability when keeping costs
    structured, and most organizations opt for a blended approach of the two pricing
    models.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 在保持成本结构的过程中，规模扩展性与可预测性之间存在权衡，大多数组织选择两种定价模型的混合方式。
- en: For more information on pricing models, head over to [https://docs.microsoft.com/azure/architecture/framework/cost/design-price](https://docs.microsoft.com/azure/architecture/framework/cost/design-price).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 欲了解更多定价模型的信息，请访问[https://docs.microsoft.com/azure/architecture/framework/cost/design-price](https://docs.microsoft.com/azure/architecture/framework/cost/design-price)。
- en: Now that we have an understanding of the various ways Azure can help you to
    assess and keep on top of your costs, we'll move on to optimizing these costs.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了Azure在帮助你评估和管理成本方面的各种方法，我们将继续讨论如何优化这些成本。
- en: Optimizing your costs
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 优化你的成本
- en: Cost optimization is the process of reducing your resource costs by identifying
    waste, mismanaged resources, and right-sized resources, and also by reserving
    capacity. With cost management being one of the five principles of cloud governance,
    it is important to focus on ways of establishing a spending plan and budget for
    your cloud resources. You will also want to use monitoring and alerting to enforce
    these budgets and detect anomalies that emerge from development practices. Microsoft
    provides the Cloud Adoption Framework for guidance on this, which details tools,
    best practices, and documentation to help organizations succeed in the cloud.
    You can find more information at [https://docs.microsoft.com/azure/cloud-adoption-framework/.](https://docs.microsoft.com/azure/cloud-adoption-framework/.)
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 成本优化是通过识别浪费、资源管理不当、资源规模不匹配以及预留容量来降低资源成本的过程。由于成本管理是云治理五大原则之一，因此关注如何为云资源制定支出计划和预算非常重要。您还需要使用监控和警报来执行这些预算，并检测开发实践中出现的异常。微软提供了云采用框架作为指导，其中详细介绍了工具、最佳实践和文档，帮助组织在云中取得成功。您可以在[https://docs.microsoft.com/azure/cloud-adoption-framework/.](https://docs.microsoft.com/azure/cloud-adoption-framework/.)
    获取更多信息。
- en: A general method for estimating cost and making changes to the pricing models
    we discussed earlier is by monitoring your workloads on a peak throughput. For
    example, if the utilization is high all the time, a pay-as-you-go model would
    be less efficient for baseline cost estimation. Hence, while providing flexibility,
    the pay-as-you-go model alone doesn't always constitute a cost-saving.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 估算成本和对我们之前讨论的定价模型进行调整的一般方法是通过监控工作负载的峰值吞吐量。例如，如果利用率一直很高，那么按需付费模式在基准成本估算时就不够高效。因此，尽管按需付费模式提供了灵活性，但单靠它并不总能实现成本节约。
- en: 'As has already been pointed out, the best cost optimization is having a plan,
    so you should use the tools at hand, from pricing calculators to checklists, to
    establish your policies, budgets, and controls to limit the spending on your solutions.
    The Azure Well-Architected Framework is a great starting point for building these
    policies and a good source of information. It is located at [https://docs.microsoft.com/azure/architecture/framework/cost/.](https://docs.microsoft.com/azure/architecture/framework/cost/.)
    We discussed the Azure Well-Architected Framework in *Chapter 4, Cloud migration:
    Planning, implementation, and best practices*.'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，最佳的成本优化是拥有一个计划，因此您应当利用手头的工具，从定价计算器到清单，来制定您的政策、预算和控制措施，以限制解决方案的支出。Azure
    良好架构框架是建立这些政策的一个很好的起点，也是一个宝贵的信息来源。它位于[https://docs.microsoft.com/azure/architecture/framework/cost/.](https://docs.microsoft.com/azure/architecture/framework/cost/.)
    我们在*第4章，云迁移：规划、实施和最佳实践*中讨论了 Azure 良好架构框架。
- en: As we begin exploring the optimization options Azure provides in the next few
    sections, you should keep in mind that it's not just about moving a workload to
    Azure, but all the things surrounding it as well. When migrating to the cloud,
    many organizations miss some of the associated underlying infrastructure costs.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们在接下来的几个部分中开始探索 Azure 提供的优化选项时，您应该记住，这不仅仅是将工作负载迁移到 Azure，还包括周围的所有事项。在迁移到云时，许多组织会忽略一些相关的基础设施成本。
- en: Azure Advisor
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure 顾问
- en: One of the useful services you can access through Azure Cost Management is Azure
    Advisor. Azure Advisor analyzes your resource configuration and usage, providing
    personalized offers and recommendations so you can optimize your resources for
    cost-effectiveness, security, and performance. For example, it helps to point
    out unused resources or those that have been idle for a long time, including right-sizing
    resources like SQL.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 通过 Azure 成本管理，您可以访问的一个有用服务是 Azure 顾问。Azure 顾问分析您的资源配置和使用情况，提供个性化的优惠和建议，帮助您优化资源以提高成本效益、安全性和性能。例如，它可以帮助您发现未使用的资源或长期处于空闲状态的资源，包括调整资源规模，如
    SQL。
- en: For more information on Azure Advisor, visit [https://docs.microsoft.com/azure/advisor/advisor-overview](https://docs.microsoft.com/azure/advisor/advisor-overview).
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解有关 Azure 顾问的更多信息，请访问[https://docs.microsoft.com/azure/advisor/advisor-overview](https://docs.microsoft.com/azure/advisor/advisor-overview)。
- en: It is important to point out that you should right-size your resources for the
    cloud. Most organizations overbuy internal infrastructure only for the purposes
    of future growth. When moving to Azure, you can scale horizontally as well as
    vertically, so if your machine needs more resources, you can add more. You can
    also use a hybrid approach, where you don't need to move all of your workloads
    out to the cloud—you can move the pieces of the workload that need more performance
    or more scalability at the instance level.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 需要特别指出的是，你应该为云计算正确调整资源。大多数组织会过度购买内部基础设施，只是为了未来的增长。当迁移到Azure时，你可以横向和纵向扩展，因此如果你的机器需要更多资源，可以增加更多资源。你还可以使用混合方法，不需要将所有工作负载迁移到云端——你可以将那些需要更多性能或实例级可扩展性的工作负载部分迁移过去。
- en: Azure Hybrid Benefit
  id: totrans-84
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure混合福利
- en: Azure Hybrid Benefit is a licensing benefit that drastically lowers the cost
    of running workloads in the cloud. It will allow you to use on-premises software
    assurance-enabled Windows or SQL Server licenses, as well as Red Hat and SUSE
    Linux subscriptions, on Azure. These types of benefits can drive down costs by
    40% or more. Furthermore, you are given three additional years of security updates
    for free when you move your Windows Server or SQL Server 2008 and 2008 R2 workloads
    to Azure.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Azure混合福利是一项许可福利，可以大幅降低在云中运行工作负载的成本。它允许你在Azure上使用本地启用软件保障的Windows或SQL Server许可证，以及Red
    Hat和SUSE Linux订阅。此类福利可以使成本降低40%或更多。此外，当你将Windows Server或SQL Server 2008及2008 R2工作负载迁移到Azure时，还将获得额外三年的安全更新，完全免费。
- en: 'One of Microsoft''s primary goals of the Hybrid Benefit model is the savings
    that come from using a Windows or SQL Server Hybrid license, which drives down
    the cost of a managed instance by almost 85%. These benefits can apply to VM operating
    systems as well. *Figure 7.6* shows some potential cost savings involving RIs
    and Azure Hybrid Benefit:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 微软的混合福利模型的主要目标之一是通过使用Windows或SQL Server混合许可证节省成本，这能使托管实例的成本降低近85%。这些福利也可以应用于虚拟机操作系统。*图7.6*显示了一些涉及预留实例（RI）和Azure混合福利的潜在成本节省：
- en: '![Comparing different Azure pricing models and potential cost savings](img/B17153_07_06.jpg)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![比较不同的Azure定价模型和潜在的成本节省](img/B17153_07_06.jpg)'
- en: 'Figure 7.6: Potential cost savings'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.6：潜在的成本节省
- en: It is recommended that you use the Hybrid Benefit calculator to figure out your
    overall cost savings using the hybrid model, which can be found at [https://azure.microsoft.com//pricing/hybrid-benefit/#calculator](https://azure.microsoft.com//pricing/hybrid-benefit/#calculator).
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 推荐使用混合福利计算器来计算使用混合模型的整体成本节省，计算器可以在[https://azure.microsoft.com//pricing/hybrid-benefit/#calculator](https://azure.microsoft.com//pricing/hybrid-benefit/#calculator)找到。
- en: Azure reservations
  id: totrans-90
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Azure预留
- en: Azure reservations can help you save money when you commit to a one- or three-year
    cost for your resources. These commitments can save up to 72% of costs over the
    pay-as-you-go pricing, since this is a contract in time to use these resources
    that you pay for upfront. Reservations should be used when you have long-term
    application plans in play that fit the timescales. They are only applied to specific
    resources in Azure, such as VMs.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: Azure预留可以帮助你在为资源承诺一年或三年的费用时节省资金。这些承诺可以使费用比按需定价节省最多72%，因为这是一项预付费用的资源使用时间合同。只有在你有长期应用计划并且符合时间要求时，预留才应使用。它们仅适用于Azure中的特定资源，如虚拟机（VM）。
- en: 'To learn more about reservations, visit the following links:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多有关预留的信息，请访问以下链接：
- en: '[https://azure.microsoft.com/reservations/](https://azure.microsoft.com/reservations/)'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://azure.microsoft.com/reservations/](https://azure.microsoft.com/reservations/)'
- en: '[https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations](https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations)'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations](https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations)'
- en: '[https://azure.microsoft.com/pricing/reserved-vm-instances/](https://azure.microsoft.com/pricing/reserved-vm-instances/)'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[https://azure.microsoft.com/pricing/reserved-vm-instances/](https://azure.microsoft.com/pricing/reserved-vm-instances/)'
- en: Spot Virtual Machines
  id: totrans-96
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Spot虚拟机
- en: Spot Virtual Machines allows you to use unused Azure compute capacity at deep
    discounts. The caveat is that when Azure needs the capacity back, it will evict
    your Spot VM. For this reason, Spot VMs are well-suited for workloads that can
    be interrupted, such as batch processing, non-production environments, big data
    analytics, and container-based and large-scale stateless applications. The available
    capacity varies from region to region, depending on the time of day or size of
    the workload; as a result, these VMs have no SLA. You can view the price history
    and the eviction rate for the Spot VMs you select in the Azure portal.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: Spot 虚拟机允许您以大幅折扣使用 Azure 未使用的计算能力。需要注意的是，当 Azure 需要恢复该计算能力时，它会驱逐您的 Spot 虚拟机。因此，Spot
    虚拟机非常适合那些可以中断的工作负载，如批处理、非生产环境、大数据分析、基于容器的大规模无状态应用程序等。可用的计算能力因地区而异，取决于一天中的时间或工作负载的大小；因此，这些虚拟机没有服务级别协议（SLA）。您可以在
    Azure 门户中查看所选 Spot 虚拟机的价格历史和驱逐率。
- en: If you would like to learn more about using Spot VMs, visit [https://docs.microsoft.com/azure/virtual-machines/spot-vms](https://docs.microsoft.com/azure/virtual-machines/spot-vms).
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想了解更多关于使用 Spot 虚拟机的信息，请访问[https://docs.microsoft.com/azure/virtual-machines/spot-vms](https://docs.microsoft.com/azure/virtual-machines/spot-vms)。
- en: DevTest pricing
  id: totrans-99
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: DevTest 定价
- en: Azure DevTest enables developers to create VMs or other PaaS resources without
    needing fast approval. It allows teams to develop non-production environments
    to test applications rapidly and enables organizations to put a consistent budget
    on these non-production resources or sandbox areas. In addition, it gives you
    the ability to set auto-startup and shutdown schedules for VMs in order to cut
    costs and allows policies to be put in place to ensure larger resources don't
    get used.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: Azure DevTest 使开发人员可以创建虚拟机或其他 PaaS 资源，而无需快速批准。它允许团队开发非生产环境，以快速测试应用程序，并使组织能够为这些非生产资源或沙箱区域设置一致的预算。此外，它还允许您为虚拟机设置自动启动和关机计划，以降低成本，并允许设置策略以确保不使用更大的资源。
- en: To learn more about how to use Azure DevTest, go to [https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview](https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview).
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解更多关于如何使用 Azure DevTest，请访问[https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview](https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview)。
- en: Optimization checklist
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 优化清单
- en: 'Based on what we''ve learned in this chapter, here are some ways to optimize
    your costs in Azure that you can implement today:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 基于我们在本章中学到的内容，以下是一些您可以立即实施的 Azure 成本优化方法：
- en: Right-size your unused resources because they can scale both horizontally and
    vertically in the cloud.
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据需要调整未使用资源的大小，因为它们可以在云中水平和垂直扩展。
- en: Shut down your unused resources when they aren't needed. This can be handled
    through automation scripting.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在未使用时关闭您的资源。这可以通过自动化脚本来处理。
- en: Take advantage of hybrid models in the cloud, only moving the necessary workloads
    to the cloud. Get more information at [https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations](https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations).
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 利用云中的混合模型，仅将必要的工作负载迁移到云中。获取更多信息，请访问[https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations](https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations)。
- en: Use reserve instances for the large VM resources that you know you're going
    to use for an extended period of time in the cloud.
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 对您知道会在云中长时间使用的大型虚拟机资源使用预留实例。
- en: Set up budgets, allocate costs to different groups, and get alerts when you
    get close to these budgets.
  id: totrans-108
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置预算，将成本分配到不同的组，并在接近预算时接收警报。
- en: Set up Azure DevTest environments for development and testing before publishing
    to your public workloads.
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 设置 Azure DevTest 环境，用于开发和测试，然后再发布到您的公共工作负载中。
- en: Explore other Azure services like PaaS, SaaS, or serverless to optimize your
    approach to the cloud and control costs.
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 探索其他 Azure 服务，如 PaaS、SaaS 或无服务器，以优化您对云的使用并控制成本。
- en: Cost-optimize your workloads, following your Azure Advisor best practice recommendations.
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照 Azure 顾问的最佳实践建议优化您的工作负载成本。
- en: Review the architecture of your workloads using the Microsoft Azure Well-Architected
    Review assessment and design documentation to see where you can optimize costs.
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Microsoft Azure 优良架构评审评估和设计文档审查您的工作负载架构，看看在哪里可以优化成本。
- en: Take advantage of Azure offers and licensing terms such as Azure Hybrid Benefit,
    paying in advance for predictable workloads with reservations, Azure Spot Virtual
    Machines, and Azure Dev/Test pricing. For more information on Azure offers, visit
    [https://azure.microsoft.com/support/legal/offer-details/](https://azure.microsoft.com/support/legal/offer-details/).
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Summary
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As you have seen, it is beneficial for organizations to put organization-wide
    cost management and guardrails in place to help free up their teams so they can
    provide more innovation. Balancing your workloads for performance and resiliency
    while trying to maintain costs in the cloud can be cumbersome, and you shouldn't
    allow costs to be the only driving force.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we have reviewed ways to optimize your costs, from right-sizing
    or creating automation around unused resources to building budgets and alerts
    for your teams to monitor expenses.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: With Azure, there is a distinct cost difference between on-premises datacenters
    and virtualizing those datacenters in the cloud. We reviewed some of the ways
    to approach these costs and cost models in Azure. We talked about the unique benefits
    of adopting Azure, including the ability to span to the cloud with hybrid models
    for workloads that don't entirely need to run in the cloud. We have also seen
    some tools to help manage and optimize costs.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: 'In summary, remember to always:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
- en: Choose the Azure compute services appropriate to your needs
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Right-size resources
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Shut down resources that are not being used
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configure autoscaling
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Reserve instances
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use Azure Hybrid Benefit
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Set up budgets for different teams and projects
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We shouldn't allow costs to drive our use of Azure but be aware of those things
    that can affect the bottom line.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
