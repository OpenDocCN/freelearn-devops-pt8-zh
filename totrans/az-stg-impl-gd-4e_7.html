<html><head></head><body>
		<div>
			<div id="_idContainer086" class="Content">
			</div>
		</div>
		<div id="_idContainer087" class="Content">
			<h1 id="_idParaDest-145">7. <a id="_idTextAnchor202"/>Offers, support, resources, and tips to optimize cost in Azure</h1>
		</div>
		<div id="_idContainer094" class="Content">
			<p>In the previous chapter, you saw the fundamentals of protecting your applications against cybercrime. We will now focus on various offers provided by Azure and the support you get from Microsoft to optimize costs, various tools that can be used to bring down costs, and tips for managing these costs.</p>
			<p>As organizations begin their journey to the cloud, one of the main things they have to learn is how to optimize their costs. From a customer point of view, cost forecasting can be based on how to reduce their datacenter footprint, OPEX pricing models, staff productivity, and other factors.</p>
			<p>In this chapter, we will cover the following:</p>
			<ul>
				<li>Understanding and forecasting your costs</li>
				<li>Strategies for optimizing your costs</li>
			</ul>
			<p>The first step is understanding and planning for the costs your organization faces.  </p>
			<h2 id="_idParaDest-146"><a id="_idTextAnchor203"/>Understanding and forecasting your costs</h2>
			<p>Organizations should perform timely analysis on their Azure invoice to monitor costs and reduce the overhead required to manage their IT resources. Using tools such as Azure Cost Management and Billing and Azure Advisor, you can analyze, manage, and optimize your workloads. Before we take a look at these tools and the benefits they provide, we must first understand the factors that are most critical for forecasting your costs in a cloud infrastructure.</p>
			<h3 id="_idParaDest-147"><a id="_idTextAnchor204"/>Cloud economics</h3>
			<p>It is important for businesses to understand cloud economics so they can forecast their costs and maximize their cloud investment. Businesses should analyze what their <strong class="bold">return on investment</strong> (<strong class="bold">ROI</strong>) should be when migrating from an on-premises workload to the cloud or switching from other workloads to Azure. Primarily, you will need to benchmark the cost of running your current datacenter. This can include capital costs, maintenance and operational costs, and software licensing costs. You should also determine the cost of migrating your IT operations to the cloud.</p>
			<p>To sum up cloud economics, your organization's focus should be on the following eight-point formula:</p>
			<ol>
				<li>Reduce your datacenter footprint by streamlining operations.</li>
				<li>Focus on utilizing on-demand cloud benefits as part of an operational expenditure model.</li>
				<li>Increase productivity by freeing up your staff from maintenance tasks.</li>
				<li>Strive for business sustainability.</li>
				<li>Explore your scalability options and deliver resources when they're needed.</li>
				<li>Meet security and compliance standards.</li>
				<li>Use high-availability cloud infrastructure to ensure business continuity.</li>
				<li>Optimize workload and usage costs.</li>
			</ol>
			<p>Azure offers solutions to help you toward all these goals, which we will explore in the following sections.</p>
			<h3 id="_idParaDest-148"><a id="_idTextAnchor205"/>Cost management tools</h3>
			<p>Azure has a wide range of tools to provide a great developer and operations experience and to help with understanding the cost of the resources being used in Azure. All the cost management solutions discussed in this chapter have a business impact if utilized properly. Let's take a look at the list of tools available to you in Azure.</p>
			<h3>Azure Cost Management and Billing</h3>
			<p>With its full set of cloud cost management capabilities and a single, unified view across all your clouds, Azure Cost Management and Billing helps you increase organizational accountability and manage your cloud spending with confidence. The <strong class="bold">Cost Management and Billing</strong> service enables you to check out billing scopes, drill down into your cost management, review your management groups, and diagnose and troubleshoot problems:</p>
			<div>
				<div id="_idContainer088" class="IMG---Figure">
					<img src="image/B17153_07_01.jpg" alt="The Cost Management + Billing pane in the Azure portal"/>
				</div>
			</div>
			<p class="figure">Figure 7.1: Cost Management + Billing page </p>
			<p>Management groups are a unique way to group subscriptions and costs. While this chapter is not on management groups, it's worth noting that they're still a useful Azure resource to manage your subscriptions.</p>
			<p>Organizations need to take a unique approach to provide access to cost management to users that aren't in the financial part of the organization. There are ways to allow these cost structures to be visible to your organization's operations and development side. Power BI dashboards and APIs can be used to pull reports and create neat, unique dashboards to access cost information; you can read more about this here: <a href="https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management">https://docs.microsoft.com/power-bi/connect-data/desktop-connect-azure-cost-management</a>. As well as Power BI, Azure allows integration with custom-written apps, as well as SaaS applications like CRM for digesting and using your data.</p>
			<p>As mentioned, management groups can help provide a better view of costs, and you can use tags to assign the budget codes within an organization. The following screenshot demonstrates how costs can be visualized on a service basis:</p>
			<div>
				<div id="_idContainer089" class="IMG---Figure">
					<img src="image/B17153_07_02.jpg" alt="An overview of costs grouped by service"/>
				</div>
			</div>
			<p class="figure">Figure 7.2: Costs grouped by service</p>
			<p>With Azure, your organization can easily manage the costs of hybrid cloud environments (Azure and AWS, say) from a single location, getting the best insights from data from both clouds.</p>
			<p>Let's take a quick look at the <strong class="bold">Cost Management</strong> section for the pay-as-you-go model (a pricing model we will discuss later in the chapter):</p>
			<div>
				<div id="_idContainer090" class="IMG---Figure">
					<img src="image/B17153_07_03.jpg" alt="The Cost Management section in the Azure portal"/>
				</div>
			</div>
			<p class="figure">Figure 7.3: Cost Management section</p>
			<p>As you can see, the <strong class="bold">Cost Management</strong> section allows you to analyze costs, create cost alerts, assign budgets, and get advisor recommendations. When you click on <strong class="bold">Cost analysis</strong>, you'll get a breakdown of the resources within the resource group's scope, such as data stores or serverless accounts.</p>
			<p>You can also set cost alerts, which is an excellent tool to help monitor overspend on non-production environments, by setting a threshold and then receiving alerts. Alerting can be used in conjunction with budgets, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer091" class="IMG---Figure">
					<img src="image/B17153_07_04.jpg" alt="The Cost alerts pane as seen in the Azure portal"/>
				</div>
			</div>
			<p class="figure">Figure 7.4: Alerts for budget threshold</p>
			<p>Budgets and alerts are an invaluable next step for organizations after they have visualized their current spending. You should monitor and analyze your Azure bill to ensure there aren't any charges or hidden infrastructure that have made their way through. This is generally essential for non-production environments, where things are a little bit more loosely controlled than in production.</p>
			<p>When an alert is triggered, you should undertake a cost review to isolate the causes and determine whether any action needs to be taken. This could be in the form of revising your budgets or implementing additional Azure Policy controls, to name a few. Assigning budgets also helps with controlling the costs of your different teams' projects and business units.</p>
			<p>To read about Azure Policy and its important role in governance, visit <a href="https://docs.microsoft.com/azure/governance/policy/overview">https://docs.microsoft.com/azure/governance/policy/overview</a>.</p>
			<p>To find out more about the capabilities of Azure Cost Management and Billing, visit <a href="https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview">https://docs.microsoft.com/azure/cost-management-billing/cost-management-billing-overview</a>.</p>
			<h3>Azure pricing calculator</h3>
			<p>The Azure pricing calculator is a free tool that can be used to get real-time cost estimates of subscription services. You can personalize your view of the estimates through a central dashboard. The pricing calculator can be combined with other utilities, such as the Azure <strong class="bold">Total Cost of Ownership</strong> (<strong class="bold">TCO</strong>) calculator, for better cost optimization. We can create estimates and save them to our accounts, or share them with relevant parties.</p>
			<p>Azure regions can sometimes affect the cost of resources in Azure, so it is helpful to use the Azure pricing calculator to predict costs before selecting a resource:</p>
			<div>
				<div id="_idContainer092" class="IMG---Figure">
					<img src="image/B17153_07_05.jpg" alt="Azure Pricing Calculator overview"/>
				</div>
			</div>
			<p class="figure">Figure 7.5: The Azure pricing calculator</p>
			<p>The Azure pricing calculator can be found here: <a href="https://azure.microsoft.com/pricing/calculator/">https://azure.microsoft.com/pricing/calculator/</a>.</p>
			<p>One of the hurdles organizations can run into when using the pricing calculator is factoring in the infrastructure around the resources, they are looking for to get the right estimate. You should always take into account all of the network infrastructure needed to deploy your applications to the cloud.</p>
			<p>For example, consider an organization with two VMs, one running a website and the other running services to support that website, which wants to move both VMs out to the cloud. They go to the pricing calculator, input the two VMs in the pricing calculator, and discover their average monthly cost.</p>
			<p>One of the things that they should have done in this scenario is look at the VMs' usage to right-size them in Azure. A lot of organizations over-allocate machines that are needed for future expansion, but in the cloud, you can expand any time you need to, so you don't need to put oversized resources into play. The organization also missed the routers and firewalls and didn't take into account VM scale sets, or the ability to protect their infrastructure should a VM go down. As you can see, a good plan can go a long way.</p>
			<h3>Total Cost of Ownership calculator</h3>
			<p>When businesses want to take a bigger, holistic view of what it means to migrate their Azure solutions, they can use the TCO calculator. This provides detailed information about moving on-premises workloads to the cloud and what it will take to make the transition smoother.</p>
			<p>You can find more information about this calculator at <a href="https://azure.microsoft.com/pricing/tco/calculator/">https://azure.microsoft.com/pricing/tco/calculator/</a>.</p>
			<h3>Azure Migrate</h3>
			<p>Another tool to use if you're choosing to migrate from on-premises to the cloud is Azure Migrate. Azure Migrate provides a centralized single pane of glass view to assess and migrate on-premises servers, infrastructures, applications, and data to the cloud. This assists organizations by providing a wide range of tools and options to help the process of assessing and migrating these different resources and workloads to Azure.</p>
			<p>For more information on how to use Azure Migrate, go to <a href="https://docs.microsoft.com/azure/migrate/migrate-services-overview">https://docs.microsoft.com/azure/migrate/migrate-services-overview</a>.</p>
			<h3 id="_idParaDest-149"><a id="_idTextAnchor206"/>Choosing the right pricing model</h3>
			<p>As well as tools, it is equally important to understand the various pricing models Azure offers to better forecast your resources and their costs. In Azure, there are two standard pricing models for services:</p>
			<ul>
				<li>The pay-as-you-go model, also known as the consumption-based model</li>
				<li>The fixed-price model</li>
			</ul>
			<p>Most Azure resources, such as PaaS or serverless, will use the consumption-based model. An example of fixed pricing is Azure <strong class="bold">Reserved Virtual Machine Instances</strong> (<strong class="bold">RIs</strong>), or <strong class="bold">Azure Reservations</strong> more broadly.</p>
			<p>The fixed-price model is more predictable, while the pay-as-you-go model can be variable, so you need to consider business requirements when choosing between them. We'll go into detail about both models in the following sections.</p>
			<h3>Consumption-based model</h3>
			<p>The consumption-based, or pay-as-you-go, model follows a utility-based structure. This means that you pay for what you use and there is no monthly or fixed cost for the resources. An example of this would be a function application, where you'd pay one dollar for a million uses of the app.</p>
			<p>This pay-for-what-you-use model can help you control costs, but could also potentially increase them. An example of this might be something like CosmosDB, which is based on usage or request units and can become very costly at the end of the day depending on how many times queries are run.</p>
			<p>You can use architectural patterns like base load-leveling and autoscaling of services to help with fixed minimum performance levels. If you need burst workloads, you can use something like a throttle pattern to maintain the quality of the service under load.</p>
			<h3>Fixed-price model</h3>
			<p>Under a fixed-price model, you pay for a resource whether it is used or not. We already mentioned Azure reservations and specifically RIs, but another example would be an App Service plan in Azure. When you select a type of resource you incur a monthly cost, and regardless of how many people utilize the application, you still pay this cost. This costing model helps organizations predict their spending in Azure a little better, but it can also be a problem based on utilization.</p>
			<p>Organizations buy reserved instances when they plan to make extensive use of VMs for their applications. In return for committing to resources for fixed terms, Azure can provide them at discounted rates. When you first migrate to the cloud, there may be uncertainty around your resource usage, so depending on your workloads, it may be best to get a handle on this before you consider RIs.</p>
			<p>There is a trade-off between scalability and predictability when keeping costs structured, and most organizations opt for a blended approach of the two pricing models.</p>
			<p>For more information on pricing models, head over to <a href="https://docs.microsoft.com/azure/architecture/framework/cost/design-price">https://docs.microsoft.com/azure/architecture/framework/cost/design-price</a>.</p>
			<p>Now that we have an understanding of the various ways Azure can help you to assess and keep on top of your costs, we'll move on to optimizing these costs.</p>
			<h2 id="_idParaDest-150"><a id="_idTextAnchor207"/>Optimizing your costs</h2>
			<p>Cost optimization is the process of reducing your resource costs by identifying waste, mismanaged resources, and right-sized resources, and also by reserving capacity. With cost management being one of the five principles of cloud governance, it is important to focus on ways of establishing a spending plan and budget for your cloud resources. You will also want to use monitoring and alerting to enforce these budgets and detect anomalies that emerge from development practices. Microsoft provides the Cloud Adoption Framework for guidance on this, which details tools, best practices, and documentation to help organizations succeed in the cloud. You can find more information at <a href="https://docs.microsoft.com/azure/cloud-adoption-framework/.">https://docs.microsoft.com/azure/cloud-adoption-framework/.</a> </p>
			<p>A general method for estimating cost and making changes to the pricing models we discussed earlier is by monitoring your workloads on a peak throughput. For example, if the utilization is high all the time, a pay-as-you-go model would be less efficient for baseline cost estimation. Hence, while providing flexibility, the pay-as-you-go model alone doesn't always constitute a cost-saving.</p>
			<p>As has already been pointed out, the best cost optimization is having a plan, so you should use the tools at hand, from pricing calculators to checklists, to establish your policies, budgets, and controls to limit the spending on your solutions. The Azure Well-Architected Framework is a great starting point for building these policies and a good source of information. It is located at <a href="https://docs.microsoft.com/azure/architecture/framework/cost/.">https://docs.microsoft.com/azure/architecture/framework/cost/.</a> We discussed the Azure Well-Architected Framework in <em class="italics">Chapter 4, Cloud migration: Planning, implementation, and best practices</em>.</p>
			<p>As we begin exploring the optimization options Azure provides in the next few sections, you should keep in mind that it's not just about moving a workload to Azure, but all the things surrounding it as well. When migrating to the cloud, many organizations miss some of the associated underlying infrastructure costs.</p>
			<h3 id="_idParaDest-151"><a id="_idTextAnchor208"/>Azure Advisor</h3>
			<p>One of the useful services you can access through Azure Cost Management is Azure Advisor. Azure Advisor analyzes your resource configuration and usage, providing personalized offers and recommendations so you can optimize your resources for cost-effectiveness, security, and performance. For example, it helps to point out unused resources or those that have been idle for a long time, including right-sizing resources like SQL.</p>
			<p>For more information on Azure Advisor, visit <a href="https://docs.microsoft.com/azure/advisor/advisor-overview">https://docs.microsoft.com/azure/advisor/advisor-overview</a>.</p>
			<p>It is important to point out that you should right-size your resources for the cloud. Most organizations overbuy internal infrastructure only for the purposes of future growth. When moving to Azure, you can scale horizontally as well as vertically, so if your machine needs more resources, you can add more. You can also use a hybrid approach, where you don't need to move all of your workloads out to the cloud—you can move the pieces of the workload that need more performance or more scalability at the instance level.</p>
			<h3 id="_idParaDest-152"><a id="_idTextAnchor209"/>Azure Hybrid Benefit</h3>
			<p>Azure Hybrid Benefit is a licensing benefit that drastically lowers the cost of running workloads in the cloud. It will allow you to use on-premises software assurance-enabled Windows or SQL Server licenses, as well as Red Hat and SUSE Linux subscriptions, on Azure. These types of benefits can drive down costs by 40% or more. Furthermore, you are given three additional years of security updates for free when you move your Windows Server or SQL Server 2008 and 2008 R2 workloads to Azure.</p>
			<p>One of Microsoft's primary goals of the Hybrid Benefit model is the savings that come from using a Windows or SQL Server Hybrid license, which drives down the cost of a managed instance by almost 85%. These benefits can apply to VM operating systems as well. <em class="italics">Figure 7.6</em> shows some potential cost savings involving RIs and Azure Hybrid Benefit:</p>
			<div>
				<div id="_idContainer093" class="IMG---Figure">
					<img src="image/B17153_07_06.jpg" alt="Comparing different Azure pricing models and potential cost savings"/>
				</div>
			</div>
			<p class="figure">Figure 7.6: Potential cost savings</p>
			<p>It is recommended that you use the Hybrid Benefit calculator to figure out your overall cost savings using the hybrid model, which can be found at <a href="https://azure.microsoft.com//pricing/hybrid-benefit/#calculator">https://azure.microsoft.com//pricing/hybrid-benefit/#calculator</a>.</p>
			<h3 id="_idParaDest-153"><a id="_idTextAnchor210"/>Azure reservations</h3>
			<p>Azure reservations can help you save money when you commit to a one- or three-year cost for your resources. These commitments can save up to 72% of costs over the pay-as-you-go pricing, since this is a contract in time to use these resources that you pay for upfront. Reservations should be used when you have long-term application plans in play that fit the timescales. They are only applied to specific resources in Azure, such as VMs.</p>
			<p>To learn more about reservations, visit the following links:</p>
			<ul>
				<li><a href="https://azure.microsoft.com/reservations/">https://azure.microsoft.com/reservations/</a></li>
				<li><a href="https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations">https://docs.microsoft.com/azure/cost-management-billing/reservations/save-compute-costs-reservations</a></li>
				<li><a href="https://azure.microsoft.com/pricing/reserved-vm-instances/">https://azure.microsoft.com/pricing/reserved-vm-instances/</a></li>
			</ul>
			<h3 id="_idParaDest-154"><a id="_idTextAnchor211"/>Spot Virtual Machines</h3>
			<p>Spot Virtual Machines allows you to use unused Azure compute capacity at deep discounts. The caveat is that when Azure needs the capacity back, it will evict your Spot VM. For this reason, Spot VMs are well-suited for workloads that can be interrupted, such as batch processing, non-production environments, big data analytics, and container-based and large-scale stateless applications. The available capacity varies from region to region, depending on the time of day or size of the workload; as a result, these VMs have no SLA. You can view the price history and the eviction rate for the Spot VMs you select in the Azure portal.</p>
			<p>If you would like to learn more about using Spot VMs, visit <a href="https://docs.microsoft.com/azure/virtual-machines/spot-vms">https://docs.microsoft.com/azure/virtual-machines/spot-vms</a>.</p>
			<h3 id="_idParaDest-155"><a id="_idTextAnchor212"/>DevTest pricing</h3>
			<p>Azure DevTest enables developers to create VMs or other PaaS resources without needing fast approval. It allows teams to develop non-production environments to test applications rapidly and enables organizations to put a consistent budget on these non-production resources or sandbox areas. In addition, it gives you the ability to set auto-startup and shutdown schedules for VMs in order to cut costs and allows policies to be put in place to ensure larger resources don't get used.</p>
			<p>To learn more about how to use Azure DevTest, go to <a href="https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview">https://docs.microsoft.com/azure/devtest-labs/devtest-lab-overview</a>.</p>
			<h3 id="_idParaDest-156"><a id="_idTextAnchor213"/>Optimization checklist</h3>
			<p>Based on what we've learned in this chapter, here are some ways to optimize your costs in Azure that you can implement today:</p>
			<ol>
				<li value="1">Right-size your unused resources because they can scale both horizontally and vertically in the cloud.</li>
				<li>Shut down your unused resources when they aren't needed. This can be handled through automation scripting.</li>
				<li>Take advantage of hybrid models in the cloud, only moving the necessary workloads to the cloud. Get more information at <a href="https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations">https://docs.microsoft.com/azure/cost-management-billing/costs/tutorial-acm-opt-recommendations</a>.</li>
				<li>Use reserve instances for the large VM resources that you know you're going to use for an extended period of time in the cloud.</li>
				<li>Set up budgets, allocate costs to different groups, and get alerts when you get close to these budgets. </li>
				<li>Set up Azure DevTest environments for development and testing before publishing to your public workloads. </li>
				<li>Explore other Azure services like PaaS, SaaS, or serverless to optimize your approach to the cloud and control costs. </li>
				<li>Cost-optimize your workloads, following your Azure Advisor best practice recommendations.</li>
				<li>Review the architecture of your workloads using the Microsoft Azure Well-Architected Review assessment and design documentation to see where you can optimize costs.</li>
				<li>Take advantage of Azure offers and licensing terms such as Azure Hybrid Benefit, paying in advance for predictable workloads with reservations, Azure Spot Virtual Machines, and Azure Dev/Test pricing. For more information on Azure offers, visit <a href="https://azure.microsoft.com/support/legal/offer-details/">https://azure.microsoft.com/support/legal/offer-details/</a>.</li>
			</ol>
			<h2 id="_idParaDest-157"><a id="_idTextAnchor214"/>Summary</h2>
			<p>As you have seen, it is beneficial for organizations to put organization-wide cost management and guardrails in place to help free up their teams so they can provide more innovation. Balancing your workloads for performance and resiliency while trying to maintain costs in the cloud can be cumbersome, and you shouldn't allow costs to be the only driving force.</p>
			<p>In this chapter, we have reviewed ways to optimize your costs, from right-sizing or creating automation around unused resources to building budgets and alerts for your teams to monitor expenses.</p>
			<p>With Azure, there is a distinct cost difference between on-premises datacenters and virtualizing those datacenters in the cloud. We reviewed some of the ways to approach these costs and cost models in Azure. We talked about the unique benefits of adopting Azure, including the ability to span to the cloud with hybrid models for workloads that don't entirely need to run in the cloud. We have also seen some tools to help manage and optimize costs.</p>
			<p>In summary, remember to always:</p>
			<ul>
				<li>Choose the Azure compute services appropriate to your needs</li>
				<li>Right-size resources</li>
				<li>Shut down resources that are not being used</li>
				<li>Configure autoscaling</li>
				<li>Reserve instances </li>
				<li>Use Azure Hybrid Benefit </li>
				<li>Set up budgets for different teams and projects</li>
			</ul>
			<p>We shouldn't allow costs to drive our use of Azure but be aware of those things that can affect the bottom line.</p>
		</div>
	</body></html>