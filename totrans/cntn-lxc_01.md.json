["```\n#define _GNU_SOURCE \n#include <sched.h> \nint clone(int (*fn)(void *), void *child_stack, int flags, void *arg); \n\n```", "```\nchild_pid = clone(childFunc, child_stack + STACK_SIZE, CLONE_NEWNS | SIGCHLD, argv[1]); \n\n```", "```\n    root@server:~# mkdir /tmp/mount_ns\n    root@server:~#\n\n    ```", "```\n    root@server:~# unshare -m /bin/bash\n    root@server:~#\n\n    ```", "```\n    root@server:~# readlink /proc/$$/ns/mnt\n    mnt:[4026532211]\n    root@server:~#\n\n    ```", "```\n    root@server:~# mount -n -t tmpfs tmpfs /tmp/mount_ns\n    root@server:~#\n\n    ```", "```\n    root@server:~# df -h | grep mount_ns\n    tmpfs           3.9G     0  3.9G   0% /tmp/mount_ns \n    root@server:~# cat /proc/mounts | grep mount_ns\n    tmpfs /tmp/mount_ns tmpfs rw,relatime 0 0\n    root@server:~#\n\n    ```", "```\n    root@server:~# readlink /proc/$$/ns/mnt\n    mnt:[4026531840]\n    root@server:~#\n\n    ```", "```\n    root@server:~# cat /proc/mounts | grep mount_ns\n    root@server:~# df -h | grep mount_ns\n    root@server:~#\n\n    ```", "```\nroot@server:~# hostname\nserver\nroot@server:~# unshare -u /bin/bash\nroot@server:~# hostname uts-namespace\nroot@server:~# hostname\nuts-namespace\nroot@server:~# cat /proc/sys/kernel/hostname\nuts-namespace\nroot@server:~#\n\n```", "```\nroot@server:~# hostname\nserver\nroot@server:~#\n\n```", "```\nroot@server:~# strace -s 2000 -f unshare -u /bin/bash\n...\nunshare(CLONE_NEWUTS)                   = 0\ngetgid()                                = 0\nsetgid(0)                               = 0\ngetuid()                                = 0\nsetuid(0)                               = 0\nexecve(\"/bin/bash\", [\"/bin/bash\"], [/* 15 vars */]) = 0\n...\n\n```", "```\n#define _GNU_SOURCE \n#include <stdlib.h> \n#include <stdio.h> \n#include <signal.h> \n#include <sched.h> \n\nstatic int childFunc(void *arg) \n{ \n    printf(\"Process ID in child  = %ld\\n\", (long) getpid()); \n} \n\n```", "```\nstatic char child_stack[1024*1024]; \n\nint main(int argc, char *argv[]) \n{ \n    pid_t child_pid; \n\n    child_pid = clone(childFunc, child_stack + \n    (1024*1024),      \n    CLONE_NEWPID | SIGCHLD, NULL); \n\n    printf(\"PID of cloned process: %ld\\n\", (long) child_pid); \n    waitpid(child_pid, NULL, 0); \n    exit(EXIT_SUCCESS); \n} \n\n```", "```\nroot@server:~# gcc pid_namespace.c -o pid_namespace\nroot@server:~# ./pid_namespace\nPID of cloned process: 17705\nProcess ID in child  = 1\nroot@server:~#\n\n```", "```\nroot@ubuntu:~# cd /usr/src/\nroot@ubuntu:/usr/src# wget https://www.kernel.org/pub/linux/utils/util-linux/v2.28/util-linux-2.28.tar.gz\nroot@ubuntu:/usr/src# tar zxfv util-linux-2.28.tar.gz\nroot@ubuntu:/usr/src# cd util-linux-2.28/\nroot@ubuntu:/usr/src/util-linux-2.28# ./configure\nroot@ubuntu:/usr/src/util-linux-2.28# make && make install\nroot@ubuntu:/usr/src/util-linux-2.28# unshare --map-root-user --user sh -c whoami\nroot\nroot@ubuntu:/usr/src/util-linux-2.28#\n\n```", "```\n#define _GNU_SOURCE \n#include <stdlib.h> \n#include <stdio.h> \n#include <signal.h> \n#include <sched.h> \n\nstatic int childFunc(void *arg) \n{ \n    printf(\"UID inside the namespace is %ld\\n\", (long) \n    geteuid()); \n    printf(\"GID inside the namespace is %ld\\n\", (long) \n    getegid()); \n} \n\nstatic char child_stack[1024*1024]; \n\nint main(int argc, char *argv[]) \n{ \n    pid_t child_pid; \n\n    child_pid = clone(childFunc, child_stack +  \n    (1024*1024),        \n    CLONE_NEWUSER | SIGCHLD, NULL); \n\n    printf(\"UID outside the namespace is %ld\\n\", (long)       \n    geteuid()); \n    printf(\"GID outside the namespace is %ld\\n\", (long)      \n    getegid()); \n    waitpid(child_pid, NULL, 0); \n    exit(EXIT_SUCCESS); \n} \n\n```", "```\nroot@server:~# gcc user_namespace.c -o user_namespace\nroot@server:~# ./user_namespace\nUID outside the namespace is 0\nGID outside the namespace is 0\nUID inside the namespace is 65534\nGID inside the namespace is 65534\nroot@server:~#\n\n```", "```\nroot@server:~# ip link\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default\n link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000\n link/ether 0e:d5:0e:b0:a3:47 brd ff:ff:ff:ff:ff:ff\nroot@server:~#\n\n```", "```\nroot@server:~# ip a s\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default\n link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\ninet 127.0.0.1/8 scope host lo\nvalid_lft forever preferred_lft forever\ninet6 ::1/128 scope host\n valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc pfifo_fast state UP group default qlen 1000\n link/ether 0e:d5:0e:b0:a3:47 brd ff:ff:ff:ff:ff:ff\ninet 10.1.32.40/24 brd 10.1.32.255 scope global eth0\nvalid_lft forever preferred_lft forever\ninet6 fe80::cd5:eff:feb0:a347/64 scope link\n valid_lft forever preferred_lft forever\nroot@server:~#\n\n```", "```\nroot@server:~# ip r s\ndefault via 10.1.32.1 dev eth0\n10.1.32.0/24 dev eth0  proto kernel  scope link  src 10.1.32.40\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns add ns1\nroot@server:~# ip netns add ns2\nroot@server:~# ip netns\nns2\nns1\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns exec ns1 ip link\n1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns exec ns1 bash\nroot@server:~# ip link\n1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default\n link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\nroot@server:~# exit\nroot@server:~#\n\n```", "```\nroot@server:~# apt-get install -y openvswitch-switch\nroot@server:~#\n\n```", "```\nroot@server:~# ovs-vsctl add-br OVS-1\nroot@server:~# ovs-vsctl show\n0ea38b4f-8943-4d5b-8d80-62ccb73ec9ec\nBridge \"OVS-1\"\n Port \"OVS-1\"\n Interface \"OVS-1\"\n type: internal\novs_version: \"2.0.2\"\nroot@server:~#\n\n```", "```\nroot@server:~# ip a s OVS-1\n4: OVS-1: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN group default\nlink/ether 9a:4b:56:97:3b:46 brd ff:ff:ff:ff:ff:ff\ninet6 fe80::f0d9:78ff:fe72:3d77/64 scope link\n valid_lft forever preferred_lft forever\nroot@server:~#\n\n```", "```\nroot@server:~# ip link add eth1-ns1 type veth peer name veth-ns1\nroot@server:~# ip link add eth1-ns2 type veth peer name veth-ns2\nroot@server:~#\n\n```", "```\nroot@server:~# ip link\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000\nlink/ether 0e:d5:0e:b0:a3:47 brd ff:ff:ff:ff:ff:ff\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default\nlink/ether 82:bf:52:d3:de:7e brd ff:ff:ff:ff:ff:ff\n4: OVS-1: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN mode DEFAULT group default\nlink/ether 9a:4b:56:97:3b:46 brd ff:ff:ff:ff:ff:ff\n5: veth-ns1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 1a:7c:74:48:73:a9 brd ff:ff:ff:ff:ff:ff\n6: eth1-ns1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 8e:99:3f:b8:43:31 brd ff:ff:ff:ff:ff:ff\n7: veth-ns2: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 5a:0d:34:87:ea:96 brd ff:ff:ff:ff:ff:ff\n8: eth1-ns2: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether fa:71:b8:a1:7f:85 brd ff:ff:ff:ff:ff:ff\nroot@server:~#\n\n```", "```\nroot@server:~# ip link set eth1-ns1 netns ns1\nroot@server:~# ip link set eth1-ns2 netns ns2\n\n```", "```\nroot@server:~# ip netns exec ns1 ip link\n1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n6: eth1-ns1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 8e:99:3f:b8:43:31 brd ff:ff:ff:ff:ff:ff\nroot@server:~#\nroot@server:~# ip netns exec ns2 ip link\n1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN mode DEFAULT group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n8: eth1-ns2: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether fa:71:b8:a1:7f:85 brd ff:ff:ff:ff:ff:ff\nroot@server:~#\n\n```", "```\nroot@server:~# ip link\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 9001 qdisc pfifo_fast state UP mode DEFAULT group default qlen 1000\nlink/ether 0e:d5:0e:b0:a3:47 brd ff:ff:ff:ff:ff:ff\n3: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default\nlink/ether 82:bf:52:d3:de:7e brd ff:ff:ff:ff:ff:ff\n4: OVS-1: <BROADCAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UNKNOWN mode DEFAULT group default\nlink/ether 9a:4b:56:97:3b:46 brd ff:ff:ff:ff:ff:ff\n5: veth-ns1: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 1a:7c:74:48:73:a9 brd ff:ff:ff:ff:ff:ff\n7: veth-ns2: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT group default qlen 1000\nlink/ether 5a:0d:34:87:ea:96 brd ff:ff:ff:ff:ff:ff\nroot@server:~#\n\n```", "```\nroot@server:~# ovs-vsctl add-port OVS-1 veth-ns1\nroot@server:~# ovs-vsctl add-port OVS-1 veth-ns2\nroot@server:~# ovs-vsctl show\n0ea38b4f-8943-4d5b-8d80-62ccb73ec9ec\nBridge \"OVS-1\"\n Port \"OVS-1\"\n Interface \"OVS-1\"\n type: internal\n Port \"veth-ns1\"\n Interface \"veth-ns1\"\n Port \"veth-ns2\"\n Interface \"veth-ns2\"\novs_version: \"2.0.2\"\nroot@server:~#\n\n```", "```\nroot@server:~# ip link set veth-ns1 up\nroot@server:~# ip link set veth-ns2 up\nroot@server:~# ip netns exec ns1 ip link set dev lo up\nroot@server:~# ip netns exec ns1 ip link set dev eth1-ns1 up\nroot@server:~# ip netns exec ns1 ip address add 192.168.0.1/24 dev eth1-ns1\nroot@server:~# ip netns exec ns1 ip a s\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\ninet 127.0.0.1/8 scope host lo\n valid_lft forever preferred_lft forever\ninet6 ::1/128 scope host\n valid_lft forever preferred_lft forever\n6: eth1-ns1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\nlink/ether 8e:99:3f:b8:43:31 brd ff:ff:ff:ff:ff:ff\ninet 192.168.0.1/24 scope global eth1-ns1\n valid_lft forever preferred_lft forever\ninet6 fe80::8c99:3fff:feb8:4331/64 scope link\n valid_lft forever preferred_lft forever\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns exec ns2 ip link set dev lo up\nroot@server:~# ip netns exec ns2 ip link set dev eth1-ns2 up\nroot@server:~# ip netns exec ns2 ip address add 192.168.0.2/24 dev eth1-ns2\nroot@server:~# ip netns exec ns2 ip a s\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\ninet 127.0.0.1/8 scope host lo\n valid_lft forever preferred_lft forever\ninet6 ::1/128 scope host\n valid_lft forever preferred_lft forever\n8: eth1-ns2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\nlink/ether fa:71:b8:a1:7f:85 brd ff:ff:ff:ff:ff:ff\ninet 192.168.0.2/24 scope global eth1-ns2\n valid_lft forever preferred_lft forever\ninet6 fe80::f871:b8ff:fea1:7f85/64 scope link\n valid_lft forever preferred_lft forever\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns exec ns1 ping -c 3 192.168.0.2\nPING 192.168.0.2 (192.168.0.2) 56(84) bytes of data.\n64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.414 ms\n64 bytes from 192.168.0.2: icmp_seq=2 ttl=64 time=0.027 ms\n64 bytes from 192.168.0.2: icmp_seq=3 ttl=64 time=0.030 ms\n--- 192.168.0.2 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 1998ms\nrtt min/avg/max/mdev = 0.027/0.157/0.414/0.181 ms\nroot@server:~#\nroot@server:~# ip netns exec ns2 ping -c 3 192.168.0.1\nPING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.\n64 bytes from 192.168.0.1: icmp_seq=1 ttl=64 time=0.150 ms\n64 bytes from 192.168.0.1: icmp_seq=2 ttl=64 time=0.025 ms\n64 bytes from 192.168.0.1: icmp_seq=3 ttl=64 time=0.027 ms\n--- 192.168.0.1 ping statistics ---\n3 packets transmitted, 3 received, 0% packet loss, time 1999ms\nrtt min/avg/max/mdev = 0.025/0.067/0.150/0.058 ms\nroot@server:~#\n\n```", "```\nroot@server:~# ovs-vsctl set port veth-ns1 tag=100\nroot@server:~# ovs-vsctl set port veth-ns2 tag=200\nroot@server:~# ovs-vsctl show\n0ea38b4f-8943-4d5b-8d80-62ccb73ec9ec\nBridge \"OVS-1\"\n Port \"OVS-1\"\n Interface \"OVS-1\"\n type: internal\n Port \"veth-ns1\"\n tag: 100\n Interface \"veth-ns1\"\n Port \"veth-ns2\"\n tag: 200\n Interface \"veth-ns2\"\novs_version: \"2.0.2\"\nroot@server:~#\n\n```", "```\nroot@server:~# ip netns exec ns1 ping -c 3 192.168.0.2\nPING 192.168.0.2 (192.168.0.2) 56(84) bytes of data.\n--- 192.168.0.2 ping statistics ---\n3 packets transmitted, 0 received, 100% packet loss, time 1999ms\nroot@server:~# ip netns exec ns2 ping -c 3 192.168.0.1\nPING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.\n--- 192.168.0.1 ping statistics ---\n3 packets transmitted, 0 received, 100% packet loss, time 1999ms\nroot@server:~#\n\n```", "```\nroot@server:~# unshare --net /bin/bash\nroot@server:~# ip a s\n1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN group default\nlink/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\nroot@server:~# exit\nroot@server\n\n```", "```\nroot@server:~# mkdir -p /cgroup/blkio\nroot@server:~# mount -t cgroup -o blkio blkio /cgroup/blkio\nroot@server:~# cat /proc/mounts | grep cgroup\nblkio /cgroup/blkio cgroup rw, relatime, blkio, crelease_agent=/run/cgmanager/agents/cgm-release-agent.blkio 0 0\nroot@server:~#\n\n```", "```\nroot@server:~# mkdir /cgroup/blkio/high_io\nroot@server:~# mkdir /cgroup/blkio/low_io\nroot@server:~#\n\n```", "```\nroot@server:~# pidof app1 | while read PID; do echo $PID >> /cgroup/blkio/high_io/tasks; done \nroot@server:~# pidof app2 | while read PID; do echo $PID >> /cgroup/blkio/low_io/tasks; done\nroot@server:~#\n\n```", "```\nroot@server:~# echo 1000 > /cgroup/blkio/high_io/blkio.weight\nroot@server:~# echo 100 > /cgroup/blkio/low_io/blkio.weight\nroot@server:~#\n\n```", "```\nroot@server:~# ls -la /cgroup/blkio/high_io/\ndrwxr-xr-x 2 root root 0 Aug 24 16:14 .\ndrwxr-xr-x 4 root root 0 Aug 19 21:14 ..\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_merged\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_merged_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_queued\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_queued_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_service_bytes\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_service_bytes_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_serviced\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_serviced_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_service_time\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_service_time_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_wait_time\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.io_wait_time_recursive\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.leaf_weight\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.leaf_weight_device\n--w------- 1 root root 0 Aug 24 16:14 blkio.reset_stats\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.sectors\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.sectors_recursive\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.io_service_bytes\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.io_serviced\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.read_bps_device\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.read_iops_device\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.write_bps_device\n-rw-r--r-- 1 root root 0 Aug 24 16:14 blkio.throttle.write_iops_device\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.time\n-r--r--r-- 1 root root 0 Aug 24 16:14 blkio.time_recursive\n-rw-r--r-- 1 root root 0 Aug 24 16:49 blkio.weight\n-rw-r--r-- 1 root root 0 Aug 24 17:01 blkio.weight_device\n-rw-r--r-- 1 root root 0 Aug 24 16:14 cgroup.clone_children\n--w--w--w- 1 root root 0 Aug 24 16:14 cgroup.event_control\n-rw-r--r-- 1 root root 0 Aug 24 16:14 cgroup.procs\n-rw-r--r-- 1 root root 0 Aug 24 16:14 notify_on_release\n-rw-r--r-- 1 root root 0 Aug 24 16:14 tasks\nroot@server:~#\n\n```", "```\nroot@server:~# vim /etc/default/grub\nRUB_CMDLINE_LINUX_DEFAULT=\"cgroup_enable=memory\"\nroot@server:~# grub-update && reboot\n\n```", "```\nroot@server:~# mkdir -p /cgroup/memory\nroot@server:~# mount -t cgroup -o memory memory /cgroup/memory\nroot@server:~# cat /proc/mounts | grep memory\nmemory /cgroup/memory cgroup rw, relatime, memory, release_agent=/run/cgmanager/agents/cgm-release-agent.memory 0 0\nroot@server:~#\n\n```", "```\nroot@server:~# mkdir /cgroup/memory/app1\nroot@server:~# echo 1G > /cgroup/memory/app1/memory.limit_in_bytes\nroot@server:~# cat /cgroup/memory/app1/memory.limit_in_bytes\n1073741824\nroot@server:~# pidof app1 | while read PID; do echo $PID >> /cgroup/memory/app1/tasks; done\nroot@server:~#\n\n```", "```\nroot@server:~# ls -la /cgroup/memory/app1/\ndrwxr-xr-x 2 root root 0 Aug 24 22:05 .\ndrwxr-xr-x 3 root root 0 Aug 19 21:02 ..\n-rw-r--r-- 1 root root 0 Aug 24 22:05 cgroup.clone_children\n--w--w--w- 1 root root 0 Aug 24 22:05 cgroup.event_control\n-rw-r--r-- 1 root root 0 Aug 24 22:05 cgroup.procs\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.failcnt\n--w------- 1 root root 0 Aug 24 22:05 memory.force_empty\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.failcnt\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.limit_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.max_usage_in_bytes\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.slabinfo\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.tcp.failcnt\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.tcp.limit_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.tcp.max_usage_in_bytes\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.tcp.usage_in_bytes\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.kmem.usage_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.limit_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.max_usage_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.move_charge_at_immigrate\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.numa_stat\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.oom_control\n---------- 1 root root 0 Aug 24 22:05 memory.pressure_level\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.soft_limit_in_bytes\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.stat\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.swappiness\n-r--r--r-- 1 root root 0 Aug 24 22:05 memory.usage_in_bytes\n-rw-r--r-- 1 root root 0 Aug 24 22:05 memory.use_hierarchy\n-rw-r--r-- 1 root root 0 Aug 24 22:05 tasks\nroot@server:~#\n\n```", "```\nroot@server:~# cat /cgroup/memory/app1/memory.oom_control\noom_kill_disable 0\nunder_oom 0\nroot@server:~# echo 1 > /cgroup/memory/app1/memory.oom_control\nroot@server:~#\n\n```", "```\nroot@server:~# head /cgroup/memory/app1/memory.stat\ncache 43325     # Number of bytes of page cache memory\nrss 55d43       # Number of bytes of anonymous and swap cache memory\nrss_huge 0      # Number of anonymous transparent hugepages\nmapped_file 2   # Number of bytes of mapped file\nwriteback 0     # Number of bytes of cache queued for syncing\npgpgin 0        # Number of charging events to the memory cgroup\npgpgout 0       # Number of uncharging events to the memory cgroup\npgfault 0       # Total number of page faults\npgmajfault 0    # Number of major page faults\ninactive_anon 0 # Anonymous and swap cache memory on inactive LRU list\n\n```", "```\nroot@server:~# echo $$ > /cgroup/memory/app1/tasks\nroot@server:~# echo \"The memory limit is now applied to all processes started from this shell\"\n\n```", "```\nroot@server:~# mkdir -p /cgroup/cpu\nroot@server:~# mount -t cgroup -o cpu cpu /cgroup/cpu\nroot@server:~# cat /proc/mounts | grep cpu\ncpu /cgroup/cpu cgroup rw, relatime, cpu, release_agent=/run/cgmanager/agents/cgm-release-agent.cpu 0 0\n\n```", "```\nroot@server:~# mkdir /cgroup/cpu/limit_60_percent\nroot@server:~# mkdir /cgroup/cpu/limit_40_percent\n\n```", "```\nroot@server:~# echo 600 > /cgroup/cpu/limit_60_percent/cpu.shares\nroot@server:~# echo 400 > /cgroup/cpu/limit_40_percent/cpu.shares\n\n```", "```\nroot@server:~# pidof app1 | while read PID; do echo $PID >> /cgroup/cpu/limit_60_percent/tasks; done\nroot@server:~# pidof app2 | while read PID; do echo $PID >> /cgroup/cpu/limit_40_percent/tasks; done\nroot@server:~#\n\n```", "```\nroot@server:~# ls -la /cgroup/cpu/limit_60_percent/\ndrwxr-xr-x 2 root root 0 Aug 25 15:13 .\ndrwxr-xr-x 4 root root 0 Aug 19 21:02 ..\n-rw-r--r-- 1 root root 0 Aug 25 15:13 cgroup.clone_children\n--w--w--w- 1 root root 0 Aug 25 15:13 cgroup.event_control\n-rw-r--r-- 1 root root 0 Aug 25 15:13 cgroup.procs\n-rw-r--r-- 1 root root 0 Aug 25 15:13 cpu.cfs_period_us\n-rw-r--r-- 1 root root 0 Aug 25 15:13 cpu.cfs_quota_us\n-rw-r--r-- 1 root root 0 Aug 25 15:14 cpu.shares\n-r--r--r-- 1 root root 0 Aug 25 15:13 cpu.stat\n-rw-r--r-- 1 root root 0 Aug 25 15:13 notify_on_release\n-rw-r--r-- 1 root root 0 Aug 25 15:13 tasks\nroot@server:~#\n\n```", "```\nroot@server:~# cat /cgroup/cpu/limit_60_percent/cpu.stat\nnr_periods 0        # number of elapsed period intervals, as specified in\n # cpu.cfs_period_us\nnr_throttled 0      # number of times a task was not scheduled to run\n # because of quota limit\nthrottled_time 0    # total time in nanoseconds for which tasks have been\n # throttled\nroot@server:~#\n\n```", "```\nroot@server:~# mkdir /cgroup/cpuset\nroot@server:~# mount -t cgroup -o cpuset cpuset /cgroup/cpuset\nroot@server:~# mkdir /cgroup/cpuset/app{1..2}\nroot@server:~# echo 0-1 > /cgroup/cpuset/app1/cpuset.cpus\nroot@server:~# echo 1 > /cgroup/cpuset/app2/cpuset.cpus\nroot@server:~# pidof app1 | while read PID; do echo $PID >> /cgroup/cpuset/app1/tasks limit_60_percent/tasks; done\nroot@server:~# pidof app2 | while read PID; do echo $PID >> /cgroup/cpuset/app2/tasks limit_40_percent/tasks; done\nroot@server:~#\n\n```", "```\nroot@server:~# taskset -c -p $(pidof app1)\npid 8052's current affinity list: 0,1\nroot@server:~# taskset -c -p $(pidof app2)\npid 8052's current affinity list: 1\nroot@server:~#\n\n```", "```\nroot@server:~# ls -la /cgroup/cpuset/app1/\ndrwxr-xr-x 2 root root 0 Aug 25 16:47 .\ndrwxr-xr-x 5 root root 0 Aug 19 21:02 ..\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cgroup.clone_children\n--w--w--w- 1 root root 0 Aug 25 16:47 cgroup.event_control\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cgroup.procs\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.cpu_exclusive\n-rw-r--r-- 1 root root 0 Aug 25 17:57 cpuset.cpus\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.mem_exclusive\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.mem_hardwall\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.memory_migrate\n-r--r--r-- 1 root root 0 Aug 25 16:47 cpuset.memory_pressure\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.memory_spread_page\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.memory_spread_slab\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.mems\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.sched_load_balance\n-rw-r--r-- 1 root root 0 Aug 25 16:47 cpuset.sched_relax_domain_level\n-rw-r--r-- 1 root root 0 Aug 25 16:47 notify_on_release\n-rw-r--r-- 1 root root 0 Aug 25 17:13 tasks\nroot@server:~#\n\n```", "```\nroot@server:~# mkdir /cgroup/freezer\nroot@server:~# mount -t cgroup -o freezer freezer /cgroup/freezer\nroot@server:~# mkdir /cgroup/freezer/frozen_group\nroot@server:~# cat /proc/mounts | grep freezer\nfreezer /cgroup/freezer cgroup rw,relatime,freezer,release_agent=/run/cgmanager/agents/cgm-release-agent.freezer 0 0\nroot@server:~#\n\n```", "```\nroot@server:~# echo 25731 > /cgroup/freezer/frozen_group/tasks\nroot@server:~# cat /cgroup/freezer/frozen_group/freezer.state\nTHAWED\nroot@server:~#\n\n```", "```\nroot@server:~# echo FROZEN > /cgroup/freezer/frozen_group/freezer.state\nroot@server:~# cat /cgroup/freezer/frozen_group/freezer.state\nFROZEN\nroot@server:~# cat /proc/25s731/status | grep -i state\nState:      D (disk sleep)\nroot@server:~#\n\n```", "```\nroot@server:~# echo THAWED > /cgroup/freezer/frozen_group/freezer.state\nroot@server:~# cat /proc/29328/status  | grep -i state\nState:  S (sleeping)\nroot@server:~#\n\n```", "```\nroot@server:~# ls -la /cgroup/freezer/frozen_group/\ndrwxr-xr-x 2 root root 0 Aug 25 20:50 .\ndrwxr-xr-x 4 root root 0 Aug 19 21:02 ..\n-rw-r--r-- 1 root root 0 Aug 25 20:50 cgroup.clone_children\n--w--w--w- 1 root root 0 Aug 25 20:50 cgroup.event_control\n-rw-r--r-- 1 root root 0 Aug 25 20:50 cgroup.procs\n-r--r--r-- 1 root root 0 Aug 25 20:50 freezer.parent_freezing\n-r--r--r-- 1 root root 0 Aug 25 20:50 freezer.self_freezing\n-rw-r--r-- 1 root root 0 Aug 25 21:00 freezer.state\n-rw-r--r-- 1 root root 0 Aug 25 20:50 notify_on_release\n-rw-r--r-- 1 root root 0 Aug 25 20:59 tasks\nroot@server:~#\n\n```", "```\nroot@server:~# apt-get install -y cgroup-bin cgroup-lite libcgroup1\nroot@server:~# service cgroup-lite start\n\n```", "```\nroot@server:~# yum install libcgroup\nroot@server:~# service cgconfig start\n\n```", "```\nroot@server:~# cgroups-mount\nroot@server:~# cat /proc/mounts | grep cgroup\ncgroup /sys/fs/cgroup/memory cgroup rw,relatime,memory,release_agent=/run/cgmanager/agents/cgm-release-agent.memory 0 0\ncgroup /sys/fs/cgroup/devices cgroup rw,relatime,devices,release_agent=/run/cgmanager/agents/cgm-release-agent.devices 0 0\ncgroup /sys/fs/cgroup/freezer cgroup rw,relatime,freezer,release_agent=/run/cgmanager/agents/cgm-release-agent.freezer 0 0\ncgroup /sys/fs/cgroup/blkio cgroup rw,relatime,blkio,release_agent=/run/cgmanager/agents/cgm-release-agent.blkio 0 0\ncgroup /sys/fs/cgroup/perf_event cgroup rw,relatime,perf_event,release_agent=/run/cgmanager/agents/cgm-release-agent.perf_event 0 0\ncgroup /sys/fs/cgroup/hugetlb cgroup rw,relatime,hugetlb,release_agent=/run/cgmanager/agents/cgm-release-agent.hugetlb 0 0\ncgroup /sys/fs/cgroup/cpuset cgroup rw,relatime,cpuset,release_agent=/run/cgmanager/agents/cgm-release-agent.cpuset,clone_children 0 0\ncgroup /sys/fs/cgroup/cpu cgroup rw,relatime,cpu,release_agent=/run/cgmanager/agents/cgm-release-agent.cpu 0 0\ncgroup /sys/fs/cgroup/cpuacct cgroup rw,relatime,cpuacct,release_agent=/run/cgmanager/agents/cgm-release-agent.cpuacct 0 0\n\n```", "```\nroot@server:~# cat /proc/cgroups\n#subsys_name  hierarchy  num_cgroups  enabled\ncpuset  7  1  1\ncpu  8  2  1\ncpuacct  9  1  1\nmemory  10  2  1\ndevices  11  1  1\nfreezer  12  1  1\nblkio  6  3  1\nperf_event  13  1  1\nhugetlb  14  1  1\n\n```", "```\nroot@server:~# cgcreate -g blkio:high_io\nroot@server:~# cgcreate -g blkio:low_io\nroot@server:~# cgclassify -g blkio:low_io $(pidof app1)\nroot@server:~# cat /sys/fs/cgroup/blkio/low_io/tasks\n8052\nroot@server:~# cgset -r blkio.weight=1000 high_io\nroot@server:~# cgset -r blkio.weight=100 low_io\nroot@server:~# cat /sys/fs/cgroup/blkio/high_io/blkio.weight\n1000\nroot@server:~#\n\n```", "```\nroot@server:~# cgsnapshot -s -f /tmp/cgconfig_io.conf\ncpuset = /sys/fs/cgroup/cpuset;\ncpu = /sys/fs/cgroup/cpu;\ncpuacct = /sys/fs/cgroup/cpuacct;\nmemory = /sys/fs/cgroup/memory;\ndevices = /sys/fs/cgroup/devices;\nfreezer = /sys/fs/cgroup/freezer;\nblkio = /sys/fs/cgroup/blkio;\nperf_event = /sys/fs/cgroup/perf_event;\nhugetlb = /sys/fs/cgroup/hugetlb;\nroot@server:~# cat /tmp/cgconfig_io.conf\n# Configuration file generated by cgsnapshot\nmount {\n blkio = /sys/fs/cgroup/blkio;\n}\ngroup low_io {\n blkio {\n blkio.leaf_weight=\"500\";\n blkio.leaf_weight_device=\"\";\n blkio.weight=\"100\";\n blkio.weight_device=\"\";\n blkio.throttle.write_iops_device=\"\";\n blkio.throttle.read_iops_device=\"\";\n blkio.throttle.write_bps_device=\"\";\n blkio.throttle.read_bps_device=\"\";\n blkio.reset_stats=\"\";\n }\n}\ngroup high_io {\nblkio {\n blkio.leaf_weight=\"500\";\n blkio.leaf_weight_device=\"\";\n blkio.weight=\"1000\";\n blkio.weight_device=\"\";\n blkio.throttle.write_iops_device=\"\";\n blkio.throttle.read_iops_device=\"\";\n blkio.throttle.write_bps_device=\"\";\n blkio.throttle.read_bps_device=\"\";\n blkio.reset_stats=\"\";\n }\n}\nroot@server:~#\n\n```", "```\nroot@server:~# cgexec -g blkio:high_io bash\nroot@server:~# echo $$\n19654\nroot@server:~# cat /sys/fs/cgroup/blkio/high_io/tasks\n19654\nroot@server:~#\n\n```", "```\nroot@server:~# cgcreate -g cpu,memory:high_prio\nroot@server:~# cgcreate -g cpu,memory:low_prio\nroot@server:~# cgclassify -g cpu,memory:high_prio 8052\nroot@server:~# cat /sys/fs/cgroup/memory/high_prio/tasks\n8052\nroot@server:~# cat /sys/fs/cgroup/cpu/high_prio/tasks\n8052\nroot@server:~#\n\n```", "```\nroot@server:~# cgset -r memory.limit_in_bytes=1G low_prio\nroot@server:~# cat /sys/fs/cgroup/memory/low_prio/memory.limit_in_bytes\n1073741824\nroot@server:~# cgset -r cpu.shares=1000 high_prio\nroot@server:~# cat /sys/fs/cgroup/cpu/high_prio/cpu.shares\n1000\nroot@server:~#\n\n```", "```\nroot@server:~# lscgroup\ncpuset:/\ncpu:/\ncpu:/low_prio\ncpu:/high_prio\ncpuacct:/\nmemory:/\nmemory:/low_prio\nmemory:/high_prio\ndevices:/\nfreezer:/\nblkio:/\nblkio:/low_io\nblkio:/high_io\nperf_event:/\nhugetlb:/\nroot@server:~#\n\n```", "```\nroot@server:~# cgdelete -g cpu,memory:high_prio\nroot@server:~# cgdelete -g cpu,memory:low_prio\nroot@server:~# lscgroup\ncpuset:/\ncpu:/\ncpuacct:/\nmemory:/\ndevices:/\nfreezer:/\nblkio:/\nblkio:/low_io\nblkio:/high_io\nperf_event:/\nhugetlb:/\nroot@server:~#\n\n```", "```\nroot@server:~# cgclear\nroot@server:~# lscgroup\ncgroups can't be listed: Cgroup is not mounted\nroot@server:~#\n\n```", "```\nroot@server:~# vim /etc/systemd/system/nginx.service\n.include /usr/lib/systemd/system/httpd.service\n[Service]\nCPUShares=2000\nMemoryLimit=1G\nBlockIOWeight=100\n\n```", "```\nroot@server:~#  systemctl daemon-reload\nroot@server:~#  systemctl restart httpd.service\nroot@server:~# \n\n```"]