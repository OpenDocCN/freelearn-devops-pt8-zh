["```\n    root@ubuntu:~# apt-get update && apt-get upgrade --yes && reboot\n    root@lxc:~# lsb_release -a 2>/dev/null\n    Distributor ID:   Ubuntu\n    Description:      Ubuntu 16.04.1 LTS\n    Release:    16.04\n    Codename:   xenial\n    root@ubuntu:~# \n    root@ubuntu:~# uname -r\n    4.4.0-38-generic\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# apt-cache policy libvirt-bin\n    libvirt-bin:\n     Installed: \n     Candidate: 1.3.1-1ubuntu10.5\n     Version table:\n     *** 1.3.1-1ubuntu10.5 500\n     500 http://rackspace.clouds.archive.ubuntu.com/ubuntu  \n                xenial-updates/main amd64 Packages\n     100 /var/lib/dpkg/status\n     1.3.1-1ubuntu10 500\n     500 http://rackspace.clouds.archive.ubuntu.com/ubuntu \n                xenial/main amd64 Packages\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# apt-get install libvirt-bin virtinst\n    root@ubuntu:~# dpkg --list | grep libvirt\n    ii  libvirt-bin      1.3.1-1ubuntu10.5       amd64         \n          programs for the libvirt library\n    ii  libvirt0:amd64     1.3.1-1ubuntu10.5     amd64        \n          library for interfacing with different virtualization systems\n    ii  python-libvirt      1.3.1-1ubuntu1       amd64        \n          libvirt Python bindings\n    root@ubuntu:~#\n\n    ```", "```\n     root@ubuntu:~# brctl show\n    bridge name      bridge id          STP enabled  interfaces\n    virbr0           8000.5254003d3c43  yes          virbr0-nic\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# export LIBVIRT_DEFAULT_URI=lxc:///\n    root@ubuntu:~# virsh net-list --all\n     Name              State      Autostart     Persistent\n    ----------------------------------------------------------\n     default           active     yes           yes\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# virsh net-dumpxml default\n    <network>\n    <name>default</name>\n    <uuid>6585ac5b-3d81-4071-bb61-3aa22007834e</uuid>\n    <forward mode='nat'>\n    <nat>\n    <port start='1024' end='65535'/>\n    </nat>\n    </forward>\n    <bridge name='virbr0' stp='on' delay='0'/>\n    <mac address='52:54:00:3d:3c:43'/>\n    <ip address='192.168.122.1' netmask='255.255.255.0'>\n    <dhcp>\n    <range start='192.168.122.2' end='192.168.122.254'/>\n    </dhcp>\n    </ip>\n    </network>\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# ps axfww\n    5310 ?        Ssl    0:00 /usr/sbin/libvirtd\n     5758 ?        S      0:00 /usr/sbin/dnsmasq \n          --conf-file=/var/lib/libvirt/dnsmasq/default.conf \n          --leasefile-ro \n          --dhcp-script=/usr/lib/libvirt/libvirt_leaseshelper\n     5759 ?        S      0:00  \\_ /usr/sbin/dnsmasq \n          --conf-file=/var/lib/libvirt/dnsmasq/default.conf \n          --leasefile-ro \n          --dhcp-script=/usr/lib/libvir/libvirt_leaseshelper\n\n    ```", "```\n    root@ubuntu:~# cat /var/lib/libvirt/dnsmasq/default.conf \n          | grep -vi \"#\"\n    strict-order\n    user=libvirt-dnsmasq\n    pid-file=/var/run/libvirt/network/default.pid\n    except-interface=lo\n    bind-dynamic\n    interface=virbr0\n    dhcp-range=192.168.122.2,192.168.122.254\n    dhcp-no-override\n    dhcp-lease-max=253\n    dhcp-hostsfile=/var/lib/libvirt/dnsmasq/default.hostsfile\n    addn-hosts=/var/lib/libvirt/dnsmasq/default.addnhosts\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# cd /opt/\n    root@ubuntu:/opt# mkdir -p containers/http1/etc\n    root@ubuntu:/opt# mkdir -p containers/http1/var/www/html\n    root@ubuntu:/opt# apt-get install --yes apache2\n    ...\n    root@ubuntu:/opt# cp -r /etc/apache2/ /opt/containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/passwd  /opt//containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/shadow  /opt//containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/group  /opt//containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/mime.types /opt//containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/init.d/ /opt//containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/resolv.conf /opt/containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/fstab /opt/containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/apache2/ /opt/containers/http1/etc/\n    root@ubuntu:/opt# cp -r /etc/network/ /opt/containers/http1/etc/\n\n    ```", "```\n    root@ubuntu:/opt# echo \"Apache in LXC http1\" > \n          /opt/containers/http1/var/www/html/index.html\n    root@ubuntu:/opt# cd containers/\n    root@ubuntu:/opt/containers# sed -i \n          's/\\${APACHE_PID_FILE}/\\/var\\/run\\/apache2\\/apache2_http1.pid/g'    \n          http1/etc/apache2/apache2.conf\n\n    ```", "```\n    root@ubuntu:/opt/containers# cat http1/etc/network/interfaces\n    auto lo\n    iface lo inet loopback\n    auto eth0\n    iface eth0 inet dhcp\n    root@ubuntu:/opt/containers#\n\n    ```", "```\nroot@ubuntu:/opt/containers# cat http1.xml\n<domain type='lxc'>\n<name>http1</name>\n<memory>102400</memory>\n<os>\n<type>exe</type>\n<init>/opt/containers/startup.sh</init>\n</os>\n<vcpu>1</vcpu>\n<on_poweroff>destroy</on_poweroff>\n<on_reboot>restart</on_reboot>\n<on_crash>destroy</on_crash>\n<devices>\n<emulator>/usr/lib/libvirt/libvirt_lxc</emulator>\n<filesystem type='mount'>\n<source dir='/opt/containers/http1/etc/apache2/'/>\n<target dir='/etc/apache2'/>\n</filesystem>\n<filesystem type='mount'>\n<source dir='/opt/containers/http1/var/www/html/'/>\n<target dir='/var/www/html'/>\n</filesystem>\n<filesystem type='mount'>\n<source dir='/opt/containers/http1/etc/'/>\n<target dir='/etc'/>\n</filesystem>\n<interface type='network'>\n<source network='default'/>\n</interface>\n<console type='pty'/>\n</devices>\n</domain>\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# cat startup.sh\n#!/bin/bash\nexport PATH=$PATH:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin\nexport PS1=\"[\\u@\\h \\W]\\\\$\"\necho \"Starting Networking\" >> /var/log/messages\n/etc/init.d/networking start\n/sbin/dhclient eth0\necho \"Starting httpd\" >> /var/log/messages\n/etc/init.d/apache2 start\n/bin/bash\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# chmod u+x startup.sh\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# ls -la http1\ntotal 16\ndrwxr-xr-x 4 root root 4096 Oct 31 17:25 .\ndrwxr-xr-x 3 root root 4096 Oct 31 17:32 ..\ndrwxr-xr-x 4 root root 4096 Oct 31 17:27 etc\ndrwxr-xr-x 3 root root 4096 Oct 31 17:25 var\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# virsh define http1.xml\nDomain http1 defined from http1.xml\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# virsh start http1\nDomain http1 started\nroot@ubuntu:/opt/containers# virsh list --all\nId    Name                           State\n----------------------------------------------------\n19032 http1                          running\nroot@ubuntu:/opt/containers# ps axfww\n...\n10592 ?      S     0:00 /usr/lib/libvirt/libvirt_lxc --name http1 \n--console 23 --security=apparmor --handshake 26 --veth vnet1\n10594 ?      S     0:00  \\_ /bin/bash /opt/containers/startup.sh\n10668 ?      Ss    0:00      \\_ /sbin/dhclient eth0\n10694 ?      Ss    0:00      \\_ /usr/sbin/apache2 -k start\n10698 ?      Sl    0:00      |   \\_ /usr/sbin/apache2 -k start\n10699 ?      Sl    0:00      |   \\_ /usr/sbin/apache2 -k start\n10697 ?      S     0:00      \\_ /bin/bash\nroot@ubuntu:/opt/containers#\n\n```", "```\nroot@ubuntu:/opt/containers# virsh console http1\n[root@ubuntu /]#ip a s\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1\n link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n inet 127.0.0.1/8 scope host lo\n valid_lft forever preferred_lft forever\n inet6 ::1/128 scope host\n valid_lft forever preferred_lft forever\n14: eth0@if15: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000\n link/ether 52:54:00:92:cf:12 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n inet 192.168.122.216/24 brd 192.168.122.255 scope global eth0\n valid_lft forever preferred_lft forever\n inet6 fe80::5054:ff:fe92:cf12/64 scope link\n valid_lft forever preferred_lft forever\n[root@ubuntu /]#ip r s\ndefault via 192.168.122.1 dev eth0\n192.168.122.0/24 dev eth0  proto kernel  scope link  src 192.168.122.10\n[root@ubuntu /]# Ctrl + ]\n\n```", "```\nroot@ubuntu:/opt/containers# curl 192.168.122.216\nApache in LXC http1\nroot@ubuntu:/opt/containers#\n\n```", "```\n    root@ubuntu:/opt/containers# cp -r http1 http2\n    root@ubuntu:/opt/containers# cp http1.xml http2.xml\n    root@ubuntu:/opt/containers#\n\n    ```", "```\n    root@ubuntu:/opt/containers# sed -i 's/http1/http2/g' \n          http2.xml \n    root@ubuntu:/opt/containers# sed -i 's/http1/http2/g' \n          http2/etc/apache2/apache2.conf \n    root@ubuntu:/opt/containers# echo \"Apache in LXC http2\" >    \n          /opt/containers/http2/var/www/html/index.html\n\n    ```", "```\n    root@ubuntu:/opt/containers# virsh define http2.xml\n    Domain http2 defined from http2.xml \n    root@ubuntu:/opt/containers# ls -la\n    total 28\n    drwxr-xr-x 4 root root 4096 Oct 31 19:57 .\n    drwxr-xr-x 3 root root 4096 Oct 31 17:32 ..\n    drwxr-xr-x 4 root root 4096 Oct 31 17:25 http1\n    -rw-r--r-- 1 root root  868 Oct 31 17:31 http1.xml\n    drwxr-xr-x 4 root root 4096 Oct 31 19:56 http2\n    -rw-r--r-- 1 root root  868 Oct 31 19:57 http2.xml\n    -rwxr--r-- 1 root root  418 Oct 31 19:44 startup.sh\n    root@ubuntu:/opt/containers#\n\n    ```", "```\n    root@ubuntu:/opt/containers# virsh start http2\n    Domain http2 started \n    root@ubuntu:/opt/containers# virsh list --all\n    Id    Name                           State\n    ----------------------------------------------------\n     10592 http1                          running\n     11726 http2                          running\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# virsh dominfo http1\n    Id:             15720\n    Name:           http1\n    UUID:           defd17d7-f220-4dca-9be9-bdf40b4d9164\n    OS Type:        exe\n    State:          running\n    CPU(s):         1\n    CPU time:       35.8s\n    Max memory:     102400 KiB\n    Used memory:    8312 KiB\n    Persistent:     yes\n    Autostart:      disable\n    Managed save:   no\n    Security model: apparmor\n    Security DOI:   0\n    Security label: libvirt-defd17d7-f220-4dca-9be9-bdf40b4d9164\n          (enforcing) \n    root@ubuntu:~# virsh dominfo http2\n    Id:             16126\n    Name:           http2\n    UUID:           a62f9e9d-4de3-415d-8f2d-358a1c8bc0bd\n    OS Type:        exe\n    State:          running\n    CPU(s):         1\n    CPU time:       36.5s\n    Max memory:     102400 KiB\n    Used memory:    8300 KiB\n    Persistent:     yes\n    Autostart:      disable\n    Managed save:   no\n    Security model: apparmor\n    Security DOI:   0\n    Security label: libvirt-a62f9e9d-4de3-415d-8f2d-358a1c8bc0bd \n          (enforcing)\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:/opt/containers# curl 192.168.122.242\n    Apache in LXC http2\n    root@ubuntu:/opt/containers#\n\n    ```", "```\n    root@ubuntu:~# echo \"nameserver 8.8.8.8\" > /etc/resolv.conf\n    root@ubuntu:~# apt-get install --yes haproxy\n    root@ubuntu:~# cat /etc/haproxy/haproxy.cfg\n    global\n     log /dev/log  local0\n     log /dev/log  local1 notice\n     chroot /var/lib/haproxy\n     stats socket /run/haproxy/admin.sock mode 660 level admin\n     stats timeout 30s\n     user haproxy\n     group haproxy\n     daemon\n     ca-base /etc/ssl/certs\n     crt-base /etc/ssl/private\n     ssl-default-bind-ciphers \n                ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128 \n                :DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES\n                :RSA+3DES:!aNULL:!MD5:!DSS\n     ssl-default-bind-options no-sslv3\n    defaults\n     log  global\n     mode  http\n     option  httplog\n     option  dontlognull\n    timeout connect 5000\n     timeout client  50000\n     timeout server  50000\n    frontend http\n     bind :80\n     reqadd X-Forwarded-Proto:\\ http\n     default_backend http_nodes\n    backend http_nodes\n     mode http\n     balance roundrobin\n     option httpclose\n     option forwardfor\n     option redispatch\n     option httpchk GET /\n     cookie JSESSIONID prefix\n     server http1 192.168.122.216:80 check inter 5000\n     server http1 192.168.122.242:80 check inter 5000\n    root@ubuntu:~# \n\n    ```", "```\n    root@ubuntu:~# service haproxy restart\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# pgrep -lfa haproxy\n    1957 /usr/sbin/haproxy-systemd-wrapper -f /etc/haproxy\n          /haproxy.cfg -p /run/haproxy.pid\n    1958 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p   \n          /run/haproxy.pid -Ds\n    1960 /usr/sbin/haproxy -f /etc/haproxy/haproxy.cfg -p    \n          /run/haproxy.pid -Ds\n    root@ubuntu:~# \n    root@ubuntu:~# netstat -antup | grep -i listen | grep -w 80\n    tcp      0     0 0.0.0.0:80      0.0.0.0:*                  \n          LISTEN      1960/haproxy\n    tcp6       0      0 :::80        :::*                    \n          LISTEN      9693/apache2\n    root@ubuntu:~# \n\n    ```", "```\n    root@ubuntu:~# curl localhost\n    Apache in LXC http1 \n    root@ubuntu:~# curl localhost\n    Apache in LXC http2\n    root@ubuntu:~#\n\n    ```", "```\n    root@ubuntu:~# virsh destroy http2\n    Domain http2 destroyed\n    root@ubuntu:~# virsh list --all\n     Id    Name                           State\n    ----------------------------------------------------\n     15720 http1                          running\n     -     http2                          shut off\n    root@ubuntu:~# curl localhost\n    Apache in LXC http1\n    root@ubuntu:~# curl localhost\n    Apache in LXC http1\n    root@ubuntu:~#\n\n    ```", "```\n    root@lxc-lb:~# apt-get update && apt-get upgrade --yes && reboot\n    root@lxc-lb:~# apt-cache policy lxc\n    lxc:\n     Installed: (none)\n     Candidate: 2.0.5-0ubuntu1~ubuntu16.04.2\n     Version table:\n     2.0.5-0ubuntu1~ubuntu16.04.2 500\n     500 http://us-east-1.ec2.archive.ubuntu.com/ubuntu \n                    xenial-updates/main amd64 Packages\n     2.0.0-0ubuntu2 500\n     500 http://us-east-1.ec2.archive.ubuntu.com/ubuntu   \n                    xenial/main amd64 Packages\n    root@lxc-lb:~# \n    root@lxc-lb:~# apt-get install --yes lxc\n    ... \n    root@lxc-lb:~# dpkg --list | grep lxc\n    ii          liblxc1      2.0.5-0ubuntu1~ubuntu16.04.2    \n          amd64       Linux Containers userspace tools (library)\n    ii          lxc          2.0.5-0ubuntu1~ubuntu16.04.2    \n          all         Transitional package for lxc1\n    ii          lxc-common   2.0.5-0ubuntu1~ubuntu16.04.2    \n          amd64       Linux Containers userspace tools (common tools)\n    ii          lxc-templates  2.0.5-0ubuntu1~ubuntu16.04.2    \n          amd64       Linux Containers userspace tools (templates)\n    ii          lxc1           2.0.5-0ubuntu1~ubuntu16.04.2    \n          amd64       Linux Containers userspace tools\n    ii          lxcfs          2.0.4-0ubuntu1~ubuntu16.04.1    \n          amd64       FUSE based filesystem for LXC\n    ii          python3-lxc    2.0.5-0ubuntu1~ubuntu16.04.2    \n\n          amd64         \n          Linux Containers userspace tools (Python 3.x bindings)\n    root@lxc-lb:~# \n    root@lxc-lb:~# lxc-create --version\n    2.0.5\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# brctl show\n    bridge name       bridge id           STP enabled interfaces\n    lxcbr0            8000.000000000000   no\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# apt-get install --yes openvswitch-switch\n    ...\n    root@lxc-lb:~# ovs-vsctl add-br lxcovsbr0\n    root@lxc-lb:~# ovs-vsctl show\n    482cf359-a59e-4482-8a71-02b0884d016d\n     Bridge \"lxcovsbr0\"\n     Port \"lxcovsbr0\"\n     Interface \"lxcovsbr0\"\n     type: internal\n     ovs_version: \"2.5.0\"\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# cat /etc/default/lxc-net | grep -vi \"#\"\n    USE_LXC_BRIDGE=\"true\"\n    LXC_BRIDGE=\"lxcbr0\"\n    LXC_ADDR=\"10.0.3.1\"\n    LXC_NETMASK=\"255.255.255.0\"\n    LXC_NETWORK=\"10.0.3.0/24\"\n    LXC_DHCP_RANGE=\"10.0.3.2,10.0.3.254\"\n    LXC_DHCP_MAX=\"253\" \n    root@lxc-lb:~# cat /etc/lxc/default.conf\n    lxc.network.type = veth\n    lxc.network.link = lxcbr0\n    lxc.network.flags = up\n    lxc.network.hwaddr = 00:16:3e:xx:xx:xx\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# sed -i 's/lxcbr0/lxcovsbr0/g' /etc/default/lxc-net\n    root@lxc-lb:~# sed -i 's/10.0.3/192.168.0/g' /etc/default/lxc-net\n    root@lxc-lb:~# sed -i 's/lxcbr0/lxcovsbr0/g' /etc/lxc/default.conf\n\n    ```", "```\n    root@lxc-lb:~# pgrep -lfa dnsmasq\n    10654 dnsmasq -u lxc-dnsmasq --strict-order --bind-interfaces\n          --pid-file=/run/lxc/dnsmasq.pid --listen-address 10.0.3.1 \n          --dhcp-range 10.0.3.2,10.0.3.254 --dhcp-lease-max=253 \n          --dhcp-no-override --except-interface=lo --interface=lxcbr0 \n          --dhcp-leasefile=/var/lib/misc/dnsmasq.lxcbr0.leases \n          --dhcp-authoritative\n    root@lxc-lb:~#\n    root@lxc-lb:~# reboot\n\n    ```", "```\n    root@lxc-lb:~# pgrep -lfa dnsmasq\n    1354 dnsmasq -u lxc-dnsmasq --strict-order --bind-interfaces \n          --pid-file=/run/lxc/dnsmasq.pid --listen-address 192.168.0.1 \n          --dhcp-range 192.168.0.2,192.168.0.254 --dhcp-lease-max=253 \n          --dhcp-no-override --except-interface=lo --interface=lxcovsbr0 \n          --dhcp-leasefile=/var/lib/misc/dnsmasq.lxcovsbr0.leases \n          --dhcp-authoritative\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# ip a s lxcovsbr0\n    4: lxcovsbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc \n          noqueue state UNKNOWN group default qlen 1\n     link/ether ee:b0:a2:42:22:4e brd ff:ff:ff:ff:ff:ff\n     inet 192.168.0.1/24 scope global lxcovsbr0\n     valid_lft forever preferred_lft forever\n     inet6 fe80::ecb0:a2ff:fe42:224e/64 scope link\n     valid_lft forever preferred_lft forever\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# lxc-create --name haproxy --template ubuntu\n    root@lxc-lb:~# lxc-start --name haproxy\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# ovs-vsctl show\n    482cf359-a59e-4482-8a71-02b0884d016d\n     Bridge \"lxcovsbr0\"\n     Port \"lxcovsbr0\"\n     Interface \"lxcovsbr0\"\n     type: internal\n     Port \"vethUY97FY\"\n     Interface \"vethUY97FY\"\n     ovs_version: \"2.5.0\"\n    root@lxc-lb:~# \n    root@lxc-lb:~# ip a s vethUY97FY\n    6: vethUY97FY@if5: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc \n          noqueue master ovs-system state UP group default qlen 1000\n     link/ether fe:d1:f3:ca:9e:83 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n     inet6 fe80::fcd1:f3ff:feca:9e83/64 scope link\n     valid_lft forever preferred_lft forever\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# lxc-attach --name haproxy\n    root@haproxy:~# ifconfig\n    eth0      Link encap:Ethernet  HWaddr 00:16:3e:76:92:0a\n     inet addr:192.168.0.26  Bcast:192.168.0.255  \n                    Mask:255.255.255.0\n     inet6 addr: fe80::216:3eff:fe76:920a/64 Scope:Link\n     UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1\n     RX packets:16 errors:0 dropped:0 overruns:0 frame:0\n     TX packets:12 errors:0 dropped:0 overruns:0 carrier:0\n     collisions:0 txqueuelen:1000\n     RX bytes:1905 (1.9 KB)  TX bytes:1716 (1.7 KB)\n    lo        Link encap:Local Loopback\n     inet addr:127.0.0.1  Mask:255.0.0.0\n     inet6 addr: ::1/128 Scope:Host\n     UP LOOPBACK RUNNING  MTU:65536  Metric:1\n     RX packets:0 errors:0 dropped:0 overruns:0 frame:0\n     TX packets:0 errors:0 dropped:0 overruns:0 carrier:0\n     collisions:0 txqueuelen:1\n     RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)\n    root@haproxy:~# route -n\n    Kernel IP routing table\n    Destination   Gateway       Genmask       Flags Metric Ref  Use Iface\n    0.0.0.0       192.168.0.1   0.0.0.0       UG    0      0     0  eth0\n    192.168.0.0   0.0.0.0       255.255.255.0 U     0      0     0  eth0\n    root@haproxy:~#\n\n    ```", "```\n    root@haproxy:~# ping -c 3 192.168.0.1\n    PING 192.168.0.1 (192.168.0.1) 56(84) bytes of data.\n    64 bytes from 192.168.0.1: icmp_seq=1 ttl=64 time=0.218 ms\n    64 bytes from 192.168.0.1: icmp_seq=2 ttl=64 time=0.045 ms\n    64 bytes from 192.168.0.1: icmp_seq=3 ttl=64 time=0.046 ms\n    --- 192.168.0.1 ping statistics ---\n    3 packets transmitted, 3 received, 0% packet loss, time 2000ms\n    rtt min/avg/max/mdev = 0.045/0.103/0.218/0.081 ms\n     root@haproxy:~# ping google.com -c 3\n    PING google.com (216.58.217.110) 56(84) bytes of data.\n    64 bytes from iad23s42-in-f14.1e100.net (216.58.217.110): icmp_seq=1 \n          ttl=48 time=2.55 ms\n    64 bytes from iad23s42-in-f14.1e100.net (216.58.217.110): icmp_seq=2 \n          ttl=48 time=2.11 ms\n    64 bytes from iad23s42-in-f14.1e100.net (216.58.217.110): icmp_seq=3 \n          ttl=48 time=2.39 ms\n    --- google.com ping statistics ---\n    3 packets transmitted, 3 received, 0% packet loss, time 2002ms\n    rtt min/avg/max/mdev = 2.113/2.354/2.555/0.191 ms\n     root@haproxy:~# exit\n    exit\n    root@lxc-lb:~#\n\n    ```", "```\nroot@lxc-lb:~# ovs-vsctl add-port lxcovsbr0 gre0 -- set interface gre0 type=gre options:remote_ip=10.1.34.124\nroot@lxc-lb:~# ovs-vsctl add-port lxcovsbr0 gre1 -- set interface gre1 type=gre options:remote_ip=10.1.34.57\nroot@lxc-lb:~#\n\n```", "```\nroot@lxc-lb:~# ovs-vsctl show\n482cf359-a59e-4482-8a71-02b0884d016d\nBridge \"lxcovsbr0\"\n Port \"gre1\"\n Interface \"gre1\"\n type: gre\n options: {remote_ip=\"10.1.34.57\"}\n Port \"vethRIC2BJ\"\n Interface \"vethRIC2BJ\"\n Port \"lxcovsbr0\"\n Interface \"lxcovsbr0\"\n type: internal\n Port \"gre0\"\n Interface \"gre0\"\n type: gre\n options: {remote_ip=\"10.1.34.124\"}\novs_version: \"2.5.0\"\nroot@lxc-lb:~#\n\n```", "```\nroot@lxc-lb:~# ovs-vsctl set bridge lxcovsbr0 stp_enable=true\nroot@lxc-lb:~#\n\n```", "```\n    root@lxc-node-01:~# apt-get update && apt-get --yes upgrade && reboot\n    root@lxc-node-01:~# apt-get install --yes lxc\n    root@lxc-node-01:~# apt-get install --yes openvswitch-switch\n    root@lxc-node-01:~# ovs-vsctl add-br lxcovsbr0\n    root@lxc-node-01:~# ifconfig lxcovsbr0 up\n\n    ```", "```\n    root@lxc-node-01:~# sed -i 's/lxcbr0/lxcovsbr0/g' \n          /etc/lxc/default.conf\n    root@lxc-node-01:~# sed -i 's/lxcbr0/lxcovsbr0/g' \n          /etc/default/lxc-net\n    root@lxc-node-01:~# sed -i 's/10.0.3/192.168.0/g' \n          /etc/default/lxc-net\n\n    ```", "```\n    root@lxc-node-01:~# ovs-vsctl add-port lxcovsbr0 gre0 -- set \n          interface gre0 type=gre options:remote_ip=10.1.34.23\n    root@lxc-node-01:~# ovs-vsctl add-port lxcovsbr0 gre1 -- set \n          interface gre1 type=gre options:remote_ip=10.1.34.57\n     root@lxc-node-01:~# ovs-vsctl show\n    625928b0-b57a-46b2-82fe-77d541473f29\n     Bridge \"lxcovsbr0\"\n     Port \"gre0\"\n     Interface \"gre0\"\n     type: gre\n     options: {remote_ip=\"10.1.34.23\"}\n     Port \"gre1\"\n     Interface \"gre1\"\n     type: gre\n     options: {remote_ip=\"10.1.34.57\"}\n     Port \"lxcovsbr0\"\n     Interface \"lxcovsbr0\"\n     type: internal\n     ovs_version: \"2.5.0\"\n    root@lxc-node-01:~#\n\n    ```", "```\n    root@lxc-node-01:~# ovs-vsctl set bridge lxcovsbr0 stp_enable=true\n    root@lxc-node-01:~#\n\n    ```", "```\n    root@lxc-node-01:~# lxc-create --name apache --template ubuntu\n    root@lxc-node-01:~# lxc-start --name apache\n\n    ```", "```\n    root@lxc-node-02:~# apt-get update && apt-get upgrade --yes && reboot\n    root@lxc-node-02:~# apt-get install --yes lxc\n    root@lxc-node-02:~# apt-get install --yes openvswitch-switch\n    root@lxc-node-02:~# ovs-vsctl add-br lxcovsbr0\n    root@lxc-node-02:~# ifconfig lxcovsbr0 up\n    root@lxc-node-02:~# sed -i 's/lxcbr0/lxcovsbr0/g' \n          /etc/lxc/default.conf\n    root@lxc-node-02:~# sed -i 's/lxcbr0/lxcovsbr0/g' \n          /etc/default/lxc-net\n    root@lxc-node-02:~# sed -i 's/10.0.3/192.168.0/g' \n          /etc/default/lxc-net\n\n    ```", "```\n    root@lxc-node-02:~# ovs-vsctl add-port lxcovsbr0 gre0 -- set \n          interface gre0 type=gre options:remote_ip=10.1.34.23\n     root@lxc-node-02:~# ovs-vsctl add-port lxcovsbr0 gre1 -- set \n          interface gre1 type=gre options:remote_ip=10.1.34.124\n     root@lxc-node-02:~# ovs-vsctl show\n    7b8574ce-ed52-443e-bcf2-6b1ddbedde4c\n     Bridge \"lxcovsbr0\"\n     Port \"gre0\"\n     Interface \"gre0\"\n     type: gre\n     options: {remote_ip=\"10.1.34.23\"}\n     Port \"gre1\"\n     Interface \"gre1\"\n     type: gre\n     options: {remote_ip=\"10.1.34.124\"}\n     Port \"lxcovsbr0\"\n     Interface \"lxcovsbr0\"\n     type: internal\n     ovs_version: \"2.5.0\"\n    root@lxc-node-02:~#\n\n    ```", "```\n    root@lxc-node-02:~# ovs-vsctl set bridge lxcovsbr0 stp_enable=true\n    root@lxc-node-02:~#\n\n    ```", "```\n    root@lxc-node-02:~# lxc-create --name apache --template ubuntu\n    root@lxc-node-02:~# lxc-start --name apache\n\n    ```", "```\nroot@lxc-lb:~# cat /var/lib/misc/dnsmasq.lxcovsbr0.leases\n1478111141 00:16:3e:84:cc:f3 192.168.0.41 apache *\n1478111044 00:16:3e:74:b3:8c 192.168.0.165 * *\n1478110360 00:16:3e:76:92:0a 192.168.0.26 haproxy *\nroot@lxc-lb:~#\n\n```", "```\n    root@lxc-lb:~# lxc-ls -f\n    NAME    STATE   AUTOSTART GROUPS IPV4         IPV6\n    haproxy RUNNING 0         -      192.168.0.26 -\n    root@lxc-lb:~#\n    root@lxc-node-01:~# lxc-ls -f\n    NAME   STATE   AUTOSTART GROUPS IPV4          IPV6\n    apache RUNNING 0         -      192.168.0.165 -\n    root@lxc-node-01:~#\n    root@lxc-node-02:~# lxc-ls -f\n    NAME   STATE   AUTOSTART GROUPS IPV4         IPV6\n    apache RUNNING 0         -      192.168.0.41 -\n    root@lxc-node-02:~#\n\n    ```", "```\n    root@lxc-lb:~# lxc-attach --name haproxy\n    root@haproxy:~# ping -c3 192.168.0.165\n    PING 192.168.0.165 (192.168.0.165) 56(84) bytes of data.\n    64 bytes from 192.168.0.165: icmp_seq=1 ttl=64 time=0.840 ms\n    64 bytes from 192.168.0.165: icmp_seq=2 ttl=64 time=0.524 ms\n    64 bytes from 192.168.0.165: icmp_seq=3 ttl=64 time=0.446 ms\n    --- 192.168.0.165 ping statistics ---\n    3 packets transmitted, 3 received, 0% packet loss, time 1999ms\n    rtt min/avg/max/mdev = 0.446/0.603/0.840/0.171 ms\n     root@haproxy:~# ping -c3 192.168.0.41\n    PING 192.168.0.41 (192.168.0.41) 56(84) bytes of data.\n    64 bytes from 192.168.0.41: icmp_seq=1 ttl=64 time=1.26 ms\n    64 bytes from 192.168.0.41: icmp_seq=2 ttl=64 time=0.939 ms\n    64 bytes from 192.168.0.41: icmp_seq=3 ttl=64 time=1.05 ms\n    --- 192.168.0.41 ping statistics ---\n    3 packets transmitted, 3 received, 0% packet loss, time 2001ms\n    rtt min/avg/max/mdev = 0.939/1.086/1.269/0.142 ms\n    root@haproxy:~#\n    root@haproxy:~# apt-get update && apt-get install haproxy\n    ...\n\n    ```", "```\n     root@haproxy:~# cat /etc/haproxy/haproxy.cfg \n     global \n     log /dev/log local0 \n     log /dev/log local1 notice \n     chroot /var/lib/haproxy \n     stats socket /run/haproxy/admin.sock mode 660 level admin \n     stats timeout 30s \n     user haproxy \n     group haproxy \n     daemon \n     ca-base /etc/ssl/certs \n     crt-base /etc/ssl/private \n     ssl-default-bind-ciphers\n                ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+\n                AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:\n                RSA+3DES:!aNULL:!MD5:!DSS \n     ssl-default-bind-options no-sslv3 \n     defaults \n     log global \n     mode http \n     option httplog \n     option dontlognull \n     timeout connect 5000 \n     timeout client 50000 \n     timeout server 50000 \n     frontend http \n     bind :80 \n     reqadd X-Forwarded-Proto:\\ http \n     default_backend http_nodes \n     backend http_nodes \n     mode http \n     balance roundrobin \n     option httpclose \n     option forwardfor \n     option redispatch \n     option httpchk GET / \n     cookie JSESSIONID prefix \n     server http1 192.168.0.165:80 check inter 5000 \n     server http1 192.168.0.41:80 check inter 5000 \n     root@haproxy:~#\n\n    ```", "```\n    root@haproxy:~# service haproxy restart\n    root@haproxy:~# ps axfww\n     PID TTY      STAT   TIME COMMAND\n     1 ?         Ss     0:00 /sbin/init\n     38 ?        Ss     0:00 /lib/systemd/systemd-journald\n     59 ?        Ss     0:00 /usr/sbin/cron -f\n     62 ?        Ssl    0:00 /usr/sbin/rsyslogd -n\n     143 ?        Ss     0:00 /sbin/dhclient -1 -v -pf \n            /run/dhclient.eth0.pid \n            -lf /var/lib/dhcp/dhclient.eth0.leases -I -df   \n            /var/lib/dhcp/dhclient6.eth0.leases eth0\n     167 ?        Ss     0:00 /usr/sbin/sshd -D\n     168 pts/2    Ss+    0:00 /sbin/agetty --noclear \n            --keep-baud pts/2 115200 38400 9600 vt220\n     169 lxc/console Ss+   0:00 /sbin/agetty --noclear \n            --keep-baud console 115200 38400 9600 vt220\n     412 ?        Ss     0:00 /usr/sbin/haproxy-systemd-wrapper -f  \n            /etc/haproxy/haproxy.cfg -p /run/haproxy.pid\n     413 ?        S      0:00  \\_ /usr/sbin/haproxy -f \n            /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n     414 ?        Ss     0:00      \\_ /usr/sbin/haproxy -f \n            /etc/haproxy/haproxy.cfg -p /run/haproxy.pid -Ds\n    root@haproxy:~#\n\n    ```", "```\n    root@lxc-node-01:~# lxc-attach --name apache\n    root@apache:~# apt-get install --yes apache2\n    root@apache:~# echo \"Apache on LXC container on host lxc-node-01\" > \n          /var/www/html/index.html\n    root@lxc-node-02:~# lxc-attach --name apache\n    root@apache:~# apt-get install --yes apache2\n    root@apache:~# echo \"Apache on LXC container on host lxc-node-02\" > \n          /var/www/html/index.html\n\n    ```", "```\n    root@haproxy:~# apt-get install --yes curl\n    root@haproxy:~# curl localhost\n    Apache on LXC container on host lxc-node-01\n    root@haproxy:~# curl localhost\n    Apache on LXC container on host lxc-node-02\n    root@haproxy:~# exit\n    exit\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# apt-get install curl\n    root@lxc-lb:~# curl 192.168.0.26\n    Apache on LXC container on host lxc-node-01\n    root@lxc-lb:~# curl 192.168.0.26\n    Apache on LXC container on host lxc-node-02\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# apt-get install haproxy\n    ...\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-lb:~# service haproxy restart\n    root@lxc-lb:~# curl 10.1.34.23\n    Apache on LXC container on host lxc-node-01\n    root@lxc-lb:~# curl 10.1.34.23\n    Apache on LXC container on host lxc-node-02\n    root@lxc-lb:~#\n\n    ```", "```\n    root@lxc-node-01:~# lxc-ls -f\n    NAME   STATE   AUTOSTART GROUPS IPV4 IPV6\n    apache RUNNING 0         -      -    -\n    root@lxc-node-01:~# lxc-stop --name apache\n\n    ```", "```\n    root@lxc-node-01:~# cd /var/lib/lxc\n    root@lxc-node-01:/var/lib/lxc# ls -alh\n    total 12K\n    drwx------  3 root root 4.0K Nov  2 16:53 .\n    drwxr-xr-x 43 root root 4.0K Nov  2 15:02 ..\n    drwxrwx---  3 root root 4.0K Nov  2 16:53 apache\n    root@lxc-node-01:/var/lib/lxc# cp -rp apache/ apache_new\n    root@lxc-node-01:/var/lib/lxc#\n\n    ```", "```\n    root@lxc-node-01:/var/lib/lxc# sed -i 's/apache/apache_new/g' \n          apache_new/config\n    root@lxc-node-01:/var/lib/lxc# sed -i '/lxc.network.hwaddr/d' \n          apache_new/config\n    root@lxc-node-01:/var/lib/lxc#\n\n    ```", "```\n    root@lxc-node-01:/var/lib/lxc# lxc-ls -f\n    NAME       STATE   AUTOSTART GROUPS IPV4 IPV6\n    apache     STOPPED 0         -      -    -\n    apache_new STOPPED 0         -      -    -\n    root@lxc-node-01:/var/lib/lxc#\n\n    ```", "```\n    root@lxc-node-01:/var/lib/lxc# lxc-start --name apache\n    root@lxc-node-01:/var/lib/lxc# lxc-start --name apache_new\n    root@lxc-node-01:/var/lib/lxc# lxc-ls -f\n    NAME       STATE   AUTOSTART GROUPS IPV4 IPV6\n    apache     RUNNING 0         -      -    -\n    apache_new RUNNING 0         -      -    -\n    root@lxc-node-01:/var/lib/lxc#\n\n    ```", "```\n    root@lxc-node-01:/var/lib/lxc# lxc-attach --name apache_new\n    root@apache:/# /etc/init.d/apache2 start\n    [ ok ] Starting apache2 (via systemctl): apache2.service.\n    root@apache:/# ps ax\n     PID TTY      STAT   TIME COMMAND\n     1 ?        Ss     0:00 /sbin/init\n     37 ?        Ss     0:00 /lib/systemd/systemd-journald\n     50 ?        Ss     0:00 /sbin/ifup -a --read-environment\n     60 ?        Ss     0:00 /usr/sbin/cron -f\n     62 ?        Ssl    0:00 /usr/sbin/rsyslogd -n\n     97 ?        S      0:00 /bin/sh -c /sbin/dhclient -1 -v -pf \n             /run/dhclient.eth0.pid -lf \n             /var/lib/dhcp/dhclient.eth0.leases -I \n             -df /var/lib/dhcp/dhclient6.eth0.leases eth0 ?\n     98 ?        S      0:00 /sbin/dhclient -1 -v -pf \n             /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases \n             -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0\n     125 pts/3    Ss     0:00 /bin/bash\n     168 ?        Ss     0:00 /usr/sbin/apache2 -k start\n     171 ?        Sl     0:00 /usr/sbin/apache2 -k start\n     172 ?        Sl     0:00 /usr/sbin/apache2 -k start\n     246 pts/3    R+     0:00 ps ax\n    root@apache:/#\n\n    ```"]