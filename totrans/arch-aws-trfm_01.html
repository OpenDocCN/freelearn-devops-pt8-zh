<html><head></head><body>
<div id="_idContainer009">
<h1 class="chapter-number" id="_idParaDest-13"><a id="_idTextAnchor012"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-14"><a id="_idTextAnchor013"/><span class="koboSpan" id="kobo.2.1">Understanding Patterns and Antipatterns of IaC and Terraform</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In an ever-evolving digital landscape, the seamless integration of development and operations has become a necessity for organizations seeking to achieve unparalleled efficiency and agility. </span><span class="koboSpan" id="kobo.3.2">The opening chapter of this book delves into the fascinating world of </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Infrastructure as Code</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">IaC</span></strong><span class="koboSpan" id="kobo.7.1">) and </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Terraform</span></strong><span class="koboSpan" id="kobo.9.1">, unraveling the key principles, patterns, and anti-patterns that underpin this transformative approach. </span><span class="koboSpan" id="kobo.9.2">With a keen focus on idempotency, immutability, and an array of best practices, this chapter illuminates the path to robust, secure, and compliant infrastructure management. </span><span class="koboSpan" id="kobo.9.3">As we embark on this captivating journey, we’ll explore the intricacies of IaC projects, examine the challenges they present, and unearth invaluable strategies to conquer them. </span><span class="koboSpan" id="kobo.9.4">By the end of this chapter, you’ll possess a solid foundation to make informed decisions about the life cycle of your infrastructure and harness the true potential of IaC </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">and Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">We’ll cover these main topics in </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">this chapter:</span></span></p>
<ul>
<li><span class="No-Break"><span class="koboSpan" id="kobo.13.1">Introducing IAC</span></span></li>
<li><span class="koboSpan" id="kobo.14.1">Patterns and practices </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">of IaC</span></span></li>
<li><span class="koboSpan" id="kobo.16.1">How to handle </span><span class="No-Break"><span class="koboSpan" id="kobo.17.1">IaC projects</span></span></li>
<li><span class="koboSpan" id="kobo.18.1">How to make decisions about </span><span class="No-Break"><span class="koboSpan" id="kobo.19.1">IaC projects</span></span></li>
</ul>
<h1 id="_idParaDest-15"><a id="_idTextAnchor014"/><span class="koboSpan" id="kobo.20.1">Introducing IaC</span></h1>
<p><span class="koboSpan" id="kobo.21.1">IaC refers to the process </span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.22.1">of managing and provisioning computing infrastructure through machine-readable definition files instead of relying on interactive configuration tools or physical </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">hardware setups.</span></span></p>
<p><span class="koboSpan" id="kobo.24.1">IaC leverages coding techniques that have been tried and tested in software systems, extending their application to infrastructure. </span><span class="koboSpan" id="kobo.24.2">It is one of the key DevOps practices that enable teams to deliver infrastructure and software rapidly and reliably at scale. </span><span class="koboSpan" id="kobo.24.3">Having a fast and dependable infrastructure provisioning mechanism is essential for organizations that want to achieve continuous delivery for </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">their applications.</span></span></p>
<p><span class="koboSpan" id="kobo.26.1">In IaC, a declarative language is typically used to describe the desired state of a system, as well as the steps required</span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.27.1"> to bring it into compliance with that state. </span><span class="koboSpan" id="kobo.27.2">The IaC tool then uses these descriptions to construct and manage the necessary steps automatically, transitioning the system from one state to another. </span><span class="koboSpan" id="kobo.27.3">As a result, IaC enables organizations to automate processes such as resource installation, configuration, deployment, scaling, updating, and deletion in their </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">IT infrastructures.</span></span></p>
<h2 id="_idParaDest-16"><a id="_idTextAnchor015"/><span class="koboSpan" id="kobo.29.1">Key principles of IaC</span></h2>
<p><span class="koboSpan" id="kobo.30.1">There are two key</span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.31.1"> principles of IaC, which we will gain an understanding of in </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">this section.</span></span></p>
<h3><span class="koboSpan" id="kobo.33.1">Idempotency</span></h3>
<p><span class="koboSpan" id="kobo.34.1">Idempotency is a characteristic</span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.35.1"> of certain operations in mathematics, programming languages, and computer science. </span><span class="koboSpan" id="kobo.35.2">It refers to the property where applying these operations multiple times produces the same result without altering it except for generating </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">identical copies.</span></span></p>
<p><span class="koboSpan" id="kobo.37.1">In the context of IaC, idempotency means that regardless of the starting state and the number of times the IaC is executed, the end state remains the same. </span><span class="koboSpan" id="kobo.37.2">This simplifies the infrastructure provisioning process and minimizes the likelihood of inconsistent outcomes. </span><span class="koboSpan" id="kobo.37.3">This property offers several advantages for operations, such as the capability to roll back changes and retry them in case </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">of failure.</span></span></p>
<p><span class="koboSpan" id="kobo.39.1">One way to achieve idempotency is by using a stateful tool such as Terraform. </span><span class="koboSpan" id="kobo.39.2">With Terraform, you can specify the desired end state of the infrastructure, and the tool will handle the process of reaching </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">that state.</span></span></p>
<h3><span class="koboSpan" id="kobo.41.1">Immutability</span></h3>
<p><span class="koboSpan" id="kobo.42.1">Configuration change </span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.43.1">management is an important topic for infrastructure provisioning. </span><span class="koboSpan" id="kobo.43.2">For success, we need a powerful change management recording system that records all changes made to the infrastructure, and it includes details about why those changes were made, who was responsible for them, when they were implemented, and </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.45.1">Configuration drift can pose a significant challenge to infrastructure management. </span><span class="koboSpan" id="kobo.45.2">It arises when changes are made to the infrastructure without proper documentation, causing different environments to diverge in ways that are difficult to replicate. </span><span class="koboSpan" id="kobo.45.3">This problem is particularly </span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.46.1">prevalent in mutable infrastructures that are active for </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">extended periods.</span></span></p>
<p><span class="koboSpan" id="kobo.48.1">The consequence of configuration drift can be severe, leading to inconsistent performance and stability and security issues in the infrastructure. </span><span class="koboSpan" id="kobo.48.2">Since it is difficult to reproduce the exact conditions that led to the drift, troubleshooting such problems can be time-consuming </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">and error-prone.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">Immutable infrastructure is a technique for constructing and managing infrastructure in a dependable, repeatable, and foreseeable manner. </span><span class="koboSpan" id="kobo.50.2">This approach offers several advantages over traditional IT environment management methods. </span><span class="koboSpan" id="kobo.50.3">Rather than altering the existing infrastructure, immutable infrastructure involves replacing it with a new one. </span><span class="koboSpan" id="kobo.50.4">By provisioning fresh infrastructure each time, the approach ensures that the infrastructure remains reproducible and free from configuration drift </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">over time.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">Immutable infrastructure also provides scalability when provisioning infrastructure in </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">cloud environments.</span></span></p>
<p><span class="koboSpan" id="kobo.54.1">Now that we know what IaC is and what its key principles are, let’s look at the patterns </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">of IaC.</span></span></p>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/><span class="koboSpan" id="kobo.56.1">Patterns and practices of IaC</span></h1>
<p><span class="koboSpan" id="kobo.57.1">Diving into the world of IaC, it is </span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.58.1">essential to uncover the patterns and practices that form the backbone of efficient and reliable implementations. </span><span class="koboSpan" id="kobo.58.2">In this section, we will explore the fundamental building blocks that contribute to the success of IaC, ensuring a comprehensive understanding of its best practices and a solid foundation for your </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">IaC journey.</span></span></p>
<h2 id="_idParaDest-18"><a id="_idTextAnchor017"/><span class="koboSpan" id="kobo.60.1">Source control and VCS</span></h2>
<p><span class="koboSpan" id="kobo.61.1">It is crucial to keep all aspects of your infrastructure, including the smallest scripts and pipeline configurations, in source </span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.62.1">control or </span><strong class="bold"><span class="koboSpan" id="kobo.63.1">version control systems</span></strong><span class="koboSpan" id="kobo.64.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.65.1">VCSs</span></strong><span class="koboSpan" id="kobo.66.1">). </span><span class="koboSpan" id="kobo.66.2">A version control system is a tool that manages and tracks changes to documents, programs, and other collections of information, often used in software development to maintain a history of </span><span class="No-Break"><span class="koboSpan" id="kobo.67.1">code changes.</span></span></p>
<p><span class="koboSpan" id="kobo.68.1">This practice ensures that you have a record of all changes made to your infrastructure, regardless of how minor they may be. </span><span class="koboSpan" id="kobo.68.2">It also simplifies the process of tracking ownership and the history of changes</span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.69.1"> to your </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">infrastructure configurations.</span></span></p>
<p><span class="koboSpan" id="kobo.71.1">Furthermore, it is important to make the infrastructure code accessible to all members of your organization, including those who do not directly work on the IaC code base. </span><span class="koboSpan" id="kobo.71.2">This visibility provides a better understanding of how the infrastructure is provisioned and enables quick troubleshooting of any issues that arise. </span><span class="koboSpan" id="kobo.71.3">By reviewing the code, users can gain a deeper understanding of how the infrastructure operates, and even contribute to the development of the infrastructure if they choose to </span><span class="No-Break"><span class="koboSpan" id="kobo.72.1">do so.</span></span></p>
<p><span class="koboSpan" id="kobo.73.1">The visibility and understanding of the applications running on your infrastructure are crucial for managing a successful IT infrastructure. </span><span class="koboSpan" id="kobo.73.2">By having a good grasp of how the applications function, you can optimize their performance and ensure that they operate efficiently. </span><span class="koboSpan" id="kobo.73.3">By keeping the infrastructure code accessible to all, you can ensure that your entire organization can contribute to maintaining and improving the infrastructure, ultimately leading to better outcomes for </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">your business.</span></span></p>
<h2 id="_idParaDest-19"><a id="_idTextAnchor018"/><span class="koboSpan" id="kobo.75.1">Modules and versions</span></h2>
<p><span class="koboSpan" id="kobo.76.1">Creating reusable modules in</span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.77.1"> IaC tools helps with maintenance, readability, and ownership. </span><span class="koboSpan" id="kobo.77.2">It keeps changes small and independently deployable and reduces the </span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">effect radius.</span></span></p>
<p><span class="koboSpan" id="kobo.79.1">Refactoring IaC is difficult compared to application development, particularly for critical pieces such as DNS records, network configurations, databases, and </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.81.1">In many organizations, team structures and responsibilities are different, so it will make more sense to separate multiple layers of infrastructure and assign governance to the respective teams. </span><span class="koboSpan" id="kobo.81.2">In some cases, there might be some more separated layers needed for cross-functional teams managing both infrastructure and </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">application development.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">The following diagram illustrates an example of Amazon EKS deployments, featuring multiple modules for each infrastructure layer and their respective governors. </span><span class="koboSpan" id="kobo.83.2">It is important to note that the </span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.84.1">modules and layers depicted in this diagram may differ depending on your </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">specific setup.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer008">
<span class="koboSpan" id="kobo.86.1"><img alt="Figure 1.1 – EKS deployment workflow" src="image/B18198_01_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.87.1">Figure 1.1 – EKS deployment workflow</span></p>
<p><span class="koboSpan" id="kobo.88.1">Versioning for modules is quite important to provide support for multiple versions of services that can operate without breaking the existing </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">production resources.</span></span></p>
<h2 id="_idParaDest-20"><a id="_idTextAnchor019"/><span class="koboSpan" id="kobo.90.1">Documentation</span></h2>
<p><span class="koboSpan" id="kobo.91.1">IaC minimizes the need for</span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.92.1"> extensive documentation for infrastructure since everything is codified and stated as a declarative manifest. </span><span class="koboSpan" id="kobo.92.2">However, some documentation is needed for better infrastructure provisioning so that consumers can understand and improve the current modules </span><span class="No-Break"><span class="koboSpan" id="kobo.93.1">and templates.</span></span></p>
<p><span class="koboSpan" id="kobo.94.1">Documentation can be challenging to manage, much like code. </span><span class="koboSpan" id="kobo.94.2">It is critical to provide sufficient documentation to convey the intended message effectively. </span><span class="koboSpan" id="kobo.94.3">However, having more documentation does not necessarily equate to better-quality documentation. </span><span class="koboSpan" id="kobo.94.4">In fact, outdated documentation can be more detrimental than having no documentation </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">at all.</span></span></p>
<p><span class="koboSpan" id="kobo.96.1">IaC documentation must live close to the code. </span><span class="koboSpan" id="kobo.96.2">Keep it close so that everyone can update the documentation without unnecessary effort and difficult steps. </span><span class="koboSpan" id="kobo.96.3">If you can build good governance automation, documentation creation or updates can be easily tracked </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">and enforced.</span></span></p>
<p><span class="koboSpan" id="kobo.98.1">An effective approach to managing documentation for IaC is to include a </span><strong class="source-inline"><span class="koboSpan" id="kobo.99.1">README</span></strong><span class="koboSpan" id="kobo.100.1"> file within the same repository as the code, rather than using an external platform such as Confluence or a wiki. </span><span class="koboSpan" id="kobo.100.2">This approach facilitates updating the documentation during the same commit as the code changes, which is particularly useful as a reminder during the pull </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">request process.</span></span></p>
<p><span class="koboSpan" id="kobo.102.1">It is also ideal to leverage </span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.103.1">automated tools to generate documentation from the code or use tests as documentation. </span><span class="koboSpan" id="kobo.103.2">By doing so, you can ensure that the documentation stays in sync with the code, reducing the likelihood of inconsistencies and outdated information. </span><span class="koboSpan" id="kobo.103.3">This approach can also streamline the documentation process, reducing the need for manual documentation efforts and enabling </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">faster iterations.</span></span></p>
<h2 id="_idParaDest-21"><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.105.1">Testing</span></h2>
<p><span class="koboSpan" id="kobo.106.1">Software testing is the </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.107.1">process of executing a program or application with the intent of finding errors. </span><span class="koboSpan" id="kobo.107.2">Testing can be done at various levels, from unit testing to integration testing to system testing and </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">acceptance testing.</span></span></p>
<p><span class="koboSpan" id="kobo.109.1">IaC development is not an easy task. </span><span class="koboSpan" id="kobo.109.2">There are many different aspects and considerations that need to be taken into account before, during, and after the development process. </span><span class="koboSpan" id="kobo.109.3">One of these considerations is how to test your IaC. </span><span class="koboSpan" id="kobo.109.4">Let’s provide you with a basic understanding of the various levels of testing that you need to think about when developing </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">your IaC:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.111.1">Static code </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.112.1">and analysis</span></strong></span><p class="list-inset"><span class="koboSpan" id="kobo.113.1">Running quick tests as frequently as</span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.114.1"> possible is crucial for obtaining prompt feedback during the development process. </span><span class="koboSpan" id="kobo.114.2">This approach is especially effective when performed on your local machine. </span><span class="koboSpan" id="kobo.114.3">There are various integrations available that can automate this process and trigger tests automatically when you save a file in your text editor </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">or IDE.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.116.1">To perform static analysis, you can use specialized tools such as Terraform Validate or TFLint. </span><span class="koboSpan" id="kobo.116.2">These tools enable you to identify issues in your code and configurations promptly, reducing the likelihood of errors and inconsistencies in your infrastructure. </span><span class="koboSpan" id="kobo.116.3">By incorporating</span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.117.1"> quick testing and static analysis into your development process, you can streamline the testing process and improve the reliability of </span><span class="No-Break"><span class="koboSpan" id="kobo.118.1">your infrastructure.</span></span></p></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.119.1">Unit testing</span></strong></span><p class="list-inset"><span class="koboSpan" id="kobo.120.1">Since many IaC tools, such as </span><a id="_idIndexMarker016"/><span class="koboSpan" id="kobo.121.1">Terraform and Ansible, operate </span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.122.1">on a declarative model, unit testing may not always be necessary. </span><span class="koboSpan" id="kobo.122.2">However, in some cases, unit tests can be beneficial, particularly when conditionals or loops </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">are involved.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.124.1">While unit testing may not always be required for IaC, incorporating it where necessary can help to catch potential issues early on in the development process, improving the overall quality of </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">your infrastructure.</span></span></p></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.126.1">Integration testing</span></strong></span><p class="list-inset"><span class="koboSpan" id="kobo.127.1">One essential step in ensuring the</span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.128.1"> reliability of your infrastructure is to perform validation testing. </span><span class="koboSpan" id="kobo.128.2">This involves provisioning resources in a test environment and verifying whether specific requirements are met. </span><span class="koboSpan" id="kobo.128.3">It is crucial to avoid writing tests for things that are already covered by your IaC tool, particularly when working with </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">declarative code.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.130.1">For example, instead of verifying whether the policies specified in IaC were applied, you should write automated tests to ensure that none of your S3 buckets are public. </span><span class="koboSpan" id="kobo.130.2">Similarly, you can test that only specific ports are open across all of your EC2 instances. </span><span class="koboSpan" id="kobo.130.3">To perform these tests, you can provision an ephemeral environment that you can later </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">tear down.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.132.1">Depending on the duration of these tests, you may want to run them after every commit or as nightly builds. </span><span class="koboSpan" id="kobo.132.2">By incorporating validation testing into your development process, you can catch potential issues early on, reduce the risk of errors, and ensure the overall </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.133.1">reliability of </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">your infrastructure.</span></span></p></li>
<li><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.135.1">Smoke tests</span></strong></span><p class="list-inset"><span class="koboSpan" id="kobo.136.1">An additional approach to testing is to provision an environment, deploy a dummy application, and run </span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.137.1">quick smoke tests to verify that the application has been deployed correctly. </span><span class="koboSpan" id="kobo.137.2">Using a dummy application can be helpful in testing scenarios that your actual application may encounter but are not configured </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">for production.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.139.1">For example, if your application connects to an externally hosted database, you should attempt to connect to it in your dummy application. </span><span class="koboSpan" id="kobo.139.2">By doing so, you can gain confidence that the infrastructure you are provisioning is capable of supporting the applications you intend to run </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">on it.</span></span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.141.1">As these tests can be time-consuming, it is advisable to run them after provisioning a new environment and periodically thereafter. </span><span class="koboSpan" id="kobo.141.2">By leveraging this testing approach, you can ensure that your infrastructure is capable of supporting your application’s requirements and minimize the risk</span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.142.1"> of errors or issues arising </span><span class="No-Break"><span class="koboSpan" id="kobo.143.1">during deployment.</span></span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.144.1">Security and compliance</span></h2>
<p><span class="koboSpan" id="kobo.145.1">The definition of IaC is to provide an</span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.146.1"> abstraction layer between the physical infrastructure and the applications that run on top of it. </span><span class="koboSpan" id="kobo.146.2">This is done by separating the hardware from the software and by abstracting out all of the tasks</span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.147.1"> that are required to manage </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">the hardware.</span></span></p>
<p><span class="koboSpan" id="kobo.149.1">IaC can be used by companies for compliance purposes, such as HIPAA, SOX, PCI DSS, and so on. </span><span class="koboSpan" id="kobo.149.2">It can also be used for security purposes, such as preventing unauthorized access to data or preventing hackers from accessing </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">sensitive information.</span></span></p>
<p><span class="koboSpan" id="kobo.151.1">Let’s look at important details of security </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">and compliance.</span></span></p>
<h3><span class="koboSpan" id="kobo.153.1">Identity and access management</span></h3>
<p><span class="koboSpan" id="kobo.154.1">Implementing a </span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.155.1">strong </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">Identity and Access Management</span></strong><span class="koboSpan" id="kobo.157.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.158.1">IAM</span></strong><span class="koboSpan" id="kobo.159.1">) strategy is essential for safeguarding both </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.160.1">your IaC and the infrastructure it provisions. </span><span class="koboSpan" id="kobo.160.2">One effective approach is to use </span><strong class="bold"><span class="koboSpan" id="kobo.161.1">Role-Based Access Control</span></strong><span class="koboSpan" id="kobo.162.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.163.1">RBAC</span></strong><span class="koboSpan" id="kobo.164.1">) for IaC, which can significantly</span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.165.1"> reduce the overall </span><span class="No-Break"><span class="koboSpan" id="kobo.166.1">attack surface.</span></span></p>
<p><span class="koboSpan" id="kobo.167.1">By leveraging RBAC, you can grant just enough permission to your IaC to perform the necessary operations while preventing unauthorized access. </span><span class="koboSpan" id="kobo.167.2">This approach helps to minimize the risk of errors or malicious activity, improving the overall security of </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">your infrastructure.</span></span></p>
<h3><span class="koboSpan" id="kobo.169.1">Secrets management</span></h3>
<p><span class="koboSpan" id="kobo.170.1">When working with IaC, it is </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.171.1">common to require secrets to provision infrastructure. </span><span class="koboSpan" id="kobo.171.2">For example, if you are provisioning resources in AWS, you will need valid AWS credentials to connect to it. </span><span class="koboSpan" id="kobo.171.3">It is crucial to ensure that you use a reliable secret management tool, such as HashiCorp Vault or AWS Secrets Manager, to manage these </span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">sensitive credentials.</span></span></p>
<p><span class="koboSpan" id="kobo.173.1">In cases where you need to store or output secrets in the state file (although it is advisable to avoid doing so), it is essential to encrypt them to prevent unauthorized access. </span><span class="koboSpan" id="kobo.173.2">By encrypting secrets stored in the state file, you can mitigate the risk of exposure in the event of a security breach or </span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">unauthorized access.</span></span></p>
<h3><span class="koboSpan" id="kobo.175.1">Security scanning</span></h3>
<p><span class="koboSpan" id="kobo.176.1">Performing security scans after provisioning or making changes to infrastructure in a lower or ephemeral environment </span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.177.1">can help mitigate potential security issues in production. </span><span class="koboSpan" id="kobo.177.2">Leveraging tools such as CIS Benchmarks and Amazon Inspector can be effective in identifying common vulnerabilities or exposures and ensuring adherence to security </span><span class="No-Break"><span class="koboSpan" id="kobo.178.1">best practices.</span></span></p>
<p><span class="koboSpan" id="kobo.179.1">By conducting security scans, you can catch potential security issues early on in the development process and prevent them from being carried over to production. </span><span class="koboSpan" id="kobo.179.2">This approach helps to minimize the risk of security breaches and protect sensitive data </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">and infrastructure.</span></span></p>
<h3><span class="koboSpan" id="kobo.181.1">Compliance</span></h3>
<p><span class="koboSpan" id="kobo.182.1">Compliance requirements</span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.183.1"> are a critical consideration for many organizations, particularly in highly regulated industries such as healthcare or finance. </span><span class="koboSpan" id="kobo.183.2">These industries are subject to stricter requirements, including HIPAA, PCI, GDPR, and SOX, to name a few. </span><span class="koboSpan" id="kobo.183.3">Traditionally, compliance teams conducted manual checks and filled in paperwork to ensure adherence to </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">these requirements.</span></span></p>
<p><span class="koboSpan" id="kobo.185.1">However, automation tools such as Chef InSpec or HashiCorp Sentinel can help streamline compliance requirements and improve efficiency. </span><span class="koboSpan" id="kobo.185.2">By automating compliance checks, you can run them more frequently and identify issues much faster. </span><span class="koboSpan" id="kobo.185.3">For instance, you can incorporate compliance tests into your IaC pipeline by provisioning an ephemeral environment and running tests every time you modify your IaC code. </span><span class="koboSpan" id="kobo.185.4">This approach enables you to catch potential compliance issues early on and rectify them before they impact </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">production systems.</span></span></p>
<h1 id="_idParaDest-23"><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.187.1">How to handle IaC projects</span></h1>
<p><span class="koboSpan" id="kobo.188.1">In today’s fast-paced </span><a id="_idIndexMarker030"/><span class="koboSpan" id="kobo.189.1">digital landscape, IaC has become a critical consideration for organizations of all sizes. </span><span class="koboSpan" id="kobo.189.2">With IaC, developers can create the machines or resources required to run their applications easily, saving time and effort in the process. </span><span class="koboSpan" id="kobo.189.3">As your organization scales, IaC can help your developers focus on solving more complex problems, rather than getting bogged down in manual </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">resource configuration.</span></span></p>
<p><span class="koboSpan" id="kobo.191.1">However, it can be challenging to ensure identical, error-free, secure, and compliant configurations across different environments. </span><span class="koboSpan" id="kobo.191.2">This is where IaC comes in. </span><span class="koboSpan" id="kobo.191.3">By defining your infrastructure as code, you can make changes or add new resources by updating a piece of code, and the IaC tool will handle the configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">for you.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">By adopting IaC, organizations can improve agility, speed, and consistency in resource provisioning and configuration. </span><span class="koboSpan" id="kobo.193.2">This enables developers to focus on delivering high-quality applications, while operations teams can manage infrastructure at scale with greater ease </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">and efficiency.</span></span></p>
<p><span class="koboSpan" id="kobo.195.1">Let’s have a look at the challenges we </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">can face.</span></span></p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.197.1">IaC principles</span></h2>
<p><span class="koboSpan" id="kobo.198.1">At the heart of IaC is the concept of defining your infrastructure in code. </span><span class="koboSpan" id="kobo.198.2">By using a declarative syntax, you define the</span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.199.1"> desired final state of your infrastructure, and the IaC tool takes care of the underlying dependency resolution and resource </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">launching steps.</span></span></p>
<p><span class="koboSpan" id="kobo.201.1">To keep track of changes made to your infrastructure, you can store this code in a VCS. </span><span class="koboSpan" id="kobo.201.2">This not only provides you with an audit trail of who made changes but also enables you to revert to a previous version </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">if needed.</span></span></p>
<p><span class="koboSpan" id="kobo.203.1">Automated quality, compliance, and security tests can also be run on your infrastructure, allowing you to verify its compliance without investing days or weeks </span><span class="No-Break"><span class="koboSpan" id="kobo.204.1">of effort.</span></span></p>
<p><span class="koboSpan" id="kobo.205.1">By adopting IaC, your developers can avoid the tedious and error-prone task of manually defining steps or scripts to launch and configure resources. </span><span class="koboSpan" id="kobo.205.2">Tools such as Terraform and CloudFormation are widely used to achieve these tasks, enabling organizations to achieve greater agility, scalability, and consistency in </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">infrastructure management.</span></span></p>
<h2 id="_idParaDest-25"><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.207.1">Version control systems for IaC</span></h2>
<p><span class="koboSpan" id="kobo.208.1">It is important to store your</span><a id="_idIndexMarker032"/><span class="koboSpan" id="kobo.209.1"> IaC in a VCS alongside your application code. </span><span class="koboSpan" id="kobo.209.2">This allows for easy collaboration among developers and a clear understanding of the entire </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">code base.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">VCSs also offer a simple way to track and audit changes made to the code base, including infrastructure changes. </span><span class="koboSpan" id="kobo.211.2">By using pipeline features within a VCS, such as those available in GitHub or GitLab, you can enforce policies and ensure that changes meet the necessary criteria before they are deployed </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">to production.</span></span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.213.1">Some common use cases of IaC</span></h2>
<p><span class="koboSpan" id="kobo.214.1">IaC is commonly used to launch infrastructure </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.215.1">across various cloud providers, as well as for provisioning machines upon launch. </span><span class="koboSpan" id="kobo.215.2">Popular tools for provisioning with IaC include Chef, Ansible, and Puppet, while Terraform and CloudFormation are commonly used for </span><span class="No-Break"><span class="koboSpan" id="kobo.216.1">infrastructure provisioning.</span></span></p>
<p><span class="koboSpan" id="kobo.217.1">IaC can also be used to deploy applications, such as with Kubernetes, by leveraging tools such as Jenkins or Ansible. </span><span class="koboSpan" id="kobo.217.2">In upcoming chapters, we will delve further into using IaC </span><span class="No-Break"><span class="koboSpan" id="kobo.218.1">with Kubernetes.</span></span></p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor026"/><span class="koboSpan" id="kobo.219.1">Challenges and best practices with IaC</span></h2>
<p><span class="koboSpan" id="kobo.220.1">IaC provides great benefits</span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.221.1"> in terms of operability and maintainability, but it also brings challenges that need to be addressed to ensure the security and stability of </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">your infrastructure.</span></span></p>
<h3><span class="koboSpan" id="kobo.223.1">Adoption within the team</span></h3>
<p><span class="koboSpan" id="kobo.224.1">Integrating IaC into your organization can present a learning curve and a change in processes. </span><span class="koboSpan" id="kobo.224.2">Your team may need to become familiar with the language used to write IaC code and develop pipelines</span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.225.1"> to execute the code. </span><span class="koboSpan" id="kobo.225.2">If your team is accustomed to making changes from cloud consoles and is operation-centric, transitioning to IaC can be a significant shift </span><span class="No-Break"><span class="koboSpan" id="kobo.226.1">for them.</span></span></p>
<p><span class="koboSpan" id="kobo.227.1">You can see huge, powerful resistance to learning new technologies or practices. </span><span class="koboSpan" id="kobo.227.2">Be ready to fight, and always be an evangelist of infrastructure automation, security, </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">and compliance.</span></span></p>
<h3><span class="koboSpan" id="kobo.229.1">Configuration drift</span></h3>
<p><span class="koboSpan" id="kobo.230.1">At the start of an IaC journey, developers</span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.231.1"> may not always know what changes are required for infrastructure provisioning and may opt to make changes manually via the console. </span><span class="koboSpan" id="kobo.231.2">This can lead to configuration drift, where the deployed infrastructure does not match the code definition, potentially causing outages or issues with future updates. </span><span class="koboSpan" id="kobo.231.3">To prevent this, it is important to educate the team on the consequences of manual changes and discourage </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">their use.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">To further mitigate the risk of configuration drift, you can build automation to detect drifts and ensure that only authorized personnel have access to make changes in critical environments. </span><span class="koboSpan" id="kobo.233.2">This can help ensure that your infrastructure remains consistent </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">and secure.</span></span></p>
<h3><span class="koboSpan" id="kobo.235.1">Security</span></h3>
<p><span class="koboSpan" id="kobo.236.1">When using open source</span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.237.1"> modules in your IaC pipeline, it is important to ensure that they are secure and free of vulnerabilities. </span><span class="koboSpan" id="kobo.237.2">Before using any open source project, it is recommended to verify that it is safe </span><span class="No-Break"><span class="koboSpan" id="kobo.238.1">to use.</span></span></p>
<p><span class="koboSpan" id="kobo.239.1">To maintain a high level of security, it is essential to establish static code analysis pipelines and continuously scan open source modules. </span><span class="koboSpan" id="kobo.239.2">This way, any vulnerabilities can be detected and </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">addressed </span></span><span class="No-Break"><a id="_idIndexMarker038"/></span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">promptly.</span></span></p>
<h3><span class="koboSpan" id="kobo.242.1">Human factors</span></h3>
<p><span class="koboSpan" id="kobo.243.1">To prevent misconfigurations</span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.244.1"> from entering production, it is crucial to catch validation errors that may be introduced when a developer makes changes. </span><span class="koboSpan" id="kobo.244.2">With Terraform, you can easily implement a validation step using the Terraform plan functionality. </span><span class="koboSpan" id="kobo.244.3">It is essential to have a full understanding of the plan outputs before applying them to ensure that no unexpected changes are made to </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">your infrastructure.</span></span></p>
<h3><span class="koboSpan" id="kobo.246.1">Side effects of automation</span></h3>
<p><span class="koboSpan" id="kobo.247.1">In IaC, a lot of code will be reused as</span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.248.1"> you automate infrastructure creation. </span><span class="koboSpan" id="kobo.248.2">However, any small misconfiguration can propagate across a large set of resources very easily. </span><span class="koboSpan" id="kobo.248.3">Therefore, it’s crucial to catch these errors during the pipeline </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">verification stage.</span></span></p>
<p><span class="koboSpan" id="kobo.250.1">To prevent unexpected changes to existing resources, always use versioning when </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">updating modules.</span></span></p>
<h3><span class="koboSpan" id="kobo.252.1">Keeping up to date with cloud providers</span></h3>
<p><span class="koboSpan" id="kobo.253.1">Changes to cloud providers’ APIs </span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.254.1">and policies can affect your existing infrastructure, which means that you need to update your tools and code. </span><span class="koboSpan" id="kobo.254.2">This can be especially difficult if you’re using open source tools, as updates may not be immediately available. </span><span class="koboSpan" id="kobo.254.3">If there is a delay in releasing changes, it can result in incorrect permissions or issues with provisioning access to machines if the RBAC API changes. </span><span class="koboSpan" id="kobo.254.4">Therefore, it’s essential to keep your tools and code up to date with the latest API changes and policies to ensure your infrastructure continues to </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">function properly.</span></span></p>
<h3><span class="koboSpan" id="kobo.256.1">Maintainability and traceability</span></h3>
<p><span class="koboSpan" id="kobo.257.1">Having a well-defined procedure for promoting infrastructure changes to the production environment and assigning responsibilities is crucial to ensure that all changes are properly verified. </span><span class="koboSpan" id="kobo.257.2">This helps to avoid chaos and maintainability issues on the </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">VCS side.</span></span></p>
<p><span class="koboSpan" id="kobo.259.1">Furthermore, traceability is</span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.260.1"> an added advantage of using VCSs as all changes are logged and can be easily tracked. </span><span class="koboSpan" id="kobo.260.2">For instance, Git provides the Git log command and commit history to view all changes made to </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">the code.</span></span></p>
<h3><span class="koboSpan" id="kobo.262.1">RBAC</span></h3>
<p><span class="koboSpan" id="kobo.263.1">Many IaC tools, including Terraform, lack an intrinsic RBAC feature, a crucial element that governs who has permission to access, manage, and execute specific resources and operations. </span><span class="koboSpan" id="kobo.263.2">In the absence of native RBAC, these tools are dependent on the underlying platform or VCS where the code resides. </span><span class="koboSpan" id="kobo.263.3">Consequently, it’s assumed that individuals executing the code possess the</span><a id="_idIndexMarker043"/><span class="koboSpan" id="kobo.264.1"> requisite permissions, transferring the onus of managing and enforcing RBAC to the VCS. </span><span class="koboSpan" id="kobo.264.2">This can involve setting up specific access controls, permissions, and restrictions within the VCS to ensure that sensitive and critical infrastructure configurations are only accessible and executable by authorized personnel, thereby maintaining security and </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">compliance standards.</span></span></p>
<h3><span class="koboSpan" id="kobo.266.1">VCS and proper approval flows</span></h3>
<p><span class="koboSpan" id="kobo.267.1">It is essential to implement version control in your IaC workflow to maintain control of your code, track changes, and </span><a id="_idIndexMarker044"/><span class="koboSpan" id="kobo.268.1">facilitate auditing. </span><span class="koboSpan" id="kobo.268.2">It is also important to establish a process where changes cannot be merged into production without proper approval and validation. </span><span class="koboSpan" id="kobo.268.3">One option is to incorporate </span><a id="_idIndexMarker045"/><span class="koboSpan" id="kobo.269.1">validations into the </span><strong class="bold"><span class="koboSpan" id="kobo.270.1">Continuous Integration</span></strong><span class="koboSpan" id="kobo.271.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.272.1">CI</span></strong><span class="koboSpan" id="kobo.273.1">) process of GitHub or GitLab. </span><span class="koboSpan" id="kobo.273.2">By treating your IaC code like any other application code, you can ensure that your infrastructure is an integral part of your </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">overall system.</span></span></p>
<h4><span class="koboSpan" id="kobo.275.1">Handling secrets properly</span></h4>
<p><span class="koboSpan" id="kobo.276.1">You need to manage two types of secrets in your IaC pipeline. </span><span class="koboSpan" id="kobo.276.2">The first type of secret is used to create resources in the cloud, and only the admin of the repository should have access to them. </span><span class="koboSpan" id="kobo.276.3">For this purpose, you can use a secret variable in GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">or GitLab.</span></span></p>
<p><span class="koboSpan" id="kobo.278.1">The second type of secret is generated when the code is executed, such as the password for an IAM user in AWS. </span><span class="koboSpan" id="kobo.278.2">It’s crucial to ensure that these secrets are not getting logged anywhere and are securely transmitted </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">to users.</span></span></p>
<h4><span class="koboSpan" id="kobo.280.1">Immutable infrastructure</span></h4>
<p><span class="koboSpan" id="kobo.281.1">Consider applying the principle of immutable infrastructure if you need to make changes to your infrastructure. </span><span class="koboSpan" id="kobo.281.2">This approach involves creating a new machine with the required changes and replacing </span><a id="_idIndexMarker046"/><span class="koboSpan" id="kobo.282.1">the old machine with the new one, instead of modifying the existing machine. </span><span class="koboSpan" id="kobo.282.2">By doing so, you can ensure that your changes are in line with the code, and there are no snowflake server states. </span><span class="koboSpan" id="kobo.282.3">The concept behind immutable infrastructure is to manage machines entirely through code, and no manual changes should </span><span class="No-Break"><span class="koboSpan" id="kobo.283.1">be made.</span></span></p>
<h4><span class="koboSpan" id="kobo.284.1">Validations and checks</span></h4>
<p><span class="koboSpan" id="kobo.285.1">By implementing checks and validations in the CI pipeline, you can catch security issues and misconfigurations on the left side of the pipeline. </span><span class="koboSpan" id="kobo.285.2">This helps increase the frequency of the development cycle and maintain the security of </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">each release.</span></span></p>
<h4><span class="koboSpan" id="kobo.287.1">Infrastructure as code and Kubernetes</span></h4>
<p><span class="koboSpan" id="kobo.288.1">Using the same principles as IaC, you can deploy your application on Kubernetes. </span><span class="koboSpan" id="kobo.288.2">Kubernetes objects are declarative files that can be defined and stored in a code repository. </span><span class="koboSpan" id="kobo.288.3">These files can then be applied to a Kubernetes cluster using a controller to deploy </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">your application.</span></span></p>
<h3><span class="koboSpan" id="kobo.290.1">Conclusion</span></h3>
<p><span class="koboSpan" id="kobo.291.1">Despite the many advantages of IaC, there are also several challenges that must be addressed to ensure the success of the implementation. </span><span class="koboSpan" id="kobo.291.2">These include the need for proper validations and checks, as well as a well-established process to avoid security lapses that can lead to increased costs and </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">compromised environments.</span></span></p>
<p><span class="koboSpan" id="kobo.293.1">Fortunately, the emerging practice of GitOps combined with IaC enables faster and safer rollout of changes, resulting in quicker deployment cycles and large-scale auditing. </span><span class="koboSpan" id="kobo.293.2">IaC is not only the present but also the future of managing infrastructure, applications, and tooling, and its adoption is highly recommended for reducing </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">operational costs.</span></span></p>
<p><span class="koboSpan" id="kobo.295.1">By using IaC tools, organizations</span><a id="_idIndexMarker047"/><span class="koboSpan" id="kobo.296.1"> can achieve the same level of productivity and efficiency with fewer personnel, making it an attractive option for businesses looking to optimize </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">their resources.</span></span></p>
<h1 id="_idParaDest-28"><a id="_idTextAnchor027"/><span class="koboSpan" id="kobo.298.1">How to make decisions about IaC projects</span></h1>
<p><span class="koboSpan" id="kobo.299.1">IaC is a set of best practices </span><a id="_idIndexMarker048"/><span class="koboSpan" id="kobo.300.1">for developers to document and configure their software infrastructure in a </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">repeatable way.</span></span></p>
<p><span class="koboSpan" id="kobo.302.1">IaC is not just about configuration management and deployment; it also provides the ability to manage infrastructure with code. </span><span class="koboSpan" id="kobo.302.2">The code can be used to automate activities such as application deployment, configuration management, and </span><span class="No-Break"><span class="koboSpan" id="kobo.303.1">continuous delivery.</span></span></p>
<p><span class="koboSpan" id="kobo.304.1">Here are a few plus points </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">to consider:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.306.1">It is easy for developers to get started with IaC because the documentation is available in a </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">single place</span></span></li>
<li><span class="koboSpan" id="kobo.308.1">It allows for more efficient collaboration between development teams by providing an easy way to share configurations with other members of </span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">the team</span></span></li>
<li><span class="koboSpan" id="kobo.310.1">It reduces errors in configuration management by making them easier </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">to reproduce</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.312.1">Let’s have a look at the decision points that will improve the maturity level of </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">IaC projects.</span></span></p>
<h2 id="_idParaDest-29"><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.314.1">The decision about where to store your code</span></h2>
<p><span class="koboSpan" id="kobo.315.1">Storing IaC files using a VCS is essential for tracking changes and collaboration. </span><span class="koboSpan" id="kobo.315.2">While any cloud storage system can be used, Git has become the de facto standard for IaC versioning. </span><span class="koboSpan" id="kobo.315.3">Originally designed for storing code, Git can be used as the primary source for deploying infrastructure code. </span><span class="koboSpan" id="kobo.315.4">Several solutions, such as GitHub, GitLab, and Bitbucket, offer free SaaS for public repositories, while community editions can be self-hosted. </span><span class="koboSpan" id="kobo.315.5">Using Git should be a basic skill set for any developer or cloud or DevOps engineer looking to start an IaC </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">project successfully.</span></span></p>
<h3><span class="koboSpan" id="kobo.317.1">The decision about how to structure your code</span></h3>
<p><span class="koboSpan" id="kobo.318.1">Once you have chosen </span><a id="_idIndexMarker049"/><span class="koboSpan" id="kobo.319.1">where to store your IaC code, the next step is deciding on how to structure it. </span><span class="koboSpan" id="kobo.319.2">The structure you choose will depend on the complexity of your organization and IT environment. </span><span class="koboSpan" id="kobo.319.3">There are several options, including using a mono-repo for all your IaC code, having a separate repository for each tool or language used, or having a repository for each application server or </span><span class="No-Break"><span class="koboSpan" id="kobo.320.1">infrastructure type.</span></span></p>
<p><span class="koboSpan" id="kobo.321.1">In addition, you need to determine a branching strategy that works well for your team. </span><span class="koboSpan" id="kobo.321.2">It’s essential to discuss and agree on this with your team to ensure everyone is on the </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">same page.</span></span></p>
<p><span class="koboSpan" id="kobo.323.1">It’s recommended to start with a simple structure and evolve it over time based on your needs. </span><span class="koboSpan" id="kobo.323.2">Alternatively, you can put more thought into the structure beforehand to prevent potential rework later. </span><span class="koboSpan" id="kobo.323.3">Whatever structure you choose, make sure it’s easily adoptable by all team members. </span><span class="koboSpan" id="kobo.323.4">Create clear documentation on the structure and decision-making process so that new team members can quickly understand and start </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">contributing effectively.</span></span></p>
<h3><span class="koboSpan" id="kobo.325.1">The decision about how to run your code</span></h3>
<p><span class="koboSpan" id="kobo.326.1">To gain better control over your infrastructure, it is recommended to use a CI/CD tool such as Jenkins, GitLab CI, or GitHub Actions to run your IaC. </span><span class="koboSpan" id="kobo.326.2">With these tools, you can trigger jobs manually, via webhooks or on a schedule, and have a record of every job that has run. </span><span class="koboSpan" id="kobo.326.3">Additionally, the jobs run from an agent can be pre-configured with the necessary tools, reducing the chances of errors due to different tool versions. </span><span class="koboSpan" id="kobo.326.4">It is important to choose the right tool that fits your needs and configure it properly to ensure </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">its effectiveness.</span></span></p>
<h3><span class="koboSpan" id="kobo.328.1">The decision about how to handle your secrets</span></h3>
<p><span class="koboSpan" id="kobo.329.1">When provisioning automated infrastructure, it is crucial to store secrets such as database passwords and logins securely. </span><span class="koboSpan" id="kobo.329.2">It is not advisable to store them in your repositories, even if the repository is only accessible within your own network and protected with </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">multi-factor authentication.</span></span></p>
<p><span class="koboSpan" id="kobo.331.1">When using Git tools, all the credentials are copied to your machines and the machines of your team members when they clone the repository, making them vulnerable to </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">security breaches.</span></span></p>
<p><span class="koboSpan" id="kobo.333.1">A better solution is to use a vault system that can encrypt your secrets and inject them as environment variables during the runtime of your pipeline. </span><span class="koboSpan" id="kobo.333.2">It is ideal to have security enabled on multiple layers, so even if one layer is breached, there is a second line of defense to protect your </span><a id="_idIndexMarker050"/><span class="No-Break"><span class="koboSpan" id="kobo.334.1">sensitive information.</span></span></p>
<h3><span class="koboSpan" id="kobo.335.1">The decision about a common set of tools</span></h3>
<p><span class="koboSpan" id="kobo.336.1">To kickstart IaC projects effectively, it’s important for the team to agree on a consistent set of tools. </span><span class="koboSpan" id="kobo.336.2">While there may be several ways to achieve the same objective, it’s beneficial to explore simpler, quicker, or more cost-effective methods. </span><span class="koboSpan" id="kobo.336.3">Using a common toolset makes it easier to share and reuse building blocks. </span><span class="koboSpan" id="kobo.336.4">Striking a balance between granting engineers the freedom to experiment with new tools and standardizing on a common set of tools is crucial. </span><span class="koboSpan" id="kobo.336.5">Certain tools work well in tandem, while others don’t, and paying for redundant licenses is generally not a </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">good idea.</span></span></p>
<h3><span class="koboSpan" id="kobo.338.1">The decision about the level of pipelines</span></h3>
<p><span class="koboSpan" id="kobo.339.1">When using pipelines to run your IaC, there are various methods to achieve the same outcome. </span><span class="koboSpan" id="kobo.339.2">It’s essential to use a naming convention and provide clear descriptions to help others understand the purpose of a pipeline. </span><span class="koboSpan" id="kobo.339.3">You can consider dividing a pipeline into multiple stages, so you have the flexibility to rerun or skip a stage depending on the type of deployment. </span><span class="koboSpan" id="kobo.339.4">Then, decide whether you want to enforce mandatory reviews, require approval from a manager, or give developers the liberty to deploy themselves </span><span class="No-Break"><span class="koboSpan" id="kobo.340.1">during go-live.</span></span></p>
<h3><span class="koboSpan" id="kobo.341.1">The decision about the life cycle of your infrastructure</span></h3>
<p><span class="koboSpan" id="kobo.342.1">The level of testing and validation required for a proof-of-concept script versus code developed for large-scale deployment is significantly different. </span><span class="koboSpan" id="kobo.342.2">Robust code requires more comprehensive testing and validation efforts, which requires additional time </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">and resources.</span></span></p>
<p><span class="koboSpan" id="kobo.344.1">In an ever-evolving world, infrastructure must also be adaptable to changes such as security updates, service improvements, and new service types. </span><span class="koboSpan" id="kobo.344.2">While using SaaS/PaaS services can reduce the maintenance workload, it comes at a cost. </span><span class="koboSpan" id="kobo.344.3">Furthermore, even these services will evolve over time, necessitating engineering efforts to keep up. </span><span class="koboSpan" id="kobo.344.4">There are various strategies</span><a id="_idIndexMarker051"/><span class="koboSpan" id="kobo.345.1"> and practices available to simplify this process, each with its own benefits and drawbacks. </span><span class="koboSpan" id="kobo.345.2">It’s important to determine the approach that works best for your </span><span class="No-Break"><span class="koboSpan" id="kobo.346.1">specific situation.</span></span></p>
<h1 id="_idParaDest-30"><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.347.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.348.1">This first chapter on understanding patterns of IaC and Terraform covered the key principles of IaC, such as idempotency and immutability. </span><span class="koboSpan" id="kobo.348.2">The chapter also discussed various patterns and practices of IaC, including source control, modules, versions, documentation, and testing. </span><span class="koboSpan" id="kobo.348.3">The chapter also covered security and compliance concerns, such as IAM, RBAC, secret management, security scanning, </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">and compliance.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">It also provided guidance on how to handle IaC projects and the decisions involved in starting IaC projects. </span><span class="koboSpan" id="kobo.350.2">Additionally, the chapter highlighted the challenges and best practices of IaC, including the importance of standardizing toolsets, naming conventions, and clear descriptions, and the need for a proper process for approvals and validation in the </span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">CI pipeline.</span></span></p>
<p><span class="koboSpan" id="kobo.352.1">Overall, this chapter provided a comprehensive overview of the principles and best practices of IaC and highlighted the importance of adopting these practices to improve the agility, efficiency, and security of </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">infrastructure management.</span></span></p>
</div>
</body></html>