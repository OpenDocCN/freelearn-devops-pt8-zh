<html><head></head><body>
<div id="_idContainer022">
<h1 class="chapter-number" id="_idParaDest-56"><a id="_idTextAnchor055"/><span class="koboSpan" id="kobo.1.1">4</span></h1>
<h1 id="_idParaDest-57"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.2.1">Discovering Best Practices for Terraform IaC Projects</span></h1>
<p><span class="koboSpan" id="kobo.3.1">As you begin to work with Terraform, it’s important to understand the best practices for </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Infrastructure As Code</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.6.1">IaC</span></strong><span class="koboSpan" id="kobo.7.1">) projects. </span><span class="koboSpan" id="kobo.7.2">In this chapter, we’ll explore some key best practices for Terraform, including how to maintain, execute, and secure your IaC projects. </span><span class="koboSpan" id="kobo.7.3">We’ll also look at ways to implement Terraform within your DevOps or cloud teams. </span><span class="koboSpan" id="kobo.7.4">By following these best practices, you’ll be able to create efficient and reliable infrastructure deployments </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">with Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">We will look at these main topics in </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">this chapter:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">How to maintain IaC projects </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">with Terraform</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">How to execute IaC projects </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">with Terraform</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">How to secure IaC projects </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">with Terraform</span></span></li>
<li><span class="koboSpan" id="kobo.17.1">Implementing Terraform in DevOps or </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">cloud teams</span></span></li>
</ul>
<h1 id="_idParaDest-58"><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.19.1">How to maintain IaC projects with Terraform</span></h1>
<p><span class="koboSpan" id="kobo.20.1">Maintaining</span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.21.1"> IaC projects with Terraform is crucial to</span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.22.1"> ensure their longevity, accuracy, and security. </span><span class="koboSpan" id="kobo.22.2">This involves managing the state, updates, changes, and versions of infrastructure configurations, among other tasks. </span><span class="koboSpan" id="kobo.22.3">In this chapter, we will discuss best practices for maintaining IaC projects with Terraform, covering topics such as managing state, employing version control, testing, and more. </span><span class="koboSpan" id="kobo.22.4">By embracing a well-defined standard module structure, you lay the foundation for streamlined development, enhanced collaboration, and the mastery of resource orchestration </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">at scale.</span></span></p>
<h2 id="_idParaDest-59"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.24.1">Follow a standard module structure</span></h2>
<p><span class="koboSpan" id="kobo.25.1">Modules in </span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.26.1">Terraform offer a way of packaging and reusing resource configurations. </span><span class="koboSpan" id="kobo.26.2">They are essentially containers that group multiple resources that are used together. </span><span class="koboSpan" id="kobo.26.3">Modules consist of a collection of </span><strong class="source-inline"><span class="koboSpan" id="kobo.27.1">.tf</span></strong><span class="koboSpan" id="kobo.28.1"> and/or </span><strong class="source-inline"><span class="koboSpan" id="kobo.29.1">.tfvars</span></strong><span class="koboSpan" id="kobo.30.1"> files kept together in a directory. </span><span class="koboSpan" id="kobo.30.2">Elevate your deployment game by following these best practices, each a stepping stone toward resourceful and </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">harmonious provisioning:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.32.1">Start each module with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">main.tf</span></strong><span class="koboSpan" id="kobo.34.1"> file, which contains the resources </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">by default.</span></span></li>
<li><span class="koboSpan" id="kobo.36.1">Include a </span><strong class="source-inline"><span class="koboSpan" id="kobo.37.1">README.md</span></strong><span class="koboSpan" id="kobo.38.1"> file in Markdown format in every module. </span><span class="koboSpan" id="kobo.38.2">This file should contain basic documentation about </span><span class="No-Break"><span class="koboSpan" id="kobo.39.1">the module.</span></span></li>
<li><span class="koboSpan" id="kobo.40.1">Create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.41.1">examples/</span></strong><span class="koboSpan" id="kobo.42.1"> folder in each module with a separate subdirectory for each example. </span><span class="koboSpan" id="kobo.42.2">For each example, include a detailed </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.43.1">README.md</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.44.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.45.1">Use descriptive names for resource files, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">network.tf</span></strong><span class="koboSpan" id="kobo.47.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">instances.tf</span></strong><span class="koboSpan" id="kobo.49.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.50.1">loadbalancer.tf</span></strong><span class="koboSpan" id="kobo.51.1">, to create logical groupings </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">of resources.</span></span></li>
<li><span class="koboSpan" id="kobo.53.1">Avoid creating a separate file for each resource. </span><span class="koboSpan" id="kobo.53.2">Instead, group resources by their shared purpose. </span><span class="koboSpan" id="kobo.53.3">For example, combine </span><strong class="source-inline"><span class="koboSpan" id="kobo.54.1">google_dns_managed_zone</span></strong><span class="koboSpan" id="kobo.55.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.56.1">google_dns_record_set</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.57.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.58.1">dns.tf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.60.1">The module’s root directory should only contain Terraform (</span><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">.tf</span></strong><span class="koboSpan" id="kobo.62.1">) and repository metadata files (such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.63.1">README.md</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.64.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">CHANGELOG.md</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">).</span></span></li>
<li><span class="koboSpan" id="kobo.67.1">Place additional documentation in a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.68.1">docs/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.69.1"> subdirectory.</span></span></li>
</ul>
<h2 id="_idParaDest-60"><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.70.1">Adopt a naming convention</span></h2>
<p><span class="koboSpan" id="kobo.71.1">Naming conventions </span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.72.1">in IaC are very important for sustainability and setting a common practice for naming resources </span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">in teams:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.74.1">Use nouns for resource names. </span><span class="koboSpan" id="kobo.74.2">For example, you could name them </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">aws_instance</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.76.1">or </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">google_storage_bucket</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.78.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.79.1">Make resource names singular; for example, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.80.1">aws_instance</span></strong><span class="koboSpan" id="kobo.81.1"> instead </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">aws_instances</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.85.1">Use meaningful names for resources of the same type to differentiate between them; for example, you might name two load balancers </span><strong class="source-inline"><span class="koboSpan" id="kobo.86.1">primary</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.87.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.88.1">secondary</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.90.1">Use nouns for data source names – for example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.91.1">aws_availability_zones</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.92.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.93.1">google_project</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.95.1">In some cases, data sources can return a list and can be plural. </span><span class="koboSpan" id="kobo.95.2">For example, </span><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">aws_availability_zones</span></strong><span class="koboSpan" id="kobo.97.1"> returns a list of </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">Availability Zones.</span></span></li>
<li><span class="koboSpan" id="kobo.99.1">Name the resource </span><strong class="source-inline"><span class="koboSpan" id="kobo.100.1">main</span></strong><span class="koboSpan" id="kobo.101.1"> to simplify references to a resource that is the only one of its type in the module. </span><span class="koboSpan" id="kobo.101.2">An example </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">is </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">aws_security_group_rule.main</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.105.1">It takes extra mental work to remember </span><strong class="source-inline"><span class="koboSpan" id="kobo.106.1">aws_resource.my_special_resource.id</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.107.1">versus </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.108.1">aws_resource.main.id</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">.</span></span></p></li>
<li><span class="koboSpan" id="kobo.110.1">Attribute names in Terraform configuration blocks should use all lowercase letters and underscores to </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">separate words.</span></span></li>
<li><span class="koboSpan" id="kobo.112.1">Consistency is important, so all configuration objects, including resource types and data source types, should also use underscores to delimit </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">multiple words.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.114.1">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">not </span></span><span class="No-Break"><a id="_idIndexMarker158"/></span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">recommended:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.117.1">
resource "azurerm_virtual_machine" "</span><strong class="source-inline"><span class="koboSpan" id="kobo.118.1">main-vm</span></strong><span class="koboSpan" id="kobo.119.1">" {
  name = "main-vm"
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.120.1">This </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">is recommended:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.122.1">resource "azurerm_virtual_machine" "</span><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">main_vm</span></strong><span class="koboSpan" id="kobo.124.1">" {
  name = "main-vm"
}</span></pre></li> <li><span class="koboSpan" id="kobo.125.1">In the resource name, don’t repeat the resource type. </span><span class="koboSpan" id="kobo.125.2">For example, the following is </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">not recommended:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.127.1">
resource "azurerm_virtual_machines" "main_virtual_machine" { … }</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.128.1">However, this </span><span class="No-Break"><span class="koboSpan" id="kobo.129.1">is </span></span><span class="No-Break"><a id="_idIndexMarker159"/></span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">recommended:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.131.1">resource "azurerm_virtual_machine" "</span><strong class="bold"><span class="koboSpan" id="kobo.132.1">main</span></strong><span class="koboSpan" id="kobo.133.1">" { ... </span><span class="koboSpan" id="kobo.133.2">}</span></pre></li> </ul>
<h2 id="_idParaDest-61"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.134.1">Use variables carefully</span></h2>
<p><span class="koboSpan" id="kobo.135.1">Discover how to wield the</span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.136.1"> might of variables judiciously, shaping dynamic environments and empowering your deployments with adaptability </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">and efficiency:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.138.1">All variables should be declared in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">variables.tf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.140.1"> file.</span></span></li>
<li><span class="koboSpan" id="kobo.141.1">Choose meaningful names for variables that accurately describe their purpose or use within the </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">Terraform configuration:</span></span><ul><li><span class="koboSpan" id="kobo.143.1">If you have inputs, local variables, or outputs that represent numeric values, such as disk sizes or RAM size, make sure to include the appropriate units in their names, </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">e.g., </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.145.1">ram_size_gb</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">.</span></span></li><li><span class="koboSpan" id="kobo.147.1">Boolean variables should be named with positive and meaningful names to simplify the conditional logic. </span><span class="koboSpan" id="kobo.147.2">For instance, a variable indicating whether external access is enabled can be </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.149.1">enable_external_access</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">.</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.151.1">Include descriptions for variables to provide additional context for new developers that descriptive names may not convey. </span><span class="koboSpan" id="kobo.151.2">Descriptions are automatically included in a published module’s </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">auto-generated documentation.</span></span></li>
<li><span class="koboSpan" id="kobo.153.1">Provide data types for </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">defined variables.</span></span></li>
<li><span class="koboSpan" id="kobo.155.1">If appropriate, provide default values </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">for variables:</span></span><ul><li><span class="koboSpan" id="kobo.157.1">Provide default values for variables that have environment-independent values, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.158.1">disk size.</span></span></li><li><span class="koboSpan" id="kobo.159.1">For variables that have values specific to a particular environment (e.g., </span><strong class="source-inline"><span class="koboSpan" id="kobo.160.1">project_id</span></strong><span class="koboSpan" id="kobo.161.1">), it is recommended not to provide default values. </span><span class="koboSpan" id="kobo.161.2">This ensures that the calling module provides the necessary values and avoids </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">unintentional misconfiguration.</span></span></li></ul></li>
<li><span class="koboSpan" id="kobo.163.1">Use empty defaults for variables (such as empty strings or lists) only when leaving the variable empty is a valid preference that the underlying APIs don’t reject. </span><span class="koboSpan" id="kobo.163.2">Always use them in the same order as in the </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">following example:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.165.1">
variable "global_settings" {
description = "Setting read in from a global settings block"
type = map
default = {}
}</span></pre></li> <li><span class="koboSpan" id="kobo.166.1">Use variables only for values that need to be different for each instance or environment. </span><span class="koboSpan" id="kobo.166.2">Before exposing a variable, make sure that there is a specific need to change that variable. </span><span class="koboSpan" id="kobo.166.3">If the possibility of a variable being used is minimal, it’s best to not expose it </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">at all.</span></span></li>
<li><span class="koboSpan" id="kobo.168.1">Always use a</span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.169.1"> plural name when defining a variable of a type map or list, as many values will potentially be </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">read in.</span></span></li>
</ul>
<h2 id="_idParaDest-62"><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.171.1">Expose outputs</span></h2>
<p><span class="koboSpan" id="kobo.172.1">Exposing outputs</span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.173.1"> in Terraform can help other modules reference useful values and reduce the amount of redundant code in your project. </span><span class="koboSpan" id="kobo.173.2">Here are some tips for exposing </span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">your outputs:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.175.1">Organize all outputs in an </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">outputs.tf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.177.1"> file</span></span></li>
<li><span class="koboSpan" id="kobo.178.1">Use meaningful descriptions for </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">all outputs</span></span></li>
<li><span class="koboSpan" id="kobo.180.1">Document output descriptions in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">README.md</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.182.1"> file</span></span></li>
<li><span class="koboSpan" id="kobo.183.1">Utilize tools such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">terraform-docs</span></strong><span class="koboSpan" id="kobo.185.1"> to auto-generate output descriptions </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">on commit</span></span></li>
<li><span class="koboSpan" id="kobo.187.1">Output all useful values that root modules might need to refer to </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">or share</span></span></li>
<li><span class="koboSpan" id="kobo.189.1">For open source or heavily used modules, expose all outputs that have the potential </span><span class="No-Break"><span class="koboSpan" id="kobo.190.1">for consumption</span></span></li>
<li><span class="koboSpan" id="kobo.191.1">Avoid passing outputs directly through input variables, as this prevents them from being properly added to the </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">dependency graph</span></span></li>
<li><span class="koboSpan" id="kobo.193.1">To ensure that implicit dependencies are created, make sure that outputs reference attributes </span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">from resources</span></span></li>
<li><span class="koboSpan" id="kobo.195.1">Instead of referencing an input variable for an instance directly, pass the attribute through, as shown in the example </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">provided next.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.197.1">This </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">is recommended:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.199.1">
output "name" {
  description = "Name of Virtual Machine"
  value       = azurerm_virtual_machine.main.name
}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.200.1">This is </span><a id="_idIndexMarker163"/><span class="No-Break"><span class="koboSpan" id="kobo.201.1">not recommended:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.202.1">output "name" {
  description = "Name of Virtual Machine"
  value       = var.name
}</span></pre></li> </ul>
<p class="callout-heading"><span class="koboSpan" id="kobo.203.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.204.1">You can find more details on the best practices</span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.205.1"> for using Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">at </span></span><a href="https://cloud.google.com/docs/terraform/best-practices-for-terraform"><span class="No-Break"><span class="koboSpan" id="kobo.207.1">https://cloud.google.com/docs/terraform/best-practices-for-terraform</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.208.1">.</span></span></p>
<h2 id="_idParaDest-63"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.209.1">Use data sources</span></h2>
<p><span class="koboSpan" id="kobo.210.1">Data sources enable </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.211.1">Terraform to use data defined externally, such as in another Terraform configuration, a separate tool, or a function. </span><span class="koboSpan" id="kobo.211.2">Here are </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">some examples:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.213.1">Place data sources next to the resources that </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">reference them</span></span></li>
<li><span class="koboSpan" id="kobo.215.1">Consider moving a large number of data sources to a dedicated </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">data.tf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.217.1"> file</span></span></li>
<li><span class="koboSpan" id="kobo.218.1">Use variable or resource interpolation to fetch data relative to the </span><span class="No-Break"><span class="koboSpan" id="kobo.219.1">current environment</span></span></li>
</ul>
<h2 id="_idParaDest-64"><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.220.1">Leverage tfvars files</span></h2>
<p><span class="koboSpan" id="kobo.221.1">For anything that’s not a </span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.222.1">secret, use </span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">tfvars</span></strong><span class="koboSpan" id="kobo.224.1"> files as much as possible for all your inputs and add them to your source control. </span><span class="koboSpan" id="kobo.224.2">That way, you can keep track of values and revert to a previous commit if you make a mistake, and you can see what’s deployed at a glance. </span><span class="koboSpan" id="kobo.224.3">This should also be where most of your deployment </span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">changes happen.</span></span></p>
<h2 id="_idParaDest-65"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.226.1">Separate variables and inputs based on their functionality</span></h2>
<p><span class="koboSpan" id="kobo.227.1">In </span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.228.1">your </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">variables.tf</span></strong><span class="koboSpan" id="kobo.230.1"> file and </span><strong class="source-inline"><span class="koboSpan" id="kobo.231.1">terraform.tfvars</span></strong><span class="koboSpan" id="kobo.232.1">, use comments to separate them based on their function. </span><span class="koboSpan" id="kobo.232.2">This makes your code more readable and easy to change when working </span><span class="No-Break"><span class="koboSpan" id="kobo.233.1">with it.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer021">
<span class="koboSpan" id="kobo.234.1"><img alt="Figure 4.1 – An example tfvars" src="image/B18198_04_1.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.235.1">Figure 4.1 – An example tfvars</span></p>
<h2 id="_idParaDest-66"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.236.1">Limit the use of custom scripts</span></h2>
<p><span class="koboSpan" id="kobo.237.1">Limit the use of scripts</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.238.1"> in your Terraform configuration to only when it is necessary. </span><span class="koboSpan" id="kobo.238.2">Keep in mind that the state of resources created through scripts is not managed by Terraform and can cause issues in the future. </span><span class="koboSpan" id="kobo.238.3">It is recommended to use Terraform’s built-in resource types and providers whenever possible. </span><span class="koboSpan" id="kobo.238.4">Here are some </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">key steps:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.240.1">Try to avoid using custom scripts as much as possible. </span><span class="koboSpan" id="kobo.240.2">Instead, rely on Terraform resources to define the desired behavior for your infrastructure. </span><span class="koboSpan" id="kobo.240.3">However, if there are cases where Terraform resources don’t provide the functionality you need, use custom scripts sparingly. </span><span class="koboSpan" id="kobo.240.4">Keep in mind that resources created through scripts are not accounted for or managed by Terraform, so they may introduce complexities in managing </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">your infrastructure.</span></span></li>
<li><span class="koboSpan" id="kobo.242.1">Clearly document the reason for any custom scripts used and have a deprecation plan, </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">if possible.</span></span></li>
<li><span class="koboSpan" id="kobo.244.1">Provisioners in Terraform can be used to call custom scripts, including the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">local-exec</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.246.1"> provisioner.</span></span></li>
<li><span class="koboSpan" id="kobo.247.1">Organize</span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.248.1"> custom scripts that Terraform will call using provisioners in a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">scripts/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.250.1"> directory.</span></span></li>
</ul>
<h2 id="_idParaDest-67"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.251.1">Include helper scripts in a separate directory</span></h2>
<p><span class="koboSpan" id="kobo.252.1">Organizing helper scripts </span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.253.1">in a separate directory is a good practice for maintaining Terraform IaC projects. </span><span class="koboSpan" id="kobo.253.2">To form a good foundation for your IaC project, consider </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.255.1">Keep helper scripts that are not called by Terraform in a directory </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">named </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">helpers/</span></strong></span></li>
<li><span class="koboSpan" id="kobo.258.1">Document all helper scripts in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">README.md</span></strong><span class="koboSpan" id="kobo.260.1"> file by providing a description and </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">example invocations</span></span></li>
<li><span class="koboSpan" id="kobo.262.1">For helper scripts that accept arguments, provide argument-checking and </span><strong class="source-inline"><span class="koboSpan" id="kobo.263.1">--help</span></strong><span class="koboSpan" id="kobo.264.1"> output to ensure that the script is being </span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">used correctly</span></span></li>
</ul>
<h2 id="_idParaDest-68"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.266.1">Put static files in a separate directory</span></h2>
<p><span class="koboSpan" id="kobo.267.1">Amplify your </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.268.1">AWS infrastructure orchestration prowess by embracing the power of organization. </span><span class="koboSpan" id="kobo.268.2">Learn how strategically separating static files into dedicated directories empowers efficient resource management and elevates the clarity of your </span><span class="No-Break"><span class="koboSpan" id="kobo.269.1">Terraform-powered deployments:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.270.1">Create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">files/</span></strong><span class="koboSpan" id="kobo.272.1"> directory for static files that Terraform references but doesn’t execute, such as startup scripts loaded onto Compute </span><span class="No-Break"><span class="koboSpan" id="kobo.273.1">Engine instances</span></span></li>
<li><span class="koboSpan" id="kobo.274.1">Place lengthy HereDocs in external files, separate from their HCL code, and reference them with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">file()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.276.1"> function</span></span></li>
<li><span class="koboSpan" id="kobo.277.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">.tftpl</span></strong><span class="koboSpan" id="kobo.279.1"> file extension for files that are read in by using the Terraform </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.280.1">templatefile()</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.281.1"> function</span></span></li>
<li><span class="koboSpan" id="kobo.282.1">Place </span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.283.1">templates in a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.284.1">templates/</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.285.1"> directory</span></span></li>
</ul>
<h2 id="_idParaDest-69"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.286.1">Protect stateful resources</span></h2>
<p><span class="koboSpan" id="kobo.287.1">Explore essential strategies to </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.288.1">protect the core of your infrastructure, ensuring resilience, compliance, and </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">seamless continuity.</span></span></p>
<p><span class="koboSpan" id="kobo.290.1">Make sure to enable deletion protection for stateful resources such as databases. </span><span class="koboSpan" id="kobo.290.2">This is an example of enabling </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">deletion protection:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.292.1">
resource "azurerm_sql_database" "main" {
  name = "primary-instance"
  settings {
    tier = " "
  }
  lifecycle {
    prevent_destroy = true
  }
}</span></pre> <h2 id="_idParaDest-70"><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.293.1">Use built-in formatting</span></h2>
<p><span class="koboSpan" id="kobo.294.1">It is important to</span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.295.1"> maintain consistency and readability in Terraform code. </span><span class="koboSpan" id="kobo.295.2">To ensure this, use the Terraform </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">fmt</span></strong><span class="koboSpan" id="kobo.297.1"> command to automatically format all Terraform files according to the official Terraform style guide. </span><span class="koboSpan" id="kobo.297.2">This helps maintain consistency and makes it easier for others to read and understand </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">your code.</span></span></p>
<h2 id="_idParaDest-71"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.299.1">Limit the complexity of expressions</span></h2>
<p><span class="koboSpan" id="kobo.300.1">Avoid overly complex </span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.301.1">interpolated expressions; if an expression requires multiple functions, consider splitting it into smaller, more readable expressions using </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">local values.</span></span></p>
<p><span class="koboSpan" id="kobo.303.1">Use only one ternary operation per line, and use multiple local values instead of building up complex logic in a </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">single line.</span></span></p>
<h2 id="_idParaDest-72"><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.305.1">Use count for conditional values</span></h2>
<p><span class="koboSpan" id="kobo.306.1">Use the count </span><a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.307.1">meta-argument to conditionally instantiate a resource. </span><span class="koboSpan" id="kobo.307.2">This is </span><span class="No-Break"><span class="koboSpan" id="kobo.308.1">an example:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.309.1">
variable "readers" {
  description = "..."
</span><span class="koboSpan" id="kobo.309.2">  type        = list
  default     = []
}</span></pre> <p><span class="koboSpan" id="kobo.310.1">This Terraform code snippet declares a variable named </span><strong class="source-inline"><span class="koboSpan" id="kobo.311.1">readers</span></strong><span class="koboSpan" id="kobo.312.1"> with a list type and an empty default value. </span><span class="koboSpan" id="kobo.312.2">The description of the variable is not included in the </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">code snippet:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.314.1">
resource "resource_type" "reference_name" {
  // Do not create this resource if the list of readers is empty.
</span><span class="koboSpan" id="kobo.314.2">  count = length(var.readers) == 0 ? </span><span class="koboSpan" id="kobo.314.3">0 : 1
  ...
</span><span class="koboSpan" id="kobo.314.4">}</span></pre> <p><span class="koboSpan" id="kobo.315.1">The code also defines a resource of type </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">resource_type</span></strong><span class="koboSpan" id="kobo.317.1"> with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">reference_name</span></strong><span class="koboSpan" id="kobo.319.1"> reference name. </span><span class="koboSpan" id="kobo.319.2">The count meta-argument is used to conditionally create the resource based on the length of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">readers</span></strong><span class="koboSpan" id="kobo.321.1"> list variable. </span><span class="koboSpan" id="kobo.321.2">If the length of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">readers</span></strong><span class="koboSpan" id="kobo.323.1"> list is </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">0</span></strong><span class="koboSpan" id="kobo.325.1">, the resource</span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.326.1"> will not be created (count = </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">0</span></strong><span class="koboSpan" id="kobo.328.1">). </span><span class="koboSpan" id="kobo.328.2">Otherwise, if the length is greater than </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">0</span></strong><span class="koboSpan" id="kobo.330.1">, the resource will be created (count = </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">1</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">).</span></span></p>
<h2 id="_idParaDest-73"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.333.1">Use for_each for iterated resources</span></h2>
<p><span class="koboSpan" id="kobo.334.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">for_each</span></strong><span class="koboSpan" id="kobo.336.1"> meta-argument when </span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.337.1">creating multiple copies of a resource based on an </span><span class="No-Break"><span class="koboSpan" id="kobo.338.1">input resource.</span></span></p>
<h2 id="_idParaDest-74"><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.339.1">Publish modules to a registry</span></h2>
<p><span class="koboSpan" id="kobo.340.1">Publish reusable </span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.341.1">modules to a module registry to increase reusability and make it easier for your team </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">to use.</span></span></p>
<p><span class="koboSpan" id="kobo.343.1">Next, we will explore how to secure IaC projects </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">with Terraform.</span></span></p>
<h1 id="_idParaDest-75"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.345.1">How to execute IaC projects with Terraform</span></h1>
<p><span class="koboSpan" id="kobo.346.1">Every </span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.347.1">team always starts their Terraform journey by </span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.348.1">running Terraform from their development environments or </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">local computers.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">As the team starts to adopt more Terraform and IaC, you will need more automation to ensure consistency between runs and to provide other important features such as integration with version control, code reviews, environment </span><span class="No-Break"><span class="koboSpan" id="kobo.351.1">management, etc.</span></span></p>
<p><span class="koboSpan" id="kobo.352.1">Terraform automation can be achieved in diverse forms and to different extents. </span><span class="koboSpan" id="kobo.352.2">Some teams might persist in running Terraform locally, using customized wrapper scripts to ensure a uniform working directory for Terraform’s operation. </span><span class="koboSpan" id="kobo.352.3">Meanwhile, other teams fully operate Terraform within orchestration tools such as Jenkins, GitHub Actions, Terraform Cloud, or </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">Terraform Enterprise.</span></span></p>
<p><span class="koboSpan" id="kobo.354.1">The following are steps to create automated execution pipelines </span><span class="No-Break"><span class="koboSpan" id="kobo.355.1">for Terraform:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.356.1">Select a version control system such as GitHub, Git, and </span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">so on.</span></span></li>
<li><span class="koboSpan" id="kobo.358.1">Store all your templates/files in </span><span class="No-Break"><span class="koboSpan" id="kobo.359.1">version control.</span></span></li>
<li><span class="koboSpan" id="kobo.360.1">Select an </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">automation pipeline.</span></span></li>
<li><span class="koboSpan" id="kobo.362.1">Decide where to store your state (e.g., AWS S3, Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">Cloud, etc.).</span></span></li>
<li><span class="koboSpan" id="kobo.364.1">In the automation pipeline script, do </span><span class="No-Break"><span class="koboSpan" id="kobo.365.1">the following:</span></span><ol><li class="Alphabets"><span class="koboSpan" id="kobo.366.1">Verify that the Terraform </span><strong class="bold"><span class="koboSpan" id="kobo.367.1">command-line interface</span></strong><span class="koboSpan" id="kobo.368.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.369.1">CLI</span></strong><span class="koboSpan" id="kobo.370.1">) exists in the </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">automation pipeline.</span></span></li><li class="Alphabets"><span class="koboSpan" id="kobo.372.1">Verify connectivity to your state location and </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">cloud provider.</span></span></li><li class="Alphabets"><span class="koboSpan" id="kobo.374.1">Initialize the Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.375.1">working directory.</span></span></li><li class="Alphabets"><span class="koboSpan" id="kobo.376.1">Produce a plan for changing resources to match the </span><span class="No-Break"><span class="koboSpan" id="kobo.377.1">current configuration.</span></span></li><li class="Alphabets"><span class="koboSpan" id="kobo.378.1">Have a human operator review that plan to ensure it </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">is acceptable.</span></span></li><li class="Alphabets"><span class="koboSpan" id="kobo.380.1">Apply </span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.381.1">the changes</span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.382.1"> described in </span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">the plan.</span></span></li></ol></li>
</ol>
<p><span class="koboSpan" id="kobo.384.1">Having established the foundational aspects of executing IaC projects with Terraform, let’s now shift our focus toward a critical facet: securing these projects. </span><span class="koboSpan" id="kobo.384.2">By seamlessly integrating robust security practices into your Terraform workflows, you not only safeguard your infrastructure but also fortify your development pipeline, ensuring the holistic success of your </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">AWS environment.</span></span></p>
<h1 id="_idParaDest-76"><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.386.1">How to secure IaC projects with Terraform</span></h1>
<p><span class="koboSpan" id="kobo.387.1">Using</span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.388.1"> IaC or Terraform to deploy and manage resources</span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.389.1"> makes the process faster and easier, eliminating the need for one-time scripts or manual steps. </span><span class="koboSpan" id="kobo.389.2">With Terraform, infrastructure can be managed in a similar way as applications and services, including servers, databases, networks, Kubernetes clusters, and entire </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">application stacks.</span></span></p>
<p><span class="koboSpan" id="kobo.391.1">While IaC may not present an immediate risk or attack surface, it’s still important to consider security. </span><span class="koboSpan" id="kobo.391.2">However, because IaC is often managed by engineering and DevOps teams, security measures may be overlooked in favor of monitoring cloud resources already </span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">in production.</span></span></p>
<p><span class="koboSpan" id="kobo.393.1">Managing infrastructure at scale can be complex, and security and DevOps teams may not have the necessary expertise, access, or tools to properly address security concerns. </span><span class="koboSpan" id="kobo.393.2">This can lead to misconfigured cloud resources, such as engineers and developers missing important </span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.394.1">security measures. </span><span class="koboSpan" id="kobo.394.2">Here are some </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">common</span></span><span class="No-Break"><a id="_idIndexMarker187"/></span><span class="No-Break"><span class="koboSpan" id="kobo.396.1"> mistakes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.397.1">Default configurations that haven’t been optimized for security </span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">are used</span></span></li>
<li><span class="koboSpan" id="kobo.399.1">Logging is not enabled, making it difficult to troubleshoot or assemble an </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">audit trail</span></span></li>
<li><span class="koboSpan" id="kobo.401.1">Unencrypted databases are used, leaving data vulnerable to corruption </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">and exfiltration</span></span></li>
<li><span class="koboSpan" id="kobo.403.1">Insecure protocols (e.g., not using HTTPS) </span><span class="No-Break"><span class="koboSpan" id="kobo.404.1">are deployed</span></span></li>
<li><span class="koboSpan" id="kobo.405.1">Foundational governance and prevention systems for security or misconfiguration </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">are lacking</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.407.1">IaC involves defining and managing configurations using code, which means that all security configurations must also be defined in code. </span><span class="koboSpan" id="kobo.407.2">Here are some tips for securing your </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">Terraform projects:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.409.1">Ensure that your state location is secure and not publicly accessible and provide appropriate access to your team </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">for operations.</span></span></li>
<li><span class="koboSpan" id="kobo.411.1">Keep private modules in private </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">module registries.</span></span></li>
<li><span class="koboSpan" id="kobo.413.1">Do not hardcode sensitive information such as secrets, credentials, keys, or certificates in Terraform files or variables. </span><span class="koboSpan" id="kobo.413.2">Instead, retrieve them from secure locations </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">at runtime.</span></span></li>
<li><span class="koboSpan" id="kobo.415.1">Use a tool such as Checkov to scan your Terraform templates and directories for misconfigurations related to encryption, network, backup, IAM, and other security and </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">compliance policies.</span></span></li>
<li><span class="koboSpan" id="kobo.417.1">Automate IaC scanning in your </span><strong class="bold"><span class="koboSpan" id="kobo.418.1">continuous integration/continuous deployment</span></strong><span class="koboSpan" id="kobo.419.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.420.1">CI/CD</span></strong><span class="koboSpan" id="kobo.421.1">) pipeline for consistency and provide automated feedback as part of the CI run to prevent </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">misconfigured code.</span></span></li>
<li><span class="koboSpan" id="kobo.423.1">Use a version control system, lock your main deployment branch, and always run automated checks and get peer reviews and approval </span><span class="No-Break"><span class="koboSpan" id="kobo.424.1">before deployment.</span></span></li>
<li><span class="koboSpan" id="kobo.425.1">Carefully</span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.426.1"> review the </span><strong class="source-inline"><span class="koboSpan" id="kobo.427.1">terraform plan</span></strong><span class="koboSpan" id="kobo.428.1"> results </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.429.1">to avoid any unexpected </span><span class="No-Break"><span class="koboSpan" id="kobo.430.1">resource destruction.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.431.1">Having fortified your IaC projects with Terraform’s security measures, the next significant stride is seamlessly integrating Terraform into your DevOps or cloud teams. </span><span class="koboSpan" id="kobo.431.2">Discover the pivotal steps to harmoniously weave Terraform into your team’s practices, enhancing collaboration, efficiency, and the realization of a cohesive and empowered </span><span class="No-Break"><span class="koboSpan" id="kobo.432.1">AWS environment.</span></span></p>
<h1 id="_idParaDest-77"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.433.1">Implementing Terraform in DevOps or cloud teams</span></h1>
<p><span class="koboSpan" id="kobo.434.1">Implementing</span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.435.1"> Terraform in DevOps or cloud teams involves more than just adopting the tool. </span><span class="koboSpan" id="kobo.435.2">It also requires understanding the process, the team’s capabilities, and the organization’s culture. </span><span class="koboSpan" id="kobo.435.3">Here are some steps you can follow to successfully implement Terraform in your DevOps or </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">cloud teams:</span></span></p>
<ol>
<li><strong class="bold"><span class="koboSpan" id="kobo.437.1">Start with a pilot project</span></strong><span class="koboSpan" id="kobo.438.1">: Begin with a small project that can demonstrate the value of Terraform to the team. </span><span class="koboSpan" id="kobo.438.2">It could be a simple infrastructure deployment, such as a VPC, or a more complex </span><span class="No-Break"><span class="koboSpan" id="kobo.439.1">application stack.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.440.1">Identify the team’s knowledge gaps</span></strong><span class="koboSpan" id="kobo.441.1">: Terraform requires knowledge of cloud infrastructure, coding, and best practices. </span><span class="koboSpan" id="kobo.441.2">Identify any gaps in the team’s knowledge and create a plan to </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">address them.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.443.1">Encourage collaboration and knowledge sharing</span></strong><span class="koboSpan" id="kobo.444.1">: Terraform is a collaborative tool that requires contributions from multiple teams. </span><span class="koboSpan" id="kobo.444.2">Encourage your teams to share their knowledge, experiences, and </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">best practices.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.446.1">Implement a version control system (VCS)</span></strong><span class="koboSpan" id="kobo.447.1">: Terraform code is code and should be treated like any other code. </span><span class="koboSpan" id="kobo.447.2">Implement </span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.448.1">a </span><strong class="bold"><span class="koboSpan" id="kobo.449.1">VCS</span></strong><span class="koboSpan" id="kobo.450.1"> to manage changes to the </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">infrastructure code.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.452.1">Implement a CI/CD pipeline</span></strong><span class="koboSpan" id="kobo.453.1">: Automate the testing, building, and deployment of Terraform code using a CI/CD pipeline. </span><span class="koboSpan" id="kobo.453.2">This ensures that infrastructure changes are thoroughly tested </span><span class="No-Break"><span class="koboSpan" id="kobo.454.1">before deployment.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.455.1">Implement IaC best practices</span></strong><span class="koboSpan" id="kobo.456.1">: Use best practices for IaC development, such as modularization, code reviews, and testing. </span><span class="koboSpan" id="kobo.456.2">This ensures that your infrastructure code is maintainable, scalable, </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">and secure.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.458.1">Monitor and optimize</span></strong><span class="koboSpan" id="kobo.459.1">: Implement monitoring and alerting to identify and address issues as they arise. </span><span class="koboSpan" id="kobo.459.2">Optimize your infrastructure by reviewing logs and metrics </span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.460.1">and identifying areas </span><span class="No-Break"><span class="koboSpan" id="kobo.461.1">for improvement.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.462.1">By following these steps, you can successfully implement Terraform in your DevOps or cloud teams and reap the benefits </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">of IaC.</span></span></p>
<h1 id="_idParaDest-78"><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.464.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.465.1">In this chapter, we covered the best practices for Terraform IaC projects, including organizing files, defining variables, using data sources, and managing state. </span><span class="koboSpan" id="kobo.465.2">We also discussed how to maintain IaC projects with Terraform, including managing resources, deploying changes, and employing version control. </span><span class="koboSpan" id="kobo.465.3">Additionally, we explored how to execute IaC projects with Terraform, including using modules, providers, and </span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">Terraform Cloud.</span></span></p>
<p><span class="koboSpan" id="kobo.467.1">Finally, we addressed how to secure IaC projects with Terraform, including securing state, avoiding hardcoded secrets, and using tools such as Checkov. </span><span class="koboSpan" id="kobo.467.2">By following these best practices, DevOps and cloud teams can effectively use Terraform to manage infrastructure at scale while maintaining security </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">and compliance.</span></span></p>
<p><span class="koboSpan" id="kobo.469.1">In the next chapter, we’ll delve into the fundamentals of planning Terraform infrastructure projects. </span><span class="koboSpan" id="kobo.469.2">We’ll kick off with guidance on crafting your initial Terraform template in AWS. </span><span class="koboSpan" id="kobo.469.3">Next, we’ll deepen your comprehension of AWS providers and Terraform modules, essential elements for any </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">Terraform project.</span></span></p>
</div>


<div class="Content" id="_idContainer023">
<h1 id="_idParaDest-79" lang="en-US" xml:lang="en-US"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.1.1">Part 2:Become an Expert in Terraform with AWS</span></h1>
<p><span class="koboSpan" id="kobo.2.1">In this section, we dive deeper into the intricacies of Terraform on AWS, guiding you through the process of becoming an expert in deploying and managing cloud infrastructure. </span><span class="koboSpan" id="kobo.2.2">We start by discussing the importance of planning and designing infrastructure projects in AWS, ensuring a solid foundation for your Terraform deployments. </span><span class="koboSpan" id="kobo.2.3">You’ll learn how to make informed decisions for your AWS Terraform projects, considering factors such as resource selection, configuration, and deployment strategies. </span><span class="koboSpan" id="kobo.2.4">We then move on to the practical implementation of Terraform in various projects, including deploying serverless applications and containers in AWS. </span><span class="koboSpan" id="kobo.2.5">By the end of this part, you’ll have a comprehensive understanding of how to expertly use Terraform to deploy and manage complex infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.3.1">on AWS.</span></span></p>
<p><span class="koboSpan" id="kobo.4.1">This part contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.5.1">following chapters:</span></span></p>
<ul>
<li><a href="B18198_05.xhtml#_idTextAnchor079"><em class="italic"><span class="koboSpan" id="kobo.6.1">Chapter 5</span></em></a><em class="italic"><span class="koboSpan" id="kobo.7.1">, Planning and Designing Infrastructure Projects in AWS</span></em></li>
<li><a href="B18198_06.xhtml#_idTextAnchor126"><em class="italic"><span class="koboSpan" id="kobo.8.1">Chapter 6</span></em></a><em class="italic"><span class="koboSpan" id="kobo.9.1">, Making Decisions for Terraform Projects with AWS</span></em></li>
<li><a href="B18198_07.xhtml#_idTextAnchor141"><em class="italic"><span class="koboSpan" id="kobo.10.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.11.1">, Implementing Terraform in Projects</span></em></li>
<li><a href="B18198_08.xhtml#_idTextAnchor156"><em class="italic"><span class="koboSpan" id="kobo.12.1">Chapter 8</span></em></a><em class="italic"><span class="koboSpan" id="kobo.13.1">, Deploying Serverless Projects with Terraform</span></em></li>
<li><a href="B18198_09.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.14.1">Chapter 9</span></em></a><em class="italic"><span class="koboSpan" id="kobo.15.1">, Deploying Containers in AWS with Terraform</span></em></li>
</ul>
</div>
<div>
<div id="_idContainer024">
</div>
</div>
<div>
<div class="Basic-Graphics-Frame" id="_idContainer025">
</div>
</div>
</body></html>