<html><head></head><body>
<div id="_idContainer020">
<h1 class="chapter-number" id="_idParaDest-42"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 id="_idParaDest-43"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.2.1">Building Your First Terraform Project</span></h1>
<p><span class="koboSpan" id="kobo.3.1">If you’re new to Terraform and looking to get started with your first project, this chapter is for you. </span><span class="koboSpan" id="kobo.3.2">In this chapter, we’ll cover the basics of building your first Terraform configuration for AWS. </span><span class="koboSpan" id="kobo.3.3">We’ll start by discussing how to install Terraform and prepare it for use with AWS. </span><span class="koboSpan" id="kobo.3.4">Then, we’ll guide you through the process of building your first Terraform configuration and template. </span><span class="koboSpan" id="kobo.3.5">We’ll also show you how to provision and test your first template so you can see your infrastructure come to life. </span><span class="koboSpan" id="kobo.3.6">By the end of this chapter, you’ll have the foundational knowledge and skills to build your own infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">with Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">How to </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">install Terraform</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">How to install/prepare Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">for AWS</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Building your first </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">Terraform configuration</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Building your first </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">Terraform template</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Provisioning and testing </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">your template</span></span></li>
</ul>
<h1 id="_idParaDest-44"><a id="_idTextAnchor043"/><span class="koboSpan" id="kobo.17.1">How to install Terraform</span></h1>
<p><span class="koboSpan" id="kobo.18.1">To get started with </span><a id="_idIndexMarker100"/><span class="koboSpan" id="kobo.19.1">Terraform, it’s important to understand how to properly install and manage the Terraform installation. </span><span class="koboSpan" id="kobo.19.2">Installing Terraform can be challenging, but there are many online resources available to guide you through the process, including the official Terraform documentation. </span><span class="koboSpan" id="kobo.19.3">Terraform is distributed as a binary package by HashiCorp, and it can also be installed using popular package managers. </span><span class="koboSpan" id="kobo.19.4">Installing Terraform is the first step to creating your first project </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">on Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.21.1">Let’s go over different installation </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">methods next.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.23.1">Manual installation</span></h2>
<p><span class="koboSpan" id="kobo.24.1">For manual installation, you have</span><a id="_idIndexMarker101"/><span class="koboSpan" id="kobo.25.1"> the choice of downloading a pre-compiled binary from the Terraform </span><strong class="bold"><span class="koboSpan" id="kobo.26.1">Downloads</span></strong><span class="koboSpan" id="kobo.27.1"> page, or compiling a binary from </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">the source.</span></span></p>
<h3><span class="koboSpan" id="kobo.29.1">Pre-compiled binary</span></h3>
<p><span class="koboSpan" id="kobo.30.1">To install Terraform, you need to download the correct package for your operating system in the form of a ZIP archive. </span><span class="koboSpan" id="kobo.30.2">The </span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.31.1">appropriate package can be found by selecting your operating system on the Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">website: </span></span><a href="https://www.terraform.io/downloads"><span class="No-Break"><span class="koboSpan" id="kobo.33.1">https://www.terraform.io/downloads</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.34.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.35.1">Once you have downloaded the appropriate Terraform package for your system, the next step is to unzip the package. </span><span class="koboSpan" id="kobo.35.2">Inside the package, you will find a single binary named </span><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">terraform</span></strong><span class="koboSpan" id="kobo.37.1">, which is the main executable for Terraform. </span><span class="koboSpan" id="kobo.37.2">You can safely remove any other files in the package, and Terraform will still </span><span class="No-Break"><span class="koboSpan" id="kobo.38.1">function properly.</span></span></p>
<p><span class="koboSpan" id="kobo.39.1">To use Terraform, you also need to ensure that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">terraform</span></strong><span class="koboSpan" id="kobo.41.1"> binary is added to your system’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.42.1">PATH</span></strong><span class="koboSpan" id="kobo.43.1"> environment variable so that it can be executed from any directory in the terminal. </span><span class="koboSpan" id="kobo.43.2">The process for setting this up varies depending on your operating system, but instructions can typically be found online or in the </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">Terraform documentation.</span></span></p>
<h4><span class="koboSpan" id="kobo.45.1">Mac or Linux PATH configuration</span></h4>
<p><span class="koboSpan" id="kobo.46.1">Print a colon-separated list </span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.47.1">of locations in </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">your </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">PATH</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.50.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.51.1">
echo $PATH</span></pre> <p><span class="koboSpan" id="kobo.52.1">Move the Terraform binary to one of the listed locations. </span><span class="koboSpan" id="kobo.52.2">This command assumes that the binary is currently in your downloads folder and that your </span><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">PATH</span></strong><span class="koboSpan" id="kobo.54.1"> includes </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">/usr/local/bin</span></strong><span class="koboSpan" id="kobo.56.1">, but you can customize it if your locations </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">are different:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.58.1">
mv ~/Downloads/terraform /usr/local/bin/</span></pre> <h4><span class="koboSpan" id="kobo.59.1">Windows PATH configuration</span></h4>
<p><span class="koboSpan" id="kobo.60.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.61.1">PATH</span></strong><span class="koboSpan" id="kobo.62.1"> configuration is stored in the</span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.63.1"> registry, which you can edit through the </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">following interface:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.65.1">Go to </span><strong class="bold"><span class="koboSpan" id="kobo.66.1">Control Panel</span></strong><span class="koboSpan" id="kobo.67.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">System</span></strong><span class="koboSpan" id="kobo.69.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.70.1">System settings</span></strong><span class="koboSpan" id="kobo.71.1"> | </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.72.1">Environment variables</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.73.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.74.1">Scroll down through the system variables until you </span><span class="No-Break"><span class="koboSpan" id="kobo.75.1">find </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.76.1">PATH</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.78.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.79.1">edit</span></strong><span class="koboSpan" id="kobo.80.1"> and make the </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">change accordingly.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.82.1">Be sure to include a semicolon at the end of the previous variable as these are used </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">as delimiters.</span></span></p></li>
<li><span class="koboSpan" id="kobo.84.1">Launch a new console for the settings to </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">take effect.</span></span></li>
</ol>
<h3><span class="koboSpan" id="kobo.86.1">Compiling from source</span></h3>
<p><span class="koboSpan" id="kobo.87.1">If you wish to </span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.88.1">compile the Terraform binary from source, you can clone the HashiCorp </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">Terraform repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.90.1">
git clone https://github.com/hashicorp/terraform.git</span></pre> <p><span class="koboSpan" id="kobo.91.1">Navigate to the </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">new directory:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.93.1">
cd terraform</span></pre> <p><span class="koboSpan" id="kobo.94.1">Then, compile the binary. </span><span class="koboSpan" id="kobo.94.2">This command will compile the binary and store it </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.96.1">$GOPATH/bin/terraform</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.98.1">
go install</span></pre> <p><span class="koboSpan" id="kobo.99.1">After installing Terraform, it is important to ensure that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.100.1">terraform</span></strong><span class="koboSpan" id="kobo.101.1"> binary is added to your system’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.102.1">PATH</span></strong><span class="koboSpan" id="kobo.103.1"> environment variable so that it can be executed from anywhere. </span><span class="koboSpan" id="kobo.103.2">This process may vary depending on your operating system, but typically involves adding the location of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">terraform</span></strong><span class="koboSpan" id="kobo.105.1"> binary to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.106.1">PATH</span></strong><span class="koboSpan" id="kobo.107.1"> variable using a command or by manually editing </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">system files.</span></span></p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor045"/><span class="koboSpan" id="kobo.109.1">Popular package managers</span></h2>
<p><span class="koboSpan" id="kobo.110.1">There are several popular </span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.111.1">package managers that simplify the process of installing Terraform on different operating systems. </span><span class="koboSpan" id="kobo.111.2">These package managers allow you to manage and update multiple software packages from a single </span><strong class="bold"><span class="koboSpan" id="kobo.112.1">Command-Line Interface</span></strong><span class="koboSpan" id="kobo.113.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.114.1">CLI</span></strong><span class="koboSpan" id="kobo.115.1">). </span><span class="koboSpan" id="kobo.115.2">In this section, we will explore some of the most popular package managers for Terraform, including Chocolatey for Windows, Homebrew for macOS, and APT and Yum </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">for Linux.</span></span></p>
<h3><span class="koboSpan" id="kobo.117.1">Homebrew on macOS</span></h3>
<p><span class="koboSpan" id="kobo.118.1">To install Terraform on Mac macOS</span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.119.1">, you can utilize the free and open source package management system for Mac macOS known as Homebrew. </span><span class="koboSpan" id="kobo.119.2">Before installing Terraform itself, you need to</span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.120.1"> install the HashiCorp </span><strong class="source-inline"><span class="koboSpan" id="kobo.121.1">tap</span></strong><span class="koboSpan" id="kobo.122.1">, which is a repository that contains all the </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">Homebrew packages:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.124.1">
brew tap hashicorp/tap</span></pre> <p><span class="koboSpan" id="kobo.125.1">Now, install Terraform </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.127.1">hashicorp/tap/terraform</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.129.1">
brew install hashicorp/tap/terraform</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.130.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.131.1">This installs a signed binary and is automatically updated with every new </span><span class="No-Break"><span class="koboSpan" id="kobo.132.1">official release.</span></span></p>
<p><span class="koboSpan" id="kobo.133.1">To update to the latest version of Terraform, first </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">update Homebrew:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.135.1">
brew update</span></pre> <p><span class="koboSpan" id="kobo.136.1">Then, run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.137.1">upgrade</span></strong><span class="koboSpan" id="kobo.138.1"> command to download and use the latest </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">Terraform version:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.140.1">
brew upgrade hashicorp/tap/terraform</span></pre> <h3><span class="koboSpan" id="kobo.141.1">Chocolatey on Windows</span></h3>
<p><span class="koboSpan" id="kobo.142.1">To install Terraform on Windows</span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.143.1"> using Chocolatey, you can use the</span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.144.1"> CLI. </span><span class="koboSpan" id="kobo.144.2">Chocolatey is a free and open source package manager for Windows that simplifies the process of installing and managing software on </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">your</span></span><span class="No-Break"><a id="_idIndexMarker111"/></span><span class="No-Break"><span class="koboSpan" id="kobo.146.1"> system:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.147.1">
choco install terraform</span></pre> <p class="callout-heading"><span class="koboSpan" id="kobo.148.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.149.1">Chocolatey and the Terraform package are </span><em class="italic"><span class="koboSpan" id="kobo.150.1">not</span></em><span class="koboSpan" id="kobo.151.1"> directly maintained by HashiCorp. </span><span class="koboSpan" id="kobo.151.2">The latest version of </span><a id="_idIndexMarker112"/><span class="koboSpan" id="kobo.152.1">Terraform is always available for </span><span class="No-Break"><span class="koboSpan" id="kobo.153.1">manual installation.</span></span></p>
<h3><span class="koboSpan" id="kobo.154.1">Linux</span></h3>
<p><span class="koboSpan" id="kobo.155.1">HashiCorp officially maintains</span><a id="_idIndexMarker113"/><span class="koboSpan" id="kobo.156.1"> and signs packages for Ubuntu/Debian, CentOS/RHEL, Fedora, and Amazon </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">Linux distributions.</span></span></p>
<h4><span class="koboSpan" id="kobo.158.1">Ubuntu/Debian</span></h4>
<p><span class="koboSpan" id="kobo.159.1">Make sure that your system is up to </span><a id="_idIndexMarker114"/><span class="koboSpan" id="kobo.160.1">date, and that you have the </span><strong class="source-inline"><span class="koboSpan" id="kobo.161.1">gnupg</span></strong><span class="koboSpan" id="kobo.162.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">software-properties-common</span></strong><span class="koboSpan" id="kobo.164.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.165.1">curl</span></strong><span class="koboSpan" id="kobo.166.1"> packages installed. </span><span class="koboSpan" id="kobo.166.2">These packages are necessary to verify the GPG signature of HashiCorp and install its Debian </span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">package repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.168.1">
sudo apt-get update &amp;&amp; sudo apt-get install -y gnupg software-properties-common</span></pre> <p><span class="koboSpan" id="kobo.169.1">Install the HashiCorp </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">GPG key:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.171.1">
gpg --no-default-keyring \
    --keyring /usr/share/keyrings/hashicorp-archive-keyring.gpg \
    --fingerprint</span></pre> <p><span class="koboSpan" id="kobo.172.1">Add the official HashiCorp repository to your system by using the appropriate command for your system. </span><span class="koboSpan" id="kobo.172.2">The command uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">lsb_release -cs</span></strong><span class="koboSpan" id="kobo.174.1"> to find the distribution release codename for your current system, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">buster</span></strong><span class="koboSpan" id="kobo.176.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">groovy</span></strong><span class="koboSpan" id="kobo.178.1">, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.179.1">sid</span></strong><span class="koboSpan" id="kobo.180.1">, and adds it to the </span><span class="No-Break"><span class="koboSpan" id="kobo.181.1">repository file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.182.1">
echo "deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] \
    https://apt.releases.hashicorp.com $(lsb_release -cs) main" | \
    sudo tee /etc/apt/sources.list.d/hashicorp.list</span></pre> <p><span class="koboSpan" id="kobo.183.1">Download the</span><a id="_idIndexMarker115"/><span class="koboSpan" id="kobo.184.1"> package information </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">from HashiCorp:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.186.1">
sudo apt update</span></pre> <p><span class="koboSpan" id="kobo.187.1">Install Terraform from the </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">new repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.189.1">
sudo apt-get install terraform</span></pre> <h4><span class="koboSpan" id="kobo.190.1">CentOS/RHEL</span></h4>
<p><span class="koboSpan" id="kobo.191.1">Install </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">yum-config-manager</span></strong><span class="koboSpan" id="kobo.193.1"> to </span><a id="_idIndexMarker116"/><span class="koboSpan" id="kobo.194.1">manage </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">your repositories:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.196.1">
sudo yum install -y yum-utils</span></pre> <p><span class="koboSpan" id="kobo.197.1">Use </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">yum-config-manager</span></strong><span class="koboSpan" id="kobo.199.1"> to add the official HashiCorp </span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">Linux repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.201.1">
sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo</span></pre> <p><span class="koboSpan" id="kobo.202.1">Install Terraform from the </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">new repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.204.1">
sudo yum -y install terraform</span></pre> <h4><span class="koboSpan" id="kobo.205.1">Fedora</span></h4>
<p><span class="koboSpan" id="kobo.206.1">Install </span><strong class="source-inline"><span class="koboSpan" id="kobo.207.1">dnf config-manager</span></strong><span class="koboSpan" id="kobo.208.1"> to manage</span><a id="_idIndexMarker117"/> <span class="No-Break"><span class="koboSpan" id="kobo.209.1">your repositories:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.210.1">
sudo dnf install -y dnf-plugins-core</span></pre> <p><span class="koboSpan" id="kobo.211.1">Use </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">dnf config-manager</span></strong><span class="koboSpan" id="kobo.213.1"> to add the official HashiCorp </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">Linux repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.215.1">
sudo dnf config-manager --add-repo https://rpm.releases.hashicorp.com/fedora/hashicorp.repo</span></pre> <p><span class="koboSpan" id="kobo.216.1">Install Terraform from the </span><span class="No-Break"><span class="koboSpan" id="kobo.217.1">new repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.218.1">
sudo dnf -y install terraform</span></pre> <h4><span class="koboSpan" id="kobo.219.1">Amazon Linux</span></h4>
<p><span class="koboSpan" id="kobo.220.1">Install </span><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">yum-config-manager</span></strong><span class="koboSpan" id="kobo.222.1"> to </span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.223.1">manage </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">your repositories:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.225.1">
sudo yum install -y yum-utils</span></pre> <p><span class="koboSpan" id="kobo.226.1">Use </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">yum-config-manager</span></strong><span class="koboSpan" id="kobo.228.1"> to add the official HashiCorp </span><span class="No-Break"><span class="koboSpan" id="kobo.229.1">Linux repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.230.1">
sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo</span></pre> <p><span class="koboSpan" id="kobo.231.1">Install Terraform from the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">new repository:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.233.1">
sudo yum -y install terraform</span></pre> <h2 id="_idParaDest-47"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.234.1">Verifying the installation</span></h2>
<p><span class="koboSpan" id="kobo.235.1">Once you have completed the</span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.236.1"> installation process, it is essential to verify that Terraform is installed correctly. </span><span class="koboSpan" id="kobo.236.2">To do this, you can open a new terminal session and list Terraform’s available subcommands. </span><span class="koboSpan" id="kobo.236.3">This will help you ensure that Terraform is functioning correctly and that you can begin to create and manage infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">using Terraform:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.238.1">
terraform -help</span></pre> <p><span class="koboSpan" id="kobo.239.1">If you are getting a response similar to the following, that means your installation </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">was successful:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.241.1">
&gt; terraform -help
Usage: terraform [-version] [-help] &lt;command&gt; [args]
The available commands for execution are listed below.
</span><span class="koboSpan" id="kobo.241.2">The most common, useful commands are shown first, followed by
less common or more advanced commands. </span><span class="koboSpan" id="kobo.241.3">If you're just getting
started with Terraform, stick with the common commands. </span><span class="koboSpan" id="kobo.241.4">For the
other commands, please read the help and docs before usage.</span></pre> <p><span class="koboSpan" id="kobo.242.1">Now that we have </span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.243.1">covered how to install Terraform, let’s move on to preparing Terraform for AWS by configuring our AWS account to allow Terraform to interact with the </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">AWS services.</span></span></p>
<h1 id="_idParaDest-48"><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.245.1">How to install/prepare Terraform for AWS</span></h1>
<p><span class="koboSpan" id="kobo.246.1">Once Terraform is installed, you can</span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.247.1"> create your first infrastructure in AWS. </span><span class="koboSpan" id="kobo.247.2">Terraform generates an execution plan outlining the necessary steps to reach the desired infrastructure state and then executes it. </span><span class="koboSpan" id="kobo.247.3">As you make changes to the </span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.248.1">configuration, Terraform can determine the differences and create incremental execution plans to apply </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">the changes.</span></span></p>
<p><span class="koboSpan" id="kobo.250.1">In the following steps, let’s create an S3 bucket in AWS. </span><span class="koboSpan" id="kobo.250.2">First of all, there are some prerequisites to provision AWS resources </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">in Terraform.</span></span></p>
<h2 id="_idParaDest-49"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.252.1">Prerequisites</span></h2>
<p><span class="koboSpan" id="kobo.253.1">After a successful Terraform</span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.254.1"> installation, you need the following ready for the </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">next steps:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.256.1">The AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">CLI installed</span></span></li>
<li><span class="koboSpan" id="kobo.258.1">An AWS account and associated credentials with permissions to </span><span class="No-Break"><span class="koboSpan" id="kobo.259.1">create resources</span></span></li>
</ul>
<h2 id="_idParaDest-50"><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.260.1">AWS CLI installation</span></h2>
<p><span class="koboSpan" id="kobo.261.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.262.1">AWS CLI</span></strong><span class="koboSpan" id="kobo.263.1"> is a comprehensive tool that enables you to manage your AWS</span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.264.1"> services from a single, unified interface. </span><span class="koboSpan" id="kobo.264.2">It simplifies the management of multiple AWS services and </span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.265.1">allows for automation through scripts. </span><span class="koboSpan" id="kobo.265.2">By using the AWS CLI, you can execute AWS commands directly from the command line, making it easier to manage your AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">resources efficiently.</span></span></p>
<h3><span class="koboSpan" id="kobo.267.1">Linux</span></h3>
<p><span class="koboSpan" id="kobo.268.1">To install </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">aws-cli</span></strong><span class="koboSpan" id="kobo.270.1">, your system must have the capability to extract or unzip the downloaded package. </span><span class="koboSpan" id="kobo.270.2">If your operating system does not have the built-in </span><strong class="source-inline"><span class="koboSpan" id="kobo.271.1">unzip</span></strong><span class="koboSpan" id="kobo.272.1"> command, you can use an equivalent. </span><span class="koboSpan" id="kobo.272.2">The AWS CLI requires </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">glibc</span></strong><span class="koboSpan" id="kobo.274.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.275.1">groff</span></strong><span class="koboSpan" id="kobo.276.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">less</span></strong><span class="koboSpan" id="kobo.278.1">. </span><span class="koboSpan" id="kobo.278.2">These components are typically</span><a id="_idIndexMarker126"/><span class="koboSpan" id="kobo.279.1"> included by default in most major distributions </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">of Linux.</span></span></p>
<p><span class="koboSpan" id="kobo.281.1">Download the installation package </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.283.1">
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"</span></pre> <p><span class="koboSpan" id="kobo.284.1">Extract the installer by unzipping it. </span><span class="koboSpan" id="kobo.284.2">If your Linux distribution does not have a built-in </span><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">unzip</span></strong><span class="koboSpan" id="kobo.286.1"> command, you can use an alternative to extract it. </span><span class="koboSpan" id="kobo.286.2">The following command is an example of unzipping the package and creating a directory called </span><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">aws</span></strong><span class="koboSpan" id="kobo.288.1"> under the </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">current directory:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.290.1">
unzip awscliv2.zip</span></pre> <p><span class="koboSpan" id="kobo.291.1">Execute the installation command using the install file located in the extracted AWS directory. </span><span class="koboSpan" id="kobo.291.2">The default installation path is </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">/usr/local/aws-cli</span></strong><span class="koboSpan" id="kobo.293.1"> and a symbolic link will be created in </span><strong class="source-inline"><span class="koboSpan" id="kobo.294.1">/usr/local/bin</span></strong><span class="koboSpan" id="kobo.295.1">. </span><span class="koboSpan" id="kobo.295.2">The command may require the use of </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">sudo</span></strong><span class="koboSpan" id="kobo.297.1"> to grant write permissions to </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">those directories:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.299.1">
sudo ./aws/install</span></pre> <p><span class="koboSpan" id="kobo.300.1">Confirm the installation with the </span><span class="No-Break"><span class="koboSpan" id="kobo.301.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.302.1">
aws –version</span></pre> <p><span class="koboSpan" id="kobo.303.1">You should receive a response similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.305.1">
aws-cli/2.7.24 Python/3.8.8 Linux/4.14.133-113.105.amzn2.x86_64 botocore/2.4.5</span></pre> <h3><span class="koboSpan" id="kobo.306.1">macOS</span></h3>
<p><span class="koboSpan" id="kobo.307.1">If you have </span><strong class="source-inline"><span class="koboSpan" id="kobo.308.1">sudo</span></strong><span class="koboSpan" id="kobo.309.1">/admin permissions, you can install the AWS CLI for all users on the computer with the </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">following</span></span><span class="No-Break"><a id="_idIndexMarker127"/></span><span class="No-Break"><span class="koboSpan" id="kobo.311.1"> commands.</span></span></p>
<p><span class="koboSpan" id="kobo.312.1">Download the file using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.313.1">curl</span></strong><span class="koboSpan" id="kobo.314.1"> command. </span><span class="koboSpan" id="kobo.314.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.315.1">-o</span></strong><span class="koboSpan" id="kobo.316.1"> option specifies the filename that the downloaded package is written to. </span><span class="koboSpan" id="kobo.316.2">In this example, the file is written to </span><strong class="source-inline"><span class="koboSpan" id="kobo.317.1">AWSCLIV2.pkg</span></strong><span class="koboSpan" id="kobo.318.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">current folder:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.320.1">
curl "https://awscli.amazonaws.com/AWSCLIV2.pkg" -o "AWSCLIV2.pkg"</span></pre> <p><span class="koboSpan" id="kobo.321.1">This process is different on macOS systems, where you can run the standard macOS installer program to install Terraform. </span><span class="koboSpan" id="kobo.321.2">You simply need to specify the downloaded </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">.pkg</span></strong><span class="koboSpan" id="kobo.323.1"> file as the source using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">-pkg</span></strong><span class="koboSpan" id="kobo.325.1"> parameter to specify the package name and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.326.1">-target /</span></strong><span class="koboSpan" id="kobo.327.1"> parameter to </span><a id="_idIndexMarker128"/><span class="koboSpan" id="kobo.328.1">specify the installation drive. </span><span class="koboSpan" id="kobo.328.2">During the installation process, the files are installed to </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">/usr/local/aws-cli</span></strong><span class="koboSpan" id="kobo.330.1">, and a symlink is automatically created in </span><strong class="source-inline"><span class="koboSpan" id="kobo.331.1">/usr/local/bin</span></strong><span class="koboSpan" id="kobo.332.1">. </span><span class="koboSpan" id="kobo.332.2">However, to grant write permissions to those folders, you must include </span><strong class="source-inline"><span class="koboSpan" id="kobo.333.1">sudo</span></strong><span class="koboSpan" id="kobo.334.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">the command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.336.1">
sudo installer -pkg ./AWSCLIV2.pkg -target /</span></pre> <p><span class="koboSpan" id="kobo.337.1">To verify that the shell can find and run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.338.1">aws</span></strong><span class="koboSpan" id="kobo.339.1"> command in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.340.1">$PATH</span></strong><span class="koboSpan" id="kobo.341.1">, use the </span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.343.1">
which aws</span></pre> <p><span class="koboSpan" id="kobo.344.1">The response should be </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.346.1">
/usr/local/bin/aws</span></pre> <p><span class="koboSpan" id="kobo.347.1">Verify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">PATH</span></strong><span class="koboSpan" id="kobo.349.1"> configuration </span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">and version:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.351.1">
aws –version</span></pre> <p><span class="koboSpan" id="kobo.352.1">The response should be like </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.354.1">
aws-cli/2.7.24 Python/3.8.8 Darwin/18.7.0 botocore/2.4.5</span></pre> <p><span class="koboSpan" id="kobo.355.1">If the </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">aws</span></strong><span class="koboSpan" id="kobo.357.1"> command cannot be found, you might need to restart your terminal </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">and re-verify.</span></span></p>
<h3><span class="koboSpan" id="kobo.359.1">Windows</span></h3>
<p><span class="koboSpan" id="kobo.360.1">You require admin rights to</span><a id="_idIndexMarker129"/><span class="koboSpan" id="kobo.361.1"> install </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">aws-cli</span></strong><span class="koboSpan" id="kobo.363.1"> on your </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">Windows system.</span></span></p>
<p><span class="koboSpan" id="kobo.365.1">Download and run the AWS CLI MSI installer for Windows (</span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">64-bit): </span></span><a href="https://awscli.amazonaws.com/AWSCLIV2.msi"><span class="No-Break"><span class="koboSpan" id="kobo.367.1">https://awscli.amazonaws.com/AWSCLIV2.msi</span></span></a></p>
<p><span class="koboSpan" id="kobo.368.1">Alternatively, you can run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.369.1">msiexec</span></strong><span class="koboSpan" id="kobo.370.1"> command to run the MSI installer from </span><span class="No-Break"><span class="koboSpan" id="kobo.371.1">Command Prompt:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.372.1">
msiexec.exe /i https://awscli.amazonaws.com/AWSCLIV2.msi</span></pre> <p><span class="koboSpan" id="kobo.373.1">You can verify whether the AWS CLI is installed on your Windows machine by opening a Command Prompt window and running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">aws --</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">version</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.376.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.377.1">
aws –version</span></pre> <p><span class="koboSpan" id="kobo.378.1">This will display the installed version of the AWS CLI, confirming its successful installation on </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">your system.</span></span></p>
<p><span class="koboSpan" id="kobo.380.1">The response should be something like </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.382.1">
aws-cli/2.7.24 Python/3.8.8 Windows/10 exe/AMD64 prompt/off</span></pre> <p><span class="koboSpan" id="kobo.383.1">If Windows is</span><a id="_idIndexMarker130"/><span class="koboSpan" id="kobo.384.1"> unable to find the program, you might need to close and reopen the Command Prompt window to refresh the path </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">and re-verify.</span></span></p>
<h3><span class="koboSpan" id="kobo.386.1">AWS account</span></h3>
<p><span class="koboSpan" id="kobo.387.1">If you do not have an AWS</span><a id="_idIndexMarker131"/><span class="koboSpan" id="kobo.388.1"> account, you can create one with the following steps; if you do already have one, please skip the AWS credentials </span><span class="No-Break"><span class="koboSpan" id="kobo.389.1">configuration part:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.390.1">Open the AWS home page </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">at </span></span><a href="https://aws.amazon.com/"><span class="No-Break"><span class="koboSpan" id="kobo.392.1">https://aws.amazon.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.393.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.394.1">Choose </span><strong class="bold"><span class="koboSpan" id="kobo.395.1">Create an </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.396.1">AWS account</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.398.1">Ensure that you provide accurate account information, including your email address, and select </span><strong class="bold"><span class="koboSpan" id="kobo.399.1">Continue</span></strong><span class="koboSpan" id="kobo.400.1">. </span><span class="koboSpan" id="kobo.400.2">Entering an incorrect email address can result in being unable to access your </span><span class="No-Break"><span class="koboSpan" id="kobo.401.1">AWS account.</span></span></li>
<li><span class="koboSpan" id="kobo.402.1">Choose </span><strong class="bold"><span class="koboSpan" id="kobo.403.1">Personal</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.404.1">or </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.405.1">Professional</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.407.1">Enter your company or </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">personal information.</span></span></li>
<li><span class="koboSpan" id="kobo.409.1">Read and accept the AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">Customer Agreement.</span></span></li>
<li><span class="koboSpan" id="kobo.411.1">Choose </span><strong class="bold"><span class="koboSpan" id="kobo.412.1">Create Account</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.413.1">and </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.414.1">Continue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.416.1">Provide your payment information on the </span><strong class="bold"><span class="koboSpan" id="kobo.417.1">Payment Information</span></strong><span class="koboSpan" id="kobo.418.1"> page and select </span><strong class="bold"><span class="koboSpan" id="kobo.419.1">Verify and Add</span></strong><span class="koboSpan" id="kobo.420.1"> to proceed. </span><span class="koboSpan" id="kobo.420.2">It’s mandatory to provide a valid payment method to complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">sign-up process.</span></span></li>
<li><span class="koboSpan" id="kobo.422.1">After completing the payment information, you will be asked to verify your phone number. </span><span class="koboSpan" id="kobo.422.2">You need to select the country or REGION code from the list and provide a phone number that you can access in the next few minutes </span><span class="No-Break"><span class="koboSpan" id="kobo.423.1">for verification.</span></span></li>
<li><span class="koboSpan" id="kobo.424.1">Enter the code</span><a id="_idIndexMarker132"/><span class="koboSpan" id="kobo.425.1"> displayed in the CAPTCHA, and </span><span class="No-Break"><span class="koboSpan" id="kobo.426.1">then submit.</span></span></li>
<li><span class="koboSpan" id="kobo.427.1">After the automated system contacts you, you need to enter the PIN you receive and then choose the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.428.1">Continue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.429.1"> option.</span></span></li>
<li><span class="koboSpan" id="kobo.430.1">On the </span><strong class="bold"><span class="koboSpan" id="kobo.431.1">Select a Support Plan</span></strong><span class="koboSpan" id="kobo.432.1"> page, choose one of the available AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.433.1">Support plans.</span></span></li>
<li><span class="koboSpan" id="kobo.434.1">Finally, wait for your new account to be activated. </span><span class="koboSpan" id="kobo.434.2">This usually takes a few minutes but can take up to </span><span class="No-Break"><span class="koboSpan" id="kobo.435.1">24 hours.</span></span></li>
<li><span class="koboSpan" id="kobo.436.1">Once your account is fully activated, AWS will send you a confirmation email. </span><span class="koboSpan" id="kobo.436.2">Be sure to check your email inbox and spam folder for the confirmation message. </span><span class="koboSpan" id="kobo.436.3">After receiving the email message, you will have full access to all </span><span class="No-Break"><span class="koboSpan" id="kobo.437.1">AWS services.</span></span></li>
</ol>
<h3><span class="koboSpan" id="kobo.438.1">AWS credentials</span></h3>
<p><span class="koboSpan" id="kobo.439.1">In order to interact with </span><a id="_idIndexMarker133"/><span class="koboSpan" id="kobo.440.1">AWS via programmatic methods, it’s required to supply your AWS access keys. </span><span class="koboSpan" id="kobo.440.2">These keys authenticate your identity when making programmatic requests. </span><span class="koboSpan" id="kobo.440.3">Access keys could be either temporary credentials that are valid for a short-term period or long-term credentials, such as those linked to an IAM user or the AWS account’s </span><span class="No-Break"><span class="koboSpan" id="kobo.441.1">root user.</span></span></p>
<p><span class="koboSpan" id="kobo.442.1">In order to use Terraform with AWS, it is recommended to create a dedicated user with specific permissions and generate access keys for the AWS CLI and Terraform CLI to communicate and </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">provision resources.</span></span></p>
<h2 id="_idParaDest-51"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.444.1">Creating an IAM user and credentials for Terraform</span></h2>
<p><span class="koboSpan" id="kobo.445.1">Creating an IAM user is a </span><a id="_idIndexMarker134"/><span class="koboSpan" id="kobo.446.1">standard practice in AWS for security and resource access management. </span><span class="koboSpan" id="kobo.446.2">It is possible to create multiple IAM users and provide them with specific permissions to AWS resources. </span><span class="koboSpan" id="kobo.446.3">The process of creating an IAM user is straightforward, and is typically done when new team members join the company or when a new application needs access to AWS resources. </span><span class="koboSpan" id="kobo.446.4">For Terraform, you need to create an IAM user and assign appropriate permissions to provision resources </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.448.1">Sign in to the AWS Management Console and open the IAM console </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">at </span></span><a href="https://console.aws.amazon.com/iam/"><span class="No-Break"><span class="koboSpan" id="kobo.450.1">https://console.aws.amazon.com/iam/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.451.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.452.1">In the left navigation pane, choose </span><strong class="bold"><span class="koboSpan" id="kobo.453.1">Users</span></strong><span class="koboSpan" id="kobo.454.1"> and then </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.455.1">Add users</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.457.1">Use </span><strong class="source-inline"><span class="koboSpan" id="kobo.458.1">terraform</span></strong><span class="koboSpan" id="kobo.459.1"> as the username for the new user. </span><span class="koboSpan" id="kobo.459.2">This is the sign-in name </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">for AWS.</span></span></li>
<li><span class="koboSpan" id="kobo.461.1">Select the type of access this user will have. </span><span class="koboSpan" id="kobo.461.2">You can select programmatic access and access to the</span><a id="_idIndexMarker135"/><span class="koboSpan" id="kobo.462.1"> AWS Management Console; I recommend just selecting programmatic access so you do not need to maintain a programmatic user’s password </span><span class="No-Break"><span class="koboSpan" id="kobo.463.1">life cycle.</span></span></li>
<li><span class="koboSpan" id="kobo.464.1">Choose </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.465.1">Next: Permissions</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.466.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.467.1">On the </span><strong class="bold"><span class="koboSpan" id="kobo.468.1">Set permissions</span></strong><span class="koboSpan" id="kobo.469.1"> page, specify how you want to assign permissions to this set of new users. </span><span class="koboSpan" id="kobo.469.2">You can add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.470.1">terraform</span></strong><span class="koboSpan" id="kobo.471.1"> user to a group, copy permissions from an existing user, or attach policies directly. </span><span class="koboSpan" id="kobo.471.2">If you are planning to provision all resources with this user, you can attach the </span><strong class="bold"><span class="koboSpan" id="kobo.472.1">AdministratorAccess</span></strong><span class="koboSpan" id="kobo.473.1"> policy to the user, but this will provide broad permission to all resources in the account, so make sure to keep your </span><span class="No-Break"><span class="koboSpan" id="kobo.474.1">credentials secret.</span></span></li>
<li><span class="koboSpan" id="kobo.475.1">Choose </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.476.1">Next: Tags</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.478.1">(Optional) On the </span><strong class="bold"><span class="koboSpan" id="kobo.479.1">Tags</span></strong><span class="koboSpan" id="kobo.480.1"> page, add metadata to the user by attaching tags as </span><span class="No-Break"><span class="koboSpan" id="kobo.481.1">key-value pairs.</span></span></li>
<li><span class="koboSpan" id="kobo.482.1">Choose </span><strong class="bold"><span class="koboSpan" id="kobo.483.1">Next: Review</span></strong><span class="koboSpan" id="kobo.484.1">. </span><span class="koboSpan" id="kobo.484.2">Verify the user permissions to be added to the new user. </span><span class="koboSpan" id="kobo.484.3">When you are ready to proceed, choose </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.485.1">Create user</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.487.1">You can view the access keys for the user by selecting the </span><strong class="bold"><span class="koboSpan" id="kobo.488.1">Show</span></strong><span class="koboSpan" id="kobo.489.1"> option next to each password and access key. </span><span class="koboSpan" id="kobo.489.2">To save the access keys, select the </span><strong class="bold"><span class="koboSpan" id="kobo.490.1">Download .csv</span></strong><span class="koboSpan" id="kobo.491.1"> option and save the file to a </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">secure location.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.493.1">Now, you have a user and credentials for the </span><span class="No-Break"><span class="koboSpan" id="kobo.494.1">next steps.</span></span></p></li>
</ol>
<p><span class="koboSpan" id="kobo.495.1">Now that you have installed</span><a id="_idIndexMarker136"/><span class="koboSpan" id="kobo.496.1"> and prepared Terraform for AWS, it’s time to start building your first Terraform configuration. </span><span class="koboSpan" id="kobo.496.2">With your AWS access keys and user permissions in place, you can now begin to write your Terraform code to provision your infrastructure in </span><span class="No-Break"><span class="koboSpan" id="kobo.497.1">the cloud.</span></span></p>
<h1 id="_idParaDest-52"><a id="_idTextAnchor051"/><span class="koboSpan" id="kobo.498.1">Building your first Terraform configuration</span></h1>
<p><span class="koboSpan" id="kobo.499.1">After installing Terraform and the</span><a id="_idIndexMarker137"/><span class="koboSpan" id="kobo.500.1"> AWS CLI, it is time to configure connectivity between them to be able to create resources </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">with Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.502.1">To authenticate the Terraform AWS provider with your IAM credentials, you need to set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">AWS_ACCESS_KEY_ID</span></strong><span class="koboSpan" id="kobo.504.1"> environment variable in your terminal by adding your key after the </span><strong class="source-inline"><span class="koboSpan" id="kobo.505.1">=</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.506.1">sign:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.507.1">
export AWS_ACCESS_KEY_ID=</span></pre> <p><span class="koboSpan" id="kobo.508.1">Then add your secret key as follows, again after the </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">=</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.510.1">sign:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.511.1">
export AWS_SECRET_ACCESS_KEY=</span></pre> <p><span class="koboSpan" id="kobo.512.1">You can verify your credentials and connectivity with the </span><span class="No-Break"><span class="koboSpan" id="kobo.513.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.514.1">
aws sts get-caller-identity</span></pre> <p><span class="koboSpan" id="kobo.515.1">And you should receive a similar output to </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.517.1">
{
    "Account": "1234567890",
    "UserId": "ABCDEFGHJIKLM",
    "Arn": "arn:aws:iam:: 1234567890:user/erol_kavas"
}</span></pre> <p><span class="koboSpan" id="kobo.518.1">Now that you have successfully built your first Terraform configuration, let’s move on to building your first </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">Terraform </span></span><span class="No-Break"><a id="_idIndexMarker138"/></span><span class="No-Break"><span class="koboSpan" id="kobo.520.1">template.</span></span></p>
<h1 id="_idParaDest-53"><a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.521.1">Building your first Terraform template</span></h1>
<p><span class="koboSpan" id="kobo.522.1">We have created our AWS account </span><a id="_idIndexMarker139"/><span class="koboSpan" id="kobo.523.1">and an IAM user and set up the necessary credentials for Terraform and the AWS CLI to communicate with AWS to provision infrastructure. </span><span class="koboSpan" id="kobo.523.2">Let’s now start developing our first </span><span class="No-Break"><span class="koboSpan" id="kobo.524.1">Terraform template.</span></span></p>
<p><span class="koboSpan" id="kobo.525.1">A dedicated working directory is required for each Terraform configuration. </span><span class="koboSpan" id="kobo.525.2">To begin with, create a new directory for your first Terraform project. </span><span class="koboSpan" id="kobo.525.3">Any code editor or terminal can be used for this purpose, and we will provide the terminal commands for </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">your convenience:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.527.1">
mkdir my-first-terraform-project</span></pre> <p><span class="koboSpan" id="kobo.528.1">Change into the directory so that we can start to create files </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">in it:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.530.1">
cd my-first-terraform-project</span></pre> <p><span class="koboSpan" id="kobo.531.1">Create an empty file to define </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">your infrastructure:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.533.1">
touch main.tf</span></pre> <p><span class="koboSpan" id="kobo.534.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">main.tf</span></strong><span class="koboSpan" id="kobo.536.1"> file in your preferred text editor and copy the following configuration into the file. </span><span class="koboSpan" id="kobo.536.2">Save the file once you have added </span><span class="No-Break"><span class="koboSpan" id="kobo.537.1">the configuration:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.538.1">
terraform {
  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~&gt; 4.0"
    }
  }
}
# Configure the AWS Provider
provider "aws" {
  region = "us-east-1"
}
resource "aws_vpc" "example" {
  cidr_block = "10.0.0.0/16"
}</span></pre> <p><span class="koboSpan" id="kobo.539.1">Here we explicitly state that we are using the AWS provider plugin from Terraform and demanding a version greater than 4.0. </span><span class="koboSpan" id="kobo.539.2">We do not provide the access key/secret from the user in IAM that we created, because they were already imported into the terminal, and you should never, ever hardcode </span><a id="_idIndexMarker140"/><span class="koboSpan" id="kobo.540.1">your credentials in Terraform templates! </span><span class="koboSpan" id="kobo.540.2">We also supply the REGION in which we want to make all changes. </span><span class="koboSpan" id="kobo.540.3">In this example, we are </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">us-east-1</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.544.1">We then use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">aws_vpc</span></strong><span class="koboSpan" id="kobo.546.1"> resource identifier to state that we are trying to bring up a VPC instance, followed by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.547.1">example</span></strong><span class="koboSpan" id="kobo.548.1"> name identifier. </span><span class="koboSpan" id="kobo.548.2">(This name can be anything </span><span class="No-Break"><span class="koboSpan" id="kobo.549.1">you like.)</span></span></p>
<p><span class="koboSpan" id="kobo.550.1">We provide the </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">cidr_block</span></strong><span class="koboSpan" id="kobo.552.1"> information to give the VPC the cidr (IP address </span><span class="No-Break"><span class="koboSpan" id="kobo.553.1">space) information.</span></span></p>
<p><span class="koboSpan" id="kobo.554.1">Now we will run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">terraform init</span></strong><span class="koboSpan" id="kobo.556.1"> command in the directory where we created our </span><strong class="source-inline"><span class="koboSpan" id="kobo.557.1">main.tf</span></strong><span class="koboSpan" id="kobo.558.1"> file to download and initialize the appropriate provider plugins. </span><span class="koboSpan" id="kobo.558.2">In this case, we are downloading the AWS provider plugin we specified in our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.559.1">main.tf</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.560.1"> file:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.561.1">
terraform init</span></pre> <p><span class="koboSpan" id="kobo.562.1">The output should be </span><span class="No-Break"><span class="koboSpan" id="kobo.563.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.564.1">
Initializing the backend...
</span><span class="koboSpan" id="kobo.564.2">Initializing provider plugins...
</span><span class="koboSpan" id="kobo.564.3">- Finding hashicorp/aws versions matching "~&gt; 4.0"...
</span><span class="koboSpan" id="kobo.564.4">- Installing hashicorp/aws v4.36.1...
</span><span class="koboSpan" id="kobo.564.5">- Installed hashicorp/aws v4.36.1 (signed by HashiCorp)
Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. </span><span class="koboSpan" id="kobo.564.6">Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run "terraform init" in the future.
</span><span class="koboSpan" id="kobo.564.7">Terraform has been successfully initialized!
</span><span class="koboSpan" id="kobo.564.8">You may now begin working with Terraform. </span><span class="koboSpan" id="kobo.564.9">Try running "terraform plan" to see
any changes that are required for your infrastructure. </span><span class="koboSpan" id="kobo.564.10">All Terraform commands
should now work.
</span><span class="koboSpan" id="kobo.564.11">If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. </span><span class="koboSpan" id="kobo.564.12">If you forget, other
commands will detect it and remind you to do so if necessary.</span></pre> <p><span class="koboSpan" id="kobo.565.1">The providers are now installed </span><a id="_idIndexMarker141"/><span class="koboSpan" id="kobo.566.1">and we have the project initialized. </span><span class="koboSpan" id="kobo.566.2">Let’s validate our template with the </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.568.1">
terraform validate</span></pre> <p><span class="koboSpan" id="kobo.569.1">The output must be </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.571.1">
Success! </span><span class="koboSpan" id="kobo.571.2">The configuration is valid.</span></pre> <p><span class="koboSpan" id="kobo.572.1">After verifying our configuration, we can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.573.1">terraform fmt</span></strong><span class="koboSpan" id="kobo.574.1"> to format our configuration files to use the correct format and style. </span><span class="koboSpan" id="kobo.574.2">In Terraform’s newer versions, the introduction of new formatting rules in </span><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">terraform fmt</span></strong><span class="koboSpan" id="kobo.576.1"> aren’t considered a breaking change. </span><span class="koboSpan" id="kobo.576.2">However, our objective is to keep changes to a minimum for configurations that already conform to the </span><a id="_idIndexMarker142"/><span class="koboSpan" id="kobo.577.1">style guides provided in the </span><span class="No-Break"><span class="koboSpan" id="kobo.578.1">Terraform documentation.</span></span></p>
<h1 id="_idParaDest-54"><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.579.1">Provisioning and testing your template</span></h1>
<p><span class="koboSpan" id="kobo.580.1">After the</span><a id="_idIndexMarker143"/><span class="koboSpan" id="kobo.581.1"> validation, let’s run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">terraform plan</span></strong><span class="koboSpan" id="kobo.583.1"> command. </span><span class="koboSpan" id="kobo.583.2">This will let us see what Terraform will do before</span><a id="_idIndexMarker144"/><span class="koboSpan" id="kobo.584.1"> we decide to </span><span class="No-Break"><span class="koboSpan" id="kobo.585.1">apply it:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.586.1">
terraform plan</span></pre> <p><span class="koboSpan" id="kobo.587.1">The output should be </span><span class="No-Break"><span class="koboSpan" id="kobo.588.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.589.1">
Terraform used the selected providers to generate the following execution plan. </span><span class="koboSpan" id="kobo.589.2">Resource actions are indicated with the following symbols:
  + create
Terraform will perform the following actions:
  # aws_vpc.example will be created
  + resource "aws_vpc" "example" {
      + arn                                  = (known after apply)
      + cidr_block                           = "10.0.0.0/16"
      + default_network_acl_id               = (known after apply)
      + default_route_table_id               = (known after apply)
      + default_security_group_id            = (known after apply)
      + dhcp_options_id                      = (known after apply)
      + enable_classiclink                   = (known after apply)
      + enable_classiclink_dns_support       = (known after apply)
      + enable_dns_hostnames                 = (known after apply)
      + enable_dns_support                   = true
      + enable_network_address_usage_metrics = (known after apply)
      + id                                   = (known after apply)
      + instance_tenancy                     = "default"
      + ipv6_association_id                  = (known after apply)
      + ipv6_cidr_block                      = (known after apply)
      + ipv6_cidr_block_network_border_group = (known after apply)
      + main_route_table_id                  = (known after apply)
      + owner_id                             = (known after apply)
      + tags_all                             = (known after apply)
    }
Plan: 1 to add, 0 to change, 0 to destroy.
</span><span class="koboSpan" id="kobo.589.3">───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Note: You didn't use the -out option to save this plan, so Terraform can't guarantee to take exactly these actions if you run "terraform apply" now.</span></pre> <p><span class="koboSpan" id="kobo.590.1">Terraform provides a dependable and secure way to manage your infrastructure life cycle through the use of declarative </span><a id="_idIndexMarker145"/><span class="koboSpan" id="kobo.591.1">configuration files. </span><span class="koboSpan" id="kobo.591.2">The largest hurdle encountered when handling</span><a id="_idIndexMarker146"/> <strong class="bold"><span class="koboSpan" id="kobo.592.1">Infrastructure as Code</span></strong><span class="koboSpan" id="kobo.593.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.594.1">IaC</span></strong><span class="koboSpan" id="kobo.595.1">) is a phenomenon known as drift. </span><span class="koboSpan" id="kobo.595.2">Drift</span><a id="_idIndexMarker147"/><span class="koboSpan" id="kobo.596.1"> refers to the discrepancy between the actual state of your infrastructure and the state articulated in </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">your configuration.</span></span></p>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">terraform plan</span></strong><span class="koboSpan" id="kobo.599.1"> is a very important command to detect drift in Terraform-managed resources – you must be able to understand every output and change in the plan’s output, especially the line with the summary. </span><span class="koboSpan" id="kobo.599.2">In our example, this is </span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.601.1">
Plan: 1 to add, 0 to change, 0 to destroy.</span></pre> <p><span class="koboSpan" id="kobo.602.1">After investigating the changes and verifying that they are what we planned and intended, let’s proceed with </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.603.1">terraform apply</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.604.1">:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.605.1">
terraform apply</span></pre> <p><span class="koboSpan" id="kobo.606.1">After running </span><strong class="source-inline"><span class="koboSpan" id="kobo.607.1">apply</span></strong><span class="koboSpan" id="kobo.608.1">, Terraform will run another plan and ask us to verify and approve the predicted changes. </span><span class="koboSpan" id="kobo.608.2">The output should be similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.609.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.610.1">
Terraform used the selected providers to generate the following execution plan. </span><span class="koboSpan" id="kobo.610.2">Resource actions are indicated with the following symbols:
  + create
Terraform will perform the following actions:
  # aws_vpc.example will be created
  + resource "aws_vpc" "example" {
      + arn                                  = (known after apply)
      + cidr_block                           = "10.0.0.0/16"
      + default_network_acl_id               = (known after apply)
      + default_route_table_id               = (known after apply)
      + default_security_group_id            = (known after apply)
      + dhcp_options_id                      = (known after apply)
      + enable_classiclink                   = (known after apply)
      + enable_classiclink_dns_support       = (known after apply)
      + enable_dns_hostnames                 = (known after apply)
      + enable_dns_support                   = true
      + enable_network_address_usage_metrics = (known after apply)
      + id                                   = (known after apply)
      + instance_tenancy                     = "default"
      + ipv6_association_id                  = (known after apply)
      + ipv6_cidr_block                      = (known after apply)
      + ipv6_cidr_block_network_border_group = (known after apply)
      + main_route_table_id                  = (known after apply)
      + owner_id                             = (known after apply)
      + tags_all                             = (known after apply)
    }
Plan: 1 to add, 0 to change, 0 to destroy.
</span><span class="koboSpan" id="kobo.610.3">Do you want to perform these actions?
</span><span class="koboSpan" id="kobo.610.4">  Terraform will perform the actions described above.
</span><span class="koboSpan" id="kobo.610.5">  Only 'yes' will be accepted to approve.
</span><span class="koboSpan" id="kobo.610.6">  Enter a value:</span></pre> <p><span class="koboSpan" id="kobo.611.1">You should carefully review the output, and if everything looks good, you can approve it by typing </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">yes</span></strong><span class="koboSpan" id="kobo.613.1">. </span><span class="koboSpan" id="kobo.613.2">Other than </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">yes</span></strong><span class="koboSpan" id="kobo.615.1">, infrastructure provisioning will be discarded, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">apply</span></strong><span class="koboSpan" id="kobo.617.1"> will not provision anything in </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">your</span></span><span class="No-Break"><a id="_idIndexMarker148"/></span><span class="No-Break"><span class="koboSpan" id="kobo.619.1"> environment.</span></span></p>
<p><span class="koboSpan" id="kobo.620.1">After your </span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.621.1">approval, </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">terraform-cli</span></strong><span class="koboSpan" id="kobo.623.1"> will start to deploy the resources you have requested, and the additional output should be similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">the following:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.625.1">
aws_vpc.example: Creating...
</span><span class="koboSpan" id="kobo.625.2">aws_vpc.example: Creation complete after 2s [id=vpc-xxxxxx]
Apply complete! </span><span class="koboSpan" id="kobo.625.3">Resources: 1 added, 0 changed, 0 destroyed.</span></pre> <p><span class="koboSpan" id="kobo.626.1">The last line gives the summary of your </span><strong class="source-inline"><span class="koboSpan" id="kobo.627.1">terraform apply</span></strong><span class="koboSpan" id="kobo.628.1"> command, allowing you to easily see what was deployed, added, changed, </span><span class="No-Break"><span class="koboSpan" id="kobo.629.1">or destroyed.</span></span></p>
<p><span class="koboSpan" id="kobo.630.1">After verifying the resource from the AWS web console, you can destroy the example resources created in this exercise by running the </span><strong class="source-inline"><span class="koboSpan" id="kobo.631.1">terraform </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">destroy</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.633.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.634.1">
terraform destroy</span></pre> <p><span class="koboSpan" id="kobo.635.1">When you use Terraform to manage </span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.636.1">your infrastructure, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.637.1">terraform destroy</span></strong><span class="koboSpan" id="kobo.638.1"> command can be used to terminate</span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.639.1"> resources created by your Terraform project. </span><span class="koboSpan" id="kobo.639.2">It is the opposite of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.640.1">terraform apply</span></strong><span class="koboSpan" id="kobo.641.1"> command because it removes all the resources specified in your Terraform state. </span><span class="koboSpan" id="kobo.641.2">However, it’s important to note that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.642.1">terraform destroy</span></strong><span class="koboSpan" id="kobo.643.1"> command does not destroy resources that are running elsewhere and are not managed by the current </span><span class="No-Break"><span class="koboSpan" id="kobo.644.1">Terraform project.</span></span></p>
<p><span class="koboSpan" id="kobo.645.1">The output should look </span><span class="No-Break"><span class="koboSpan" id="kobo.646.1">like this:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.647.1">
aws_vpc.example: Refreshing state... </span><span class="koboSpan" id="kobo.647.2">[id=vpc-xxxx]
Terraform used the selected providers to generate the following execution plan. </span><span class="koboSpan" id="kobo.647.3">Resource actions are indicated with the following symbols:
  - destroy
Terraform will perform the following actions:
  # aws_vpc.example will be destroyed
  - resource "aws_vpc" "example" {
      - arn                                  = "arn:aws:ec2:us-east-1:xxxx:vpc/vpc-xxxx" -&gt; null
      - assign_generated_ipv6_cidr_block     = false -&gt; null
      - cidr_block                           = "10.0.0.0/16" -&gt; null
      - default_network_acl_id               = "acl-0cbfcf0156e3eec97" -&gt; null
      - default_route_table_id               = "rtb-0933253f8baad1cb2" -&gt; null
      - default_security_group_id            = "sg-09aa1459d60ec7939" -&gt; null
      - dhcp_options_id                      = "dopt-26ad5a5f" -&gt; null
      - enable_classiclink                   = false -&gt; null
      - enable_classiclink_dns_support       = false -&gt; null
      - enable_dns_hostnames                 = false -&gt; null
      - enable_dns_support                   = true -&gt; null
      - enable_network_address_usage_metrics = false -&gt; null
      - id                                   = "vpc-xxxx" -&gt; null
      - instance_tenancy                     = "default" -&gt; null
      - ipv6_netmask_length                  = 0 -&gt; null
      - main_route_table_id                  = "rtb-xxxx" -&gt; null
      - owner_id                             = "xx" -&gt; null
      - tags                                 = {} -&gt; null
      - tags_all                             = {} -&gt; null
    }
Plan: 0 to add, 0 to change, 1 to destroy.
</span><span class="koboSpan" id="kobo.647.4">Do you really want to destroy all resources?
</span><span class="koboSpan" id="kobo.647.5">  Terraform will destroy all your managed infrastructure, as shown above.
</span><span class="koboSpan" id="kobo.647.6">  There is no undo. </span><span class="koboSpan" id="kobo.647.7">Only 'yes' will be accepted to confirm.
</span><span class="koboSpan" id="kobo.647.8">  Enter a value:</span></pre> <p><span class="koboSpan" id="kobo.648.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.649.1">-</span></strong><span class="koboSpan" id="kobo.650.1"> prefix in </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">terraform destroy</span></strong><span class="koboSpan" id="kobo.652.1"> indicates that the instance will be destroyed. </span><span class="koboSpan" id="kobo.652.2">Similar to </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1">apply</span></strong><span class="koboSpan" id="kobo.654.1">, Terraform shows its execution plan and waits for approval before making any changes. </span><span class="koboSpan" id="kobo.654.2">It’s important to</span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.655.1"> carefully review all changes and approve them, as there is no way to recover the</span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.656.1"> resources </span><span class="No-Break"><span class="koboSpan" id="kobo.657.1">after approval.</span></span></p>
<p><span class="koboSpan" id="kobo.658.1">Answer </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">yes</span></strong><span class="koboSpan" id="kobo.660.1"> to execute this plan and destroy </span><span class="No-Break"><span class="koboSpan" id="kobo.661.1">the infrastructure:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.662.1">
aws_vpc.example: Destroying... </span><span class="koboSpan" id="kobo.662.2">[id=vpc-xxxx]
aws_vpc.example: Destruction complete after 1s
Destroy complete! </span><span class="koboSpan" id="kobo.662.3">Resources: 1 destroyed.</span></pre> <p><span class="koboSpan" id="kobo.663.1">Similar to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.664.1">apply</span></strong><span class="koboSpan" id="kobo.665.1"> command, Terraform will determine the order in which to destroy resources. </span><span class="koboSpan" id="kobo.665.2">If there are multiple resources with dependencies, Terraform will destroy them in the appropriate order with regard to those dependencies. </span><span class="koboSpan" id="kobo.665.3">In this case, Terraform identified a single VPC with no dependencies and </span><span class="No-Break"><span class="koboSpan" id="kobo.666.1">destroyed it.</span></span></p>
<h1 id="_idParaDest-55"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.667.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.668.1">In this chapter, we learned how to install Terraform and prepare it for use with AWS. </span><span class="koboSpan" id="kobo.668.2">We covered various installation methods including downloading the binary, using a package manager, and compiling from source. </span><span class="koboSpan" id="kobo.668.3">Additionally, we discussed how to set up an AWS account and create an IAM user for Terraform. </span><span class="koboSpan" id="kobo.668.4">We then walked through the process of creating a directory for our first Terraform project, pasting in configuration code, and using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">terraform apply</span></strong><span class="koboSpan" id="kobo.670.1"> command to provision resources. </span><span class="koboSpan" id="kobo.670.2">Finally, we learned how to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.671.1">terraform destroy</span></strong><span class="koboSpan" id="kobo.672.1"> to tear down the resources created by our Terraform project. </span><span class="koboSpan" id="kobo.672.2">With the skills learned in this chapter, you should now be able to create and manage infrastructure on AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.673.1">using Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.674.1">In the following chapter, we will explore the utilization of Terraform in </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.675.1">IaC</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.676.1"> projects.</span></span></p>
</div>
</body></html>