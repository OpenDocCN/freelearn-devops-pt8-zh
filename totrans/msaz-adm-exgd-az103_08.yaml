- en: Configuring Azure Files and Implementing Azure Backup
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置 Azure 文件和实施 Azure 备份
- en: In the previous chapter, we covered the different ways of migrating large amounts
    of data to Azure using disks and Azure Data Box. We also covered how to configure
    an Azure **Content Delivery Network** (**CDN**) to cache static and dynamic content
    and deliver it more quickly to your users.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一章中，我们介绍了通过磁盘和 Azure 数据盒将大量数据迁移到 Azure 的不同方式。我们还讲解了如何配置 Azure **内容分发网络**（**CDN**）来缓存静态和动态内容，并更快地将其交付给用户。
- en: This chapter proceeds with the last part of the *Implementing and Managing Storage*
    objective. In this chapter, we are going to cover how you can create Azure file
    share  and how to troubleshoot them. We are also going to look at the backup and
    restore capabilities in Azure. You will learn about Azure Backup and Azure Site
    Recovery, and we are going to perform a backup and restore operation for our Azure
    file share.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章继续讲解*实现和管理存储*目标的最后部分。在本章中，我们将介绍如何创建 Azure 文件共享，并如何排查它们的问题。我们还将了解 Azure 的备份和恢复功能。你将学习
    Azure 备份和 Azure 站点恢复，并将执行一次 Azure 文件共享的备份和恢复操作。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Creating an Azure file share and Azure file share sync service
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建 Azure 文件共享和 Azure 文件共享同步服务
- en: Azure Backup
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 备份
- en: Azure Site Recovery
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Azure 站点恢复
- en: Performing a backup and restore operation
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行备份和恢复操作
- en: Creating a Recovery Services vault
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建恢复服务库
- en: Creating and configuring a backup policy
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建和配置备份策略
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: This chapter uses Azure PowerShell ([https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0](https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0)) for
    our examples.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的示例使用了 Azure PowerShell ([https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0](https://docs.microsoft.com/en-us/powershell/azure/install-az-ps?view=azps-1.8.0))。
- en: The source code for this chapter can be downloaded from [https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter06](https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter06)[.](https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter06)
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的源代码可以从[https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter06](https://github.com/PacktPublishing/Microsoft-Azure-Administrator-Exam-Guide-AZ-103/tree/master/Chapter06)下载。
- en: Azure file share and Azure file share sync service
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 文件共享和 Azure 文件共享同步服务
- en: Azure Files was briefly covered in [Chapter 4](82d030ea-5235-4278-9517-47cdefaabe22.xhtml),
    *Creating and Configuring Storage Accounts. *In this chapter, we are going to
    create and configure an Azure file share.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 文件在[第 4 章](82d030ea-5235-4278-9517-47cdefaabe22.xhtml)中已简要介绍，*创建和配置存储账户*。在本章中，我们将创建和配置一个
    Azure 文件共享。
- en: With Azure Files, you can create file shares in the cloud. You can access your
    files using the **Server Message Block** (**SMB**) protocol, which is an industry
    standard that can be used on Linux, Windows, and macOS devices. Azure Files can
    also be mounted as if it is a local drive on these same devices, and they can
    be cached for fast access on Windows Server using Azure File Sync.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Azure 文件，你可以在云中创建文件共享。你可以使用**服务器消息块**（**SMB**）协议访问文件，这是一个行业标准，可以在 Linux、Windows
    和 macOS 设备上使用。Azure 文件还可以像本地驱动器一样在这些设备上挂载，并可以通过 Azure 文件同步在 Windows Server 上进行缓存，以便快速访问。
- en: In the following section, we are going to create an Azure file share from the
    Azure portal.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的部分，我们将从 Azure 门户创建一个 Azure 文件共享。
- en: Creating an Azure file share
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建 Azure 文件共享
- en: 'To create an Azure file share, we first need to create a new storage account
    from the Azure portal. We created a storage account in [Chapter 4](82d030ea-5235-4278-9517-47cdefaabe22.xhtml), *Creating
    and Configuring Storage Accounts.* In this demonstration, we are going to create
    one from the Azure portal as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 要创建一个 Azure 文件共享，我们首先需要在 Azure 门户中创建一个新的存储账户。在[第 4 章](82d030ea-5235-4278-9517-47cdefaabe22.xhtml)，我们已经创建了一个存储账户，*创建和配置存储账户*。在本次演示中，我们将按照以下步骤在
    Azure 门户中创建一个：
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开[https://portal.azure.com](https://portal.azure.com)，进入 Azure 门户。
- en: In the left menu, click + Create a resource | Storage | Storage Account.
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧菜单中，点击 + 创建资源 | 存储 | 存储账户。
- en: 'Add the following values:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下值：
- en: '**Subscription**:Select the subscription where you want to create the storage
    account.'
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**订阅**：选择您要创建存储帐户的订阅。'
- en: '**Resource group**: Create a new one, and call it `PacktFileShareResourceGroup`.'
  id: totrans-23
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**资源组**：创建一个新的资源组，并命名为`PacktFileShareResourceGroup`。'
- en: '**Storage account name**: `packtfileshare`.'
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**存储帐户名称**：`packtfileshare`。'
- en: '**Location**: East US.'
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**位置**：美国东部。'
- en: '**Performance**: Standard.'
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性能**：标准。'
- en: '**Account type**: StorageV2.'
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**帐户类型**：StorageV2。'
- en: '**Replication**: Select Read-access geo-redundant Storage (RA-GRS). This will
    make six copies of the data distributed over different Azure regions.'
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**复制**：选择读取访问地理冗余存储（RA-GRS）。这将使数据的六个副本分布在不同的 Azure 区域。'
- en: '**Access tier**: Hot, because this data is going to be accessed frequently.'
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**访问层**：热存储，因为这些数据将频繁访问。'
- en: 'These values are shown in the following screenshot:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 这些值在以下截图中显示：
- en: '![](img/daa4eb05-94e1-4b49-8f78-45c2540c20be.png)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![](img/daa4eb05-94e1-4b49-8f78-45c2540c20be.png)'
- en: Creating a new storage account
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的存储帐户
- en: Click **Review + create**. After the review, click the **Create **button.
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**审查 + 创建**。审核后，点击**创建**按钮。
- en: 'After creation, open the resource and you will be redirected to the overview
    blade of the storage account. In there, we can create our file share. In the left
    menu, under **File service**, select **Files**. And in the Files blade, click **+
    File share **in the top menu as shown in the following screenshot:'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建后，打开该资源，您将被重定向到存储帐户的概览页面。在这里，我们可以创建我们的文件共享。在左侧菜单中，选择**文件服务**下的**文件**。然后，在文件页面中，点击顶部菜单中的**+
    文件共享**，如以下截图所示：
- en: '![](img/b7cde747-8ec8-4707-be0f-8726500f6c1f.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b7cde747-8ec8-4707-be0f-8726500f6c1f.png)'
- en: Creating a new file share
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个新的文件共享
- en: 'Add the following values as shown in the following screenshot:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下值，如以下截图所示：
- en: '**Name**: `packtfileshare`'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称**：`packtfileshare`'
- en: '**Quota**: `` `10` ``'
  id: totrans-39
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**配额**：`` `10` ``'
- en: '![](img/e3178fa0-ff49-44df-b3ae-a12788049651.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e3178fa0-ff49-44df-b3ae-a12788049651.png)'
- en: Setting the file share properties
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 设置文件共享属性
- en: Click **Create**.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**。
- en: 'After creation, in the overview blade, click the context menu button. After
    that, select Connect as follows:'
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 创建后，在概述页面中点击上下文菜单按钮。之后，选择**连接**，如下所示：
- en: '![](img/cf5ff279-5075-428f-99d6-292b43670697.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cf5ff279-5075-428f-99d6-292b43670697.png)'
- en: Connect to the file share
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 连接到文件共享
- en: 'A new blade will be opened with the details to connect to this file share from
    a Windows, Linux, and MacOS machine as shown in the following screenshot:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将打开一个新页面，显示如何从 Windows、Linux 和 macOS 机器连接到该文件共享，具体如以下截图所示：
- en: '![](img/b8c9288a-2cbb-4a5b-956b-860c53773672.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8c9288a-2cbb-4a5b-956b-860c53773672.png)'
- en: Connection information
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 连接信息
- en: 'Let''s now connect this file share to our local computer using the command
    line prompt. Copy and paste the command highlighted in the preceding screenshot
    in a command line prompt window. When you run that command, the following output
    will be generated:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们通过命令行提示符将这个文件共享连接到本地计算机。在命令行提示符窗口中复制并粘贴上面截图中高亮的命令。运行该命令后，将生成以下输出：
- en: '![](img/b6df1601-dd71-4e40-b7f5-54848fff2cd2.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b6df1601-dd71-4e40-b7f5-54848fff2cd2.png)'
- en: Adding the drive to the local filesystem
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 将驱动器添加到本地文件系统
- en: The drive is now added to your local filesystem.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 驱动器现在已添加到您的本地文件系统。
- en: Now that we have created a file share and added it to our local machine, we
    can proceed with the Azure file share sync service.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经创建了文件共享并将其添加到本地计算机，接下来可以继续使用 Azure 文件共享同步服务。
- en: Azure file share sync service
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 文件共享同步服务
- en: The Azure file share sync service is a service that can synchronize the data
    from on-premises file shares with Azure Files. This way, you can keep the flexibility,
    compatibility, and performance of an on-premises file server, but also store a
    copy of all the data on the file share in Azure. You can use any protocol that's
    available on Windows Server to access your data locally, including **Server Message
    Block** (**SMB**), **Network File System** (**NFS**), and **File Transfer Protocol
    over TLS** (**FTPS**).
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 文件共享同步服务是一项可以将本地文件共享数据与 Azure 文件同步的服务。通过这种方式，您可以保持本地文件服务器的灵活性、兼容性和性能，同时也将所有数据的副本存储在
    Azure 的文件共享中。您可以使用任何 Windows Server 上可用的协议来本地访问数据，包括**服务器消息块**（**SMB**）、**网络文件系统**（**NFS**）和**通过
    TLS 的文件传输协议**（**FTPS**）。
- en: 'In the next demonstration, we are going to configure Azure File Sync. For this,
    the following couple of things need to be in place:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的演示中，我们将配置 Azure 文件同步。为此，以下几件事情需要到位：
- en: Windows Server. For this, I created a Windows Server 2016 VM in Azure. Make
    sure that you enable **Remote Desktop** (**RDP**) on the server.
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows Server。为此，我在Azure中创建了一个Windows Server 2016虚拟机。确保启用服务器上的**远程桌面**（**RDP**）。
- en: Opening the RDP port for a virtual machine during creation is covered in *chapter 7: Creating
    and Configuring VMs for Windows and Linux*, in the "Deploying a Windows VM from
    the Azure portal" section.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在创建虚拟机时开启RDP端口的步骤在*第7章：为Windows和Linux创建和配置虚拟机*中的“从Azure门户部署Windows虚拟机”部分有详细介绍。
- en: A storage account (this storage account needs to be created in one of the supported
    regions for Azure File Sync). You can refer to the following website for the available
    regions: [https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning#region-availability](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning#region-availability).
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 存储帐户（此存储帐户需要在Azure File Sync支持的区域之一中创建）。您可以参考以下网站了解可用区域：[https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning#region-availability](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning#region-availability)。
- en: An Azure file share created in the same region as the storage account.
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在与存储帐户相同区域创建的Azure文件共享。
- en: Once the preceding resources are created, we can start with the creation of
    the Azure File Sync service in Azure and the installation of Azure File Sync on
    the Windows Server.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦前面的资源创建完成，我们就可以开始在Azure中创建Azure File Sync服务，并在Windows Server上安装Azure File
    Sync。
- en: 'First, we will create the Azure File Sync service in Azure. Therefore, take
    the following steps:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将在Azure中创建Azure File Sync服务。请按照以下步骤操作：
- en: Navigate to the Azure portal by opening [https://portal.azure.com](https://portal.azure.com).
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开[https://portal.azure.com](https://portal.azure.com)，进入Azure门户。
- en: In the left menu, click **+ Create a resource**, and in the search box, type `Azure File
    Sync`. Create a new service.
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧菜单中，点击**+ 创建资源**，在搜索框中输入`Azure File Sync`。创建一个新服务。
- en: 'Add the following values:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下值：
- en: '**Name:** `PacktFileSync`.'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称：** `PacktFileSync`。'
- en: '**Subscription:** Pick the same subscription as where the storage account and
    file share are created.'
  id: totrans-67
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**订阅：** 选择与存储帐户和文件共享相同的订阅。'
- en: '**Resource group:** Pick the same subscription as where the storage account
    and file share are created.'
  id: totrans-68
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**资源组：** 选择与存储帐户和文件共享相同的订阅。'
- en: '**Location:** Pick the same location as where the storage account and file
    share are created.'
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**位置：** 选择与存储帐户和文件共享相同的位置。'
- en: 'These values are shown in the following screenshot:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了这些值：
- en: '![](img/5d91487d-045d-4268-83a7-5f89545d9a0f.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5d91487d-045d-4268-83a7-5f89545d9a0f.png)'
- en: Creating a file sync service
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 创建文件同步服务
- en: Click **Create**.
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建**。
- en: 'After deployment, open the Storage Sync Service and click **+ Sync group**
    in the top menu. We are going to create this group to connect the sync service
    to the file share as follows:'
  id: totrans-74
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 部署完成后，打开存储同步服务并点击顶部菜单中的**+ 同步组**。我们将创建这个组以连接同步服务到文件共享，如下所示：
- en: '![](img/26c448d4-bd8b-49ab-a606-5b5e343d1666.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/26c448d4-bd8b-49ab-a606-5b5e343d1666.png)'
- en: Creating a sync group
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 创建同步组
- en: 'Add the following values:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加以下值：
- en: '**Name**: `packtsyncgroup`.'
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**名称：** `packtsyncgroup`。'
- en: '**Subscription**: Select the subscription where the storage account and file
    share are created.'
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**订阅：** 选择存储帐户和文件共享所在的订阅。'
- en: '**Storage account**: Select the storage account where the file share is created.'
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**存储帐户：** 选择创建文件共享的存储帐户。'
- en: 'These values are shown in the following screenshot:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 以下截图展示了这些值：
- en: '![](img/a7e5e3c2-3ec2-4fdc-81c8-9e63f8f32939.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a7e5e3c2-3ec2-4fdc-81c8-9e63f8f32939.png)'
- en: Configuring the sync group
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 配置同步组
- en: RDP to the Windows Server and log in. We first need to disable **IE Enhanced
    Security Configuration**. Open **Server Manager** | **Local Server** and disable
    it for both administrators and users.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 远程桌面连接到Windows Server并登录。我们首先需要禁用**IE增强型安全配置**。打开**服务器管理器** | **本地服务器**并为管理员和用户都禁用此配置。
- en: Download the Azure File Sync agent from the following website: [https://www.microsoft.com/en-us/download/details.aspx?id=57159](https://www.microsoft.com/en-us/download/details.aspx?id=57159)[.](https://www.microsoft.com/en-us/download/details.aspx?id=57159)
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从以下网站下载Azure File Sync代理：[https://www.microsoft.com/en-us/download/details.aspx?id=57159](https://www.microsoft.com/en-us/download/details.aspx?id=57159)。
- en: 'Install the agent on the server. Keep the default path to install the agent.
    In the next screen, enable **Use the existing proxy settings configured on the
    server** as shown in the following screenshot:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在服务器上安装代理。保持默认路径安装代理。在下一个屏幕中，启用**使用服务器上配置的现有代理设置**，如下图所示：
- en: '![](img/589812d7-cbdf-49e0-b67f-e483b88eb7e7.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/589812d7-cbdf-49e0-b67f-e483b88eb7e7.png)'
- en: Proxy Settings
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 代理设置
- en: Click Next.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击“下一步”。
- en: Enable Windows updates and install the tool.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启用 Windows 更新并安装工具。
- en: Once the tool is installed, open the installation folder, which will be `C:\Program
    Files\Azure\StorageSyncAgent`.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦工具安装完成，打开安装文件夹，路径为`C:\Program Files\Azure\StorageSyncAgent`。
- en: Run the `ServerRegistration` tool from the installation folder.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从安装文件夹运行`ServerRegistration`工具。
- en: 'Now, we can register the server. First, we need to sign in. Click the Sign
    In button as follows:'
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们可以注册服务器。首先需要登录。点击登录按钮，如下所示：
- en: '![](img/d4d44f7d-8d8f-4c48-afab-7c867ef4c57c.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d4d44f7d-8d8f-4c48-afab-7c867ef4c57c.png)'
- en: Selecting a Azure Environment
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 Azure 环境
- en: Log in using your Azure administrator credentials.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用 Azure 管理员凭据登录。
- en: 'We can now select the Storage Sync Service that we created in the Azure portal
    earlier. Therefore, you need to select the subscription, resource group, and the
    actual Storage Sync Service as follows:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在我们可以选择之前在 Azure 门户中创建的 Storage Sync 服务。因此，你需要选择订阅、资源组以及实际的 Storage Sync 服务，如下所示：
- en: '![](img/1edb35c0-790e-4583-abd6-d03f77c10590.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1edb35c0-790e-4583-abd6-d03f77c10590.png)'
- en: Selecting a Storage Sync Service
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 选择 Storage Sync 服务
- en: Click **Register**.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**注册**。
- en: After the registration is successful, there is a trust relationship established
    between the on-premises server and the Storage Sync Service in Azure. Click **OK**.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 注册成功后，本地服务器与 Azure 中的 Storage Sync 服务之间建立了信任关系。点击**确定**。
- en: 'Now, we need to go back to the sync service in the Azure portal to create an
    endpoint. Go to the Storage Sync Service again and select the sync group that
    we created earlier. In the sync group settings blade, select **Add server endpoint**
    in the top menu as follows:'
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们需要返回到 Azure 门户中的同步服务，创建一个端点。再次进入 Storage Sync 服务，并选择之前创建的同步组。在同步组设置面板中，选择顶部菜单中的**添加服务器端点**，如下所示：
- en: '![](img/e4506c7d-56f7-4e7c-a205-5d366a4a7cce.png)'
  id: totrans-103
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e4506c7d-56f7-4e7c-a205-5d366a4a7cce.png)'
- en: Adding a server endpoint
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 添加服务器端点
- en: 'Select the registered server and provide the following path: `D:\Data`. Keep
    Cloud Tiering and Offline Data Transfer disabled and click Create as follows:'
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择已注册的服务器并提供以下路径：`D:\Data`。保持云分层和离线数据传输功能关闭，然后点击“创建”，如下所示：
- en: '![](img/221a9110-c142-4476-ab9c-27365f7aadb3.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](img/221a9110-c142-4476-ab9c-27365f7aadb3.png)'
- en: Endpoint values
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 端点值
- en: The server endpoint is now created.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 现在服务器端点已创建。
- en: 'If you now go back to the VM where we installed the sync agent and open the
    `D` drive, you will see that there is a folder added called `Data`. You can copy
    files to it as shown in the following screenshot:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果现在返回到我们安装了同步代理的虚拟机并打开 `D` 盘，你会看到添加了一个名为 `Data` 的文件夹。你可以像下面的截图所示，将文件复制到该文件夹中：
- en: '![](img/0bf5bf92-ccc3-4423-8fe8-13b3f1c849a3.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0bf5bf92-ccc3-4423-8fe8-13b3f1c849a3.png)'
- en: Images stored in the Data folder
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 存储在数据文件夹中的图像
- en: 'When you switch back to the file share in Azure, you will see that all the
    files are synced to the storage account in Azure as shown in the following screenshot:'
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你切换回 Azure 中的文件共享时，你会看到所有文件已经同步到 Azure 存储账户，如下图所示：
- en: '![](img/a6e7a62e-411c-4902-81b8-50d829223139.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a6e7a62e-411c-4902-81b8-50d829223139.png)'
- en: Synced files to Azure file storage
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 同步的文件到 Azure 文件存储
- en: This concludes the section about Azure file storage and the Azure file share
    sync service. In the next section, we are going to look at Azure Backup and recovery.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这部分介绍了 Azure 文件存储和 Azure 文件共享同步服务。接下来的部分，我们将探讨 Azure 备份和恢复。
- en: Azure Backup
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 备份
- en: The Azure Backup service is used to back up resources and data in Azure. This
    can be used for cloud only or hybrid scenarios where you want to back up your
    on-premises VMs to Azure. Your on-premises backup solution can also be extended
    to the cloud in conjunction with Azure Backup. Azure Backup is capable of creating
    backups for VMs, files, folders, applications, workloads, system states, and volumes.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 备份服务用于备份 Azure 中的资源和数据。它可以用于仅云或混合场景，适用于你希望将本地虚拟机备份到 Azure 的情况。你本地的备份解决方案也可以与
    Azure 备份结合使用，扩展到云端。Azure 备份可以为虚拟机、文件、文件夹、应用程序、工作负载、系统状态和卷创建备份。
- en: 'Azure Backup consists of the following features and capabilities:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 备份包括以下功能和能力：
- en: '**Back up on-premises resources to Azure**: Azure Backup offers short and long-term
    backup. This can be a replacement for tape and off-site backup.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**将本地资源备份到 Azure**：Azure 备份提供短期和长期备份。这可以替代磁带和**异地**备份。'
- en: '**Back up Azure VMs**: Azure Backup offers independent and isolated backups.
    These backups are stored in a Recovery Services vault. This vault has built-in
    management for recovery points.'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备份 Azure 虚拟机**：Azure 备份提供独立且隔离的备份。这些备份存储在恢复服务库中。该库内置了恢复点的管理功能。'
- en: '**Automatic scaling**: You can get unlimited scale without maintenance overheads.
    Alerts can be set for delivering information about events.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动扩展**：您可以在没有维护开销的情况下获得无限扩展。可以设置警报来传递有关事件的信息。'
- en: '**Unlimited data transfer**:There is no limit to the amount of inbound and
    outbound traffic that can be transferred during the backup process. However, if
    you use the Azure import/export service for importing large amounts of data, then
    there is a cost associated with inbound data.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**无限数据传输**：在备份过程中，进出流量的传输量没有限制。然而，如果您使用 Azure 导入/导出服务来导入大量数据，则进站数据会产生费用。'
- en: '**Data encryption**: Data can be encrypted using an encryption passphrase.
    This is stored locally and is then needed to restore the data.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据加密**：数据可以使用加密密码短语进行加密。密码短语会被本地存储，并且恢复数据时需要使用。'
- en: '**Short and long-term retention**: Recovery Services is where the backups are
    stored and provides short and long-term backups. Azure doesn''t limit the time
    or length that data can be stored in a Recovery Services vault.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**短期和长期保留**：恢复服务是备份存储的地方，提供短期和长期备份。Azure 不限制数据在恢复服务库中的存储时间或时长。'
- en: '**Multiple storage options**: Azure Backup offers two types of replication—**Locally
    redundant storage** (**LRS**), where your data is replicated three times by creating
    three copies of the data within the same region, and **G****eo****-redundant storage**
    (**GRS**), which is the default option, where the data is replicated to a secondary region.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**多种存储选项**：Azure 备份提供两种类型的复制—**本地冗余存储**（**LRS**），数据会在同一地区通过创建三份副本进行三次复制，和**地理冗余存储**（**GRS**），这是默认选项，数据会复制到一个备用地区。'
- en: 'You can use Azure Backup to back up data that is protected by the following
    products:'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用 Azure 备份来备份以下产品保护的数据：
- en: '**System Center Data Protection Manager (DPM)**:DPM can run on-premises or
    in Azure on physical servers or virtual servers. The DPM server can be backed
    up to Recovery Services as well. The DPM server and its machines need to be in
    the same network. On-premises machines can only be protected by an on-premises
    DPM server, while Azure machines can only be protected by a DPM server that is
    running in Azure.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**系统中心数据保护管理器（DPM）**：DPM 可以在本地或 Azure 中的物理服务器或虚拟服务器上运行。DPM 服务器也可以备份到恢复服务库中。DPM
    服务器及其机器需要在同一网络中。本地机器只能由本地 DPM 服务器保护，而 Azure 机器只能由在 Azure 中运行的 DPM 服务器保护。'
- en: '**Microsoft Azure Backup Server (MABS)**: MABS can run on-premises or in Azure
    on physical servers or virtual servers. It offers similar capabilities to DPM,
    except that MABS can be backed up to tape and you don''t need to have a system
    center license for it. Just like DPM, on-premises machines can only be protected
    by an on-premises MABS server, while Azure machines can only be protected by an
    MABS server that is running in Azure.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Microsoft Azure 备份服务器（MABS）**：MABS 可以在本地或 Azure 中的物理服务器或虚拟服务器上运行。它提供与 DPM
    类似的功能，不同的是，MABS 可以备份到磁带，且不需要系统中心许可证。与 DPM 相似，本地机器只能由本地 MABS 服务器保护，而 Azure 机器只能由在
    Azure 中运行的 MABS 服务器保护。'
- en: Azure Site Recovery
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Azure 站点恢复
- en: Azure Site Recovery can be replicated from Azure VMs and other workloads, such
    as Azure file storage between different Azure regions, as well as on-premises VMs,
    physical (file) servers, and Azure Stack VMs.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 站点恢复可以从 Azure 虚拟机及其他工作负载进行复制，例如不同 Azure 区域之间的 Azure 文件存储，以及本地虚拟机、物理（文件）服务器和
    Azure Stack 虚拟机。
- en: 'Azure Recovery Services offers the following features:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: Azure 恢复服务提供以下功能：
- en: '**Site Recovery service**: Site Recovery makes sure that your VMs, apps, and
    workloads are still running during outages. It replicates the workloads running
    on the machines, both virtual and physical, from a primary to a secondary location.
    You can fail over to a secondary location when an outage occurs at the primary
    site. When the primary location is up again, you can fail back to it.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**站点恢复服务**：站点恢复确保在停机期间你的虚拟机（VM）、应用程序和工作负载仍在运行。它将运行在机器上的工作负载（无论是虚拟的还是物理的）从主站点复制到备用站点。当主站点发生故障时，你可以切换到备用站点。主站点恢复后，你可以再切换回主站点。'
- en: '**Backup service**: This service keeps your data safe by backing it up to Azure.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**备份服务**：此服务通过将数据备份到 Azure 来保障数据安全。'
- en: 'You can also use Azure Site Recovery for migration from on-premises machines
    to Azure VMs. This differs from disaster recovery in the following ways:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以使用 Azure 站点恢复将本地机器迁移到 Azure 虚拟机。这与灾难恢复的不同之处在于：
- en: '**Disaster recovery**: With disaster recovery, machines are replicated regularly.
    In the case of an outage, the machines are failed over from the primary to the
    secondary site in Azure. The machines can then be accessed from the secondary
    site. When the primary site is available again, you fail back from the secondary
    site to the primary again.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**灾难恢复**：在灾难恢复中，机器会定期进行复制。在发生停机时，机器会从主站点切换到 Azure 中的备用站点。然后可以从备用站点访问这些机器。当主站点恢复时，你可以从备用站点切换回主站点。'
- en: '**Migration**: On-premises machines are replicated to Azure, or Azure VMs to
    a secondary region. After that, the VM is failed over from the primary site to
    the secondary site, which completes the migration process without a failback process.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**迁移**：本地机器被复制到 Azure，或将 Azure 虚拟机复制到备用区域。之后，虚拟机会从主站点切换到备用站点，完成迁移过程而无需执行失败回退过程。'
- en: In the next section, we are going to perform a backup and restore operation
    for an Azure file share.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一部分中，我们将执行 Azure 文件共享的备份和恢复操作。
- en: Performing a backup and restore operation
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行备份和恢复操作
- en: In this demonstration, we will be performing a backup and restore operation
    for an Azure file share. We are going to back up the file share that we created
    in this chapter and restore it from a Recovery Services vault.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 在本演示中，我们将为 Azure 文件共享执行备份和恢复操作。我们将备份本章中创建的文件共享，并从恢复服务库中恢复它。
- en: In [Chapter 8](a3544485-da13-4b33-932f-68a4709ba43e.xhtml), *Managing Azure
    VMs and VM Backups*, we are going to set up backup and restore for a virtual machine
    in Azure from the Azure portal. You can refer to this chapter for more information
    about backup and restore.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第 8 章](a3544485-da13-4b33-932f-68a4709ba43e.xhtml)，*管理 Azure 虚拟机和虚拟机备份*，我们将从
    Azure 门户设置 Azure 虚拟机的备份和恢复。你可以参考本章，了解更多关于备份和恢复的信息。
- en: Creating a Recovery Services vault
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 创建恢复服务库
- en: 'We are going to create the Recovery Services vault in Azure. You can create
    this using the Azure portal, PowerShell, and CLI. We are going the create the
    vault using PowerShell. To create this, perform the following steps:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将要在 Azure 中创建恢复服务库。你可以通过 Azure 门户、PowerShell 或 CLI 来创建这个库。我们将使用 PowerShell
    来创建这个库。按照以下步骤来创建它：
- en: 'First, we need to log in to the Azure account as follows:'
  id: totrans-143
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要按照以下步骤登录 Azure 账户：
- en: '[PRE0]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'If necessary, select the right subscription as follows (make sure that you
    use the same subscription here as that you''ve used to create the file share in):'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如有必要，按照以下方式选择正确的订阅（确保此处使用的订阅与创建文件共享时使用的订阅相同）：
- en: '[PRE1]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Create a resource group for the Recovery Services Vault as follows:'
  id: totrans-147
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为恢复服务库创建一个资源组，如下所示：
- en: '[PRE2]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Create a new Recovery Services vault as follows:'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按如下方式创建一个新的恢复服务库：
- en: '[PRE3]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'You can now set the type of redundancy to use for the vault storage as follows:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，你可以按照以下方式设置库存储的冗余类型：
- en: '[PRE4]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: We have now created the Recovery Services vault. In the next part, we are going
    to create a backup policy for the Azure file share.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经创建了恢复服务库。在下一部分，我们将为 Azure 文件共享创建一个备份策略。
- en: Configuring a backup policy
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 配置备份策略
- en: A backup policy specifies the schedule for backups, and how long backup recovery
    points should be kept. It is associated with at least one retention policy, which defines
    how long a recovery point will be kept before it is deleted.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 备份策略指定了备份的时间表，以及备份恢复点应该保存多长时间。它至少与一个保留策略相关联，该策略定义了恢复点在被删除之前将保存多久。
- en: 'In the following example, we are going to create a backup policy in PowerShell,
    which will take a daily backup and will retain for 30 days:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下示例中，我们将通过 PowerShell 创建一个备份策略，它会进行每日备份并保留 30 天：
- en: 'First, we need to store the vault ID in a variable to pass it on creating the
    policy later as follows:'
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要将保管库 ID 存储在一个变量中，以便稍后在创建策略时传递，如下所示：
- en: '[PRE5]'
  id: totrans-158
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Next, we are going to set two variables for storing the schedule and retention
    policies. Then we will create a new backup policy using these values:'
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，我们将设置两个变量，用于存储计划和保留策略。然后我们将使用这些值创建一个新的备份策略：
- en: '[PRE6]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'And lastly, we can enable this policy for the Azure files storage account as
    follows:'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们可以按如下方式为 Azure 文件存储账户启用此策略：
- en: '[PRE7]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We have now created a backup policy to back up our file share that we created
    at the beginning of this chapter. This backup policy will create a daily backup.
    You can also trigger an on-demand backup. For this, leave PowerShell open, because
    we need the Vault ID in to trigger an on-demand job. We will cover this in the
    next section.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经创建了一个备份策略，用于备份本章开始时创建的文件共享。此备份策略将进行每日备份。你还可以触发按需备份。为此，请保持 PowerShell 打开，因为我们需要
    Vault ID 来触发按需任务。我们将在下一个部分讲解这一点。
- en: Trigger an on-demand backup
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 触发按需备份
- en: 'In this demonstration, we are going to trigger an on-demand backup using PowerShell.
    With your PowerShell session still open,  take the following steps:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在本演示中，我们将使用 PowerShell 触发一个按需备份。保持 PowerShell 会话打开，并执行以下步骤：
- en: 'First, we need to retrieve the backup container:'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，我们需要检索备份容器：
- en: '[PRE8]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Then we need to retrieve the backup item from the container:'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 然后我们需要从容器中检索备份项：
- en: '[PRE9]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'At last, we can schedule the job:'
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们可以安排任务：
- en: '[PRE10]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Now that we have created a backup, we can restore it using PowerShell. We will
    do this in the next section.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经创建了备份，可以使用 PowerShell 恢复它。我们将在下一个部分进行操作。
- en: Restore the backup
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 恢复备份
- en: 'To restore the backup that we created in the previous demonstration from PowerShell,
    we have to take the following steps:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 要恢复我们在之前 PowerShell 演示中创建的备份，我们必须采取以下步骤：
- en: 'Generate a list of available recovery points:'
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 生成可用恢复点的列表：
- en: '[PRE11]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'Restore the backup. In this example we are going to restore the backup in the
    original destination. You can also use an alternative destination, like another
    storage account for instance. We first need to set the vault context again before
    we can restore the backup:'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 恢复备份。在这个示例中，我们将在原始目标位置恢复备份。你也可以使用替代目标，比如另一个存储账户。我们首先需要重新设置保管库上下文，然后才能恢复备份：
- en: '[PRE12]'
  id: totrans-178
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Summary
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we covered the third and last part of the *Implementing and
    Managing Storage*objective. We covered the Azure file shares and we covered how
    to install and configure the Azure file share sync service. We also looked at
    backup and restore of our files shared in Azure.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们涵盖了实现和管理存储目标的第三部分和最后一部分。我们介绍了 Azure 文件共享，并且我们讲解了如何安装和配置 Azure 文件共享同步服务。我们还查看了在
    Azure 中共享文件的备份和恢复。
- en: In the next chapter, we will introduce the *Deploying and Managing Virtual Machines* objective
    by covering how to create and configure VMs for Windows and Linux.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍 *部署和管理虚拟机* 目标，讲解如何为 Windows 和 Linux 创建和配置虚拟机。
- en: Questions
  id: totrans-182
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: 'Answer the following questions to test your knowledge of the information in
    this chapter. You can find the answers in the *Assessments* section at the end
    of this book:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 回答以下问题，测试你对本章信息的掌握程度。你可以在本书结尾的 *评估* 部分找到答案：
- en: Can you use Azure Backup to back up Azure file shares?
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以使用 Azure 备份来备份 Azure 文件共享吗？
- en: 'Yes'
  id: totrans-185
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是
- en: 'No'
  id: totrans-186
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 否
- en: Can you use Azure Backup in conjunction with MABS?
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以将 Azure 备份与 MABS 一起使用吗？
- en: 'Yes'
  id: totrans-188
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是
- en: 'No'
  id: totrans-189
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 否
- en: Can you use the Azure file share sync service to mount an Azure file share to
    your local computer?
  id: totrans-190
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以使用 Azure 文件共享同步服务将 Azure 文件共享挂载到本地计算机吗？
- en: 'Yes'
  id: totrans-191
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是
- en: 'No'
  id: totrans-192
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 否
- en: Further reading
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'You can check out the following links for more information about the topics
    that were covered in this chapter:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以查看以下链接，了解更多关于本章中涉及主题的信息：
- en: '*What is Azure Files?*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction](https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction)'
  id: totrans-195
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*什么是 Azure 文件？*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction](https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction)'
- en: '*Planning for an Azure File Sync deployment*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning)'
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Azure 文件同步部署规划*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-planning)'
- en: '*Deploy Azure File Sync*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal)'
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*部署 Azure 文件同步*: [https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal](https://docs.microsoft.com/en-us/azure/storage/files/storage-sync-files-deployment-guide?tabs=azure-portal)'
- en: '*What is Azure Backup?*: [https://docs.microsoft.com/en-us/azure/backup/backup-overview](https://docs.microsoft.com/en-us/azure/backup/backup-overview)'
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*什么是 Azure 备份?*: [https://docs.microsoft.com/en-us/azure/backup/backup-overview](https://docs.microsoft.com/en-us/azure/backup/backup-overview)'
- en: '*Overview of the features in Azure Backup*: [https://docs.microsoft.com/en-us/azure/backup/backup-introduction-to-azure-backup#which-azure-backup-components-should-i-use](https://docs.microsoft.com/en-us/azure/backup/backup-introduction-to-azure-backup#which-azure-backup-components-should-i-use)'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*Azure 备份功能概览*: [https://docs.microsoft.com/en-us/azure/backup/backup-introduction-to-azure-backup#which-azure-backup-components-should-i-use](https://docs.microsoft.com/en-us/azure/backup/backup-introduction-to-azure-backup#which-azure-backup-components-should-i-use)'
- en: '*About Site Recovery*: [https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview](https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview)'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*关于站点恢复*: [https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview](https://docs.microsoft.com/en-us/azure/site-recovery/site-recovery-overview)'
