<html><head></head><body>
<div id="_idContainer036">
<h1 class="chapter-number" id="_idParaDest-157"><a id="_idTextAnchor156"/><span class="koboSpan" id="kobo.1.1">8</span></h1>
<h1 id="_idParaDest-158"><a id="_idTextAnchor157"/><span class="koboSpan" id="kobo.2.1">Deploying Serverless Projects with Terraform</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Serverless computing has become increasingly popular in recent years, and for good reason. </span><span class="koboSpan" id="kobo.3.2">With AWS Lambda and AWS Fargate, you can develop and deploy your applications without the need to manage servers or infrastructure. </span><span class="koboSpan" id="kobo.3.3">Terraform makes it easy to design, deploy, and manage your serverless infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">on AWS.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this chapter, we will explore the concepts of AWS landing zones and foundations, and how they can help you set up and manage your AWS accounts and infrastructure. </span><span class="koboSpan" id="kobo.5.2">We will cover the different options available for implementing landing zones and how to select the best design for your needs. </span><span class="koboSpan" id="kobo.5.3">Additionally, we will explore the use of AWS Organizations with Terraform to manage your </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">AWS infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">Next, we will dive into the world of serverless computing, exploring what it is and when to use it. </span><span class="koboSpan" id="kobo.7.2">We will cover AWS Lambda and AWS Fargate, and how to use them to build and deploy your applications. </span><span class="koboSpan" id="kobo.7.3">We will also explore different deployment patterns and how to use Terraform to design and deploy your </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">serverless infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">By the end of this chapter, you will have a solid understanding of AWS landing zones and foundations, as well as how to design and deploy serverless infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">using Terraform.</span></span></p>
<h1 id="_idParaDest-159"><a id="_idTextAnchor158"/><span class="koboSpan" id="kobo.11.1">What are landing zones and why do we need them?</span></h1>
<p><span class="koboSpan" id="kobo.12.1">A landing zone is a reference</span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.13.1"> architecture for a multi-account AWS environment. </span><span class="koboSpan" id="kobo.13.2">It provides a set of foundational resources and best practices that you can use as a starting point for </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">your infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">A landing zone typically includes the </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">following components:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.17.1">A core account</span></strong><span class="koboSpan" id="kobo.18.1">: This is the primary account that contains the shared resources for</span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.19.1"> the environment, such </span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.20.1">as the landing zone itself </span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.21.1">and the </span><strong class="bold"><span class="koboSpan" id="kobo.22.1">Identity and Access Management</span></strong><span class="koboSpan" id="kobo.23.1"> (</span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.24.1">IAM</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">) resources.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.26.1">One or more member accounts</span></strong><span class="koboSpan" id="kobo.27.1">: These</span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.28.1"> are the accounts that contain the resources for your applications and workloads. </span><span class="koboSpan" id="kobo.28.2">The member accounts are linked to the core account and inherit the shared resources and policies from the </span><span class="No-Break"><span class="koboSpan" id="kobo.29.1">core account.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.30.1">A networking layer</span></strong><span class="koboSpan" id="kobo.31.1">: This includes the </span><strong class="bold"><span class="koboSpan" id="kobo.32.1">Virtual Private Clouds</span></strong><span class="koboSpan" id="kobo.33.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.34.1">VPCs</span></strong><span class="koboSpan" id="kobo.35.1">) and other networking</span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.36.1"> resources that </span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.37.1">are shared across</span><a id="_idIndexMarker383"/> <span class="No-Break"><span class="koboSpan" id="kobo.38.1">the accounts.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.39.1">A security layer</span></strong><span class="koboSpan" id="kobo.40.1">: This includes the IAM </span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.41.1">policies and other security resources that are shared across </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">the accounts.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.43.1">A governance layer</span></strong><span class="koboSpan" id="kobo.44.1">: This includes</span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.45.1"> the policies and controls that are used to enforce compliance and manage </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">the environment.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.47.1">A landing zone can help you manage a multi-account environment more effectively and efficiently by providing a consistent set of resources and practices across all accounts. </span><span class="koboSpan" id="kobo.47.2">It can also help you onboard new accounts and applications more quickly by providing a standard framework </span><span class="No-Break"><span class="koboSpan" id="kobo.48.1">to follow.</span></span></p>
<p><span class="koboSpan" id="kobo.49.1">There are several reasons why you</span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.50.1"> might want to use a landing zone in your </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">AWS environment:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.52.1">Improved security and compliance</span></strong><span class="koboSpan" id="kobo.53.1">: A landing zone provides a set of shared security and compliance resources, such as IAM policies and network controls, that are applied consistently across all accounts. </span><span class="koboSpan" id="kobo.53.2">This can help you improve the security and compliance of your environment by enforcing best practices and reducing the risk </span><span class="No-Break"><span class="koboSpan" id="kobo.54.1">of misconfigurations.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.55.1">Improved efficiency and automation</span></strong><span class="koboSpan" id="kobo.56.1">: A landing zone can help you automate the setup and management of your multi-account environment by providing a standard set of resources and practices to follow. </span><span class="koboSpan" id="kobo.56.2">This can save you time and effort and reduce </span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.57.1">the risk </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">of errors.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.59.1">Improved scalability and flexibility</span></strong><span class="koboSpan" id="kobo.60.1">: A landing zone can help you scale your environment more easily by providing a flexible, modular architecture that can accommodate new accounts and applications </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">as needed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.62.1">Improved governance and control</span></strong><span class="koboSpan" id="kobo.63.1">: A landing zone can help you enforce governance and control over your environment by providing a central location for managing shared resources </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">and policies.</span></span></li>
</ul>
<h2 id="_idParaDest-160"><a id="_idTextAnchor159"/><span class="koboSpan" id="kobo.65.1">AWS Foundations</span></h2>
<p><span class="koboSpan" id="kobo.66.1">AWS Foundations is a set of best practices and recommended configurations for building and managing infrastructure </span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.67.1">on AWS. </span><span class="koboSpan" id="kobo.67.2">It provides guidance on how to set up your AWS accounts, networking, security, and governance in a way that is scalable, secure, </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">and compliant.</span></span></p>
<p><span class="koboSpan" id="kobo.69.1">AWS Foundations includes recommendations for the </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">following areas:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.71.1">Account structure</span></strong><span class="koboSpan" id="kobo.72.1">: This includes </span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.73.1">guidance on how to set up and organize your AWS accounts and how to use AWS Organizations to </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">manage them</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.75.1">Networking</span></strong><span class="koboSpan" id="kobo.76.1">: This includes guidance on how to set up your VPCs, subnets, and routing to create a scalable and secure </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">network architecture</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.78.1">Security</span></strong><span class="koboSpan" id="kobo.79.1">: This includes guidance on how to secure your AWS resources using IAM, encryption, and other </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">security controls</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.81.1">Governance</span></strong><span class="koboSpan" id="kobo.82.1">: This includes guidance on how to enforce compliance and manage your AWS environment using policies, controls, </span><span class="No-Break"><span class="koboSpan" id="kobo.83.1">and monitoring</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.84.1">AWS Foundations is intended to provide a set of best practices and recommendations that you can use as a starting point for building and managing your infrastructure on AWS. </span><span class="koboSpan" id="kobo.84.2">It is not a one-size-fits-all solution, and you may need to tailor the recommendations to fit the specific needs of </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">your organization.</span></span></p>
<p><span class="koboSpan" id="kobo.86.1">AWS Foundations is </span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.87.1">not a product or a service offered by AWS, but rather a set of guidelines and recommendations that you can use to build your infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">on AWS.</span></span></p>
<p><span class="koboSpan" id="kobo.89.1">AWS Foundations includes recommendations for setting up and organizing your AWS accounts, creating a scalable and secure networking architecture, securing your AWS resources, and enforcing compliance and governance in </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">your environment.</span></span></p>
<p><span class="koboSpan" id="kobo.91.1">AWS Foundations is intended to be a living document that is regularly updated with new best practices and recommendations as they </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">become available.</span></span></p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor160"/><span class="koboSpan" id="kobo.93.1">How to build landing zones with Terraform in AWS</span></h2>
<p><span class="koboSpan" id="kobo.94.1">AWS Control Tower </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.95.1">Account Factory is a feature of AWS Control Tower that allows you to automate the creation of member accounts in your multi-account AWS environment. </span><span class="koboSpan" id="kobo.95.2">With Account Factory, you can use Terraform templates to define the resources and configuration for your member accounts and then use the AWS Control Tower API to create the accounts and provision the </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">resources automatically.</span></span></p>
<p><span class="koboSpan" id="kobo.97.1">Here are some key features of AWS Control Tower </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">Account Factory:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.99.1">Automated account creation</span></strong><span class="koboSpan" id="kobo.100.1">: With Account Factory, you can use Terraform templates to define the resources and configuration for your member accounts and then use the AWS</span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.101.1"> Control Tower API to create the accounts and provision the </span><span class="No-Break"><span class="koboSpan" id="kobo.102.1">resources automatically.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.103.1">Standardized account setup</span></strong><span class="koboSpan" id="kobo.104.1">: Account Factory allows you to enforce a standard set of resources and configuration for your member accounts, helping you ensure consistency and compliance across </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">your environment.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.106.1">Customization options</span></strong><span class="koboSpan" id="kobo.107.1">: You can use variables in your Terraform templates to customize the resources and configuration for your member accounts. </span><span class="koboSpan" id="kobo.107.2">This allows you to create accounts that are tailored to the specific needs of </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">your organization.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.109.1">Integration with AWS Control Tower</span></strong><span class="koboSpan" id="kobo.110.1">: Account Factory is integrated with AWS Control Tower, allowing you to use the AWS Control Tower dashboard to monitor and manage </span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.111.1">your </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">member accounts.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.113.1">There is an informative tutorial from Terraform on how to utilize Account Factory for Terraform (</span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">AFT): </span></span><a href="https://developer.hashicorp.com/terraform/tutorials/aws/aws-control-tower-aft"><span class="No-Break"><span class="koboSpan" id="kobo.115.1">https://developer.hashicorp.com/terraform/tutorials/aws/aws-control-tower-aft</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.116.1">.</span></span></p>
<h1 id="_idParaDest-162"><a id="_idTextAnchor161"/><span class="koboSpan" id="kobo.117.1">What is serverless?</span></h1>
<p><span class="koboSpan" id="kobo.118.1">Serverless computing is a cloud computing execution model that allows the cloud provider to dynamically allocate</span><a id="_idIndexMarker394"/><span class="koboSpan" id="kobo.119.1"> resources to run the user’s code, with the user only paying for the resources consumed. </span><span class="koboSpan" id="kobo.119.2">This model frees the user from the hassle of provisioning, scaling, and maintaining the </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">underlying infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.121.1">In a serverless model, the user creates and deploys code in the form of functions, which are executed in response to events or invocations. </span><span class="koboSpan" id="kobo.121.2">The cloud provider automatically allocates the necessary resources to run the function, and the user only pays for the actual execution of </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">the function.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">Serverless computing can provide several benefits, including reduced operational overhead, scalability, and cost-efficiency. </span><span class="koboSpan" id="kobo.123.2">It is particularly well suited for applications that have intermittent or unpredictable workloads, as the user only pays for the resources used to run </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">the code.</span></span></p>
<p><span class="koboSpan" id="kobo.125.1">AWS offers several serverless computing services, including AWS Lambda, which allows you to run code in response to events or invocations, and AWS Fargate, which allows you to run containerized applications in a </span><span class="No-Break"><span class="koboSpan" id="kobo.126.1">serverless environment.</span></span></p>
<h1 id="_idParaDest-163"><a id="_idTextAnchor162"/><span class="koboSpan" id="kobo.127.1">What are AWS serverless patterns?</span></h1>
<p><span class="koboSpan" id="kobo.128.1">AWS serverless patterns </span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.129.1">are templates for common ways to build and deploy applications using serverless technologies on </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Amazon Web Services</span></strong><span class="koboSpan" id="kobo.131.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.132.1">AWS</span></strong><span class="koboSpan" id="kobo.133.1">). </span><span class="koboSpan" id="kobo.133.2">These patterns provide guidance on how to design and architect your applications to take advantage of the benefits of </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">serverless computing.</span></span></p>
<p><span class="koboSpan" id="kobo.135.1">There are many different serverless patterns that you can use, depending on the requirements of your application. </span><span class="koboSpan" id="kobo.135.2">Some common serverless patterns include </span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.137.1">Event-driven architecture</span></strong><span class="koboSpan" id="kobo.138.1">: This</span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.139.1"> pattern involves building applications that respond to events, such as a user uploading a file or a sensor </span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">sending data</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.141.1">Microservices</span></strong><span class="koboSpan" id="kobo.142.1">: This pattern</span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.143.1"> involves breaking up a large application into smaller, independent services that can be developed, deployed, and </span><span class="No-Break"><span class="koboSpan" id="kobo.144.1">scaled independently</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.145.1">Data processing</span></strong><span class="koboSpan" id="kobo.146.1">: This pattern</span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.147.1"> involves using serverless technologies to process large amounts of data, such as converting data from one format to another or aggregating data from </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">multiple sources</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.149.1">Web applications</span></strong><span class="koboSpan" id="kobo.150.1">: This pattern</span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.151.1"> involves using serverless technologies to build and deploy web applications, such as static websites or dynamic </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">web applications</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.153.1">These are just a few examples of the types of serverless patterns that are available. </span><span class="koboSpan" id="kobo.153.2">There are many other patterns that you can use to build and deploy your applications </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">on AWS.</span></span></p>
<p><span class="koboSpan" id="kobo.155.1">AWS serverless resources are resources that are used to build and deploy applications using serverless technologies on AWS. </span><span class="koboSpan" id="kobo.155.2">These resources can include a variety of different services and tools, such as </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.157.1">AWS Lambda</span></strong><span class="koboSpan" id="kobo.158.1">: A service</span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.159.1"> that lets you run code without provisioning or </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">managing servers</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.161.1">Amazon API Gateway</span></strong><span class="koboSpan" id="kobo.162.1">: A service</span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.163.1"> that makes it easy to create, publish, maintain, monitor, and </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">secure APIs</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.165.1">AWS Fargate</span></strong><span class="koboSpan" id="kobo.166.1">: A service that lets you</span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.167.1"> run containers without having to manage the underlying </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">EC2 instances</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.169.1">AWS Step Functions</span></strong><span class="koboSpan" id="kobo.170.1">: A service that makes it easy to coordinate the functions of distributed applications </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">and </span></span><span class="No-Break"><a id="_idIndexMarker403"/></span><span class="No-Break"><span class="koboSpan" id="kobo.172.1">microservices</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.173.1">AWS App Runner</span></strong><span class="koboSpan" id="kobo.174.1">: A service </span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.175.1">that makes it easy to build and deploy </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">containerized applications</span></span></li>
</ul>
<h1 id="_idParaDest-164"><a id="_idTextAnchor163"/><span class="koboSpan" id="kobo.177.1">What is AWS Lambda?</span></h1>
<p><span class="koboSpan" id="kobo.178.1">AWS Lambda is a fully managed serverless </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.179.1">compute service that allows you to execute your code in response to various events, such as changes to data in an Amazon S3 bucket or a new item being added to a DynamoDB table. </span><span class="koboSpan" id="kobo.179.2">It automatically manages the underlying compute resources for you, so you don’t need to worry about provisioning or maintaining any servers. </span><span class="koboSpan" id="kobo.179.3">This enables you to focus on writing and deploying your code, without any </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">administrative overhead.</span></span></p>
<p><span class="koboSpan" id="kobo.181.1">Some common use cases for </span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.182.1">AWS Lambda include </span><span class="No-Break"><span class="koboSpan" id="kobo.183.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.184.1">Running backend logic for web and </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">mobile applications</span></span></li>
<li><span class="koboSpan" id="kobo.186.1">Processing data streams and </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">event triggers</span></span></li>
<li><span class="koboSpan" id="kobo.188.1">Automating maintenance and </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">administration tasks</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.190.1">In Lambda, you write your code and then upload it to the service. </span><span class="koboSpan" id="kobo.190.2">When an event occurs that triggers your code, Lambda executes it and automatically scales the underlying infrastructure to run your code. </span><span class="koboSpan" id="kobo.190.3">You only pay for the compute time that you consume, so you can run your code without having to worry about managing servers </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">or infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.192.1">AWS Lambda supports a variety of programming languages, including Node.js, Python, Java, C#, and Go, and you can use it in conjunction with other AWS services to build powerful and </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">scalable applications.</span></span></p>
<p><span class="koboSpan" id="kobo.194.1">Let’s look at some </span><span class="No-Break"><span class="koboSpan" id="kobo.195.1">key features:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.196.1">Lambda functions</span></strong><span class="koboSpan" id="kobo.197.1">: In Lambda, you </span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.198.1">create functions that contain your code. </span><span class="koboSpan" id="kobo.198.2">These functions are triggered by events, such as a user uploading a file to Amazon S3 or a request to an API Gateway endpoint. </span><span class="koboSpan" id="kobo.198.3">You can specify the events that trigger your functions, and Lambda automatically executes the function when these </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">events occur.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.200.1">Execution environment</span></strong><span class="koboSpan" id="kobo.201.1">: AWS Lambda provides a fully managed execution environment for your functions. </span><span class="koboSpan" id="kobo.201.2">This includes the infrastructure and operating system, as well as the language </span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.202.1">runtime (e.g., Node.js, Python, Java, etc.). </span><span class="koboSpan" id="kobo.202.2">When you create a function, you can specify the runtime and the amount of memory that you want to allocate to </span><span class="No-Break"><span class="koboSpan" id="kobo.203.1">your function.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.204.1">Scaling</span></strong><span class="koboSpan" id="kobo.205.1">: One of the benefits of using AWS Lambda is that it automatically scales to meet the needs of your application. </span><span class="koboSpan" id="kobo.205.2">When your function is invoked, Lambda allocates the necessary compute resources to run your code. </span><span class="koboSpan" id="kobo.205.3">If your function is invoked more frequently, Lambda automatically scales up to meet the </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">increased demand.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.207.1">Integrations</span></strong><span class="koboSpan" id="kobo.208.1">: AWS Lambda integrates with a wide variety of other AWS services, allowing you to build powerful and scalable applications. </span><span class="koboSpan" id="kobo.208.2">For example, you can use Lambda with Amazon S3 to automatically process files as they are uploaded to the bucket, or with Amazon DynamoDB to automatically update records in the database as they are added </span><span class="No-Break"><span class="koboSpan" id="kobo.209.1">or modified.</span></span></li>
</ul>
<h1 id="_idParaDest-165"><a id="_idTextAnchor164"/><span class="koboSpan" id="kobo.210.1">What is AWS Fargate?</span></h1>
<p><span class="koboSpan" id="kobo.211.1">AWS Fargate is a fully managed service that makes it easier to run containerized applications on AWS. </span><span class="koboSpan" id="kobo.211.2">AWS Fargate removes the need to manage the underlying infrastructure, so you can focus on building and running </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">your applications.</span></span></p>
<p><span class="koboSpan" id="kobo.213.1">With AWS Fargate, you simply </span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.214.1">specify the number and type of resources that you want to allocate to your applications, and AWS Fargate takes care of the rest. </span><span class="koboSpan" id="kobo.214.2">It automatically allocates the necessary compute resources, such as Amazon </span><strong class="bold"><span class="koboSpan" id="kobo.215.1">Elastic Compute Cloud</span></strong><span class="koboSpan" id="kobo.216.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.217.1">EC2</span></strong><span class="koboSpan" id="kobo.218.1">) instances, and </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.219.1">ensures that your containers are running in a highly available and </span><span class="No-Break"><span class="koboSpan" id="kobo.220.1">scalable manner.</span></span></p>
<p><span class="koboSpan" id="kobo.221.1">AWS Fargate is a good choice for developers who want to run containerized applications on AWS without the overhead of managing the underlying infrastructure. </span><span class="koboSpan" id="kobo.221.2">It is especially well suited for applications that require rapid scaling or that have unpredictable workloads, as AWS Fargate can automatically scale your resources up or down </span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">as needed.</span></span></p>
<p><span class="koboSpan" id="kobo.223.1">AWS Fargate is a fully managed service, which means that AWS takes care of the underlying infrastructure for you. </span><span class="koboSpan" id="kobo.223.2">This includes provisioning and managing the EC2 instances that run your tasks, as well as handling any infrastructure maintenance </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">or patching.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">AWS Fargate is available in all regions where Amazon ECS is available, and you can use it to run tasks on </span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.226.1">both Amazon ECS and Amazon </span><strong class="bold"><span class="koboSpan" id="kobo.227.1">Elastic Kubernetes </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.228.1">Service</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.229.1"> (</span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.230.1">EKS</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.232.1">AWS Fargate supports all of the same features as Amazon ECS, including the ability to use Amazon ECS task</span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.233.1"> definitions to define your tasks, integration with other AWS services such as Amazon CloudWatch and AWS IAM, and support for </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">Docker containers.</span></span></p>
<p><span class="koboSpan" id="kobo.235.1">AWS Fargate is well suited for use cases where you want to run containers but don’t want to worry about the underlying infrastructure. </span><span class="koboSpan" id="kobo.235.2">It can be a good choice for developers who want to focus on building and deploying applications rather than managing infrastructure, or for organizations that want to run containerized applications but don’t have the in-house expertise to manage the </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">underlying infrastructure.</span></span></p>
<p><span class="koboSpan" id="kobo.237.1">You can use AWS</span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.238.1"> Fargate with Amazon </span><strong class="bold"><span class="koboSpan" id="kobo.239.1">Elastic Container Service</span></strong><span class="koboSpan" id="kobo.240.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.241.1">ECS</span></strong><span class="koboSpan" id="kobo.242.1">) or Amazon EKS to run your containerized applications. </span><span class="koboSpan" id="kobo.242.2">It is also integrated with other AWS services, such as Amazon CloudWatch and AWS IAM, which you can use to monitor and secure </span><span class="No-Break"><span class="koboSpan" id="kobo.243.1">your applications.</span></span></p>
<h1 id="_idParaDest-166"><a id="_idTextAnchor165"/><span class="koboSpan" id="kobo.244.1">How to design a serverless infrastructure with Terraform</span></h1>
<p><span class="koboSpan" id="kobo.245.1">Here are general steps you can follow to design a serverless infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.246.1">using Terraform:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.247.1">Identify the components </span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.248.1">of your infrastructure that can be implemented as serverless resources. </span><span class="koboSpan" id="kobo.248.2">This might include things such as APIs, backend workers, and data </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">processing pipelines.</span></span></li>
<li><span class="koboSpan" id="kobo.250.1">Determine which serverless platforms and services you will use to implement these components. </span><span class="koboSpan" id="kobo.250.2">This might include services such as AWS Lambda, Amazon API Gateway, and Amazon DynamoDB, or managed services such as AWS Fargate or </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">AWS AppSync.</span></span></li>
<li><span class="koboSpan" id="kobo.252.1">Define the required IAM roles and permissions for your serverless resources. </span><span class="koboSpan" id="kobo.252.2">This will typically involve creating IAM policies and attaching them to IAM roles that your resources </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">can assume.</span></span></li>
<li><span class="koboSpan" id="kobo.254.1">Use Terraform to </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.255.1">create the necessary infrastructure resources, such as VPCs, security groups, and subnets. </span><span class="koboSpan" id="kobo.255.2">You can also use Terraform to create and configure the serverless </span><span class="No-Break"><span class="koboSpan" id="kobo.256.1">resources themselves.</span></span></li>
<li><span class="koboSpan" id="kobo.257.1">Define any dependencies between your resources using Terraform’s dependencies syntax. </span><span class="koboSpan" id="kobo.257.2">This will ensure that resources are created in the correct order and that any necessary connections are established </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">between them.</span></span></li>
<li><span class="koboSpan" id="kobo.259.1">Use Terraform’s testing and validation features to ensure that your infrastructure is configured correctly and adheres to best practices. </span><span class="koboSpan" id="kobo.259.2">This might include things such as running </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">terraform plan</span></strong><span class="koboSpan" id="kobo.261.1"> to preview changes, or running </span><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">terraform validate</span></strong><span class="koboSpan" id="kobo.263.1"> to check for </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">syntax errors.</span></span></li>
<li><span class="koboSpan" id="kobo.265.1">Use Terraform’s version control integration to manage changes to your infrastructure over time. </span><span class="koboSpan" id="kobo.265.2">This will allow you to track changes, roll back to previous versions if necessary, and collaborate with other </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">team members.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.267.1">Moreover, here are some additional points to consider for designing the </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">serverless infrastructure:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.269.1">Decide on a deployment strategy that works for your organization. </span><span class="koboSpan" id="kobo.269.2">This might include using Terraform’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">apply</span></strong><span class="koboSpan" id="kobo.271.1"> command to </span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.272.1">deploy changes directly or using a </span><strong class="bold"><span class="koboSpan" id="kobo.273.1">continuous integration/continuous deployment</span></strong><span class="koboSpan" id="kobo.274.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.275.1">CI/CD</span></strong><span class="koboSpan" id="kobo.276.1">) platform such as AWS CodePipeline to automate the </span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">deployment process.</span></span></li>
<li><span class="koboSpan" id="kobo.278.1">Consider the scalability and availability requirements of your serverless resources. </span><span class="koboSpan" id="kobo.278.2">You can use Terraform to specify things like the number of replicas for an Amazon ECS service, or the number of function instances for an AWS </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">Lambda function.</span></span></li>
<li><span class="koboSpan" id="kobo.280.1">Use Terraform’s output values to expose important information about your infrastructure to other tools and processes. </span><span class="koboSpan" id="kobo.280.2">For example, you might output the URL of an API </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.281.1">Gateway endpoint so that it can be used by other parts of </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">your infrastructure.</span></span></li>
<li><span class="koboSpan" id="kobo.283.1">Use Terraform’s workspaces feature to manage multiple environments, such as production, staging, and development. </span><span class="koboSpan" id="kobo.283.2">This will allow you to easily switch between environments and apply changes to the </span><span class="No-Break"><span class="koboSpan" id="kobo.284.1">appropriate environment.</span></span></li>
<li><span class="koboSpan" id="kobo.285.1">Consider using Terraform modules to encapsulate reusable pieces of infrastructure. </span><span class="koboSpan" id="kobo.285.2">This can help you reduce duplication and make it easier to manage and maintain your infrastructure </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">over time.</span></span></li>
</ul>
<h1 id="_idParaDest-167"><a id="_idTextAnchor166"/><span class="koboSpan" id="kobo.287.1">How to develop a serverless infrastructure</span></h1>
<p><span class="koboSpan" id="kobo.288.1">To develop a serverless</span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.289.1"> infrastructure, you can follow these </span><span class="No-Break"><span class="koboSpan" id="kobo.290.1">general steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.291.1">Identify the components of your infrastructure that can be implemented as serverless resources. </span><span class="koboSpan" id="kobo.291.2">This might include things such as APIs, backend workers, and data </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">processing pipelines.</span></span></li>
<li><span class="koboSpan" id="kobo.293.1">Determine which serverless platforms and services you will use to implement these components. </span><span class="koboSpan" id="kobo.293.2">This might include services such as AWS Lambda, Amazon API Gateway, and Amazon DynamoDB, or managed services such as AWS Fargate or </span><span class="No-Break"><span class="koboSpan" id="kobo.294.1">AWS AppSync.</span></span></li>
<li><span class="koboSpan" id="kobo.295.1">Define the required IAM roles and permissions for your serverless resources. </span><span class="koboSpan" id="kobo.295.2">This will typically involve creating IAM policies and attaching them to IAM roles that your resources </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">can assume.</span></span></li>
<li><span class="koboSpan" id="kobo.297.1">Use the relevant tools and APIs to create and configure your serverless resources. </span><span class="koboSpan" id="kobo.297.2">This might include using the AWS Management Console, the AWS CLI, or the </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">AWS SDKs.</span></span></li>
<li><span class="koboSpan" id="kobo.299.1">Define any dependencies between your resources, such as connections between an API Gateway and a Lambda function, or between a Lambda function and a </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">DynamoDB table.</span></span></li>
<li><span class="koboSpan" id="kobo.301.1">Test your infrastructure to confirm that everything is working </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">as expected.</span></span></li>
<li><span class="koboSpan" id="kobo.303.1">Use monitoring and logging tools to track the performance and health of your serverless resources. </span><span class="koboSpan" id="kobo.303.2">This</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.304.1"> might include using Amazon CloudWatch to monitor resource metrics and logs or using AWS X-Ray to trace requests as they flow through </span><span class="No-Break"><span class="koboSpan" id="kobo.305.1">your infrastructure.</span></span></li>
</ol>
<h1 id="_idParaDest-168"><a id="_idTextAnchor167"/><span class="koboSpan" id="kobo.306.1">How to deploy a serverless infrastructure using Terraform</span></h1>
<p><span class="koboSpan" id="kobo.307.1">To deploy a serverless infrastructure </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.308.1">using Terraform, you can follow </span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.310.1">Write Terraform configuration files to define the desired state of your infrastructure. </span><span class="koboSpan" id="kobo.310.2">These configuration files</span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.311.1"> can use the </span><strong class="bold"><span class="koboSpan" id="kobo.312.1">HashiCorp Configuration Language</span></strong><span class="koboSpan" id="kobo.313.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.314.1">HCL</span></strong><span class="koboSpan" id="kobo.315.1">) to specify the resources that you want to create, as well as the properties of </span><span class="No-Break"><span class="koboSpan" id="kobo.316.1">those resources.</span></span></li>
<li><span class="koboSpan" id="kobo.317.1">If you are following an event-driven architecture, you should consider carving all triggers and resources into the same </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">Terraform project.</span></span></li>
<li><span class="koboSpan" id="kobo.319.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">terraform init</span></strong><span class="koboSpan" id="kobo.321.1"> command to initialize your working directory and download any necessary plugins </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">or dependencies.</span></span></li>
<li><span class="koboSpan" id="kobo.323.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">terraform plan</span></strong><span class="koboSpan" id="kobo.325.1"> command to preview the changes that Terraform will make to your infrastructure. </span><span class="koboSpan" id="kobo.325.2">This will allow you to see what resources will be created, modified, or destroyed, and to confirm that the changes are what </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">you expect.</span></span></li>
<li><span class="koboSpan" id="kobo.327.1">Use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">terraform apply</span></strong><span class="koboSpan" id="kobo.329.1"> command to apply the changes to your infrastructure. </span><span class="koboSpan" id="kobo.329.2">This will create or update the resources according to your </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">configuration files.</span></span></li>
<li><span class="koboSpan" id="kobo.331.1">Test your infrastructure to confirm that everything is working </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">as expected.</span></span></li>
<li><span class="koboSpan" id="kobo.333.1">Use Terraform’s version control integration to manage changes to your infrastructure over time. </span><span class="koboSpan" id="kobo.333.2">This will allow you to track changes, roll back to previous versions if necessary, and collaborate with other </span><span class="No-Break"><span class="koboSpan" id="kobo.334.1">team members.</span></span></li>
<li><span class="koboSpan" id="kobo.335.1">Create a separate</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.336.1"> S3 bucket with relevant permissions to move your Terraform state file to secure and make it easy for collaboration with other </span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">team members.</span></span></li>
<li><span class="koboSpan" id="kobo.338.1">Consider creating a pipeline in your CI/CD system to execute your Terraform templates for security </span><span class="No-Break"><span class="koboSpan" id="kobo.339.1">and observability.</span></span></li>
<li><span class="koboSpan" id="kobo.340.1">Avoid provisioning manual resources; utilize Terraform to cover all your resources, configurations, and environments. </span><span class="koboSpan" id="kobo.340.2">Any existing or legacy resources can easily be imported </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">to Terraform.</span></span></li>
</ol>
<h1 id="_idParaDest-169"><a id="_idTextAnchor168"/><span class="koboSpan" id="kobo.342.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.343.1">In this chapter, we learned about deploying serverless projects with Terraform. </span><span class="koboSpan" id="kobo.343.2">We covered the basics of serverless computing, AWS Lambda, and AWS Fargate, and how to design and deploy serverless infrastructure with Terraform. </span><span class="koboSpan" id="kobo.343.3">We also explored the importance of AWS landing zones and how to select and implement them. </span><span class="koboSpan" id="kobo.343.4">Additionally, we discussed AWS Organizations and how to use them </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">with Terraform.</span></span></p>
<p><span class="koboSpan" id="kobo.345.1">In the next chapter, we will explore deploying containers in AWS with Terraform. </span><span class="koboSpan" id="kobo.345.2">We will cover the basics of containers, AWS ECS, Amazon EKS, and how to deploy containers with Terraform. </span><span class="koboSpan" id="kobo.345.3">We will also discuss best practices for deploying containers in AWS and how to use Terraform to manage </span><span class="No-Break"><span class="koboSpan" id="kobo.346.1">container deployments.</span></span></p>
</div>
</body></html>