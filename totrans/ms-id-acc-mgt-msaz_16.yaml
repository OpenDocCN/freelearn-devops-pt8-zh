- en: Identifying and Detecting Sensitive Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Identifying and detecting sensitive data is a very important process inside
    an information-protection solution. You need to be able to identify sensitive
    information within your environment using suitable matching criteria to provide
    the related results for appropriate classification and protection controls. This
    is quite important to give the right access to the right person and to improve
    your security standards. Microsoft has invested in this field and provides different
    solutions that work natively together. The solutions provide capabilities for
    data in motion, in transit, and at rest. In this chapter, we''ll give a practical
    overview of the needed information that can be used for your organization or customers:'
  prefs: []
  type: TYPE_NORMAL
- en: Extending your lab environment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understanding and using AIP capabilities for data in motion
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understanding and using AIP capabilities for data at rest
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the first part of the chapter, we will extend your lab environment.
  prefs: []
  type: TYPE_NORMAL
- en: Extending your lab environment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First, we need to extend your lab environment to test the different features
    and give you the chance to extend the scenarios as you work through the different
    chapters in this book.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will add two Windows 10 test clients and the **YD1INF01** server. Use the
    following diagram to get the correct sizing, and the virtual machine configuration
    and domain membership for the virtual machines:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f52502be-d472-4869-8814-fd0d262128b3.png)'
  prefs: []
  type: TYPE_IMG
- en: Lab environment overview
  prefs: []
  type: TYPE_NORMAL
- en: 'The Windows 10 clients need to be joined to **YOURDOMAIN1.COM** and you need
    to copy the example data files from the code package to any directory on the two
    clients:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the **Domain Users** in the local **Administrator** group to provide easy
    access to the virtual machines:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7a38b462-53fb-4330-86bf-27dfffb7ef09.png)'
  prefs: []
  type: TYPE_IMG
- en: User access to VM
  prefs: []
  type: TYPE_NORMAL
- en: 'To use single-sign-on, add `*.yourdomain1.com` to your Local intranet zone
    in your Internet Explorer configuration:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/256d07bf-1056-43a1-bb91-fdc9c14d103f.png)'
  prefs: []
  type: TYPE_IMG
- en: IE Local Intranet zone configuration
  prefs: []
  type: TYPE_NORMAL
- en: Install **Office Suite** and the **Azure Information Protection** client on
    both virtual machines.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Open [https://portal.office.com](https://portal.office.com) with your **Office
    365 licensed admin user**:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1c9bcdae-f297-48b3-a91c-8c5fc32d6e1d.png)'
  prefs: []
  type: TYPE_IMG
- en: Installing the 64-bit version of Office
  prefs: []
  type: TYPE_NORMAL
- en: Install the 64-bit Version of Office on the client.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Download and install the Azure Information Protection client on the client.
    You will find the installer under [https://aka.ms/aipclient.](https://aka.ms/aipclient)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the `AzInfoProtection_PREVIEW_1.45.32.0.exe` binary and install it without
    a demo policy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Additionally, we will install a SharePoint single farm on the **YD1INF01**
    server for testing the discovery capabilities on-premises:'
  prefs: []
  type: TYPE_NORMAL
- en: Visit [https://bit.ly/2QFfBZ0](https://bit.ly/2QFfBZ0) to install SharePoint.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The expected result is that we have a demo SharePoint infrastructure with a
    simple Documents library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/079388bc-3588-4c82-8516-cb4ca0064611.png)'
  prefs: []
  type: TYPE_IMG
- en: SharePoint library for test files
  prefs: []
  type: TYPE_NORMAL
- en: 'We configure an example file structure on the **YD1INF01** server to discover
    sensitive data on traditional file server solutions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: We'll copy data during the relevant configuration steps in the *Understanding
    and using AIP capabilities for data in motion* section. After completing the extension
    of your lab environment, let's identify and detect data in motion.
  prefs: []
  type: TYPE_NORMAL
- en: Understanding and using AIP capabilities for data in motion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The meaning of data in motion or transit is that information is actively moving
    from one location to another inside your environment or outside through the internet.
    Typically, the process starts with the creation of a document, presentation, or
    spreadsheet, or the export of information from a source, such as the HR, CRM,
    or another system. The best option is to include the classification and protection
    process directly in these processes. Otherwise, you need to be able to detect
    and identify sensitive data from scratch on client computers and servers. Another
    important thing is that you know where your sensitive, protected, or not-protected
    information is exchanged and stored. Let''s say you need a solution that''s able
    to monitor the sensitive data on client computers, on-premises, and in the cloud.
    Microsoft follows this strategy and provides the following technologies to fulfill
    these requirements to actively monitor sensitive data in motion:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Azure Information Protection**: Classification and protection monitoring
    including document tracking.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows Defender ATP**: Monitoring classification and protection activities
    on client computers.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cloud App Security**: Active monitoring of your enabled cloud ecosystem,
    including data-leakage prevention, classification, and protection capabilities.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Office 365**: Monitoring, data-leakage prevention, classification, and protection
    capabilities inside the Office 365 services.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's dive a bit deeper into the different functionalities of these technologies.
  prefs: []
  type: TYPE_NORMAL
- en: Scenario 1 – Usage of Azure Information Protection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Azure Information Protection client offers you the capability to classify
    and protect information in several formats. In our example, we''ll use a manual
    classification that also applies protection to the document. We use the `Q3_Product_Strategy.docx` document
    from the code package for this example:'
  prefs: []
  type: TYPE_NORMAL
- en: Log on to one of the test clients with `don.hall@yourdomain1.com`. Don Hall
    is a Strategy Consultant.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the `Q3_Product_Strategy.docx` document.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Because of the sensitive content, Don classifies the document as Confidential | All
    Employees to classify and protect the information against people outside his organization,
    which is shown in the following image:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6ccf371d-1bda-4cf8-8240-da75d2ce7e81.png)'
  prefs: []
  type: TYPE_IMG
- en: All Employees AIP label
  prefs: []
  type: TYPE_NORMAL
- en: 'Save the file and send it to any of your personal email addresses and to `dan.jump@yourdomain1.com`,
    the CEO of our demo (be sure that he has a Microsoft 365 E5 license assigned):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/58562606-9eda-483b-9df4-4dd05339d8b3.png)'
  prefs: []
  type: TYPE_IMG
- en: Test mail including external contact
  prefs: []
  type: TYPE_NORMAL
- en: Try to open the email attachment on your private account—you won't get access!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log on to the second Windows 10 client with the `dan.jump@yourdomain1.com` user.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Open Outlook, open the attachment, and click View Permission...:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/95f67120-ea78-4d2f-b8c2-565bc6ebcc6f.png)'
  prefs: []
  type: TYPE_IMG
- en: Protected document with associated rights
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that we''ve worked on a document, and classified and protected it, including
    exchanging the information with an internal employee and an external account,
    we can view the monitoring capabilities of Azure Information Protection by following
    the steps listed here:'
  prefs: []
  type: TYPE_NORMAL
- en: Go back to the Don Hall client and open the protected document, `Q3_Product_Strategy.docx`,
    again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Azure Information Protection Protect button and choose Track and
    Revoke as shown in the image here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5bd1453b-4240-4f2f-9449-a14974139309.png)'
  prefs: []
  type: TYPE_IMG
- en: RMS Track and Revoke feature
  prefs: []
  type: TYPE_NORMAL
- en: You will be redirected to the Azure RMS tracking website: [https://track.azurerms.com/](https://track.azurerms.com/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in with `don.hall@yourdomain1.com`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You''ll get all the information about your protected document as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c3e260c3-2707-4924-9112-d46b9d3412ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Tracking report on the protected document
  prefs: []
  type: TYPE_NORMAL
- en: View all the capabilities you have as a user under Summary | List | Timeline
    | Map and Settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, we''ll look into the administrative portal blade of Azure Information
    Protection:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Under the Activity Logs section, you''ll be able to view all the activities
    on `Q3_Product_Strategy.docx`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c8578219-2979-48ba-a7d5-fba55d99a2bd.png)'
  prefs: []
  type: TYPE_IMG
- en: Activity logs of AIP operations
  prefs: []
  type: TYPE_NORMAL
- en: 'As we''ve already configured **Azure Log Analytics** in [Chapter 5](da02140a-858e-4ab1-9e31-a9a59df8d7f8.xhtml), *Configuring
    and Managing Identity Protection,* we can use the same Log Analytics workspace
    for our Azure Information Protection data under the Configure analytics (Preview) section.
    Ensure that the Enable the document content matches feature... checkbox is enabled:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/3521166f-31c5-4c9b-8274-5ed506f0abc2.png)'
  prefs: []
  type: TYPE_IMG
- en: Log analytics store
  prefs: []
  type: TYPE_NORMAL
- en: Under Activity logs (Preview), you will find the Log Analytics button—click
    it!
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We''ll be shown more detailed information about our classification and protection
    task with `don.hall@yourdomain1.com`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/71df5b3c-5a9d-4ede-9252-ad3997411493.png)'
  prefs: []
  type: TYPE_IMG
- en: Detailed log in Azure Log Analytics
  prefs: []
  type: TYPE_NORMAL
- en: 'You also can drill down directly over the Usage report (preview) section, which
    is demonstrated in the following image:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/629a1cac-91d0-4e02-be90-0aaad95170cb.png)'
  prefs: []
  type: TYPE_IMG
- en: Labels usage overview
  prefs: []
  type: TYPE_NORMAL
- en: 'Click the Log Analytics icon to view the generated query and the result:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/05107f34-7b30-4ea4-a3c3-425e76e95591.png)'
  prefs: []
  type: TYPE_IMG
- en: Specific log results of the document
  prefs: []
  type: TYPE_NORMAL
- en: To identify and classify more information, we'll use several methods such as
    keywords, or prepared sets of sensitive information, in [Chapter 15](1bedc98d-8713-410f-b51b-04c8e97de9bf.xhtml),
    *Configuring Azure Informatio**n Protection Solutions*. You can come back to the
    monitoring part and see the results.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we've seen the standard capabilities of Azure Information Protection
    for users and administrators to discover sensitive information, we can view the
    Windows Defender ATP features.
  prefs: []
  type: TYPE_NORMAL
- en: Scenario 2 – Monitoring with Windows Defender ATP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Windows Defender Advanced Threat Protection is basically designed to prevent,
    detect, investigate, and respond to advanced threats. We can also use it to detect
    and identify sensitive information, especially on client systems.
  prefs: []
  type: TYPE_NORMAL
- en: 'To work with this feature, we need to configure it and onboard the two test
    clients:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Visit [https://securitycenter.windows.com/](https://securitycenter.windows.com/) and
    log in as **global administrator** to start the configuration as shown in the
    image here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click Next:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/58feeda3-e407-4a12-9a24-e896e1dd89e7.png)'
  prefs: []
  type: TYPE_IMG
- en: Windows Security Center portal
  prefs: []
  type: TYPE_NORMAL
- en: 'Choose your storage location based on your needs:'
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/519b4692-6d0a-426d-86b8-5f8117be4a6d.png)'
  prefs: []
  type: TYPE_IMG
- en: Data storage configuration
  prefs: []
  type: TYPE_NORMAL
- en: Select the data retention policy.
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/34bdfdaf-e431-4021-a77a-533cea3399da.png)'
  prefs: []
  type: TYPE_IMG
- en: Retention time configuration
  prefs: []
  type: TYPE_NORMAL
- en: Select your organization size, the industry, and the preview experience.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Onboard the two test clients:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Download the package and install it.
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Run the detection test script on both clients:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/22ada1a2-702c-497f-8ce3-d0dac842c8e1.png)'
  prefs: []
  type: TYPE_IMG
- en: Onboarding the test script
  prefs: []
  type: TYPE_NORMAL
- en: 'Activate the Advanced features, including Azure Information Protection and
    Microsoft Cloud App Security, under Settings | General | Advanced Features:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/26e1d9e7-b17a-421b-82ba-8a2a3db2e271.png)'
  prefs: []
  type: TYPE_IMG
- en: Connected services configuration
  prefs: []
  type: TYPE_NORMAL
- en: 'The two demo clients will appear under the machine list:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/11ffe5dd-8311-43a1-8fc5-2b079a18d44b.png)'
  prefs: []
  type: TYPE_IMG
- en: Machine list
  prefs: []
  type: TYPE_NORMAL
- en: 'After the successful activation and onboarding of the two client machines to
    **Windows Defender ATP**, we''re ready to test the features for our sensitive
    data discovery:'
  prefs: []
  type: TYPE_NORMAL
- en: Log on to one of the test clients with `dan.jump@yourdomain1.com`. Dan Jump
    is the CEO.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the `Employee Details.xlsx` spreadsheet.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Classify the document as Highly Confidential | All Employees.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In [Chapter 15](1bedc98d-8713-410f-b51b-04c8e97de9bf.xhtml), *Configuring Azure
    Information Protection Solutions,* we'll provide the related classification and
    labels for the specific use cases. For now, it's just important to generate, modify,
    and use sensitive data.
  prefs: []
  type: TYPE_NORMAL
- en: 'Wait a few minutes to receive the results in the Data Discovery (Preview) section
    of Azure Information Protection:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/610285f4-1a42-4778-8852-c7e075d124fa.png)'
  prefs: []
  type: TYPE_IMG
- en: Label report from the clients
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on the client Endpoint:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/4425b86f-641f-40a1-80ef-c2fc407b2348.png)'
  prefs: []
  type: TYPE_IMG
- en: Client endpoint information
  prefs: []
  type: TYPE_NORMAL
- en: 'Awesome! This integration between the different services will let you discover
    sensitive data-handling in your environment. With Windows Defender ATP, Azure
    ATP, and Azure Information Protection, you can associate the three most important
    elements:'
  prefs: []
  type: TYPE_NORMAL
- en: The identity, including the authentication information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The data-handling associated to the identity itself
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The attacks against computers, servers your identity provider and at the end
    to your sensitive information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the next section, we'll dive into the Cloud App Security feature set to identify
    sensitive data in your cloud ecosystem.
  prefs: []
  type: TYPE_NORMAL
- en: Scenario 3 – Identifying sensitive information in your cloud ecosystem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Microsoft Cloud App Security is a **Cloud Access Security Broker** (**CASB**)
    that gives you the needed insights into your cloud app and services ecosystem.
    With this service, you're able to control how your data travels, and you can identify
    and work against cyber threats. In this section, we'll take a closer look at the
    discovery of sensitive information inside our demo environment.
  prefs: []
  type: TYPE_NORMAL
- en: First, we need to enable Cloud App Security and connect our cloud apps to monitor
    our cloud ecosystem. We also need to configure the Azure Information Protection
    integration to combine the services.
  prefs: []
  type: TYPE_NORMAL
- en: Visit [https://portal.cloudappsecurity.com](https://portal.cloudappsecurity.com)
    and log in with the global administrator credentials.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you''re working through all the labs in this book, your General dashboard
    will look like the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/aaf7f0d2-e6f0-4798-bb68-c650e882d79c.png)'
  prefs: []
  type: TYPE_IMG
- en: Cloud app security dashboard
  prefs: []
  type: TYPE_NORMAL
- en: 'With the following steps, we start the configuration:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Connect the apps we configured in the previous chapters to the Cloud App Security
    framework:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Office 365
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Salesforce
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Dropbox
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Azure
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This can be done through the getting started wizard—click Connect apps:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a70795b6-1591-4b63-897b-28fddc78ab3d.png)'
  prefs: []
  type: TYPE_IMG
- en: Connecting additional apps to cloud app security
  prefs: []
  type: TYPE_NORMAL
- en: Connect these apps with the + dropdown.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Provide the **related administrative credentials** to connect the apps:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1f6d83a7-174a-46d6-9944-7c29726b19d3.png)'
  prefs: []
  type: TYPE_IMG
- en: Cloud app connectors
  prefs: []
  type: TYPE_NORMAL
- en: 'To give you an example, we''ll demonstrate the process with Salesforce:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Provide your Salesforce instance name:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2238c931-7f81-4f1d-a8ac-439fcdede8ff.png)'
  prefs: []
  type: TYPE_IMG
- en: Connecting Salesforce
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow the link to connect the app and allow the required permissions:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/85637b72-5736-4a7a-8b2c-fe8fff22889c.png)'
  prefs: []
  type: TYPE_IMG
- en: Permission assignment
  prefs: []
  type: TYPE_NORMAL
- en: 'Provide your administrative credentials:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d81730fb-1b2b-41c9-8157-b91c36e5282b.png)'
  prefs: []
  type: TYPE_IMG
- en: Providing admin credentials
  prefs: []
  type: TYPE_NORMAL
- en: 'You will be requested to consent—click Allow:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3ac112d7-cf6f-4b44-8dd7-15bd10e2647a.png)'
  prefs: []
  type: TYPE_IMG
- en: Checking and accepting OAuth consent
  prefs: []
  type: TYPE_NORMAL
- en: 'Cloud App Security will start scanning the users, data, and activities:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/960e730a-05c9-4fcc-bb36-be14a5630110.png)'
  prefs: []
  type: TYPE_IMG
- en: Cloud app security starting the discovery process
  prefs: []
  type: TYPE_NORMAL
- en: 'You will receive a Connected status:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3597047f-32e0-4515-8bd0-5a55314d17bc.png)'
  prefs: []
  type: TYPE_IMG
- en: Salesforce connection status
  prefs: []
  type: TYPE_NORMAL
- en: Use the wizards for every application that's connected to Cloud App Security.
  prefs: []
  type: TYPE_NORMAL
- en: 'Activate the Azure Information Protection integration in the Settings section:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ef072155-bdc4-451f-8a42-92886e865e1f.png)'
  prefs: []
  type: TYPE_IMG
- en: Configuring AIP integration
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to Information Protection | Azure Information Protection and set active
    the following two settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7e3f2047-504c-4154-af83-9d53834ab220.png)'
  prefs: []
  type: TYPE_IMG
- en: AIP settings in Cloud App Security
  prefs: []
  type: TYPE_NORMAL
- en: 'Grant permission to Cloud App Security to inspect protected files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a69d5c53-7998-4c4a-b5e9-28e677224379.png)'
  prefs: []
  type: TYPE_IMG
- en: OAuth consent to assign permissions
  prefs: []
  type: TYPE_NORMAL
- en: Click Accept.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now, that we have connected our apps to Cloud App Security and configured the
    Azure Information protection, we can start, to work through our next tasks. With
    the following steps we start the configuration:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in to one of the test clients with `ye.xu@yourdomain1.com`. Ye Xu works
    in Sales.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in to your Access Panel UI: [https://myapps.microsoft.com.](https://myapps.microsoft.com)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click Salesforce.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Post the following files from the code package:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Q3 Sales and Marketing Expense Report Audit
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Employee Details
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: de-drv
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: Superstore Sales
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Customer Accounts:'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/56c63f6f-4336-4f49-84c1-a2885915f908.png)'
  prefs: []
  type: TYPE_IMG
- en: Salesforce user view and data usage behavior
  prefs: []
  type: TYPE_NORMAL
- en: Jump back to the Cloud App Security portal ([https://portal.cloudappsecurity.com](https://portal.cloudappsecurity.com))
    as a global administrator.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Navigate to Investigate | Files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5009b70b-e62b-4d8d-90c5-b84f2ef1b95c.png)'
  prefs: []
  type: TYPE_IMG
- en: Cloud App Security file usage overview
  prefs: []
  type: TYPE_NORMAL
- en: 'Change the APP to Salesforce—your posted files are now viewable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/56bd383b-5782-49e7-80bc-a07059843b44.png)'
  prefs: []
  type: TYPE_IMG
- en: Data usage report of Salesforce
  prefs: []
  type: TYPE_NORMAL
- en: 'Some sensitive data was transferred unprotected to Salesforce, and from this
    point, we can define rules that this information is blocked if someone uploads
    it to such an application. If we change the filter to Microsoft OneDrive for Business
    and you upload the documents to these locations, **Cloud App Security** is already
    able to set the correct classification label manually or automatically on the
    information:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a22bdaf2-9aae-4487-b9a0-f32a060b20e2.png)'
  prefs: []
  type: TYPE_IMG
- en: Applying classification labels with Cloud App Security
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that we''ve seen a few powerful features of Cloud App Security, let''s
    check out the last scenario: using Office 365 for data-leakage prevention.'
  prefs: []
  type: TYPE_NORMAL
- en: Scenario 4 – Data leakage prevention in Office 365
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we'll use an Exchange Online Mail flow rule to detect sensitive
    information. We'll encrypt the mail to protect the content automatically. This
    is a typical use case.
  prefs: []
  type: TYPE_NORMAL
- en: 'We create the Exchange Online Mail flow rules:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Rule 1**: Encrypts any email that contains a credit card number if the mail
    leaves the organization:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '**Rule 2**: Prevents emails from being sent externally if they''re classified
    as `Confidential / All Employees`:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Log on to one of the test clients with `ye.xu@yourdomain1.com`. Ye Xu works
    in Sales.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Send a mail with the following content to `Karim.Manar@yourdomain1.com` and
    your private email address. Karim is a Controller.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Hi Karim
  prefs: []
  type: TYPE_NORMAL
- en: My AMEX card number is 344047014854133\. The expiration date is 09/28, and the
    CVV is 4368
  prefs: []
  type: TYPE_NORMAL
- en: Best regards
  prefs: []
  type: TYPE_NORMAL
- en: Ye
  prefs: []
  type: TYPE_NORMAL
- en: Log in as `Karim.Manar@yourdomain1.com` on the second client and view the email.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Log in to your private account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click Read the message and you can read the message:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6754671e-5f5f-4393-a5ad-c444f549cb41.png)'
  prefs: []
  type: TYPE_IMG
- en: OMEv2 user experience
  prefs: []
  type: TYPE_NORMAL
- en: Log in to one of the test clients with `Dan.Jump@yourdomain1.com`. Dan is the
    CEO.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Classify an email with the following content as Confidential | All Employees,
    then send it to your private email account and to Ye Xu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a04138ca-fffa-42c9-a365-c6ef8c7fc5c6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You should receive a message similar to this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/72f78c2c-d411-4826-aa37-92c5c93a7b16.png)'
  prefs: []
  type: TYPE_IMG
- en: Office 365 DLP message
  prefs: []
  type: TYPE_NORMAL
- en: With this scenario, we saw a few capabilities of the Office 365 service, which
    helps us to discover and identify sensitive content. In the next section, we'll
    explore the functionalities of the Azure Information features for data at rest.
  prefs: []
  type: TYPE_NORMAL
- en: Understanding and using AIP capabilities for data at rest
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The identification and detection of sensitive information that isn''t actively
    moved is a very important component inside an information-protection solution.
    For this reason, Microsoft provides the Azure Information Protection scanner,
    which allows you to scan two typical file locations, File Shares and SharePoint
    Document libraries, as you can see in the following diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a9bac3f5-d0b5-47d1-ac0d-b1146092192f.png)'
  prefs: []
  type: TYPE_IMG
- en: Azure Information Protection scanner architecture and components
  prefs: []
  type: TYPE_NORMAL
- en: 'To explore the functionality of the **AIP Scanner**, we need to distribute
    some of our example documents to the following file locations:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Move the example contents from the code package to the **YD1INF01** server
    where we created the following test shares:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c67cfb98-5a59-4bf8-bd9c-a2c81c9cc070.png)'
  prefs: []
  type: TYPE_IMG
- en: Example file structure
  prefs: []
  type: TYPE_NORMAL
- en: 'Upload some of the test files to your document library on SharePoint:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/aa3a718c-d9e5-4b53-8587-7fed3ebe03b4.png)'
  prefs: []
  type: TYPE_IMG
- en: Sample data on SharePoint
  prefs: []
  type: TYPE_NORMAL
- en: 'We need to install and configure the **AIP Scanner** on our **YD1APP01** server
    where, in [Chapter 7](468509fa-856c-411d-abdb-e9a39c266750.xhtml), *Deploying
    Solutions on Azure AD and ADFS*, we installed the SQL server:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following command to create the service account with which the AIP
    Scanner service runs and scans:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'If you want to work with a cloud-only account, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Synchronize the service account to your Azure AD:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d177f328-0468-490c-bb89-55a2c097609d.png)'
  prefs: []
  type: TYPE_IMG
- en: Synchronized AIP Scanner service account in Azure AD
  prefs: []
  type: TYPE_NORMAL
- en: 'The service account needs the following rights on different services:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Log on locally (need to be assigned) and Log on as service right (accomplished
    by the installation):'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/3e8b23a1-2a73-4da8-892d-e25ed716fd37.png)'
  prefs: []
  type: TYPE_IMG
- en: Log on locally permission assignment
  prefs: []
  type: TYPE_NORMAL
- en: 'Read (Discovery) or Contribute rights on the document library for classification/protection:'
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/c3e5949d-9c36-44da-9e26-b6abee51501a.png)'
  prefs: []
  type: TYPE_IMG
- en: SharePoint access rights for the AIP Scanner service account
  prefs: []
  type: TYPE_NORMAL
- en: 'The following list shows the needed permissions:'
  prefs: []
  type: TYPE_NORMAL
- en: Read permissions to each file share repository for discovery, and Read/Write
    permissions for classification/protection
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: Local administrator of the server and permissions to write to the SQL Server
    master database, **SQL specific permissions** if you can't grant the Sysadmin
    rights for the installation
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: AzInfoProtectionScanner database needs to be created manually
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following accounts need to be `db_owner`:'
  prefs: []
  type: TYPE_NORMAL
- en: Service account for the scanner
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: User account for scanner installation
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: User account for scanner configuration
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: For labels that re-protect or remove protection, the account needs to be part
    of the super users group
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Install the **Azure RMS PowerShell** module with the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Connect to Azure RMS with the following cmdlet and global administrator credentials:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Enable the **Azure RMS Super User** feature, which is disabled by default:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Create a **mail-enabled group** called in your Azure AD and assign the group
    as `SuperUserGroup`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: We will discuss the **Super Users Group** in more depth in [Chapter 15](1bedc98d-8713-410f-b51b-04c8e97de9bf.xhtml),
    *Configuring Azure Information Protection Solutions*.
  prefs: []
  type: TYPE_NORMAL
- en: Download the **AzInfoProtection.exe** binary from [https://bit.ly/2ccqSu0](https://bit.ly/2ccqSu0)[.](https://bit.ly/2ccqSu0)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the binary installation on the **YD1APP01** server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Install the AIP Scanner on the server:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'To run the configuration tasks, install the `AzureADPreview` PowerShell Module:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'Run the following command to **connect to your Azure AD** and provide global
    administrator credentials:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'Create the `WebApp` and the associated `Service Principle`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Build the `RequiredResourceAccess` object that''s needed to **automate delegation**
    of permissions for the native application:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'Run the following command to create the `Native App` and associated Service
    Principle:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'Build the `Set-AIPAuthentication` command, to run it under the AIP Scanner
    service account:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: Open a PowerShell (Run as different user) and provide the on-premises AIP Scanner
    Service account credentials.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Run the command from the `Set-AIPAuthentication.txt` file, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: Accept to acquire an **authentication token**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart the AIP Scanner.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the next procedure, we will provide the steps to **upgrade** the AIP Scanner
    from a GA version to the newest preview version, `AzInfoProtection_PREVIEW_1.45.32.0.exe`:'
  prefs: []
  type: TYPE_NORMAL
- en: Download the newest preview from [https://bit.ly/2ccqSu0](https://bit.ly/2ccqSu0)
    and install the binaries.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Update the scanner with the `Profile` parameter:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'To check that the scanner successfully restarts, **create the profile** in
    the Azure Information Protection blade:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0ebac29d-93c2-44dd-b576-a2f572bd3ef9.png)'
  prefs: []
  type: TYPE_IMG
- en: AIP Profiles for location handling
  prefs: []
  type: TYPE_NORMAL
- en: 'The database will also be renamed to the profile name:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6e110594-ad39-4ffe-86c6-f691d969360e.png)'
  prefs: []
  type: TYPE_IMG
- en: AIP Scanner database viewed in SQL Management Studio
  prefs: []
  type: TYPE_NORMAL
- en: Open the newly-created profile and configure the AIP Scanner settings
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Configure the following repositories (replace the server name):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/dcc97e44-16eb-40c9-a2cf-cbb583b83642.png)'
  prefs: []
  type: TYPE_IMG
- en: Configured AIP Scanner repositories
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following configuration for all the file-share repositories and the
    SharePoint document library:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/87a656da-8020-403a-8541-0ae30da786ab.png)'
  prefs: []
  type: TYPE_IMG
- en: Repository policy settings options
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following settings for the Profile:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/84b21e06-7ff4-4c2b-963f-cfab5d952e3c.png)'
  prefs: []
  type: TYPE_IMG
- en: Profile settings section for the AIP Scanner
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the Policies settings under the Classifications section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Global policy and change the default label to General:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2e23fd35-c502-4cb4-ad5f-b11376c03d7b.png)'
  prefs: []
  type: TYPE_IMG
- en: Default label configuration in AIP Global Policy
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to the Scanner | Nodes section, mark the scanner server, and click
    Scan now:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/960de517-3c04-405a-836c-0cd1b70c00fd.png)'
  prefs: []
  type: TYPE_IMG
- en: Enabling a scan on the repositories
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to Dashboards | Data discovery (Preview) to view the first results:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a613fd9b-ce6f-4c4b-858b-b0a206ac57f6.png)'
  prefs: []
  type: TYPE_IMG
- en: Discovery results from the scanner
  prefs: []
  type: TYPE_NORMAL
- en: Read the following articles for information on customizing your configuration
    to your needs:[ https://bit.ly/2T9CPn6](https://bit.ly/2T9CPn6) and [https://bit.ly/2Dk2YdK](https://bit.ly/2Dk2YdK).
  prefs: []
  type: TYPE_NORMAL
- en: You can also use all the discussed technologies to gather information about
    data at rest. But, it's very important to understand that everything depends on
    the quality of your detection rules that you can get from the data in motion and
    the associated processes. We will follow up on this rule in [Chapter 15](1bedc98d-8713-410f-b51b-04c8e97de9bf.xhtml),
    *Configuring Azure Information Protection Solutions*.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we discussed and configured the key technologies for the discovery
    of sensitive data in motion, transit, and at rest. You saw how important these
    tasks are, and the benefits and data control they provide in your environment.
    They give you the power to build efficient detection and data-leakage-prevention
    rules. We'll use this knowledge to build an Azure Information Protection solution
    in [Chapter 15](1bedc98d-8713-410f-b51b-04c8e97de9bf.xhtml), *Configuring Azure
    Information Protection Solutions*. But first, we'll learn more about the Azure
    RMS keys, which you need to understand to follow the protection process and find
    the right tool to troubleshoot against errors.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, you'll learn how Azure RMS keys are used and which deployment
    models are available for different compliance requirements.
  prefs: []
  type: TYPE_NORMAL
